import{A as S,B as _,C as a,F as s,G as c,H as u,I as k,J as d,K as m,L as r,M as D,N as b,T as w,U as E,a as H,aa as M,b as I,ba as P,ca as N,da as Y,k as f,la as R,m as T,ma as V,n as y,na as h,oa as F,q as g,r as x,v as n,w as B}from"./chunk-5ZUFUI6A.js";function L(i,e){if(i&1&&(s(0,"span"),r(1),w(2,"date"),c()),i&2){let t=m().$implicit;a("background","#f8d7da")("width","100%")("display","block"),n(),D(E(2,7,t.date,"dd-MM-YYYY"))}}function j(i,e){if(i&1){let t=k();s(0,"span"),S(1,L,3,10,"span",3),u(2,"br"),r(3,"\u0426\u0435\u043D\u0430: "),s(4,"span"),r(5),c(),u(6,"br"),s(7,"div"),r(8,"Category: "),s(9,"span",4),d("click",function(){let p=g(t).$implicit,l=m();return x(l.showCategoryDetails(p.category))}),r(10),c()(),r(11),w(12,"date"),u(13,"br")(14,"br"),s(15,"span",4),d("click",function(){let p=g(t).index,l=m();return x(l.onDelete(p))}),r(16,"Delete |"),c(),s(17,"span",4),d("click",function(){let p=g(t).index,l=m();return x(l.onDeleteFromBalance(p))}),r(18," Delete from balance"),c(),u(19,"hr"),c()}if(i&2){let t=e.$implicit,o=m();n(),_("ngIf",t.showDateTitle),n(3),a("color","#DB2C07"),n(),b("",t.amount,"\u20AC"),n(4),a("color","blue"),n(),D(o.getCategoryNameByIdFunc(t.category)),n(),b(" Date: ",E(12,20,t.date,"HH:mm")," "),n(4),a("color","grey")("cursor","pointer"),n(2),a("color","grey")("cursor","pointer"),n(2),a("background","#f8d7da")("height","2px")}}var v=class i{constructor(e){this.router=e}expenses=[];totalAmount=0;temporaryDate=0;getCategoryNameByIdFunc=F;ngOnInit(){this.expenses=JSON.parse(localStorage.getItem("expenses")||"[]").map(e=>I(H({},e),{showDateTitle:this.isDatePanelVisible(e.date)})),this.sumValues()}onDelete(e){confirm("Delete?")&&(this.updateBalance(e),this.expenses.splice(e,1),localStorage.setItem("expenses",JSON.stringify(this.expenses)),this.sumValues())}updateBalance(e){let t=Number(localStorage.getItem("balance"))||0;if(t){let o=Math.round((t+this.expenses[e].amount)*100)/100;localStorage.setItem("balance",o.toString())}}onDeleteFromBalance(e){confirm("Return to balance?")&&this.updateBalance(e)}onSwipeRight(){this.router.navigate(["/"])}showCategoryDetails(e){this.router.navigate(["/details"],{queryParams:{"category-id":e,"back-url":"/history"}})}isDatePanelVisible(e){return this.temporaryDate===0?(this.temporaryDate=e,!0):new Date(this.temporaryDate).toDateString()===new Date(e).toDateString()?!1:(this.temporaryDate=e,!0)}touchStartX=0;touchStartY=0;touchEndX=0;touchEndY=0;onTouchStart(e){this.touchStartX=e.changedTouches[0].screenX,this.touchStartY=e.changedTouches[0].screenY}onTouchEnd(e){this.touchEndX=e.changedTouches[0].screenX,this.touchEndY=e.changedTouches[0].screenY,this.handleSwipeGesture()}handleSwipeGesture(){let e=this.touchEndX-this.touchStartX,t=this.touchEndY-this.touchStartY;Math.abs(e)>Math.abs(t)&&(e>50?this.onSwipeRight():e<-50&&this.onSwipeLeft())}onSwipeLeft(){this.router.navigate(["/statistics"])}sumValues(){this.totalAmount=this.expenses.reduce((e,t)=>{let o=e+t.amount;return Math.round(o*100)/100},0)}static \u0275fac=function(t){return new(t||i)(B(R))};static \u0275cmp=T({type:i,selectors:[["app-history"]],hostBindings:function(t,o){t&1&&d("touchstart",function(l){return o.onTouchStart(l)})("touchend",function(l){return o.onTouchEnd(l)})},decls:11,vars:15,consts:[[1,"history-container"],[3,"routerLink"],[4,"ngFor","ngForOf"],[3,"background","width","display",4,"ngIf"],[3,"click"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"span",1),r(2,"< Back"),c(),u(3,"br"),s(4,"div")(5,"span"),r(6,"\u041E\u0431\u0449\u0438\u0439 \u0440\u0430\u0441\u0445\u043E\u0434: "),c(),s(7,"span"),r(8),c()(),u(9,"hr"),S(10,j,20,23,"span",2),c()),t&2&&(n(),a("color","blue")("cursor","pointer"),_("routerLink","/"),n(3),a("margin","10","px"),n(3),a("color","#DB2C07"),n(),b("",o.totalAmount,"\u20AC"),n(),a("background","#f8d7da")("height","2px"),n(),_("ngForOf",o.expenses))},dependencies:[V,M,P,N],styles:[".history-container[_ngcontent-%COMP%]{overflow-y:scroll}"]})};var A=[{path:"",component:v}],C=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=y({type:i});static \u0275inj=f({imports:[h.forChild(A),h]})};var X=class i{static \u0275fac=function(t){return new(t||i)};static \u0275mod=y({type:i});static \u0275inj=f({imports:[h,C,Y]})};export{X as HistoryModule};
