import{a as Vy,b as Fd,c as Ny,d as ka,e as Ld,f as Al,g as Fy,h as Ly,i as Bd,j as jt,k as qr,l as Un,m as Cl,n as Ra,o as By,p as zy,q as Ui,r as $e,s as zd}from"./chunk-7PBWPF3H.js";import{$ as zt,A as ht,Aa as Ay,B as dy,Ba as Cy,C as Oe,Ca as Py,D as gi,Da as Nd,E as xl,Ea as ky,F as wl,G as rt,Ga as Ry,H as st,Ha as Dy,I as fy,Ia as My,J as Te,K as jn,L as Tl,M as Us,Ma as Oy,N as py,Na as jy,O as gy,Oa as Uy,P as nt,Pa as qi,Q as $t,Qa as qy,R as Ee,Ra as jd,S as Ct,Sa as Wi,T as Ie,Ta as Wy,U as El,Ua as Wr,V as my,Va as Hy,W as Y,X,Y as me,a as Bs,aa as ot,b as zs,ba as tt,c as sy,ca as Ca,d as ml,da as et,e as oy,ea as gn,f as jr,fa as _e,g as js,ga as _y,h as zi,ha as yy,i as ji,ia as vy,j as Be,ja as by,k as ay,ka as Md,l as cy,la as Od,m as Aa,n as _l,na as Pa,o as ly,oa as xy,p as yl,pa as wy,q as vl,qa as Vd,r as Rd,ra as Ty,s as bl,sa as Ey,t as Ur,ta as Il,u as Dd,ua as mn,v as uy,va as Iy,w as hy,wa as Sy,x as Me,y as pi,z as we,za as Sl}from"./chunk-HQIQ7A42.js";import{a as pn,b as Rn,c as KI,e as ry,f as kd,g as U}from"./chunk-FP237ANB.js";var Ud=KI((uN,Pl)=>{(function(n,t,e,i){"use strict";var r=["","webkit","Moz","MS","ms","o"],s=t.createElement("div"),o="function",a=Math.round,c=Math.abs,l=Date.now;function h(_,x,C){return setTimeout(R(_,C),x)}function d(_,x,C){return Array.isArray(_)?(p(_,C[x],C),!0):!1}function p(_,x,C){var N;if(_)if(_.forEach)_.forEach(x,C);else if(_.length!==i)for(N=0;N<_.length;)x.call(C,_[N],N,_),N++;else for(N in _)_.hasOwnProperty(N)&&x.call(C,_[N],N,_)}function g(_,x,C){var N="DEPRECATED METHOD: "+x+`
`+C+` AT 
`;return function(){var W=new Error("get-stack-trace"),Q=W&&W.stack?W.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",ut=n.console&&(n.console.warn||n.console.log);return ut&&ut.call(n.console,N,Q),_.apply(this,arguments)}}var y;typeof Object.assign!="function"?y=function(x){if(x===i||x===null)throw new TypeError("Cannot convert undefined or null to object");for(var C=Object(x),N=1;N<arguments.length;N++){var W=arguments[N];if(W!==i&&W!==null)for(var Q in W)W.hasOwnProperty(Q)&&(C[Q]=W[Q])}return C}:y=Object.assign;var v=g(function(x,C,N){for(var W=Object.keys(C),Q=0;Q<W.length;)(!N||N&&x[W[Q]]===i)&&(x[W[Q]]=C[W[Q]]),Q++;return x},"extend","Use `assign`."),w=g(function(x,C){return v(x,C,!0)},"merge","Use `assign`.");function k(_,x,C){var N=x.prototype,W;W=_.prototype=Object.create(N),W.constructor=_,W._super=N,C&&y(W,C)}function R(_,x){return function(){return _.apply(x,arguments)}}function M(_,x){return typeof _==o?_.apply(x&&x[0]||i,x):_}function F(_,x){return _===i?x:_}function V(_,x,C){p(E(x),function(N){_.addEventListener(N,C,!1)})}function L(_,x,C){p(E(x),function(N){_.removeEventListener(N,C,!1)})}function I(_,x){for(;_;){if(_==x)return!0;_=_.parentNode}return!1}function b(_,x){return _.indexOf(x)>-1}function E(_){return _.trim().split(/\s+/g)}function A(_,x,C){if(_.indexOf&&!C)return _.indexOf(x);for(var N=0;N<_.length;){if(C&&_[N][C]==x||!C&&_[N]===x)return N;N++}return-1}function P(_){return Array.prototype.slice.call(_,0)}function D(_,x,C){for(var N=[],W=[],Q=0;Q<_.length;){var ut=x?_[Q][x]:_[Q];A(W,ut)<0&&N.push(_[Q]),W[Q]=ut,Q++}return C&&(x?N=N.sort(function(le,be){return le[x]>be[x]}):N=N.sort()),N}function S(_,x){for(var C,N,W=x[0].toUpperCase()+x.slice(1),Q=0;Q<r.length;){if(C=r[Q],N=C?C+W:x,N in _)return N;Q++}return i}var Mt=1;function ft(){return Mt++}function xt(_){var x=_.ownerDocument||_;return x.defaultView||x.parentWindow||n}var wt=/mobile|tablet|ip(ad|hone|od)|android/i,te="ontouchstart"in n,Wt=S(n,"PointerEvent")!==i,En=te&&wt.test(navigator.userAgent),ln="touch",ye="pen",At="mouse",In="kinect",en=25,Ot=1,nn=2,Ht=4,ke=8,oi=1,Bn=2,ai=4,ci=8,li=16,qe=Bn|ai,zn=ci|li,oa=qe|zn,Qc=["x","y"],Ar=["clientX","clientY"];function Le(_,x){var C=this;this.manager=_,this.callback=x,this.element=_.element,this.target=_.options.inputTarget,this.domHandler=function(N){M(_.options.enable,[_])&&C.handler(N)},this.init()}Le.prototype={handler:function(){},init:function(){this.evEl&&V(this.element,this.evEl,this.domHandler),this.evTarget&&V(this.target,this.evTarget,this.domHandler),this.evWin&&V(xt(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&L(this.element,this.evEl,this.domHandler),this.evTarget&&L(this.target,this.evTarget,this.domHandler),this.evWin&&L(xt(this.element),this.evWin,this.domHandler)}};function aa(_){var x,C=_.options.inputClass;return C?x=C:Wt?x=ui:En?x=Dr:te?x=di:x=Ps,new x(_,Xc)}function Xc(_,x,C){var N=C.pointers.length,W=C.changedPointers.length,Q=x&Ot&&N-W===0,ut=x&(Ht|ke)&&N-W===0;C.isFirst=!!Q,C.isFinal=!!ut,Q&&(_.session={}),C.eventType=x,xd(_,C),_.emit("hammer.input",C),_.recognize(C),_.session.prevInput=C}function xd(_,x){var C=_.session,N=x.pointers,W=N.length;C.firstInput||(C.firstInput=As(x)),W>1&&!C.firstMultiple?C.firstMultiple=As(x):W===1&&(C.firstMultiple=!1);var Q=C.firstInput,ut=C.firstMultiple,ee=ut?ut.center:Q.center,le=x.center=ce(N);x.timeStamp=l(),x.deltaTime=x.timeStamp-Q.timeStamp,x.angle=Cs(ee,le),x.distance=Pr(ee,le),ca(C,x),x.offsetDirection=Cr(x.deltaX,x.deltaY);var be=pe(x.deltaTime,x.deltaX,x.deltaY);x.overallVelocityX=be.x,x.overallVelocityY=be.y,x.overallVelocity=c(be.x)>c(be.y)?be.x:be.y,x.scale=ut?kr(ut.pointers,N):1,x.rotation=ut?wd(ut.pointers,N):0,x.maxPointers=C.prevInput?x.pointers.length>C.prevInput.maxPointers?x.pointers.length:C.prevInput.maxPointers:x.pointers.length,la(C,x);var fn=_.element;I(x.srcEvent.target,fn)&&(fn=x.srcEvent.target),x.target=fn}function ca(_,x){var C=x.center,N=_.offsetDelta||{},W=_.prevDelta||{},Q=_.prevInput||{};(x.eventType===Ot||Q.eventType===Ht)&&(W=_.prevDelta={x:Q.deltaX||0,y:Q.deltaY||0},N=_.offsetDelta={x:C.x,y:C.y}),x.deltaX=W.x+(C.x-N.x),x.deltaY=W.y+(C.y-N.y)}function la(_,x){var C=_.lastInterval||x,N=x.timeStamp-C.timeStamp,W,Q,ut,ee;if(x.eventType!=ke&&(N>en||C.velocity===i)){var le=x.deltaX-C.deltaX,be=x.deltaY-C.deltaY,fn=pe(N,le,be);Q=fn.x,ut=fn.y,W=c(fn.x)>c(fn.y)?fn.x:fn.y,ee=Cr(le,be),_.lastInterval=x}else W=C.velocity,Q=C.velocityX,ut=C.velocityY,ee=C.direction;x.velocity=W,x.velocityX=Q,x.velocityY=ut,x.direction=ee}function As(_){for(var x=[],C=0;C<_.pointers.length;)x[C]={clientX:a(_.pointers[C].clientX),clientY:a(_.pointers[C].clientY)},C++;return{timeStamp:l(),pointers:x,center:ce(x),deltaX:_.deltaX,deltaY:_.deltaY}}function ce(_){var x=_.length;if(x===1)return{x:a(_[0].clientX),y:a(_[0].clientY)};for(var C=0,N=0,W=0;W<x;)C+=_[W].clientX,N+=_[W].clientY,W++;return{x:a(C/x),y:a(N/x)}}function pe(_,x,C){return{x:x/_||0,y:C/_||0}}function Cr(_,x){return _===x?oi:c(_)>=c(x)?_<0?Bn:ai:x<0?ci:li}function Pr(_,x,C){C||(C=Qc);var N=x[C[0]]-_[C[0]],W=x[C[1]]-_[C[1]];return Math.sqrt(N*N+W*W)}function Cs(_,x,C){C||(C=Qc);var N=x[C[0]]-_[C[0]],W=x[C[1]]-_[C[1]];return Math.atan2(W,N)*180/Math.PI}function wd(_,x){return Cs(x[1],x[0],Ar)+Cs(_[1],_[0],Ar)}function kr(_,x){return Pr(x[0],x[1],Ar)/Pr(_[0],_[1],Ar)}var Jc={mousedown:Ot,mousemove:nn,mouseup:Ht},Zc="mousedown",ua="mousemove mouseup";function Ps(){this.evEl=Zc,this.evWin=ua,this.pressed=!1,Le.apply(this,arguments)}k(Ps,Le,{handler:function(x){var C=Jc[x.type];C&Ot&&x.button===0&&(this.pressed=!0),C&nn&&x.which!==1&&(C=Ht),this.pressed&&(C&Ht&&(this.pressed=!1),this.callback(this.manager,C,{pointers:[x],changedPointers:[x],pointerType:At,srcEvent:x}))}});var Td={pointerdown:Ot,pointermove:nn,pointerup:Ht,pointercancel:ke,pointerout:ke},ha={2:ln,3:ye,4:At,5:In},da="pointerdown",fa="pointermove pointerup pointercancel";n.MSPointerEvent&&!n.PointerEvent&&(da="MSPointerDown",fa="MSPointerMove MSPointerUp MSPointerCancel");function ui(){this.evEl=da,this.evWin=fa,Le.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}k(ui,Le,{handler:function(x){var C=this.store,N=!1,W=x.type.toLowerCase().replace("ms",""),Q=Td[W],ut=ha[x.pointerType]||x.pointerType,ee=ut==ln,le=A(C,x.pointerId,"pointerId");Q&Ot&&(x.button===0||ee)?le<0&&(C.push(x),le=C.length-1):Q&(Ht|ke)&&(N=!0),!(le<0)&&(C[le]=x,this.callback(this.manager,Q,{pointers:C,changedPointers:[x],pointerType:ut,srcEvent:x}),N&&C.splice(le,1))}});var pa={touchstart:Ot,touchmove:nn,touchend:Ht,touchcancel:ke},ga="touchstart",hi="touchstart touchmove touchend touchcancel";function ma(){this.evTarget=ga,this.evWin=hi,this.started=!1,Le.apply(this,arguments)}k(ma,Le,{handler:function(x){var C=pa[x.type];if(C===Ot&&(this.started=!0),!!this.started){var N=ks.call(this,x,C);C&(Ht|ke)&&N[0].length-N[1].length===0&&(this.started=!1),this.callback(this.manager,C,{pointers:N[0],changedPointers:N[1],pointerType:ln,srcEvent:x})}}});function ks(_,x){var C=P(_.touches),N=P(_.changedTouches);return x&(Ht|ke)&&(C=D(C.concat(N),"identifier",!0)),[C,N]}var tl={touchstart:Ot,touchmove:nn,touchend:Ht,touchcancel:ke},Rr="touchstart touchmove touchend touchcancel";function Dr(){this.evTarget=Rr,this.targetIds={},Le.apply(this,arguments)}k(Dr,Le,{handler:function(x){var C=tl[x.type],N=ve.call(this,x,C);N&&this.callback(this.manager,C,{pointers:N[0],changedPointers:N[1],pointerType:ln,srcEvent:x})}});function ve(_,x){var C=P(_.touches),N=this.targetIds;if(x&(Ot|nn)&&C.length===1)return N[C[0].identifier]=!0,[C,C];var W,Q,ut=P(_.changedTouches),ee=[],le=this.target;if(Q=C.filter(function(be){return I(be.target,le)}),x===Ot)for(W=0;W<Q.length;)N[Q[W].identifier]=!0,W++;for(W=0;W<ut.length;)N[ut[W].identifier]&&ee.push(ut[W]),x&(Ht|ke)&&delete N[ut[W].identifier],W++;if(ee.length)return[D(Q.concat(ee),"identifier",!0),ee]}var el=2500,Oi=25;function di(){Le.apply(this,arguments);var _=R(this.handler,this);this.touch=new Dr(this.manager,_),this.mouse=new Ps(this.manager,_),this.primaryTouch=null,this.lastTouches=[]}k(di,Le,{handler:function(x,C,N){var W=N.pointerType==ln,Q=N.pointerType==At;if(!(Q&&N.sourceCapabilities&&N.sourceCapabilities.firesTouchEvents)){if(W)Ed.call(this,C,N);else if(Q&&Vi.call(this,N))return;this.callback(x,C,N)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});function Ed(_,x){_&Ot?(this.primaryTouch=x.changedPointers[0].identifier,nl.call(this,x)):_&(Ht|ke)&&nl.call(this,x)}function nl(_){var x=_.changedPointers[0];if(x.identifier===this.primaryTouch){var C={x:x.clientX,y:x.clientY};this.lastTouches.push(C);var N=this.lastTouches,W=function(){var Q=N.indexOf(C);Q>-1&&N.splice(Q,1)};setTimeout(W,el)}}function Vi(_){for(var x=_.srcEvent.clientX,C=_.srcEvent.clientY,N=0;N<this.lastTouches.length;N++){var W=this.lastTouches[N],Q=Math.abs(x-W.x),ut=Math.abs(C-W.y);if(Q<=Oi&&ut<=Oi)return!0}return!1}var il=S(s.style,"touchAction"),rl=il!==i,Mr="compute",_a="auto",Or="manipulation",un="none",We="pan-x",Ni="pan-y",Vr=sl();function Nr(_,x){this.manager=_,this.set(x)}Nr.prototype={set:function(_){_==Mr&&(_=this.compute()),rl&&this.manager.element.style&&Vr[_]&&(this.manager.element.style[il]=_),this.actions=_.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var _=[];return p(this.manager.recognizers,function(x){M(x.options.enable,[x])&&(_=_.concat(x.getTouchAction()))}),ya(_.join(" "))},preventDefaults:function(_){var x=_.srcEvent,C=_.offsetDirection;if(this.manager.session.prevented){x.preventDefault();return}var N=this.actions,W=b(N,un)&&!Vr[un],Q=b(N,Ni)&&!Vr[Ni],ut=b(N,We)&&!Vr[We];if(W){var ee=_.pointers.length===1,le=_.distance<2,be=_.deltaTime<250;if(ee&&le&&be)return}if(!(ut&&Q)&&(W||Q&&C&qe||ut&&C&zn))return this.preventSrc(x)},preventSrc:function(_){this.manager.session.prevented=!0,_.preventDefault()}};function ya(_){if(b(_,un))return un;var x=b(_,We),C=b(_,Ni);return x&&C?un:x||C?x?We:Ni:b(_,Or)?Or:_a}function sl(){if(!rl)return!1;var _={},x=n.CSS&&n.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach(function(C){_[C]=x?n.CSS.supports("touch-action",C):!0}),_}var Fr=1,He=2,Sn=4,An=8,rn=An,Cn=16,ge=32;function sn(_){this.options=y({},this.defaults,_||{}),this.id=ft(),this.manager=null,this.options.enable=F(this.options.enable,!0),this.state=Fr,this.simultaneous={},this.requireFail=[]}sn.prototype={defaults:{},set:function(_){return y(this.options,_),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(_){if(d(_,"recognizeWith",this))return this;var x=this.simultaneous;return _=Lr(_,this),x[_.id]||(x[_.id]=_,_.recognizeWith(this)),this},dropRecognizeWith:function(_){return d(_,"dropRecognizeWith",this)?this:(_=Lr(_,this),delete this.simultaneous[_.id],this)},requireFailure:function(_){if(d(_,"requireFailure",this))return this;var x=this.requireFail;return _=Lr(_,this),A(x,_)===-1&&(x.push(_),_.requireFailure(this)),this},dropRequireFailure:function(_){if(d(_,"dropRequireFailure",this))return this;_=Lr(_,this);var x=A(this.requireFail,_);return x>-1&&this.requireFail.splice(x,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(_){return!!this.simultaneous[_.id]},emit:function(_){var x=this,C=this.state;function N(W){x.manager.emit(W,_)}C<An&&N(x.options.event+ol(C)),N(x.options.event),_.additionalEvent&&N(_.additionalEvent),C>=An&&N(x.options.event+ol(C))},tryEmit:function(_){if(this.canEmit())return this.emit(_);this.state=ge},canEmit:function(){for(var _=0;_<this.requireFail.length;){if(!(this.requireFail[_].state&(ge|Fr)))return!1;_++}return!0},recognize:function(_){var x=y({},_);if(!M(this.options.enable,[this,x])){this.reset(),this.state=ge;return}this.state&(rn|Cn|ge)&&(this.state=Fr),this.state=this.process(x),this.state&(He|Sn|An|Cn)&&this.tryEmit(x)},process:function(_){},getTouchAction:function(){},reset:function(){}};function ol(_){return _&Cn?"cancel":_&An?"end":_&Sn?"move":_&He?"start":""}function va(_){return _==li?"down":_==ci?"up":_==Bn?"left":_==ai?"right":""}function Lr(_,x){var C=x.manager;return C?C.get(_):_}function Ge(){sn.apply(this,arguments)}k(Ge,sn,{defaults:{pointers:1},attrTest:function(_){var x=this.options.pointers;return x===0||_.pointers.length===x},process:function(_){var x=this.state,C=_.eventType,N=x&(He|Sn),W=this.attrTest(_);return N&&(C&ke||!W)?x|Cn:N||W?C&Ht?x|An:x&He?x|Sn:He:ge}});function Fi(){Ge.apply(this,arguments),this.pX=null,this.pY=null}k(Fi,Ge,{defaults:{event:"pan",threshold:10,pointers:1,direction:oa},getTouchAction:function(){var _=this.options.direction,x=[];return _&qe&&x.push(Ni),_&zn&&x.push(We),x},directionTest:function(_){var x=this.options,C=!0,N=_.distance,W=_.direction,Q=_.deltaX,ut=_.deltaY;return W&x.direction||(x.direction&qe?(W=Q===0?oi:Q<0?Bn:ai,C=Q!=this.pX,N=Math.abs(_.deltaX)):(W=ut===0?oi:ut<0?ci:li,C=ut!=this.pY,N=Math.abs(_.deltaY))),_.direction=W,C&&N>x.threshold&&W&x.direction},attrTest:function(_){return Ge.prototype.attrTest.call(this,_)&&(this.state&He||!(this.state&He)&&this.directionTest(_))},emit:function(_){this.pX=_.deltaX,this.pY=_.deltaY;var x=va(_.direction);x&&(_.additionalEvent=this.options.event+x),this._super.emit.call(this,_)}});function Br(){Ge.apply(this,arguments)}k(Br,Ge,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[un]},attrTest:function(_){return this._super.attrTest.call(this,_)&&(Math.abs(_.scale-1)>this.options.threshold||this.state&He)},emit:function(_){if(_.scale!==1){var x=_.scale<1?"in":"out";_.additionalEvent=this.options.event+x}this._super.emit.call(this,_)}});function Rs(){sn.apply(this,arguments),this._timer=null,this._input=null}k(Rs,sn,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[_a]},process:function(_){var x=this.options,C=_.pointers.length===x.pointers,N=_.distance<x.threshold,W=_.deltaTime>x.time;if(this._input=_,!N||!C||_.eventType&(Ht|ke)&&!W)this.reset();else if(_.eventType&Ot)this.reset(),this._timer=h(function(){this.state=rn,this.tryEmit()},x.time,this);else if(_.eventType&Ht)return rn;return ge},reset:function(){clearTimeout(this._timer)},emit:function(_){this.state===rn&&(_&&_.eventType&Ht?this.manager.emit(this.options.event+"up",_):(this._input.timeStamp=l(),this.manager.emit(this.options.event,this._input)))}});function Ds(){Ge.apply(this,arguments)}k(Ds,Ge,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[un]},attrTest:function(_){return this._super.attrTest.call(this,_)&&(Math.abs(_.rotation)>this.options.threshold||this.state&He)}});function ba(){Ge.apply(this,arguments)}k(ba,Ge,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:qe|zn,pointers:1},getTouchAction:function(){return Fi.prototype.getTouchAction.call(this)},attrTest:function(_){var x=this.options.direction,C;return x&(qe|zn)?C=_.overallVelocity:x&qe?C=_.overallVelocityX:x&zn&&(C=_.overallVelocityY),this._super.attrTest.call(this,_)&&x&_.offsetDirection&&_.distance>this.options.threshold&&_.maxPointers==this.options.pointers&&c(C)>this.options.velocity&&_.eventType&Ht},emit:function(_){var x=va(_.offsetDirection);x&&this.manager.emit(this.options.event+x,_),this.manager.emit(this.options.event,_)}});function Ms(){sn.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}k(Ms,sn,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[Or]},process:function(_){var x=this.options,C=_.pointers.length===x.pointers,N=_.distance<x.threshold,W=_.deltaTime<x.time;if(this.reset(),_.eventType&Ot&&this.count===0)return this.failTimeout();if(N&&W&&C){if(_.eventType!=Ht)return this.failTimeout();var Q=this.pTime?_.timeStamp-this.pTime<x.interval:!0,ut=!this.pCenter||Pr(this.pCenter,_.center)<x.posThreshold;this.pTime=_.timeStamp,this.pCenter=_.center,!ut||!Q?this.count=1:this.count+=1,this._input=_;var ee=this.count%x.taps;if(ee===0)return this.hasRequireFailures()?(this._timer=h(function(){this.state=rn,this.tryEmit()},x.interval,this),He):rn}return ge},failTimeout:function(){return this._timer=h(function(){this.state=ge},this.options.interval,this),ge},reset:function(){clearTimeout(this._timer)},emit:function(){this.state==rn&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}});function hn(_,x){return x=x||{},x.recognizers=F(x.recognizers,hn.defaults.preset),new Pn(_,x)}hn.VERSION="2.0.7",hn.defaults={domEvents:!1,touchAction:Mr,enable:!0,inputTarget:null,inputClass:null,preset:[[Ds,{enable:!1}],[Br,{enable:!1},["rotate"]],[ba,{direction:qe}],[Fi,{direction:qe},["swipe"]],[Ms],[Ms,{event:"doubletap",taps:2},["tap"]],[Rs]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}};var al=1,cl=2;function Pn(_,x){this.options=y({},hn.defaults,x||{}),this.options.inputTarget=this.options.inputTarget||_,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=_,this.input=aa(this),this.touchAction=new Nr(this,this.options.touchAction),dn(this,!0),p(this.options.recognizers,function(C){var N=this.add(new C[0](C[1]));C[2]&&N.recognizeWith(C[2]),C[3]&&N.requireFailure(C[3])},this)}Pn.prototype={set:function(_){return y(this.options,_),_.touchAction&&this.touchAction.update(),_.inputTarget&&(this.input.destroy(),this.input.target=_.inputTarget,this.input.init()),this},stop:function(_){this.session.stopped=_?cl:al},recognize:function(_){var x=this.session;if(!x.stopped){this.touchAction.preventDefaults(_);var C,N=this.recognizers,W=x.curRecognizer;(!W||W&&W.state&rn)&&(W=x.curRecognizer=null);for(var Q=0;Q<N.length;)C=N[Q],x.stopped!==cl&&(!W||C==W||C.canRecognizeWith(W))?C.recognize(_):C.reset(),!W&&C.state&(He|Sn|An)&&(W=x.curRecognizer=C),Q++}},get:function(_){if(_ instanceof sn)return _;for(var x=this.recognizers,C=0;C<x.length;C++)if(x[C].options.event==_)return x[C];return null},add:function(_){if(d(_,"add",this))return this;var x=this.get(_.options.event);return x&&this.remove(x),this.recognizers.push(_),_.manager=this,this.touchAction.update(),_},remove:function(_){if(d(_,"remove",this))return this;if(_=this.get(_),_){var x=this.recognizers,C=A(x,_);C!==-1&&(x.splice(C,1),this.touchAction.update())}return this},on:function(_,x){if(_!==i&&x!==i){var C=this.handlers;return p(E(_),function(N){C[N]=C[N]||[],C[N].push(x)}),this}},off:function(_,x){if(_!==i){var C=this.handlers;return p(E(_),function(N){x?C[N]&&C[N].splice(A(C[N],x),1):delete C[N]}),this}},emit:function(_,x){this.options.domEvents&&Os(_,x);var C=this.handlers[_]&&this.handlers[_].slice();if(!(!C||!C.length)){x.type=_,x.preventDefault=function(){x.srcEvent.preventDefault()};for(var N=0;N<C.length;)C[N](x),N++}},destroy:function(){this.element&&dn(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}};function dn(_,x){var C=_.element;if(C.style){var N;p(_.options.cssProps,function(W,Q){N=S(C.style,Q),x?(_.oldCssProps[N]=C.style[N],C.style[N]=W):C.style[N]=_.oldCssProps[N]||""}),x||(_.oldCssProps={})}}function Os(_,x){var C=t.createEvent("Event");C.initEvent(_,!0,!0),C.gesture=x,x.target.dispatchEvent(C)}y(hn,{INPUT_START:Ot,INPUT_MOVE:nn,INPUT_END:Ht,INPUT_CANCEL:ke,STATE_POSSIBLE:Fr,STATE_BEGAN:He,STATE_CHANGED:Sn,STATE_ENDED:An,STATE_RECOGNIZED:rn,STATE_CANCELLED:Cn,STATE_FAILED:ge,DIRECTION_NONE:oi,DIRECTION_LEFT:Bn,DIRECTION_RIGHT:ai,DIRECTION_UP:ci,DIRECTION_DOWN:li,DIRECTION_HORIZONTAL:qe,DIRECTION_VERTICAL:zn,DIRECTION_ALL:oa,Manager:Pn,Input:Le,TouchAction:Nr,TouchInput:Dr,MouseInput:Ps,PointerEventInput:ui,TouchMouseInput:di,SingleTouchInput:ma,Recognizer:sn,AttrRecognizer:Ge,Tap:Ms,Pan:Fi,Swipe:ba,Pinch:Br,Rotate:Ds,Press:Rs,on:V,off:L,each:p,merge:w,extend:v,assign:y,inherit:k,bindFn:R,prefixed:S});var Vs=typeof n<"u"?n:typeof self<"u"?self:{};Vs.Hammer=hn,typeof define=="function"&&define.amd?define(function(){return hn}):typeof Pl<"u"&&Pl.exports?Pl.exports=hn:n[e]=hn})(window,document,"Hammer")});var K5=ry(Ud());var YI="firebase",QI="10.13.2";Ui(YI,QI,"app");var qs=new xy("ANGULARFIRE2_VERSION");var XI=(n,t)=>{let e=t?[t]:zy(),i=[];return e.forEach(r=>{r.container.getProvider(n).instances.forEach(o=>{i.includes(o)||i.push(o)})}),i},Hr=class{constructor(){return XI(JI)}},JI="app-check";function qd(){}var kl=class{zone;delegate;constructor(t,e=oy){this.zone=t,this.delegate=e}now(){return this.delegate.now()}schedule(t,e,i){let r=this.zone,s=function(o){r.runGuarded(()=>{t.apply(this,[o])})};return this.delegate.schedule(s,e,i)}},Wd=class{zone;task=null;constructor(t){this.zone=t}call(t,e){let i=this.unscheduleTask.bind(this);return this.task=this.zone.run(()=>Zone.current.scheduleMacroTask("firebaseZoneBlock",qd,{},qd,qd)),e.pipe(hy({next:i,complete:i,error:i})).subscribe(t).add(i)}unscheduleTask(){setTimeout(()=>{this.task!=null&&this.task.state==="scheduled"&&(this.task.invoke(),this.task=null)},10)}},Rl=(()=>{class n{ngZone;outsideAngular;insideAngular;constructor(e){this.ngZone=e,this.outsideAngular=e.runOutsideAngular(()=>new kl(Zone.current)),this.insideAngular=e.run(()=>new kl(Zone.current,ml)),globalThis.\u0275AngularFireScheduler||=this}static \u0275fac=function(i){return new(i||n)(ht(jn))};static \u0275prov=Me({token:n,factory:n.\u0275fac,providedIn:"root"})}return n})();function ZI(){let n=globalThis.\u0275AngularFireScheduler;if(!n)throw new Error(`Either AngularFireModule has not been provided in your AppModule (this can be done manually or implictly using
provideFirebaseApp) or you're calling an AngularFire method outside of an NgModule (which is not supported).`);return n}function Ke(n){return tS(ZI())(n)}function tS(n){return function(e){return e=e.lift(new Wd(n.ngZone)),e.pipe(js(n.outsideAngular),jr(n.insideAngular))}}var eS="firebase",nS="10.13.2";$e.registerVersion(eS,nS,"app-compat");var iS=["ngOnDestroy"],Ky=(n,t,e,i={})=>new Proxy(n,{get:(r,s)=>e.runOutsideAngular(()=>{if(n[s])return i?.spy?.get&&i.spy.get(s,n[s]),n[s];if(iS.indexOf(s)>-1)return()=>{};let o=t.toPromise().then(a=>{let c=a?.[s];return typeof c=="function"?c.bind(a):c?.then?c.then(l=>e.run(()=>l)):e.run(()=>c)});return new Proxy(()=>{},{get:(a,c)=>o[c],apply:(a,c,l)=>o.then(h=>{let d=h?.(...l);return i?.spy?.apply&&i.spy.apply(s,l,d),d})})})});var Dl=class{constructor(t){return t}},Ws=new we("angularfire2.app.options"),Hs=new we("angularfire2.app.name");function Da(n,t,e){let i=typeof e=="string"&&e||"[DEFAULT]",r=typeof e=="object"&&e||{};r.name=r.name||i;let o=$e.apps.filter(a=>a&&a.name===r.name)[0]||t.runOutsideAngular(()=>$e.initializeApp(n,r));try{if(JSON.stringify(n)!==JSON.stringify(o.options)){let a=!!module.hot;rS("error",`${o.name} Firebase App already initialized with different options${a?", you may need to reload as Firebase is not HMR aware.":"."}`)}}catch{}return new Dl(o)}var rS=(n,...t)=>{Vd()&&typeof console<"u"&&console[n](...t)},sS={provide:Dl,useFactory:Da,deps:[Ws,jn,[new dy,Hs]]},Yy=(()=>{class n{static initializeApp(e,i){return{ngModule:n,providers:[{provide:Ws,useValue:e},{provide:Hs,useValue:i}]}}constructor(e){$e.registerVersion("angularfire",qs.full,"core"),$e.registerVersion("angularfire",qs.full,"app-compat"),$e.registerVersion("angular",wy.full,e.toString())}static \u0275fac=function(i){return new(i||n)(ht(Us))};static \u0275mod=gi({type:n});static \u0275inj=pi({providers:[sS]})}return n})();function Ml(n,t,e,i,r){let[,s,o]=globalThis.\u0275AngularfireInstanceCache.find(a=>a[0]===n)||[];if(s)return oS(r,o)||($y("error",`${t} was already initialized on the ${e} Firebase App with different settings.${aS?" You may need to reload as Firebase is not HMR aware.":""}`),$y("warn",{is:r,was:o})),s;{let a=i();return globalThis.\u0275AngularfireInstanceCache.push([n,a,r]),a}}function oS(n,t){try{return n.toString()===t.toString()}catch{return n===t}}var aS=typeof module<"u"&&!!module.hot,$y=(n,...t)=>{Vd()&&typeof console<"u"&&console[n](...t)};globalThis.\u0275AngularfireInstanceCache||=[];var uS=new Map,hS={activated:!1,tokenObservers:[]},dS={initialized:!1,enabled:!1};function Dn(n){return uS.get(n)||Object.assign({},hS)}function t0(){return dS}var fS="https://content-firebaseappcheck.googleapis.com/v1";var pS="exchangeDebugToken",Qy={OFFSET_DURATION:5*60*1e3,RETRIAL_MIN_WAIT:30*1e3,RETRIAL_MAX_WAIT:16*60*1e3},NN=24*60*60*1e3;var Gd=class{constructor(t,e,i,r,s){if(this.operation=t,this.retryPolicy=e,this.getWaitDuration=i,this.lowerBound=r,this.upperBound=s,this.pending=null,this.nextErrorWaitInterval=r,r>s)throw new Error("Proactive refresh lower bound greater than upper bound!")}start(){this.nextErrorWaitInterval=this.lowerBound,this.process(!0).catch(()=>{})}stop(){this.pending&&(this.pending.reject("cancelled"),this.pending=null)}isRunning(){return!!this.pending}process(t){return U(this,null,function*(){this.stop();try{this.pending=new Fd,this.pending.promise.catch(e=>{}),yield gS(this.getNextRun(t)),this.pending.resolve(),yield this.pending.promise,this.pending=new Fd,this.pending.promise.catch(e=>{}),yield this.operation(),this.pending.resolve(),yield this.pending.promise,this.process(!0).catch(()=>{})}catch(e){this.retryPolicy(e)?this.process(!1).catch(()=>{}):this.stop()}})}getNextRun(t){if(t)return this.nextErrorWaitInterval=this.lowerBound,this.getWaitDuration();{let e=this.nextErrorWaitInterval;return this.nextErrorWaitInterval*=2,this.nextErrorWaitInterval>this.upperBound&&(this.nextErrorWaitInterval=this.upperBound),e}}};function gS(n){return new Promise(t=>{setTimeout(t,n)})}var mS={"already-initialized":"You have already called initializeAppCheck() for FirebaseApp {$appName} with different options. To avoid this error, call initializeAppCheck() with the same options as when it was originally called. This will return the already initialized instance.","use-before-activation":"App Check is being used before initializeAppCheck() is called for FirebaseApp {$appName}. Call initializeAppCheck() before instantiating other Firebase services.","fetch-network-error":"Fetch failed to connect to a network. Check Internet connection. Original error: {$originalErrorMessage}.","fetch-parse-error":"Fetch client could not parse response. Original error: {$originalErrorMessage}.","fetch-status-error":"Fetch server returned an HTTP error status. HTTP status: {$httpStatus}.","storage-open":"Error thrown when opening storage. Original error: {$originalErrorMessage}.","storage-get":"Error thrown when reading from storage. Original error: {$originalErrorMessage}.","storage-set":"Error thrown when writing to storage. Original error: {$originalErrorMessage}.","recaptcha-error":"ReCAPTCHA error.",throttled:"Requests throttled due to {$httpStatus} error. Attempts allowed again after {$time}"},Hi=new Ly("appCheck","AppCheck",mS);function e0(n){if(!Dn(n).activated)throw Hi.create("use-before-activation",{appName:n.name})}function n0(i,r){return U(this,arguments,function*({url:n,body:t},e){let s={"Content-Type":"application/json"},o=e.getImmediate({optional:!0});if(o){let g=yield o.getHeartbeatsHeader();g&&(s["X-Firebase-Client"]=g)}let a={method:"POST",body:JSON.stringify(t),headers:s},c;try{c=yield fetch(n,a)}catch(g){throw Hi.create("fetch-network-error",{originalErrorMessage:g?.message})}if(c.status!==200)throw Hi.create("fetch-status-error",{httpStatus:c.status});let l;try{l=yield c.json()}catch(g){throw Hi.create("fetch-parse-error",{originalErrorMessage:g?.message})}let h=l.ttl.match(/^([\d.]+)(s)$/);if(!h||!h[2]||isNaN(Number(h[1])))throw Hi.create("fetch-parse-error",{originalErrorMessage:`ttl field (timeToLive) is not in standard Protobuf Duration format: ${l.ttl}`});let d=Number(h[1])*1e3,p=Date.now();return{token:l.token,expireTimeMillis:p+d,issuedAtTimeMillis:p}})}function i0(n,t){let{projectId:e,appId:i,apiKey:r}=n.options;return{url:`${fS}/projects/${e}/apps/${i}:${pS}?key=${r}`,body:{debug_token:t}}}var _S="firebase-app-check-database",yS=1,$d="firebase-app-check-store";var Ol=null;function vS(){return Ol||(Ol=new Promise((n,t)=>{try{let e=indexedDB.open(_S,yS);e.onsuccess=i=>{n(i.target.result)},e.onerror=i=>{var r;t(Hi.create("storage-open",{originalErrorMessage:(r=i.target.error)===null||r===void 0?void 0:r.message}))},e.onupgradeneeded=i=>{let r=i.target.result;switch(i.oldVersion){case 0:r.createObjectStore($d,{keyPath:"compositeKey"})}}}catch(e){t(Hi.create("storage-open",{originalErrorMessage:e?.message}))}}),Ol)}function bS(n,t){return xS(wS(n),t)}function xS(n,t){return U(this,null,function*(){let i=(yield vS()).transaction($d,"readwrite"),s=i.objectStore($d).put({compositeKey:n,value:t});return new Promise((o,a)=>{s.onsuccess=c=>{o()},i.onerror=c=>{var l;a(Hi.create("storage-set",{originalErrorMessage:(l=c.target.error)===null||l===void 0?void 0:l.message}))}})})}function wS(n){return`${n.options.appId}-${n.name}`}var Kd=new Cl("@firebase/app-check");function Hd(n,t){return Al()?bS(n,t).catch(e=>{Kd.warn(`Failed to write token to IndexedDB. Error: ${e}`)}):Promise.resolve()}function r0(){return t0().enabled}function s0(){return U(this,null,function*(){let n=t0();if(n.enabled&&n.token)return n.token.promise;throw Error(`
            Can't get debug token in production mode.
        `)})}var TS={error:"UNKNOWN_ERROR"};function ES(n){return Vy.encodeString(JSON.stringify(n),!1)}function Yd(n,t=!1){return U(this,null,function*(){let e=n.app;e0(e);let i=Dn(e),r=i.token,s;if(r&&!Ma(r)&&(i.token=void 0,r=void 0),!r){let c=yield i.cachedTokenPromise;c&&(Ma(c)?r=c:yield Hd(e,void 0))}if(!t&&r&&Ma(r))return{token:r.token};let o=!1;if(r0()){i.exchangeTokenPromise||(i.exchangeTokenPromise=n0(i0(e,yield s0()),n.heartbeatServiceProvider).finally(()=>{i.exchangeTokenPromise=void 0}),o=!0);let c=yield i.exchangeTokenPromise;return yield Hd(e,c),i.token=c,{token:c.token}}try{i.exchangeTokenPromise||(i.exchangeTokenPromise=i.provider.getToken().finally(()=>{i.exchangeTokenPromise=void 0}),o=!0),r=yield Dn(e).exchangeTokenPromise}catch(c){c.code==="appCheck/throttled"?Kd.warn(c.message):Kd.error(c),s=c}let a;return r?s?Ma(r)?a={token:r.token,internalError:s}:a=Jy(s):(a={token:r.token},i.token=r,yield Hd(e,r)):a=Jy(s),o&&CS(e,a),a})}function IS(n){return U(this,null,function*(){let t=n.app;e0(t);let{provider:e}=Dn(t);if(r0()){let i=yield s0(),{token:r}=yield n0(i0(t,i),n.heartbeatServiceProvider);return{token:r}}else{let{token:i}=yield e.getToken();return{token:i}}})}function SS(n,t,e,i){let{app:r}=n,s=Dn(r),o={next:e,error:i,type:t};if(s.tokenObservers=[...s.tokenObservers,o],s.token&&Ma(s.token)){let a=s.token;Promise.resolve().then(()=>{e({token:a.token}),Xy(n)}).catch(()=>{})}s.cachedTokenPromise.then(()=>Xy(n))}function o0(n,t){let e=Dn(n),i=e.tokenObservers.filter(r=>r.next!==t);i.length===0&&e.tokenRefresher&&e.tokenRefresher.isRunning()&&e.tokenRefresher.stop(),e.tokenObservers=i}function Xy(n){let{app:t}=n,e=Dn(t),i=e.tokenRefresher;i||(i=AS(n),e.tokenRefresher=i),!i.isRunning()&&e.isTokenAutoRefreshEnabled&&i.start()}function AS(n){let{app:t}=n;return new Gd(()=>U(this,null,function*(){let e=Dn(t),i;if(e.token?i=yield Yd(n,!0):i=yield Yd(n),i.error)throw i.error;if(i.internalError)throw i.internalError}),()=>!0,()=>{let e=Dn(t);if(e.token){let i=e.token.issuedAtTimeMillis+(e.token.expireTimeMillis-e.token.issuedAtTimeMillis)*.5+3e5,r=e.token.expireTimeMillis-5*60*1e3;return i=Math.min(i,r),Math.max(0,i-Date.now())}else return 0},Qy.RETRIAL_MIN_WAIT,Qy.RETRIAL_MAX_WAIT)}function CS(n,t){let e=Dn(n).tokenObservers;for(let i of e)try{i.type==="EXTERNAL"&&t.error!=null?i.error(t.error):i.next(t)}catch{}}function Ma(n){return n.expireTimeMillis-Date.now()>0}function Jy(n){return{token:ES(TS),error:n}}var Qd=class{constructor(t,e){this.app=t,this.heartbeatServiceProvider=e}_delete(){let{tokenObservers:t}=Dn(this.app);for(let e of t)o0(this.app,e.next);return Promise.resolve()}};function PS(n,t){return new Qd(n,t)}function kS(n){return{getToken:t=>Yd(n,t),getLimitedUseToken:()=>IS(n),addTokenListener:t=>SS(n,"INTERNAL",t),removeTokenListener:t=>o0(n.app,t)}}var RS="@firebase/app-check",DS="0.8.8";var MS="app-check",Zy="app-check-internal";function OS(){Ra(new qr(MS,n=>{let t=n.getProvider("app").getImmediate(),e=n.getProvider("heartbeat");return PS(t,e)},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((n,t,e)=>{n.getProvider(Zy).initialize()})),Ra(new qr(Zy,n=>{let t=n.getProvider("app-check").getImmediate();return kS(t)},"PUBLIC").setInstantiationMode("EXPLICIT")),Ui(RS,DS)}OS();var VS=["localhost","0.0.0.0","127.0.0.1"],KN=typeof window<"u"&&VS.includes(window.location.hostname);var Xd=new we("angularfire2.auth.use-emulator"),Jd=new we("angularfire2.auth.settings"),Zd=new we("angularfire2.auth.tenant-id"),tf=new we("angularfire2.auth.langugage-code"),ef=new we("angularfire2.auth.use-device-language"),nf=new we("angularfire.auth.persistence"),rf=(n,t,e,i,r,s,o,a)=>Ml(`${n.name}.auth`,"AngularFireAuth",n.name,()=>{let c=t.runOutsideAngular(()=>n.auth());if(e&&c.useEmulator(...e),i&&(c.tenantId=i),c.languageCode=r,s&&c.useDeviceLanguage(),o)for(let[l,h]of Object.entries(o))c.settings[l]=h;return a&&c.setPersistence(a),c},[e,i,r,s,o,a]),Vl=(()=>{class n{authState;idToken;user;idTokenResult;credential;constructor(e,i,r,s,o,a,c,l,h,d,p,g){let y=new zs,v=ji(void 0).pipe(jr(o.outsideAngular),Ur(()=>s.runOutsideAngular(()=>import("./chunk-NCIQEABU.js"))),Be(()=>Da(e,s,i)),Be(w=>rf(w,s,a,l,h,d,c,p)),Rd({bufferSize:1,refCount:!1}));if(Sl(r))this.authState=this.user=this.idToken=this.idTokenResult=this.credential=ji(null);else{v.pipe(ly()).subscribe();let w=v.pipe(Ur(M=>M.getRedirectResult().then(F=>F,()=>null)),Ke,Rd({bufferSize:1,refCount:!1})),k=v.pipe(Ur(M=>new Bs(F=>({unsubscribe:s.runOutsideAngular(()=>M.onAuthStateChanged(V=>F.next(V),V=>F.error(V),()=>F.complete()))})))),R=v.pipe(Ur(M=>new Bs(F=>({unsubscribe:s.runOutsideAngular(()=>M.onIdTokenChanged(V=>F.next(V),V=>F.error(V),()=>F.complete()))}))));this.authState=w.pipe(Dd(k),js(o.outsideAngular),jr(o.insideAngular)),this.user=w.pipe(Dd(R),js(o.outsideAngular),jr(o.insideAngular)),this.idToken=this.user.pipe(Ur(M=>M?zi(M.getIdToken()):ji(null))),this.idTokenResult=this.user.pipe(Ur(M=>M?zi(M.getIdTokenResult()):ji(null))),this.credential=cy(w,y,this.authState.pipe(Aa(M=>!M))).pipe(Be(M=>M?.user?M:null),js(o.outsideAngular),jr(o.insideAngular))}return Ky(this,v,s,{spy:{apply:(w,k,R)=>{(w.startsWith("signIn")||w.startsWith("createUser"))&&R.then(M=>y.next(M))}}})}static \u0275fac=function(i){return new(i||n)(ht(Ws),ht(Hs,8),ht(Us),ht(jn),ht(Rl),ht(Xd,8),ht(Jd,8),ht(Zd,8),ht(tf,8),ht(ef,8),ht(nf,8),ht(Hr,8))};static \u0275prov=Me({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})();var l0=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},u0={};var Gi,sf;(function(){var n;function t(I,b){function E(){}E.prototype=b.prototype,I.D=b.prototype,I.prototype=new E,I.prototype.constructor=I,I.C=function(A,P,D){for(var S=Array(arguments.length-2),Mt=2;Mt<arguments.length;Mt++)S[Mt-2]=arguments[Mt];return b.prototype[P].apply(A,S)}}function e(){this.blockSize=-1}function i(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}t(i,e),i.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function r(I,b,E){E||(E=0);var A=Array(16);if(typeof b=="string")for(var P=0;16>P;++P)A[P]=b.charCodeAt(E++)|b.charCodeAt(E++)<<8|b.charCodeAt(E++)<<16|b.charCodeAt(E++)<<24;else for(P=0;16>P;++P)A[P]=b[E++]|b[E++]<<8|b[E++]<<16|b[E++]<<24;b=I.g[0],E=I.g[1],P=I.g[2];var D=I.g[3],S=b+(D^E&(P^D))+A[0]+3614090360&4294967295;b=E+(S<<7&4294967295|S>>>25),S=D+(P^b&(E^P))+A[1]+3905402710&4294967295,D=b+(S<<12&4294967295|S>>>20),S=P+(E^D&(b^E))+A[2]+606105819&4294967295,P=D+(S<<17&4294967295|S>>>15),S=E+(b^P&(D^b))+A[3]+3250441966&4294967295,E=P+(S<<22&4294967295|S>>>10),S=b+(D^E&(P^D))+A[4]+4118548399&4294967295,b=E+(S<<7&4294967295|S>>>25),S=D+(P^b&(E^P))+A[5]+1200080426&4294967295,D=b+(S<<12&4294967295|S>>>20),S=P+(E^D&(b^E))+A[6]+2821735955&4294967295,P=D+(S<<17&4294967295|S>>>15),S=E+(b^P&(D^b))+A[7]+4249261313&4294967295,E=P+(S<<22&4294967295|S>>>10),S=b+(D^E&(P^D))+A[8]+1770035416&4294967295,b=E+(S<<7&4294967295|S>>>25),S=D+(P^b&(E^P))+A[9]+2336552879&4294967295,D=b+(S<<12&4294967295|S>>>20),S=P+(E^D&(b^E))+A[10]+4294925233&4294967295,P=D+(S<<17&4294967295|S>>>15),S=E+(b^P&(D^b))+A[11]+2304563134&4294967295,E=P+(S<<22&4294967295|S>>>10),S=b+(D^E&(P^D))+A[12]+1804603682&4294967295,b=E+(S<<7&4294967295|S>>>25),S=D+(P^b&(E^P))+A[13]+4254626195&4294967295,D=b+(S<<12&4294967295|S>>>20),S=P+(E^D&(b^E))+A[14]+2792965006&4294967295,P=D+(S<<17&4294967295|S>>>15),S=E+(b^P&(D^b))+A[15]+1236535329&4294967295,E=P+(S<<22&4294967295|S>>>10),S=b+(P^D&(E^P))+A[1]+4129170786&4294967295,b=E+(S<<5&4294967295|S>>>27),S=D+(E^P&(b^E))+A[6]+3225465664&4294967295,D=b+(S<<9&4294967295|S>>>23),S=P+(b^E&(D^b))+A[11]+643717713&4294967295,P=D+(S<<14&4294967295|S>>>18),S=E+(D^b&(P^D))+A[0]+3921069994&4294967295,E=P+(S<<20&4294967295|S>>>12),S=b+(P^D&(E^P))+A[5]+3593408605&4294967295,b=E+(S<<5&4294967295|S>>>27),S=D+(E^P&(b^E))+A[10]+38016083&4294967295,D=b+(S<<9&4294967295|S>>>23),S=P+(b^E&(D^b))+A[15]+3634488961&4294967295,P=D+(S<<14&4294967295|S>>>18),S=E+(D^b&(P^D))+A[4]+3889429448&4294967295,E=P+(S<<20&4294967295|S>>>12),S=b+(P^D&(E^P))+A[9]+568446438&4294967295,b=E+(S<<5&4294967295|S>>>27),S=D+(E^P&(b^E))+A[14]+3275163606&4294967295,D=b+(S<<9&4294967295|S>>>23),S=P+(b^E&(D^b))+A[3]+4107603335&4294967295,P=D+(S<<14&4294967295|S>>>18),S=E+(D^b&(P^D))+A[8]+1163531501&4294967295,E=P+(S<<20&4294967295|S>>>12),S=b+(P^D&(E^P))+A[13]+2850285829&4294967295,b=E+(S<<5&4294967295|S>>>27),S=D+(E^P&(b^E))+A[2]+4243563512&4294967295,D=b+(S<<9&4294967295|S>>>23),S=P+(b^E&(D^b))+A[7]+1735328473&4294967295,P=D+(S<<14&4294967295|S>>>18),S=E+(D^b&(P^D))+A[12]+2368359562&4294967295,E=P+(S<<20&4294967295|S>>>12),S=b+(E^P^D)+A[5]+4294588738&4294967295,b=E+(S<<4&4294967295|S>>>28),S=D+(b^E^P)+A[8]+2272392833&4294967295,D=b+(S<<11&4294967295|S>>>21),S=P+(D^b^E)+A[11]+1839030562&4294967295,P=D+(S<<16&4294967295|S>>>16),S=E+(P^D^b)+A[14]+4259657740&4294967295,E=P+(S<<23&4294967295|S>>>9),S=b+(E^P^D)+A[1]+2763975236&4294967295,b=E+(S<<4&4294967295|S>>>28),S=D+(b^E^P)+A[4]+1272893353&4294967295,D=b+(S<<11&4294967295|S>>>21),S=P+(D^b^E)+A[7]+4139469664&4294967295,P=D+(S<<16&4294967295|S>>>16),S=E+(P^D^b)+A[10]+3200236656&4294967295,E=P+(S<<23&4294967295|S>>>9),S=b+(E^P^D)+A[13]+681279174&4294967295,b=E+(S<<4&4294967295|S>>>28),S=D+(b^E^P)+A[0]+3936430074&4294967295,D=b+(S<<11&4294967295|S>>>21),S=P+(D^b^E)+A[3]+3572445317&4294967295,P=D+(S<<16&4294967295|S>>>16),S=E+(P^D^b)+A[6]+76029189&4294967295,E=P+(S<<23&4294967295|S>>>9),S=b+(E^P^D)+A[9]+3654602809&4294967295,b=E+(S<<4&4294967295|S>>>28),S=D+(b^E^P)+A[12]+3873151461&4294967295,D=b+(S<<11&4294967295|S>>>21),S=P+(D^b^E)+A[15]+530742520&4294967295,P=D+(S<<16&4294967295|S>>>16),S=E+(P^D^b)+A[2]+3299628645&4294967295,E=P+(S<<23&4294967295|S>>>9),S=b+(P^(E|~D))+A[0]+4096336452&4294967295,b=E+(S<<6&4294967295|S>>>26),S=D+(E^(b|~P))+A[7]+1126891415&4294967295,D=b+(S<<10&4294967295|S>>>22),S=P+(b^(D|~E))+A[14]+2878612391&4294967295,P=D+(S<<15&4294967295|S>>>17),S=E+(D^(P|~b))+A[5]+4237533241&4294967295,E=P+(S<<21&4294967295|S>>>11),S=b+(P^(E|~D))+A[12]+1700485571&4294967295,b=E+(S<<6&4294967295|S>>>26),S=D+(E^(b|~P))+A[3]+2399980690&4294967295,D=b+(S<<10&4294967295|S>>>22),S=P+(b^(D|~E))+A[10]+4293915773&4294967295,P=D+(S<<15&4294967295|S>>>17),S=E+(D^(P|~b))+A[1]+2240044497&4294967295,E=P+(S<<21&4294967295|S>>>11),S=b+(P^(E|~D))+A[8]+1873313359&4294967295,b=E+(S<<6&4294967295|S>>>26),S=D+(E^(b|~P))+A[15]+4264355552&4294967295,D=b+(S<<10&4294967295|S>>>22),S=P+(b^(D|~E))+A[6]+2734768916&4294967295,P=D+(S<<15&4294967295|S>>>17),S=E+(D^(P|~b))+A[13]+1309151649&4294967295,E=P+(S<<21&4294967295|S>>>11),S=b+(P^(E|~D))+A[4]+4149444226&4294967295,b=E+(S<<6&4294967295|S>>>26),S=D+(E^(b|~P))+A[11]+3174756917&4294967295,D=b+(S<<10&4294967295|S>>>22),S=P+(b^(D|~E))+A[2]+718787259&4294967295,P=D+(S<<15&4294967295|S>>>17),S=E+(D^(P|~b))+A[9]+3951481745&4294967295,I.g[0]=I.g[0]+b&4294967295,I.g[1]=I.g[1]+(P+(S<<21&4294967295|S>>>11))&4294967295,I.g[2]=I.g[2]+P&4294967295,I.g[3]=I.g[3]+D&4294967295}i.prototype.u=function(I,b){b===void 0&&(b=I.length);for(var E=b-this.blockSize,A=this.B,P=this.h,D=0;D<b;){if(P==0)for(;D<=E;)r(this,I,D),D+=this.blockSize;if(typeof I=="string"){for(;D<b;)if(A[P++]=I.charCodeAt(D++),P==this.blockSize){r(this,A),P=0;break}}else for(;D<b;)if(A[P++]=I[D++],P==this.blockSize){r(this,A),P=0;break}}this.h=P,this.o+=b},i.prototype.v=function(){var I=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);I[0]=128;for(var b=1;b<I.length-8;++b)I[b]=0;var E=8*this.o;for(b=I.length-8;b<I.length;++b)I[b]=E&255,E/=256;for(this.u(I),I=Array(16),b=E=0;4>b;++b)for(var A=0;32>A;A+=8)I[E++]=this.g[b]>>>A&255;return I};function s(I,b){var E=a;return Object.prototype.hasOwnProperty.call(E,I)?E[I]:E[I]=b(I)}function o(I,b){this.h=b;for(var E=[],A=!0,P=I.length-1;0<=P;P--){var D=I[P]|0;A&&D==b||(E[P]=D,A=!1)}this.g=E}var a={};function c(I){return-128<=I&&128>I?s(I,function(b){return new o([b|0],0>b?-1:0)}):new o([I|0],0>I?-1:0)}function l(I){if(isNaN(I)||!isFinite(I))return d;if(0>I)return w(l(-I));for(var b=[],E=1,A=0;I>=E;A++)b[A]=I/E|0,E*=4294967296;return new o(b,0)}function h(I,b){if(I.length==0)throw Error("number format error: empty string");if(b=b||10,2>b||36<b)throw Error("radix out of range: "+b);if(I.charAt(0)=="-")return w(h(I.substring(1),b));if(0<=I.indexOf("-"))throw Error('number format error: interior "-" character');for(var E=l(Math.pow(b,8)),A=d,P=0;P<I.length;P+=8){var D=Math.min(8,I.length-P),S=parseInt(I.substring(P,P+D),b);8>D?(D=l(Math.pow(b,D)),A=A.j(D).add(l(S))):(A=A.j(E),A=A.add(l(S)))}return A}var d=c(0),p=c(1),g=c(16777216);n=o.prototype,n.m=function(){if(v(this))return-w(this).m();for(var I=0,b=1,E=0;E<this.g.length;E++){var A=this.i(E);I+=(0<=A?A:4294967296+A)*b,b*=4294967296}return I},n.toString=function(I){if(I=I||10,2>I||36<I)throw Error("radix out of range: "+I);if(y(this))return"0";if(v(this))return"-"+w(this).toString(I);for(var b=l(Math.pow(I,6)),E=this,A="";;){var P=F(E,b).g;E=k(E,P.j(b));var D=((0<E.g.length?E.g[0]:E.h)>>>0).toString(I);if(E=P,y(E))return D+A;for(;6>D.length;)D="0"+D;A=D+A}},n.i=function(I){return 0>I?0:I<this.g.length?this.g[I]:this.h};function y(I){if(I.h!=0)return!1;for(var b=0;b<I.g.length;b++)if(I.g[b]!=0)return!1;return!0}function v(I){return I.h==-1}n.l=function(I){return I=k(this,I),v(I)?-1:y(I)?0:1};function w(I){for(var b=I.g.length,E=[],A=0;A<b;A++)E[A]=~I.g[A];return new o(E,~I.h).add(p)}n.abs=function(){return v(this)?w(this):this},n.add=function(I){for(var b=Math.max(this.g.length,I.g.length),E=[],A=0,P=0;P<=b;P++){var D=A+(this.i(P)&65535)+(I.i(P)&65535),S=(D>>>16)+(this.i(P)>>>16)+(I.i(P)>>>16);A=S>>>16,D&=65535,S&=65535,E[P]=S<<16|D}return new o(E,E[E.length-1]&-2147483648?-1:0)};function k(I,b){return I.add(w(b))}n.j=function(I){if(y(this)||y(I))return d;if(v(this))return v(I)?w(this).j(w(I)):w(w(this).j(I));if(v(I))return w(this.j(w(I)));if(0>this.l(g)&&0>I.l(g))return l(this.m()*I.m());for(var b=this.g.length+I.g.length,E=[],A=0;A<2*b;A++)E[A]=0;for(A=0;A<this.g.length;A++)for(var P=0;P<I.g.length;P++){var D=this.i(A)>>>16,S=this.i(A)&65535,Mt=I.i(P)>>>16,ft=I.i(P)&65535;E[2*A+2*P]+=S*ft,R(E,2*A+2*P),E[2*A+2*P+1]+=D*ft,R(E,2*A+2*P+1),E[2*A+2*P+1]+=S*Mt,R(E,2*A+2*P+1),E[2*A+2*P+2]+=D*Mt,R(E,2*A+2*P+2)}for(A=0;A<b;A++)E[A]=E[2*A+1]<<16|E[2*A];for(A=b;A<2*b;A++)E[A]=0;return new o(E,0)};function R(I,b){for(;(I[b]&65535)!=I[b];)I[b+1]+=I[b]>>>16,I[b]&=65535,b++}function M(I,b){this.g=I,this.h=b}function F(I,b){if(y(b))throw Error("division by zero");if(y(I))return new M(d,d);if(v(I))return b=F(w(I),b),new M(w(b.g),w(b.h));if(v(b))return b=F(I,w(b)),new M(w(b.g),b.h);if(30<I.g.length){if(v(I)||v(b))throw Error("slowDivide_ only works with positive integers.");for(var E=p,A=b;0>=A.l(I);)E=V(E),A=V(A);var P=L(E,1),D=L(A,1);for(A=L(A,2),E=L(E,2);!y(A);){var S=D.add(A);0>=S.l(I)&&(P=P.add(E),D=S),A=L(A,1),E=L(E,1)}return b=k(I,P.j(b)),new M(P,b)}for(P=d;0<=I.l(b);){for(E=Math.max(1,Math.floor(I.m()/b.m())),A=Math.ceil(Math.log(E)/Math.LN2),A=48>=A?1:Math.pow(2,A-48),D=l(E),S=D.j(b);v(S)||0<S.l(I);)E-=A,D=l(E),S=D.j(b);y(D)&&(D=p),P=P.add(D),I=k(I,S)}return new M(P,I)}n.A=function(I){return F(this,I).h},n.and=function(I){for(var b=Math.max(this.g.length,I.g.length),E=[],A=0;A<b;A++)E[A]=this.i(A)&I.i(A);return new o(E,this.h&I.h)},n.or=function(I){for(var b=Math.max(this.g.length,I.g.length),E=[],A=0;A<b;A++)E[A]=this.i(A)|I.i(A);return new o(E,this.h|I.h)},n.xor=function(I){for(var b=Math.max(this.g.length,I.g.length),E=[],A=0;A<b;A++)E[A]=this.i(A)^I.i(A);return new o(E,this.h^I.h)};function V(I){for(var b=I.g.length+1,E=[],A=0;A<b;A++)E[A]=I.i(A)<<1|I.i(A-1)>>>31;return new o(E,I.h)}function L(I,b){var E=b>>5;b%=32;for(var A=I.g.length-E,P=[],D=0;D<A;D++)P[D]=0<b?I.i(D+E)>>>b|I.i(D+E+1)<<32-b:I.i(D+E);return new o(P,I.h)}i.prototype.digest=i.prototype.v,i.prototype.reset=i.prototype.s,i.prototype.update=i.prototype.u,sf=u0.Md5=i,o.prototype.add=o.prototype.add,o.prototype.multiply=o.prototype.j,o.prototype.modulo=o.prototype.A,o.prototype.compare=o.prototype.l,o.prototype.toNumber=o.prototype.m,o.prototype.toString=o.prototype.toString,o.prototype.getBits=o.prototype.i,o.fromNumber=l,o.fromString=h,Gi=u0.Integer=o}).apply(typeof l0<"u"?l0:typeof self<"u"?self:typeof window<"u"?window:{});var Nl=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},mi={};var of,af,Gs,cf,Oa,Fl,lf,uf,hf;(function(){var n,t=typeof Object.defineProperties=="function"?Object.defineProperty:function(u,f,m){return u==Array.prototype||u==Object.prototype||(u[f]=m.value),u};function e(u){u=[typeof globalThis=="object"&&globalThis,u,typeof window=="object"&&window,typeof self=="object"&&self,typeof Nl=="object"&&Nl];for(var f=0;f<u.length;++f){var m=u[f];if(m&&m.Math==Math)return m}throw Error("Cannot find global object")}var i=e(this);function r(u,f){if(f)t:{var m=i;u=u.split(".");for(var T=0;T<u.length-1;T++){var O=u[T];if(!(O in m))break t;m=m[O]}u=u[u.length-1],T=m[u],f=f(T),f!=T&&f!=null&&t(m,u,{configurable:!0,writable:!0,value:f})}}function s(u,f){u instanceof String&&(u+="");var m=0,T=!1,O={next:function(){if(!T&&m<u.length){var j=m++;return{value:f(j,u[j]),done:!1}}return T=!0,{done:!0,value:void 0}}};return O[Symbol.iterator]=function(){return O},O}r("Array.prototype.values",function(u){return u||function(){return s(this,function(f,m){return m})}});var o=o||{},a=this||self;function c(u){var f=typeof u;return f=f!="object"?f:u?Array.isArray(u)?"array":f:"null",f=="array"||f=="object"&&typeof u.length=="number"}function l(u){var f=typeof u;return f=="object"&&u!=null||f=="function"}function h(u,f,m){return u.call.apply(u.bind,arguments)}function d(u,f,m){if(!u)throw Error();if(2<arguments.length){var T=Array.prototype.slice.call(arguments,2);return function(){var O=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(O,T),u.apply(f,O)}}return function(){return u.apply(f,arguments)}}function p(u,f,m){return p=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?h:d,p.apply(null,arguments)}function g(u,f){var m=Array.prototype.slice.call(arguments,1);return function(){var T=m.slice();return T.push.apply(T,arguments),u.apply(this,T)}}function y(u,f){function m(){}m.prototype=f.prototype,u.aa=f.prototype,u.prototype=new m,u.prototype.constructor=u,u.Qb=function(T,O,j){for(var G=Array(arguments.length-2),Et=2;Et<arguments.length;Et++)G[Et-2]=arguments[Et];return f.prototype[O].apply(T,G)}}function v(u){let f=u.length;if(0<f){let m=Array(f);for(let T=0;T<f;T++)m[T]=u[T];return m}return[]}function w(u,f){for(let m=1;m<arguments.length;m++){let T=arguments[m];if(c(T)){let O=u.length||0,j=T.length||0;u.length=O+j;for(let G=0;G<j;G++)u[O+G]=T[G]}else u.push(T)}}class k{constructor(f,m){this.i=f,this.j=m,this.h=0,this.g=null}get(){let f;return 0<this.h?(this.h--,f=this.g,this.g=f.next,f.next=null):f=this.i(),f}}function R(u){return/^[\s\xa0]*$/.test(u)}function M(){var u=a.navigator;return u&&(u=u.userAgent)?u:""}function F(u){return F[" "](u),u}F[" "]=function(){};var V=M().indexOf("Gecko")!=-1&&!(M().toLowerCase().indexOf("webkit")!=-1&&M().indexOf("Edge")==-1)&&!(M().indexOf("Trident")!=-1||M().indexOf("MSIE")!=-1)&&M().indexOf("Edge")==-1;function L(u,f,m){for(let T in u)f.call(m,u[T],T,u)}function I(u,f){for(let m in u)f.call(void 0,u[m],m,u)}function b(u){let f={};for(let m in u)f[m]=u[m];return f}let E="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function A(u,f){let m,T;for(let O=1;O<arguments.length;O++){T=arguments[O];for(m in T)u[m]=T[m];for(let j=0;j<E.length;j++)m=E[j],Object.prototype.hasOwnProperty.call(T,m)&&(u[m]=T[m])}}function P(u){var f=1;u=u.split(":");let m=[];for(;0<f&&u.length;)m.push(u.shift()),f--;return u.length&&m.push(u.join(":")),m}function D(u){a.setTimeout(()=>{throw u},0)}function S(){var u=Wt;let f=null;return u.g&&(f=u.g,u.g=u.g.next,u.g||(u.h=null),f.next=null),f}class Mt{constructor(){this.h=this.g=null}add(f,m){let T=ft.get();T.set(f,m),this.h?this.h.next=T:this.g=T,this.h=T}}var ft=new k(()=>new xt,u=>u.reset());class xt{constructor(){this.next=this.g=this.h=null}set(f,m){this.h=f,this.g=m,this.next=null}reset(){this.next=this.g=this.h=null}}let wt,te=!1,Wt=new Mt,En=()=>{let u=a.Promise.resolve(void 0);wt=()=>{u.then(ln)}};var ln=()=>{for(var u;u=S();){try{u.h.call(u.g)}catch(m){D(m)}var f=ft;f.j(u),100>f.h&&(f.h++,u.next=f.g,f.g=u)}te=!1};function ye(){this.s=this.s,this.C=this.C}ye.prototype.s=!1,ye.prototype.ma=function(){this.s||(this.s=!0,this.N())},ye.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function At(u,f){this.type=u,this.g=this.target=f,this.defaultPrevented=!1}At.prototype.h=function(){this.defaultPrevented=!0};var In=function(){if(!a.addEventListener||!Object.defineProperty)return!1;var u=!1,f=Object.defineProperty({},"passive",{get:function(){u=!0}});try{let m=()=>{};a.addEventListener("test",m,f),a.removeEventListener("test",m,f)}catch{}return u}();function en(u,f){if(At.call(this,u?u.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,u){var m=this.type=u.type,T=u.changedTouches&&u.changedTouches.length?u.changedTouches[0]:null;if(this.target=u.target||u.srcElement,this.g=f,f=u.relatedTarget){if(V){t:{try{F(f.nodeName);var O=!0;break t}catch{}O=!1}O||(f=null)}}else m=="mouseover"?f=u.fromElement:m=="mouseout"&&(f=u.toElement);this.relatedTarget=f,T?(this.clientX=T.clientX!==void 0?T.clientX:T.pageX,this.clientY=T.clientY!==void 0?T.clientY:T.pageY,this.screenX=T.screenX||0,this.screenY=T.screenY||0):(this.clientX=u.clientX!==void 0?u.clientX:u.pageX,this.clientY=u.clientY!==void 0?u.clientY:u.pageY,this.screenX=u.screenX||0,this.screenY=u.screenY||0),this.button=u.button,this.key=u.key||"",this.ctrlKey=u.ctrlKey,this.altKey=u.altKey,this.shiftKey=u.shiftKey,this.metaKey=u.metaKey,this.pointerId=u.pointerId||0,this.pointerType=typeof u.pointerType=="string"?u.pointerType:Ot[u.pointerType]||"",this.state=u.state,this.i=u,u.defaultPrevented&&en.aa.h.call(this)}}y(en,At);var Ot={2:"touch",3:"pen",4:"mouse"};en.prototype.h=function(){en.aa.h.call(this);var u=this.i;u.preventDefault?u.preventDefault():u.returnValue=!1};var nn="closure_listenable_"+(1e6*Math.random()|0),Ht=0;function ke(u,f,m,T,O){this.listener=u,this.proxy=null,this.src=f,this.type=m,this.capture=!!T,this.ha=O,this.key=++Ht,this.da=this.fa=!1}function oi(u){u.da=!0,u.listener=null,u.proxy=null,u.src=null,u.ha=null}function Bn(u){this.src=u,this.g={},this.h=0}Bn.prototype.add=function(u,f,m,T,O){var j=u.toString();u=this.g[j],u||(u=this.g[j]=[],this.h++);var G=ci(u,f,T,O);return-1<G?(f=u[G],m||(f.fa=!1)):(f=new ke(f,this.src,j,!!T,O),f.fa=m,u.push(f)),f};function ai(u,f){var m=f.type;if(m in u.g){var T=u.g[m],O=Array.prototype.indexOf.call(T,f,void 0),j;(j=0<=O)&&Array.prototype.splice.call(T,O,1),j&&(oi(f),u.g[m].length==0&&(delete u.g[m],u.h--))}}function ci(u,f,m,T){for(var O=0;O<u.length;++O){var j=u[O];if(!j.da&&j.listener==f&&j.capture==!!m&&j.ha==T)return O}return-1}var li="closure_lm_"+(1e6*Math.random()|0),qe={};function zn(u,f,m,T,O){if(T&&T.once)return Ar(u,f,m,T,O);if(Array.isArray(f)){for(var j=0;j<f.length;j++)zn(u,f[j],m,T,O);return null}return m=As(m),u&&u[nn]?u.K(f,m,l(T)?!!T.capture:!!T,O):oa(u,f,m,!1,T,O)}function oa(u,f,m,T,O,j){if(!f)throw Error("Invalid event type");var G=l(O)?!!O.capture:!!O,Et=ca(u);if(Et||(u[li]=Et=new Bn(u)),m=Et.add(f,m,T,G,j),m.proxy)return m;if(T=Qc(),m.proxy=T,T.src=u,T.listener=m,u.addEventListener)In||(O=G),O===void 0&&(O=!1),u.addEventListener(f.toString(),T,O);else if(u.attachEvent)u.attachEvent(Xc(f.toString()),T);else if(u.addListener&&u.removeListener)u.addListener(T);else throw Error("addEventListener and attachEvent are unavailable.");return m}function Qc(){function u(m){return f.call(u.src,u.listener,m)}let f=xd;return u}function Ar(u,f,m,T,O){if(Array.isArray(f)){for(var j=0;j<f.length;j++)Ar(u,f[j],m,T,O);return null}return m=As(m),u&&u[nn]?u.L(f,m,l(T)?!!T.capture:!!T,O):oa(u,f,m,!0,T,O)}function Le(u,f,m,T,O){if(Array.isArray(f))for(var j=0;j<f.length;j++)Le(u,f[j],m,T,O);else T=l(T)?!!T.capture:!!T,m=As(m),u&&u[nn]?(u=u.i,f=String(f).toString(),f in u.g&&(j=u.g[f],m=ci(j,m,T,O),-1<m&&(oi(j[m]),Array.prototype.splice.call(j,m,1),j.length==0&&(delete u.g[f],u.h--)))):u&&(u=ca(u))&&(f=u.g[f.toString()],u=-1,f&&(u=ci(f,m,T,O)),(m=-1<u?f[u]:null)&&aa(m))}function aa(u){if(typeof u!="number"&&u&&!u.da){var f=u.src;if(f&&f[nn])ai(f.i,u);else{var m=u.type,T=u.proxy;f.removeEventListener?f.removeEventListener(m,T,u.capture):f.detachEvent?f.detachEvent(Xc(m),T):f.addListener&&f.removeListener&&f.removeListener(T),(m=ca(f))?(ai(m,u),m.h==0&&(m.src=null,f[li]=null)):oi(u)}}}function Xc(u){return u in qe?qe[u]:qe[u]="on"+u}function xd(u,f){if(u.da)u=!0;else{f=new en(f,this);var m=u.listener,T=u.ha||u.src;u.fa&&aa(u),u=m.call(T,f)}return u}function ca(u){return u=u[li],u instanceof Bn?u:null}var la="__closure_events_fn_"+(1e9*Math.random()>>>0);function As(u){return typeof u=="function"?u:(u[la]||(u[la]=function(f){return u.handleEvent(f)}),u[la])}function ce(){ye.call(this),this.i=new Bn(this),this.M=this,this.F=null}y(ce,ye),ce.prototype[nn]=!0,ce.prototype.removeEventListener=function(u,f,m,T){Le(this,u,f,m,T)};function pe(u,f){var m,T=u.F;if(T)for(m=[];T;T=T.F)m.push(T);if(u=u.M,T=f.type||f,typeof f=="string")f=new At(f,u);else if(f instanceof At)f.target=f.target||u;else{var O=f;f=new At(T,u),A(f,O)}if(O=!0,m)for(var j=m.length-1;0<=j;j--){var G=f.g=m[j];O=Cr(G,T,!0,f)&&O}if(G=f.g=u,O=Cr(G,T,!0,f)&&O,O=Cr(G,T,!1,f)&&O,m)for(j=0;j<m.length;j++)G=f.g=m[j],O=Cr(G,T,!1,f)&&O}ce.prototype.N=function(){if(ce.aa.N.call(this),this.i){var u=this.i,f;for(f in u.g){for(var m=u.g[f],T=0;T<m.length;T++)oi(m[T]);delete u.g[f],u.h--}}this.F=null},ce.prototype.K=function(u,f,m,T){return this.i.add(String(u),f,!1,m,T)},ce.prototype.L=function(u,f,m,T){return this.i.add(String(u),f,!0,m,T)};function Cr(u,f,m,T){if(f=u.i.g[String(f)],!f)return!0;f=f.concat();for(var O=!0,j=0;j<f.length;++j){var G=f[j];if(G&&!G.da&&G.capture==m){var Et=G.listener,xe=G.ha||G.src;G.fa&&ai(u.i,G),O=Et.call(xe,T)!==!1&&O}}return O&&!T.defaultPrevented}function Pr(u,f,m){if(typeof u=="function")m&&(u=p(u,m));else if(u&&typeof u.handleEvent=="function")u=p(u.handleEvent,u);else throw Error("Invalid listener argument");return 2147483647<Number(f)?-1:a.setTimeout(u,f||0)}function Cs(u){u.g=Pr(()=>{u.g=null,u.i&&(u.i=!1,Cs(u))},u.l);let f=u.h;u.h=null,u.m.apply(null,f)}class wd extends ye{constructor(f,m){super(),this.m=f,this.l=m,this.h=null,this.i=!1,this.g=null}j(f){this.h=arguments,this.g?this.i=!0:Cs(this)}N(){super.N(),this.g&&(a.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function kr(u){ye.call(this),this.h=u,this.g={}}y(kr,ye);var Jc=[];function Zc(u){L(u.g,function(f,m){this.g.hasOwnProperty(m)&&aa(f)},u),u.g={}}kr.prototype.N=function(){kr.aa.N.call(this),Zc(this)},kr.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var ua=a.JSON.stringify,Ps=a.JSON.parse,Td=class{stringify(u){return a.JSON.stringify(u,void 0)}parse(u){return a.JSON.parse(u,void 0)}};function ha(){}ha.prototype.h=null;function da(u){return u.h||(u.h=u.i())}function fa(){}var ui={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function pa(){At.call(this,"d")}y(pa,At);function ga(){At.call(this,"c")}y(ga,At);var hi={},ma=null;function ks(){return ma=ma||new ce}hi.La="serverreachability";function tl(u){At.call(this,hi.La,u)}y(tl,At);function Rr(u){let f=ks();pe(f,new tl(f))}hi.STAT_EVENT="statevent";function Dr(u,f){At.call(this,hi.STAT_EVENT,u),this.stat=f}y(Dr,At);function ve(u){let f=ks();pe(f,new Dr(f,u))}hi.Ma="timingevent";function el(u,f){At.call(this,hi.Ma,u),this.size=f}y(el,At);function Oi(u,f){if(typeof u!="function")throw Error("Fn must not be null and must be a function");return a.setTimeout(function(){u()},f)}function di(){this.g=!0}di.prototype.xa=function(){this.g=!1};function Ed(u,f,m,T,O,j){u.info(function(){if(u.g)if(j)for(var G="",Et=j.split("&"),xe=0;xe<Et.length;xe++){var vt=Et[xe].split("=");if(1<vt.length){var Re=vt[0];vt=vt[1];var De=Re.split("_");G=2<=De.length&&De[1]=="type"?G+(Re+"="+vt+"&"):G+(Re+"=redacted&")}}else G=null;else G=j;return"XMLHTTP REQ ("+T+") [attempt "+O+"]: "+f+`
`+m+`
`+G})}function nl(u,f,m,T,O,j,G){u.info(function(){return"XMLHTTP RESP ("+T+") [ attempt "+O+"]: "+f+`
`+m+`
`+j+" "+G})}function Vi(u,f,m,T){u.info(function(){return"XMLHTTP TEXT ("+f+"): "+rl(u,m)+(T?" "+T:"")})}function il(u,f){u.info(function(){return"TIMEOUT: "+f})}di.prototype.info=function(){};function rl(u,f){if(!u.g)return f;if(!f)return null;try{var m=JSON.parse(f);if(m){for(u=0;u<m.length;u++)if(Array.isArray(m[u])){var T=m[u];if(!(2>T.length)){var O=T[1];if(Array.isArray(O)&&!(1>O.length)){var j=O[0];if(j!="noop"&&j!="stop"&&j!="close")for(var G=1;G<O.length;G++)O[G]=""}}}}return ua(m)}catch{return f}}var Mr={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},_a={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Or;function un(){}y(un,ha),un.prototype.g=function(){return new XMLHttpRequest},un.prototype.i=function(){return{}},Or=new un;function We(u,f,m,T){this.j=u,this.i=f,this.l=m,this.R=T||1,this.U=new kr(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Ni}function Ni(){this.i=null,this.g="",this.h=!1}var Vr={},Nr={};function ya(u,f,m){u.L=1,u.v=C(dn(f)),u.m=m,u.P=!0,sl(u,null)}function sl(u,f){u.F=Date.now(),Sn(u),u.A=dn(u.v);var m=u.A,T=u.R;Array.isArray(T)||(T=[String(T)]),N_(m.i,"t",T),u.C=0,m=u.j.J,u.h=new Ni,u.g=ty(u.j,m?f:null,!u.m),0<u.O&&(u.M=new wd(p(u.Y,u,u.g),u.O)),f=u.U,m=u.g,T=u.ca;var O="readystatechange";Array.isArray(O)||(O&&(Jc[0]=O.toString()),O=Jc);for(var j=0;j<O.length;j++){var G=zn(m,O[j],T||f.handleEvent,!1,f.h||f);if(!G)break;f.g[G.key]=G}f=u.H?b(u.H):{},u.m?(u.u||(u.u="POST"),f["Content-Type"]="application/x-www-form-urlencoded",u.g.ea(u.A,u.u,u.m,f)):(u.u="GET",u.g.ea(u.A,u.u,null,f)),Rr(),Ed(u.i,u.u,u.A,u.l,u.R,u.m)}We.prototype.ca=function(u){u=u.target;let f=this.M;f&&fi(u)==3?f.j():this.Y(u)},We.prototype.Y=function(u){try{if(u==this.g)t:{let De=fi(this.g);var f=this.g.Ba();let Ls=this.g.Z();if(!(3>De)&&(De!=3||this.g&&(this.h.h||this.g.oa()||q_(this.g)))){this.J||De!=4||f==7||(f==8||0>=Ls?Rr(3):Rr(2)),rn(this);var m=this.g.Z();this.X=m;e:if(Fr(this)){var T=q_(this.g);u="";var O=T.length,j=fi(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){ge(this),Cn(this);var G="";break e}this.h.i=new a.TextDecoder}for(f=0;f<O;f++)this.h.h=!0,u+=this.h.i.decode(T[f],{stream:!(j&&f==O-1)});T.length=0,this.h.g+=u,this.C=0,G=this.h.g}else G=this.g.oa();if(this.o=m==200,nl(this.i,this.u,this.A,this.l,this.R,De,m),this.o){if(this.T&&!this.K){e:{if(this.g){var Et,xe=this.g;if((Et=xe.g?xe.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!R(Et)){var vt=Et;break e}}vt=null}if(m=vt)Vi(this.i,this.l,m,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,sn(this,m);else{this.o=!1,this.s=3,ve(12),ge(this),Cn(this);break t}}if(this.P){m=!0;let kn;for(;!this.J&&this.C<G.length;)if(kn=He(this,G),kn==Nr){De==4&&(this.s=4,ve(14),m=!1),Vi(this.i,this.l,null,"[Incomplete Response]");break}else if(kn==Vr){this.s=4,ve(15),Vi(this.i,this.l,G,"[Invalid Chunk]"),m=!1;break}else Vi(this.i,this.l,kn,null),sn(this,kn);if(Fr(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),De!=4||G.length!=0||this.h.h||(this.s=1,ve(16),m=!1),this.o=this.o&&m,!m)Vi(this.i,this.l,G,"[Invalid Chunked Response]"),ge(this),Cn(this);else if(0<G.length&&!this.W){this.W=!0;var Re=this.j;Re.g==this&&Re.ba&&!Re.M&&(Re.j.info("Great, no buffering proxy detected. Bytes received: "+G.length),Cd(Re),Re.M=!0,ve(11))}}else Vi(this.i,this.l,G,null),sn(this,G);De==4&&ge(this),this.o&&!this.J&&(De==4?Q_(this.j,this):(this.o=!1,Sn(this)))}else GI(this.g),m==400&&0<G.indexOf("Unknown SID")?(this.s=3,ve(12)):(this.s=0,ve(13)),ge(this),Cn(this)}}}catch{}finally{}};function Fr(u){return u.g?u.u=="GET"&&u.L!=2&&u.j.Ca:!1}function He(u,f){var m=u.C,T=f.indexOf(`
`,m);return T==-1?Nr:(m=Number(f.substring(m,T)),isNaN(m)?Vr:(T+=1,T+m>f.length?Nr:(f=f.slice(T,T+m),u.C=T+m,f)))}We.prototype.cancel=function(){this.J=!0,ge(this)};function Sn(u){u.S=Date.now()+u.I,An(u,u.I)}function An(u,f){if(u.B!=null)throw Error("WatchDog timer not null");u.B=Oi(p(u.ba,u),f)}function rn(u){u.B&&(a.clearTimeout(u.B),u.B=null)}We.prototype.ba=function(){this.B=null;let u=Date.now();0<=u-this.S?(il(this.i,this.A),this.L!=2&&(Rr(),ve(17)),ge(this),this.s=2,Cn(this)):An(this,this.S-u)};function Cn(u){u.j.G==0||u.J||Q_(u.j,u)}function ge(u){rn(u);var f=u.M;f&&typeof f.ma=="function"&&f.ma(),u.M=null,Zc(u.U),u.g&&(f=u.g,u.g=null,f.abort(),f.ma())}function sn(u,f){try{var m=u.j;if(m.G!=0&&(m.g==u||Fi(m.h,u))){if(!u.K&&Fi(m.h,u)&&m.G==3){try{var T=m.Da.g.parse(f)}catch{T=null}if(Array.isArray(T)&&T.length==3){var O=T;if(O[0]==0){t:if(!m.u){if(m.g)if(m.g.F+3e3<u.F)fl(m),hl(m);else break t;Ad(m),ve(18)}}else m.za=O[1],0<m.za-m.T&&37500>O[2]&&m.F&&m.v==0&&!m.C&&(m.C=Oi(p(m.Za,m),6e3));if(1>=Ge(m.h)&&m.ca){try{m.ca()}catch{}m.ca=void 0}}else zr(m,11)}else if((u.K||m.g==u)&&fl(m),!R(f))for(O=m.Da.g.parse(f),f=0;f<O.length;f++){let vt=O[f];if(m.T=vt[0],vt=vt[1],m.G==2)if(vt[0]=="c"){m.K=vt[1],m.ia=vt[2];let Re=vt[3];Re!=null&&(m.la=Re,m.j.info("VER="+m.la));let De=vt[4];De!=null&&(m.Aa=De,m.j.info("SVER="+m.Aa));let Ls=vt[5];Ls!=null&&typeof Ls=="number"&&0<Ls&&(T=1.5*Ls,m.L=T,m.j.info("backChannelRequestTimeoutMs_="+T)),T=m;let kn=u.g;if(kn){let gl=kn.g?kn.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(gl){var j=T.h;j.g||gl.indexOf("spdy")==-1&&gl.indexOf("quic")==-1&&gl.indexOf("h2")==-1||(j.j=j.l,j.g=new Set,j.h&&(Br(j,j.h),j.h=null))}if(T.D){let Pd=kn.g?kn.g.getResponseHeader("X-HTTP-Session-Id"):null;Pd&&(T.ya=Pd,x(T.I,T.D,Pd))}}m.G=3,m.l&&m.l.ua(),m.ba&&(m.R=Date.now()-u.F,m.j.info("Handshake RTT: "+m.R+"ms")),T=m;var G=u;if(T.qa=Z_(T,T.J?T.ia:null,T.W),G.K){Rs(T.h,G);var Et=G,xe=T.L;xe&&(Et.I=xe),Et.B&&(rn(Et),Sn(Et)),T.g=G}else K_(T);0<m.i.length&&dl(m)}else vt[0]!="stop"&&vt[0]!="close"||zr(m,7);else m.G==3&&(vt[0]=="stop"||vt[0]=="close"?vt[0]=="stop"?zr(m,7):Sd(m):vt[0]!="noop"&&m.l&&m.l.ta(vt),m.v=0)}}Rr(4)}catch{}}var ol=class{constructor(u,f){this.g=u,this.map=f}};function va(u){this.l=u||10,a.PerformanceNavigationTiming?(u=a.performance.getEntriesByType("navigation"),u=0<u.length&&(u[0].nextHopProtocol=="hq"||u[0].nextHopProtocol=="h2")):u=!!(a.chrome&&a.chrome.loadTimes&&a.chrome.loadTimes()&&a.chrome.loadTimes().wasFetchedViaSpdy),this.j=u?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function Lr(u){return u.h?!0:u.g?u.g.size>=u.j:!1}function Ge(u){return u.h?1:u.g?u.g.size:0}function Fi(u,f){return u.h?u.h==f:u.g?u.g.has(f):!1}function Br(u,f){u.g?u.g.add(f):u.h=f}function Rs(u,f){u.h&&u.h==f?u.h=null:u.g&&u.g.has(f)&&u.g.delete(f)}va.prototype.cancel=function(){if(this.i=Ds(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(let u of this.g.values())u.cancel();this.g.clear()}};function Ds(u){if(u.h!=null)return u.i.concat(u.h.D);if(u.g!=null&&u.g.size!==0){let f=u.i;for(let m of u.g.values())f=f.concat(m.D);return f}return v(u.i)}function ba(u){if(u.V&&typeof u.V=="function")return u.V();if(typeof Map<"u"&&u instanceof Map||typeof Set<"u"&&u instanceof Set)return Array.from(u.values());if(typeof u=="string")return u.split("");if(c(u)){for(var f=[],m=u.length,T=0;T<m;T++)f.push(u[T]);return f}f=[],m=0;for(T in u)f[m++]=u[T];return f}function Ms(u){if(u.na&&typeof u.na=="function")return u.na();if(!u.V||typeof u.V!="function"){if(typeof Map<"u"&&u instanceof Map)return Array.from(u.keys());if(!(typeof Set<"u"&&u instanceof Set)){if(c(u)||typeof u=="string"){var f=[];u=u.length;for(var m=0;m<u;m++)f.push(m);return f}f=[],m=0;for(let T in u)f[m++]=T;return f}}}function hn(u,f){if(u.forEach&&typeof u.forEach=="function")u.forEach(f,void 0);else if(c(u)||typeof u=="string")Array.prototype.forEach.call(u,f,void 0);else for(var m=Ms(u),T=ba(u),O=T.length,j=0;j<O;j++)f.call(void 0,T[j],m&&m[j],u)}var al=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function cl(u,f){if(u){u=u.split("&");for(var m=0;m<u.length;m++){var T=u[m].indexOf("="),O=null;if(0<=T){var j=u[m].substring(0,T);O=u[m].substring(T+1)}else j=u[m];f(j,O?decodeURIComponent(O.replace(/\+/g," ")):"")}}}function Pn(u){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,u instanceof Pn){this.h=u.h,Os(this,u.j),this.o=u.o,this.g=u.g,Vs(this,u.s),this.l=u.l;var f=u.i,m=new xa;m.i=f.i,f.g&&(m.g=new Map(f.g),m.h=f.h),_(this,m),this.m=u.m}else u&&(f=String(u).match(al))?(this.h=!1,Os(this,f[1]||"",!0),this.o=N(f[2]||""),this.g=N(f[3]||"",!0),Vs(this,f[4]),this.l=N(f[5]||"",!0),_(this,f[6]||"",!0),this.m=N(f[7]||"")):(this.h=!1,this.i=new xa(null,this.h))}Pn.prototype.toString=function(){var u=[],f=this.j;f&&u.push(W(f,ut,!0),":");var m=this.g;return(m||f=="file")&&(u.push("//"),(f=this.o)&&u.push(W(f,ut,!0),"@"),u.push(encodeURIComponent(String(m)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),m=this.s,m!=null&&u.push(":",String(m))),(m=this.l)&&(this.g&&m.charAt(0)!="/"&&u.push("/"),u.push(W(m,m.charAt(0)=="/"?le:ee,!0))),(m=this.i.toString())&&u.push("?",m),(m=this.m)&&u.push("#",W(m,fn)),u.join("")};function dn(u){return new Pn(u)}function Os(u,f,m){u.j=m?N(f,!0):f,u.j&&(u.j=u.j.replace(/:$/,""))}function Vs(u,f){if(f){if(f=Number(f),isNaN(f)||0>f)throw Error("Bad port number "+f);u.s=f}else u.s=null}function _(u,f,m){f instanceof xa?(u.i=f,BI(u.i,u.h)):(m||(f=W(f,be)),u.i=new xa(f,u.h))}function x(u,f,m){u.i.set(f,m)}function C(u){return x(u,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),u}function N(u,f){return u?f?decodeURI(u.replace(/%25/g,"%2525")):decodeURIComponent(u):""}function W(u,f,m){return typeof u=="string"?(u=encodeURI(u).replace(f,Q),m&&(u=u.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),u):null}function Q(u){return u=u.charCodeAt(0),"%"+(u>>4&15).toString(16)+(u&15).toString(16)}var ut=/[#\/\?@]/g,ee=/[#\?:]/g,le=/[#\?]/g,be=/[#\?@]/g,fn=/#/g;function xa(u,f){this.h=this.g=null,this.i=u||null,this.j=!!f}function Li(u){u.g||(u.g=new Map,u.h=0,u.i&&cl(u.i,function(f,m){u.add(decodeURIComponent(f.replace(/\+/g," ")),m)}))}n=xa.prototype,n.add=function(u,f){Li(this),this.i=null,u=Ns(this,u);var m=this.g.get(u);return m||this.g.set(u,m=[]),m.push(f),this.h+=1,this};function O_(u,f){Li(u),f=Ns(u,f),u.g.has(f)&&(u.i=null,u.h-=u.g.get(f).length,u.g.delete(f))}function V_(u,f){return Li(u),f=Ns(u,f),u.g.has(f)}n.forEach=function(u,f){Li(this),this.g.forEach(function(m,T){m.forEach(function(O){u.call(f,O,T,this)},this)},this)},n.na=function(){Li(this);let u=Array.from(this.g.values()),f=Array.from(this.g.keys()),m=[];for(let T=0;T<f.length;T++){let O=u[T];for(let j=0;j<O.length;j++)m.push(f[T])}return m},n.V=function(u){Li(this);let f=[];if(typeof u=="string")V_(this,u)&&(f=f.concat(this.g.get(Ns(this,u))));else{u=Array.from(this.g.values());for(let m=0;m<u.length;m++)f=f.concat(u[m])}return f},n.set=function(u,f){return Li(this),this.i=null,u=Ns(this,u),V_(this,u)&&(this.h-=this.g.get(u).length),this.g.set(u,[f]),this.h+=1,this},n.get=function(u,f){return u?(u=this.V(u),0<u.length?String(u[0]):f):f};function N_(u,f,m){O_(u,f),0<m.length&&(u.i=null,u.g.set(Ns(u,f),v(m)),u.h+=m.length)}n.toString=function(){if(this.i)return this.i;if(!this.g)return"";let u=[],f=Array.from(this.g.keys());for(var m=0;m<f.length;m++){var T=f[m];let j=encodeURIComponent(String(T)),G=this.V(T);for(T=0;T<G.length;T++){var O=j;G[T]!==""&&(O+="="+encodeURIComponent(String(G[T]))),u.push(O)}}return this.i=u.join("&")};function Ns(u,f){return f=String(f),u.j&&(f=f.toLowerCase()),f}function BI(u,f){f&&!u.j&&(Li(u),u.i=null,u.g.forEach(function(m,T){var O=T.toLowerCase();T!=O&&(O_(this,T),N_(this,O,m))},u)),u.j=f}function zI(u,f){let m=new di;if(a.Image){let T=new Image;T.onload=g(Bi,m,"TestLoadImage: loaded",!0,f,T),T.onerror=g(Bi,m,"TestLoadImage: error",!1,f,T),T.onabort=g(Bi,m,"TestLoadImage: abort",!1,f,T),T.ontimeout=g(Bi,m,"TestLoadImage: timeout",!1,f,T),a.setTimeout(function(){T.ontimeout&&T.ontimeout()},1e4),T.src=u}else f(!1)}function jI(u,f){let m=new di,T=new AbortController,O=setTimeout(()=>{T.abort(),Bi(m,"TestPingServer: timeout",!1,f)},1e4);fetch(u,{signal:T.signal}).then(j=>{clearTimeout(O),j.ok?Bi(m,"TestPingServer: ok",!0,f):Bi(m,"TestPingServer: server error",!1,f)}).catch(()=>{clearTimeout(O),Bi(m,"TestPingServer: error",!1,f)})}function Bi(u,f,m,T,O){try{O&&(O.onload=null,O.onerror=null,O.onabort=null,O.ontimeout=null),T(m)}catch{}}function UI(){this.g=new Td}function qI(u,f,m){let T=m||"";try{hn(u,function(O,j){let G=O;l(O)&&(G=ua(O)),f.push(T+j+"="+encodeURIComponent(G))})}catch(O){throw f.push(T+"type="+encodeURIComponent("_badmap")),O}}function wa(u){this.l=u.Ub||null,this.j=u.eb||!1}y(wa,ha),wa.prototype.g=function(){return new ll(this.l,this.j)},wa.prototype.i=function(u){return function(){return u}}({});function ll(u,f){ce.call(this),this.D=u,this.o=f,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}y(ll,ce),n=ll.prototype,n.open=function(u,f){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=u,this.A=f,this.readyState=1,Ea(this)},n.send=function(u){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;let f={headers:this.u,method:this.B,credentials:this.m,cache:void 0};u&&(f.body=u),(this.D||a).fetch(new Request(this.A,f)).then(this.Sa.bind(this),this.ga.bind(this))},n.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,Ta(this)),this.readyState=0},n.Sa=function(u){if(this.g&&(this.l=u,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=u.headers,this.readyState=2,Ea(this)),this.g&&(this.readyState=3,Ea(this),this.g)))if(this.responseType==="arraybuffer")u.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof a.ReadableStream<"u"&&"body"in u){if(this.j=u.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;F_(this)}else u.text().then(this.Ra.bind(this),this.ga.bind(this))};function F_(u){u.j.read().then(u.Pa.bind(u)).catch(u.ga.bind(u))}n.Pa=function(u){if(this.g){if(this.o&&u.value)this.response.push(u.value);else if(!this.o){var f=u.value?u.value:new Uint8Array(0);(f=this.v.decode(f,{stream:!u.done}))&&(this.response=this.responseText+=f)}u.done?Ta(this):Ea(this),this.readyState==3&&F_(this)}},n.Ra=function(u){this.g&&(this.response=this.responseText=u,Ta(this))},n.Qa=function(u){this.g&&(this.response=u,Ta(this))},n.ga=function(){this.g&&Ta(this)};function Ta(u){u.readyState=4,u.l=null,u.j=null,u.v=null,Ea(u)}n.setRequestHeader=function(u,f){this.u.append(u,f)},n.getResponseHeader=function(u){return this.h&&this.h.get(u.toLowerCase())||""},n.getAllResponseHeaders=function(){if(!this.h)return"";let u=[],f=this.h.entries();for(var m=f.next();!m.done;)m=m.value,u.push(m[0]+": "+m[1]),m=f.next();return u.join(`\r
`)};function Ea(u){u.onreadystatechange&&u.onreadystatechange.call(u)}Object.defineProperty(ll.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(u){this.m=u?"include":"same-origin"}});function L_(u){let f="";return L(u,function(m,T){f+=T,f+=":",f+=m,f+=`\r
`}),f}function Id(u,f,m){t:{for(T in m){var T=!1;break t}T=!0}T||(m=L_(m),typeof u=="string"?m!=null&&encodeURIComponent(String(m)):x(u,f,m))}function Gt(u){ce.call(this),this.headers=new Map,this.o=u||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}y(Gt,ce);var WI=/^https?$/i,HI=["POST","PUT"];n=Gt.prototype,n.Ha=function(u){this.J=u},n.ea=function(u,f,m,T){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+u);f=f?f.toUpperCase():"GET",this.D=u,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Or.g(),this.v=this.o?da(this.o):da(Or),this.g.onreadystatechange=p(this.Ea,this);try{this.B=!0,this.g.open(f,String(u),!0),this.B=!1}catch(j){B_(this,j);return}if(u=m||"",m=new Map(this.headers),T)if(Object.getPrototypeOf(T)===Object.prototype)for(var O in T)m.set(O,T[O]);else if(typeof T.keys=="function"&&typeof T.get=="function")for(let j of T.keys())m.set(j,T.get(j));else throw Error("Unknown input type for opt_headers: "+String(T));T=Array.from(m.keys()).find(j=>j.toLowerCase()=="content-type"),O=a.FormData&&u instanceof a.FormData,!(0<=Array.prototype.indexOf.call(HI,f,void 0))||T||O||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(let[j,G]of m)this.g.setRequestHeader(j,G);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{U_(this),this.u=!0,this.g.send(u),this.u=!1}catch(j){B_(this,j)}};function B_(u,f){u.h=!1,u.g&&(u.j=!0,u.g.abort(),u.j=!1),u.l=f,u.m=5,z_(u),ul(u)}function z_(u){u.A||(u.A=!0,pe(u,"complete"),pe(u,"error"))}n.abort=function(u){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=u||7,pe(this,"complete"),pe(this,"abort"),ul(this))},n.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),ul(this,!0)),Gt.aa.N.call(this)},n.Ea=function(){this.s||(this.B||this.u||this.j?j_(this):this.bb())},n.bb=function(){j_(this)};function j_(u){if(u.h&&typeof o<"u"&&(!u.v[1]||fi(u)!=4||u.Z()!=2)){if(u.u&&fi(u)==4)Pr(u.Ea,0,u);else if(pe(u,"readystatechange"),fi(u)==4){u.h=!1;try{let G=u.Z();t:switch(G){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var f=!0;break t;default:f=!1}var m;if(!(m=f)){var T;if(T=G===0){var O=String(u.D).match(al)[1]||null;!O&&a.self&&a.self.location&&(O=a.self.location.protocol.slice(0,-1)),T=!WI.test(O?O.toLowerCase():"")}m=T}if(m)pe(u,"complete"),pe(u,"success");else{u.m=6;try{var j=2<fi(u)?u.g.statusText:""}catch{j=""}u.l=j+" ["+u.Z()+"]",z_(u)}}finally{ul(u)}}}}function ul(u,f){if(u.g){U_(u);let m=u.g,T=u.v[0]?()=>{}:null;u.g=null,u.v=null,f||pe(u,"ready");try{m.onreadystatechange=T}catch{}}}function U_(u){u.I&&(a.clearTimeout(u.I),u.I=null)}n.isActive=function(){return!!this.g};function fi(u){return u.g?u.g.readyState:0}n.Z=function(){try{return 2<fi(this)?this.g.status:-1}catch{return-1}},n.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},n.Oa=function(u){if(this.g){var f=this.g.responseText;return u&&f.indexOf(u)==0&&(f=f.substring(u.length)),Ps(f)}};function q_(u){try{if(!u.g)return null;if("response"in u.g)return u.g.response;switch(u.H){case"":case"text":return u.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in u.g)return u.g.mozResponseArrayBuffer}return null}catch{return null}}function GI(u){let f={};u=(u.g&&2<=fi(u)&&u.g.getAllResponseHeaders()||"").split(`\r
`);for(let T=0;T<u.length;T++){if(R(u[T]))continue;var m=P(u[T]);let O=m[0];if(m=m[1],typeof m!="string")continue;m=m.trim();let j=f[O]||[];f[O]=j,j.push(m)}I(f,function(T){return T.join(", ")})}n.Ba=function(){return this.m},n.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function Ia(u,f,m){return m&&m.internalChannelParams&&m.internalChannelParams[u]||f}function W_(u){this.Aa=0,this.i=[],this.j=new di,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=Ia("failFast",!1,u),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=Ia("baseRetryDelayMs",5e3,u),this.cb=Ia("retryDelaySeedMs",1e4,u),this.Wa=Ia("forwardChannelMaxRetries",2,u),this.wa=Ia("forwardChannelRequestTimeoutMs",2e4,u),this.pa=u&&u.xmlHttpFactory||void 0,this.Xa=u&&u.Tb||void 0,this.Ca=u&&u.useFetchStreams||!1,this.L=void 0,this.J=u&&u.supportsCrossDomainXhr||!1,this.K="",this.h=new va(u&&u.concurrentRequestLimit),this.Da=new UI,this.P=u&&u.fastHandshake||!1,this.O=u&&u.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=u&&u.Rb||!1,u&&u.xa&&this.j.xa(),u&&u.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&u&&u.detectBufferingProxy||!1,this.ja=void 0,u&&u.longPollingTimeout&&0<u.longPollingTimeout&&(this.ja=u.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}n=W_.prototype,n.la=8,n.G=1,n.connect=function(u,f,m,T){ve(0),this.W=u,this.H=f||{},m&&T!==void 0&&(this.H.OSID=m,this.H.OAID=T),this.F=this.X,this.I=Z_(this,null,this.W),dl(this)};function Sd(u){if(H_(u),u.G==3){var f=u.U++,m=dn(u.I);if(x(m,"SID",u.K),x(m,"RID",f),x(m,"TYPE","terminate"),Sa(u,m),f=new We(u,u.j,f),f.L=2,f.v=C(dn(m)),m=!1,a.navigator&&a.navigator.sendBeacon)try{m=a.navigator.sendBeacon(f.v.toString(),"")}catch{}!m&&a.Image&&(new Image().src=f.v,m=!0),m||(f.g=ty(f.j,null),f.g.ea(f.v)),f.F=Date.now(),Sn(f)}J_(u)}function hl(u){u.g&&(Cd(u),u.g.cancel(),u.g=null)}function H_(u){hl(u),u.u&&(a.clearTimeout(u.u),u.u=null),fl(u),u.h.cancel(),u.s&&(typeof u.s=="number"&&a.clearTimeout(u.s),u.s=null)}function dl(u){if(!Lr(u.h)&&!u.s){u.s=!0;var f=u.Ga;wt||En(),te||(wt(),te=!0),Wt.add(f,u),u.B=0}}function $I(u,f){return Ge(u.h)>=u.h.j-(u.s?1:0)?!1:u.s?(u.i=f.D.concat(u.i),!0):u.G==1||u.G==2||u.B>=(u.Va?0:u.Wa)?!1:(u.s=Oi(p(u.Ga,u,f),X_(u,u.B)),u.B++,!0)}n.Ga=function(u){if(this.s)if(this.s=null,this.G==1){if(!u){this.U=Math.floor(1e5*Math.random()),u=this.U++;let O=new We(this,this.j,u),j=this.o;if(this.S&&(j?(j=b(j),A(j,this.S)):j=this.S),this.m!==null||this.O||(O.H=j,j=null),this.P)t:{for(var f=0,m=0;m<this.i.length;m++){e:{var T=this.i[m];if("__data__"in T.map&&(T=T.map.__data__,typeof T=="string")){T=T.length;break e}T=void 0}if(T===void 0)break;if(f+=T,4096<f){f=m;break t}if(f===4096||m===this.i.length-1){f=m+1;break t}}f=1e3}else f=1e3;f=$_(this,O,f),m=dn(this.I),x(m,"RID",u),x(m,"CVER",22),this.D&&x(m,"X-HTTP-Session-Id",this.D),Sa(this,m),j&&(this.O?f="headers="+encodeURIComponent(String(L_(j)))+"&"+f:this.m&&Id(m,this.m,j)),Br(this.h,O),this.Ua&&x(m,"TYPE","init"),this.P?(x(m,"$req",f),x(m,"SID","null"),O.T=!0,ya(O,m,null)):ya(O,m,f),this.G=2}}else this.G==3&&(u?G_(this,u):this.i.length==0||Lr(this.h)||G_(this))};function G_(u,f){var m;f?m=f.l:m=u.U++;let T=dn(u.I);x(T,"SID",u.K),x(T,"RID",m),x(T,"AID",u.T),Sa(u,T),u.m&&u.o&&Id(T,u.m,u.o),m=new We(u,u.j,m,u.B+1),u.m===null&&(m.H=u.o),f&&(u.i=f.D.concat(u.i)),f=$_(u,m,1e3),m.I=Math.round(.5*u.wa)+Math.round(.5*u.wa*Math.random()),Br(u.h,m),ya(m,T,f)}function Sa(u,f){u.H&&L(u.H,function(m,T){x(f,T,m)}),u.l&&hn({},function(m,T){x(f,T,m)})}function $_(u,f,m){m=Math.min(u.i.length,m);var T=u.l?p(u.l.Na,u.l,u):null;t:{var O=u.i;let j=-1;for(;;){let G=["count="+m];j==-1?0<m?(j=O[0].g,G.push("ofs="+j)):j=0:G.push("ofs="+j);let Et=!0;for(let xe=0;xe<m;xe++){let vt=O[xe].g,Re=O[xe].map;if(vt-=j,0>vt)j=Math.max(0,O[xe].g-100),Et=!1;else try{qI(Re,G,"req"+vt+"_")}catch{T&&T(Re)}}if(Et){T=G.join("&");break t}}}return u=u.i.splice(0,m),f.D=u,T}function K_(u){if(!u.g&&!u.u){u.Y=1;var f=u.Fa;wt||En(),te||(wt(),te=!0),Wt.add(f,u),u.v=0}}function Ad(u){return u.g||u.u||3<=u.v?!1:(u.Y++,u.u=Oi(p(u.Fa,u),X_(u,u.v)),u.v++,!0)}n.Fa=function(){if(this.u=null,Y_(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var u=2*this.R;this.j.info("BP detection timer enabled: "+u),this.A=Oi(p(this.ab,this),u)}},n.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,ve(10),hl(this),Y_(this))};function Cd(u){u.A!=null&&(a.clearTimeout(u.A),u.A=null)}function Y_(u){u.g=new We(u,u.j,"rpc",u.Y),u.m===null&&(u.g.H=u.o),u.g.O=0;var f=dn(u.qa);x(f,"RID","rpc"),x(f,"SID",u.K),x(f,"AID",u.T),x(f,"CI",u.F?"0":"1"),!u.F&&u.ja&&x(f,"TO",u.ja),x(f,"TYPE","xmlhttp"),Sa(u,f),u.m&&u.o&&Id(f,u.m,u.o),u.L&&(u.g.I=u.L);var m=u.g;u=u.ia,m.L=1,m.v=C(dn(f)),m.m=null,m.P=!0,sl(m,u)}n.Za=function(){this.C!=null&&(this.C=null,hl(this),Ad(this),ve(19))};function fl(u){u.C!=null&&(a.clearTimeout(u.C),u.C=null)}function Q_(u,f){var m=null;if(u.g==f){fl(u),Cd(u),u.g=null;var T=2}else if(Fi(u.h,f))m=f.D,Rs(u.h,f),T=1;else return;if(u.G!=0){if(f.o)if(T==1){m=f.m?f.m.length:0,f=Date.now()-f.F;var O=u.B;T=ks(),pe(T,new el(T,m)),dl(u)}else K_(u);else if(O=f.s,O==3||O==0&&0<f.X||!(T==1&&$I(u,f)||T==2&&Ad(u)))switch(m&&0<m.length&&(f=u.h,f.i=f.i.concat(m)),O){case 1:zr(u,5);break;case 4:zr(u,10);break;case 3:zr(u,6);break;default:zr(u,2)}}}function X_(u,f){let m=u.Ta+Math.floor(Math.random()*u.cb);return u.isActive()||(m*=2),m*f}function zr(u,f){if(u.j.info("Error code "+f),f==2){var m=p(u.fb,u),T=u.Xa;let O=!T;T=new Pn(T||"//www.google.com/images/cleardot.gif"),a.location&&a.location.protocol=="http"||Os(T,"https"),C(T),O?zI(T.toString(),m):jI(T.toString(),m)}else ve(2);u.G=0,u.l&&u.l.sa(f),J_(u),H_(u)}n.fb=function(u){u?(this.j.info("Successfully pinged google.com"),ve(2)):(this.j.info("Failed to ping google.com"),ve(1))};function J_(u){if(u.G=0,u.ka=[],u.l){let f=Ds(u.h);(f.length!=0||u.i.length!=0)&&(w(u.ka,f),w(u.ka,u.i),u.h.i.length=0,v(u.i),u.i.length=0),u.l.ra()}}function Z_(u,f,m){var T=m instanceof Pn?dn(m):new Pn(m);if(T.g!="")f&&(T.g=f+"."+T.g),Vs(T,T.s);else{var O=a.location;T=O.protocol,f=f?f+"."+O.hostname:O.hostname,O=+O.port;var j=new Pn(null);T&&Os(j,T),f&&(j.g=f),O&&Vs(j,O),m&&(j.l=m),T=j}return m=u.D,f=u.ya,m&&f&&x(T,m,f),x(T,"VER",u.la),Sa(u,T),T}function ty(u,f,m){if(f&&!u.J)throw Error("Can't create secondary domain capable XhrIo object.");return f=u.Ca&&!u.pa?new Gt(new wa({eb:m})):new Gt(u.pa),f.Ha(u.J),f}n.isActive=function(){return!!this.l&&this.l.isActive(this)};function ey(){}n=ey.prototype,n.ua=function(){},n.ta=function(){},n.sa=function(){},n.ra=function(){},n.isActive=function(){return!0},n.Na=function(){};function pl(){}pl.prototype.g=function(u,f){return new on(u,f)};function on(u,f){ce.call(this),this.g=new W_(f),this.l=u,this.h=f&&f.messageUrlParams||null,u=f&&f.messageHeaders||null,f&&f.clientProtocolHeaderRequired&&(u?u["X-Client-Protocol"]="webchannel":u={"X-Client-Protocol":"webchannel"}),this.g.o=u,u=f&&f.initMessageHeaders||null,f&&f.messageContentType&&(u?u["X-WebChannel-Content-Type"]=f.messageContentType:u={"X-WebChannel-Content-Type":f.messageContentType}),f&&f.va&&(u?u["X-WebChannel-Client-Profile"]=f.va:u={"X-WebChannel-Client-Profile":f.va}),this.g.S=u,(u=f&&f.Sb)&&!R(u)&&(this.g.m=u),this.v=f&&f.supportsCrossDomainXhr||!1,this.u=f&&f.sendRawJson||!1,(f=f&&f.httpSessionIdParam)&&!R(f)&&(this.g.D=f,u=this.h,u!==null&&f in u&&(u=this.h,f in u&&delete u[f])),this.j=new Fs(this)}y(on,ce),on.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},on.prototype.close=function(){Sd(this.g)},on.prototype.o=function(u){var f=this.g;if(typeof u=="string"){var m={};m.__data__=u,u=m}else this.u&&(m={},m.__data__=ua(u),u=m);f.i.push(new ol(f.Ya++,u)),f.G==3&&dl(f)},on.prototype.N=function(){this.g.l=null,delete this.j,Sd(this.g),delete this.g,on.aa.N.call(this)};function ny(u){pa.call(this),u.__headers__&&(this.headers=u.__headers__,this.statusCode=u.__status__,delete u.__headers__,delete u.__status__);var f=u.__sm__;if(f){t:{for(let m in f){u=m;break t}u=void 0}(this.i=u)&&(u=this.i,f=f!==null&&u in f?f[u]:void 0),this.data=f}else this.data=u}y(ny,pa);function iy(){ga.call(this),this.status=1}y(iy,ga);function Fs(u){this.g=u}y(Fs,ey),Fs.prototype.ua=function(){pe(this.g,"a")},Fs.prototype.ta=function(u){pe(this.g,new ny(u))},Fs.prototype.sa=function(u){pe(this.g,new iy)},Fs.prototype.ra=function(){pe(this.g,"b")},pl.prototype.createWebChannel=pl.prototype.g,on.prototype.send=on.prototype.o,on.prototype.open=on.prototype.m,on.prototype.close=on.prototype.close,hf=mi.createWebChannelTransport=function(){return new pl},uf=mi.getStatEventTarget=function(){return ks()},lf=mi.Event=hi,Fl=mi.Stat={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},Mr.NO_ERROR=0,Mr.TIMEOUT=8,Mr.HTTP_ERROR=6,Oa=mi.ErrorCode=Mr,_a.COMPLETE="complete",cf=mi.EventType=_a,fa.EventType=ui,ui.OPEN="a",ui.CLOSE="b",ui.ERROR="c",ui.MESSAGE="d",ce.prototype.listen=ce.prototype.K,Gs=mi.WebChannel=fa,af=mi.FetchXmlHttpFactory=wa,Gt.prototype.listenOnce=Gt.prototype.L,Gt.prototype.getLastError=Gt.prototype.Ka,Gt.prototype.getLastErrorCode=Gt.prototype.Ba,Gt.prototype.getStatus=Gt.prototype.Z,Gt.prototype.getResponseJson=Gt.prototype.Oa,Gt.prototype.getResponseText=Gt.prototype.oa,Gt.prototype.send=Gt.prototype.ea,Gt.prototype.setWithCredentials=Gt.prototype.Ha,of=mi.XhrIo=Gt}).apply(typeof Nl<"u"?Nl:typeof self<"u"?self:typeof window<"u"?window:{});var h0="@firebase/firestore";var re=class{constructor(t){this.uid=t}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(t){return t.uid===this.uid}};re.UNAUTHENTICATED=new re(null),re.GOOGLE_CREDENTIALS=new re("google-credentials-uid"),re.FIRST_PARTY=new re("first-party-uid"),re.MOCK_USER=new re("mock-user");var Eo="10.13.2";var Zi=new Cl("@firebase/firestore");function Xs(){return Zi.logLevel}function fv(n){Zi.setLogLevel(n)}function H(n,...t){if(Zi.logLevel<=Un.DEBUG){let e=t.map(mg);Zi.debug(`Firestore (${Eo}): ${n}`,...e)}}function Qt(n,...t){if(Zi.logLevel<=Un.ERROR){let e=t.map(mg);Zi.error(`Firestore (${Eo}): ${n}`,...e)}}function yn(n,...t){if(Zi.logLevel<=Un.WARN){let e=t.map(mg);Zi.warn(`Firestore (${Eo}): ${n}`,...e)}}function mg(n){if(typeof n=="string")return n;try{return function(e){return JSON.stringify(e)}(n)}catch{return n}}function J(n="Unexpected state"){let t=`FIRESTORE (${Eo}) INTERNAL ASSERTION FAILED: `+n;throw Qt(t),new Error(t)}function Z(n,t){n||J()}function pv(n,t){n||J()}function $(n,t){return n}var z={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},q=class extends Fy{constructor(t,e){super(t,e),this.code=t,this.message=e,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}};var se=class{constructor(){this.promise=new Promise((t,e)=>{this.resolve=t,this.reject=e})}};var Kl=class{constructor(t,e){this.user=e,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${t}`)}},mf=class{getToken(){return Promise.resolve(null)}invalidateToken(){}start(t,e){t.enqueueRetryable(()=>e(re.UNAUTHENTICATED))}shutdown(){}},_f=class{constructor(t){this.token=t,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(t,e){this.changeListener=e,t.enqueueRetryable(()=>e(this.token.user))}shutdown(){this.changeListener=null}},yf=class{constructor(t){this.t=t,this.currentUser=re.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(t,e){let i=this.i,r=c=>this.i!==i?(i=this.i,e(c)):Promise.resolve(),s=new se;this.o=()=>{this.i++,this.currentUser=this.u(),s.resolve(),s=new se,t.enqueueRetryable(()=>r(this.currentUser))};let o=()=>{let c=s;t.enqueueRetryable(()=>U(this,null,function*(){yield c.promise,yield r(this.currentUser)}))},a=c=>{H("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=c,this.auth.addAuthTokenListener(this.o),o()};this.t.onInit(c=>a(c)),setTimeout(()=>{if(!this.auth){let c=this.t.getImmediate({optional:!0});c?a(c):(H("FirebaseAuthCredentialsProvider","Auth not yet detected"),s.resolve(),s=new se)}},0),o()}getToken(){let t=this.i,e=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(e).then(i=>this.i!==t?(H("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):i?(Z(typeof i.accessToken=="string"),new Kl(i.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.auth.removeAuthTokenListener(this.o)}u(){let t=this.auth&&this.auth.getUid();return Z(t===null||typeof t=="string"),new re(t)}},vf=class{constructor(t,e,i){this.l=t,this.h=e,this.P=i,this.type="FirstParty",this.user=re.FIRST_PARTY,this.I=new Map}T(){return this.P?this.P():null}get headers(){this.I.set("X-Goog-AuthUser",this.l);let t=this.T();return t&&this.I.set("Authorization",t),this.h&&this.I.set("X-Goog-Iam-Authorization-Token",this.h),this.I}},bf=class{constructor(t,e,i){this.l=t,this.h=e,this.P=i}getToken(){return Promise.resolve(new vf(this.l,this.h,this.P))}start(t,e){t.enqueueRetryable(()=>e(re.FIRST_PARTY))}shutdown(){}invalidateToken(){}},xf=class{constructor(t){this.value=t,this.type="AppCheck",this.headers=new Map,t&&t.length>0&&this.headers.set("x-firebase-appcheck",this.value)}},wf=class{constructor(t){this.A=t,this.forceRefresh=!1,this.appCheck=null,this.R=null}start(t,e){let i=s=>{s.error!=null&&H("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${s.error.message}`);let o=s.token!==this.R;return this.R=s.token,H("FirebaseAppCheckTokenProvider",`Received ${o?"new":"existing"} token.`),o?e(s.token):Promise.resolve()};this.o=s=>{t.enqueueRetryable(()=>i(s))};let r=s=>{H("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=s,this.appCheck.addTokenListener(this.o)};this.A.onInit(s=>r(s)),setTimeout(()=>{if(!this.appCheck){let s=this.A.getImmediate({optional:!0});s?r(s):H("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){let t=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(t).then(e=>e?(Z(typeof e.token=="string"),this.R=e.token,new xf(e.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.appCheck.removeTokenListener(this.o)}};function NS(n){let t=typeof self<"u"&&(self.crypto||self.msCrypto),e=new Uint8Array(n);if(t&&typeof t.getRandomValues=="function")t.getRandomValues(e);else for(let i=0;i<n;i++)e[i]=Math.floor(256*Math.random());return e}var Yl=class{static newId(){let t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e=Math.floor(256/t.length)*t.length,i="";for(;i.length<20;){let r=NS(40);for(let s=0;s<r.length;++s)i.length<20&&r[s]<e&&(i+=t.charAt(r[s]%t.length))}return i}};function at(n,t){return n<t?-1:n>t?1:0}function oo(n,t,e){return n.length===t.length&&n.every((i,r)=>e(i,t[r]))}function gv(n){return n+"\0"}var Ut=class n{constructor(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new q(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new q(z.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new q(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new q(z.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}static now(){return n.fromMillis(Date.now())}static fromDate(t){return n.fromMillis(t.getTime())}static fromMillis(t){let e=Math.floor(t/1e3),i=Math.floor(1e6*(t-1e3*e));return new n(e,i)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/1e6}_compareTo(t){return this.seconds===t.seconds?at(this.nanoseconds,t.nanoseconds):at(this.seconds,t.seconds)}isEqual(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){let t=this.seconds- -62135596800;return String(t).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}};var it=class n{constructor(t){this.timestamp=t}static fromTimestamp(t){return new n(t)}static min(){return new n(new Ut(0,0))}static max(){return new n(new Ut(253402300799,999999999))}compareTo(t){return this.timestamp._compareTo(t.timestamp)}isEqual(t){return this.timestamp.isEqual(t.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}};var Ql=class n{constructor(t,e,i){e===void 0?e=0:e>t.length&&J(),i===void 0?i=t.length-e:i>t.length-e&&J(),this.segments=t,this.offset=e,this.len=i}get length(){return this.len}isEqual(t){return n.comparator(this,t)===0}child(t){let e=this.segments.slice(this.offset,this.limit());return t instanceof n?t.forEach(i=>{e.push(i)}):e.push(t),this.construct(e)}limit(){return this.offset+this.length}popFirst(t){return t=t===void 0?1:t,this.construct(this.segments,this.offset+t,this.length-t)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(t){return this.segments[this.offset+t]}isEmpty(){return this.length===0}isPrefixOf(t){if(t.length<this.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}isImmediateParentOf(t){if(this.length+1!==t.length)return!1;for(let e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0}forEach(t){for(let e=this.offset,i=this.limit();e<i;e++)t(this.segments[e])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(t,e){let i=Math.min(t.length,e.length);for(let r=0;r<i;r++){let s=t.get(r),o=e.get(r);if(s<o)return-1;if(s>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0}},mt=class n extends Ql{construct(t,e,i){return new n(t,e,i)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...t){let e=[];for(let i of t){if(i.indexOf("//")>=0)throw new q(z.INVALID_ARGUMENT,`Invalid segment (${i}). Paths must not contain // in them.`);e.push(...i.split("/").filter(r=>r.length>0))}return new n(e)}static emptyPath(){return new n([])}},FS=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Xt=class n extends Ql{construct(t,e,i){return new n(t,e,i)}static isValidIdentifier(t){return FS.test(t)}canonicalString(){return this.toArray().map(t=>(t=t.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),n.isValidIdentifier(t)||(t="`"+t+"`"),t)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)==="__name__"}static keyField(){return new n(["__name__"])}static fromServerFormat(t){let e=[],i="",r=0,s=()=>{if(i.length===0)throw new q(z.INVALID_ARGUMENT,`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);e.push(i),i=""},o=!1;for(;r<t.length;){let a=t[r];if(a==="\\"){if(r+1===t.length)throw new q(z.INVALID_ARGUMENT,"Path has trailing escape character: "+t);let c=t[r+1];if(c!=="\\"&&c!=="."&&c!=="`")throw new q(z.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);i+=c,r+=2}else a==="`"?(o=!o,r++):a!=="."||o?(i+=a,r++):(s(),r++)}if(s(),o)throw new q(z.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new n(e)}static emptyPath(){return new n([])}};var K=class n{constructor(t){this.path=t}static fromPath(t){return new n(mt.fromString(t))}static fromName(t){return new n(mt.fromString(t).popFirst(5))}static empty(){return new n(mt.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(t){return this.path.length>=2&&this.path.get(this.path.length-2)===t}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(t){return t!==null&&mt.comparator(this.path,t.path)===0}toString(){return this.path.toString()}static comparator(t,e){return mt.comparator(t.path,e.path)}static isDocumentKey(t){return t.length%2==0}static fromSegments(t){return new n(new mt(t.slice()))}};var ao=class{constructor(t,e,i,r){this.indexId=t,this.collectionGroup=e,this.fields=i,this.indexState=r}};function Tf(n){return n.fields.find(t=>t.kind===2)}function $r(n){return n.fields.filter(t=>t.kind!==2)}ao.UNKNOWN_ID=-1;var io=class{constructor(t,e){this.fieldPath=t,this.kind=e}};var Ga=class n{constructor(t,e){this.sequenceNumber=t,this.offset=e}static empty(){return new n(0,vn.min())}};function mv(n,t){let e=n.toTimestamp().seconds,i=n.toTimestamp().nanoseconds+1,r=it.fromTimestamp(i===1e9?new Ut(e+1,0):new Ut(e,i));return new vn(r,K.empty(),t)}function _v(n){return new vn(n.readTime,n.key,-1)}var vn=class n{constructor(t,e,i){this.readTime=t,this.documentKey=e,this.largestBatchId=i}static min(){return new n(it.min(),K.empty(),-1)}static max(){return new n(it.max(),K.empty(),-1)}};function _g(n,t){let e=n.readTime.compareTo(t.readTime);return e!==0?e:(e=K.comparator(n.documentKey,t.documentKey),e!==0?e:at(n.largestBatchId,t.largestBatchId))}var yv="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",Xl=class{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(t){this.onCommittedListeners.push(t)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(t=>t())}};function lr(n){return U(this,null,function*(){if(n.code!==z.FAILED_PRECONDITION||n.message!==yv)throw n;H("LocalStore","Unexpectedly lost primary lease")})}var B=class n{constructor(t){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(e=>{this.isDone=!0,this.result=e,this.nextCallback&&this.nextCallback(e)},e=>{this.isDone=!0,this.error=e,this.catchCallback&&this.catchCallback(e)})}catch(t){return this.next(void 0,t)}next(t,e){return this.callbackAttached&&J(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(e,this.error):this.wrapSuccess(t,this.result):new n((i,r)=>{this.nextCallback=s=>{this.wrapSuccess(t,s).next(i,r)},this.catchCallback=s=>{this.wrapFailure(e,s).next(i,r)}})}toPromise(){return new Promise((t,e)=>{this.next(t,e)})}wrapUserFunction(t){try{let e=t();return e instanceof n?e:n.resolve(e)}catch(e){return n.reject(e)}}wrapSuccess(t,e){return t?this.wrapUserFunction(()=>t(e)):n.resolve(e)}wrapFailure(t,e){return t?this.wrapUserFunction(()=>t(e)):n.reject(e)}static resolve(t){return new n((e,i)=>{e(t)})}static reject(t){return new n((e,i)=>{i(t)})}static waitFor(t){return new n((e,i)=>{let r=0,s=0,o=!1;t.forEach(a=>{++r,a.next(()=>{++s,o&&s===r&&e()},c=>i(c))}),o=!0,s===r&&e()})}static or(t){let e=n.resolve(!1);for(let i of t)e=e.next(r=>r?n.resolve(r):i());return e}static forEach(t,e){let i=[];return t.forEach((r,s)=>{i.push(e.call(this,r,s))}),this.waitFor(i)}static mapArray(t,e){return new n((i,r)=>{let s=t.length,o=new Array(s),a=0;for(let c=0;c<s;c++){let l=c;e(t[l]).next(h=>{o[l]=h,++a,a===s&&i(o)},h=>r(h))}})}static doWhile(t,e){return new n((i,r)=>{let s=()=>{t()===!0?e().next(()=>{s()},r):i()};s()})}};var Jl=class n{constructor(t,e){this.action=t,this.transaction=e,this.aborted=!1,this.V=new se,this.transaction.oncomplete=()=>{this.V.resolve()},this.transaction.onabort=()=>{e.error?this.V.reject(new Zr(t,e.error)):this.V.resolve()},this.transaction.onerror=i=>{let r=yg(i.target.error);this.V.reject(new Zr(t,r))}}static open(t,e,i,r){try{return new n(e,t.transaction(r,i))}catch(s){throw new Zr(e,s)}}get m(){return this.V.promise}abort(t){t&&this.V.reject(t),this.aborted||(H("SimpleDb","Aborting transaction:",t?t.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())}g(){let t=this.transaction;this.aborted||typeof t.commit!="function"||t.commit()}store(t){let e=this.transaction.objectStore(t);return new If(e)}},tr=class n{constructor(t,e,i){this.name=t,this.version=e,this.p=i,n.S(ka())===12.2&&Qt("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}static delete(t){return H("SimpleDb","Removing database:",t),Kr(window.indexedDB.deleteDatabase(t)).toPromise()}static D(){if(!Al())return!1;if(n.v())return!0;let t=ka(),e=n.S(t),i=0<e&&e<10,r=vv(t),s=0<r&&r<4.5;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0||i||s)}static v(){var t;return typeof process<"u"&&((t=process.__PRIVATE_env)===null||t===void 0?void 0:t.C)==="YES"}static F(t,e){return t.store(e)}static S(t){let e=t.match(/i(?:phone|pad|pod) os ([\d_]+)/i),i=e?e[1].split("_").slice(0,2).join("."):"-1";return Number(i)}M(t){return U(this,null,function*(){return this.db||(H("SimpleDb","Opening database:",this.name),this.db=yield new Promise((e,i)=>{let r=indexedDB.open(this.name,this.version);r.onsuccess=s=>{let o=s.target.result;e(o)},r.onblocked=()=>{i(new Zr(t,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},r.onerror=s=>{let o=s.target.error;o.name==="VersionError"?i(new q(z.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):o.name==="InvalidStateError"?i(new q(z.FAILED_PRECONDITION,"Unable to open an IndexedDB connection. This could be due to running in a private browsing session on a browser whose private browsing sessions do not support IndexedDB: "+o)):i(new Zr(t,o))},r.onupgradeneeded=s=>{H("SimpleDb",'Database "'+this.name+'" requires upgrade from version:',s.oldVersion);let o=s.target.result;this.p.O(o,r.transaction,s.oldVersion,this.version).next(()=>{H("SimpleDb","Database upgrade to version "+this.version+" complete")})}})),this.N&&(this.db.onversionchange=e=>this.N(e)),this.db})}L(t){this.N=t,this.db&&(this.db.onversionchange=e=>t(e))}runTransaction(t,e,i,r){return U(this,null,function*(){let s=e==="readonly",o=0;for(;;){++o;try{this.db=yield this.M(t);let a=Jl.open(this.db,t,s?"readonly":"readwrite",i),c=r(a).next(l=>(a.g(),l)).catch(l=>(a.abort(l),B.reject(l))).toPromise();return c.catch(()=>{}),yield a.m,c}catch(a){let c=a,l=c.name!=="FirebaseError"&&o<3;if(H("SimpleDb","Transaction failed with error:",c.message,"Retrying:",l),this.close(),!l)return Promise.reject(c)}}})}close(){this.db&&this.db.close(),this.db=void 0}};function vv(n){let t=n.match(/Android ([\d.]+)/i),e=t?t[1].split(".").slice(0,2).join("."):"-1";return Number(e)}var Ef=class{constructor(t){this.B=t,this.k=!1,this.q=null}get isDone(){return this.k}get K(){return this.q}set cursor(t){this.B=t}done(){this.k=!0}$(t){this.q=t}delete(){return Kr(this.B.delete())}},Zr=class extends q{constructor(t,e){super(z.UNAVAILABLE,`IndexedDB transaction '${t}' failed: ${e}`),this.name="IndexedDbTransactionError"}};function ur(n){return n.name==="IndexedDbTransactionError"}var If=class{constructor(t){this.store=t}put(t,e){let i;return e!==void 0?(H("SimpleDb","PUT",this.store.name,t,e),i=this.store.put(e,t)):(H("SimpleDb","PUT",this.store.name,"<auto-key>",t),i=this.store.put(t)),Kr(i)}add(t){return H("SimpleDb","ADD",this.store.name,t,t),Kr(this.store.add(t))}get(t){return Kr(this.store.get(t)).next(e=>(e===void 0&&(e=null),H("SimpleDb","GET",this.store.name,t,e),e))}delete(t){return H("SimpleDb","DELETE",this.store.name,t),Kr(this.store.delete(t))}count(){return H("SimpleDb","COUNT",this.store.name),Kr(this.store.count())}U(t,e){let i=this.options(t,e),r=i.index?this.store.index(i.index):this.store;if(typeof r.getAll=="function"){let s=r.getAll(i.range);return new B((o,a)=>{s.onerror=c=>{a(c.target.error)},s.onsuccess=c=>{o(c.target.result)}})}{let s=this.cursor(i),o=[];return this.W(s,(a,c)=>{o.push(c)}).next(()=>o)}}G(t,e){let i=this.store.getAll(t,e===null?void 0:e);return new B((r,s)=>{i.onerror=o=>{s(o.target.error)},i.onsuccess=o=>{r(o.target.result)}})}j(t,e){H("SimpleDb","DELETE ALL",this.store.name);let i=this.options(t,e);i.H=!1;let r=this.cursor(i);return this.W(r,(s,o,a)=>a.delete())}J(t,e){let i;e?i=t:(i={},e=t);let r=this.cursor(i);return this.W(r,e)}Y(t){let e=this.cursor({});return new B((i,r)=>{e.onerror=s=>{let o=yg(s.target.error);r(o)},e.onsuccess=s=>{let o=s.target.result;o?t(o.primaryKey,o.value).next(a=>{a?o.continue():i()}):i()}})}W(t,e){let i=[];return new B((r,s)=>{t.onerror=o=>{s(o.target.error)},t.onsuccess=o=>{let a=o.target.result;if(!a)return void r();let c=new Ef(a),l=e(a.primaryKey,a.value,c);if(l instanceof B){let h=l.catch(d=>(c.done(),B.reject(d)));i.push(h)}c.isDone?r():c.K===null?a.continue():a.continue(c.K)}}).next(()=>B.waitFor(i))}options(t,e){let i;return t!==void 0&&(typeof t=="string"?i=t:e=t),{index:i,range:e}}cursor(t){let e="next";if(t.reverse&&(e="prev"),t.index){let i=this.store.index(t.index);return t.H?i.openKeyCursor(t.range,e):i.openCursor(t.range,e)}return this.store.openCursor(t.range,e)}};function Kr(n){return new B((t,e)=>{n.onsuccess=i=>{let r=i.target.result;t(r)},n.onerror=i=>{let r=yg(i.target.error);e(r)}})}var d0=!1;function yg(n){let t=tr.S(ka());if(t>=12.2&&t<13){let e="An internal error was encountered in the Indexed Database server";if(n.message.indexOf(e)>=0){let i=new q("internal",`IOS_INDEXEDDB_BUG1: IndexedDb has thrown '${e}'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.`);return d0||(d0=!0,setTimeout(()=>{throw i},0)),i}}return n}var Sf=class{constructor(t,e){this.asyncQueue=t,this.Z=e,this.task=null}start(){this.X(15e3)}stop(){this.task&&(this.task.cancel(),this.task=null)}get started(){return this.task!==null}X(t){H("IndexBackfiller",`Scheduled in ${t}ms`),this.task=this.asyncQueue.enqueueAfterDelay("index_backfill",t,()=>U(this,null,function*(){this.task=null;try{H("IndexBackfiller",`Documents written: ${yield this.Z.ee()}`)}catch(e){ur(e)?H("IndexBackfiller","Ignoring IndexedDB error during index backfill: ",e):yield lr(e)}yield this.X(6e4)}))}},Af=class{constructor(t,e){this.localStore=t,this.persistence=e}ee(t=50){return U(this,null,function*(){return this.persistence.runTransaction("Backfill Indexes","readwrite-primary",e=>this.te(e,t))})}te(t,e){let i=new Set,r=e,s=!0;return B.doWhile(()=>s===!0&&r>0,()=>this.localStore.indexManager.getNextCollectionGroupToUpdate(t).next(o=>{if(o!==null&&!i.has(o))return H("IndexBackfiller",`Processing collection: ${o}`),this.ne(t,o,r).next(a=>{r-=a,i.add(o)});s=!1})).next(()=>e-r)}ne(t,e,i){return this.localStore.indexManager.getMinOffsetFromCollectionGroup(t,e).next(r=>this.localStore.localDocuments.getNextDocuments(t,e,r,i).next(s=>{let o=s.changes;return this.localStore.indexManager.updateIndexEntries(t,o).next(()=>this.re(r,s)).next(a=>(H("IndexBackfiller",`Updating offset: ${a}`),this.localStore.indexManager.updateCollectionGroup(t,e,a))).next(()=>o.size)}))}re(t,e){let i=t;return e.changes.forEach((r,s)=>{let o=_v(s);_g(o,i)>0&&(i=o)}),new vn(i.readTime,i.documentKey,Math.max(e.batchId,t.largestBatchId))}};var an=(()=>{class n{constructor(e,i){this.previousValue=e,i&&(i.sequenceNumberHandler=r=>this.ie(r),this.se=r=>i.writeSequenceNumber(r))}ie(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){let e=++this.previousValue;return this.se&&this.se(e),e}}return n.oe=-1,n})();function gc(n){return n==null}function $a(n){return n===0&&1/n==-1/0}function bv(n){return typeof n=="number"&&Number.isInteger(n)&&!$a(n)&&n<=Number.MAX_SAFE_INTEGER&&n>=Number.MIN_SAFE_INTEGER}function ze(n){let t="";for(let e=0;e<n.length;e++)t.length>0&&(t=f0(t)),t=LS(n.get(e),t);return f0(t)}function LS(n,t){let e=t,i=n.length;for(let r=0;r<i;r++){let s=n.charAt(r);switch(s){case"\0":e+="";break;case"":e+="";break;default:e+=s}}return e}function f0(n){return n+""}function qn(n){let t=n.length;if(Z(t>=2),t===2)return Z(n.charAt(0)===""&&n.charAt(1)===""),mt.emptyPath();let e=t-2,i=[],r="";for(let s=0;s<t;){let o=n.indexOf("",s);switch((o<0||o>e)&&J(),n.charAt(o+1)){case"":let a=n.substring(s,o),c;r.length===0?c=a:(r+=a,c=r,r=""),i.push(c);break;case"":r+=n.substring(s,o),r+="\0";break;case"":r+=n.substring(s,o+1);break;default:J()}s=o+2}return new mt(i)}var p0=["userId","batchId"];function Ul(n,t){return[n,ze(t)]}function xv(n,t,e){return[n,ze(t),e]}var BS={},zS=["prefixPath","collectionGroup","readTime","documentId"],jS=["prefixPath","collectionGroup","documentId"],US=["collectionGroup","readTime","prefixPath","documentId"],qS=["canonicalId","targetId"],WS=["targetId","path"],HS=["path","targetId"],GS=["collectionId","parent"],$S=["indexId","uid"],KS=["uid","sequenceNumber"],YS=["indexId","uid","arrayValue","directionalValue","orderedDocumentKey","documentKey"],QS=["indexId","uid","orderedDocumentKey"],XS=["userId","collectionPath","documentId"],JS=["userId","collectionPath","largestBatchId"],ZS=["userId","collectionGroup","largestBatchId"],wv=["mutationQueues","mutations","documentMutations","remoteDocuments","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries"],tA=[...wv,"documentOverlays"],Tv=["mutationQueues","mutations","documentMutations","remoteDocumentsV14","targets","owner","targetGlobal","targetDocuments","clientMetadata","remoteDocumentGlobal","collectionParents","bundles","namedQueries","documentOverlays"],Ev=Tv,vg=[...Ev,"indexConfiguration","indexState","indexEntries"],eA=vg,nA=[...vg,"globals"];var Ka=class extends Xl{constructor(t,e){super(),this._e=t,this.currentSequenceNumber=e}};function he(n,t){let e=$(n);return tr.F(e._e,t)}function g0(n){let t=0;for(let e in n)Object.prototype.hasOwnProperty.call(n,e)&&t++;return t}function hs(n,t){for(let e in n)Object.prototype.hasOwnProperty.call(n,e)&&t(e,n[e])}function Iv(n){for(let t in n)if(Object.prototype.hasOwnProperty.call(n,t))return!1;return!0}var Vt=class n{constructor(t,e){this.comparator=t,this.root=e||Hn.EMPTY}insert(t,e){return new n(this.comparator,this.root.insert(t,e,this.comparator).copy(null,null,Hn.BLACK,null,null))}remove(t){return new n(this.comparator,this.root.remove(t,this.comparator).copy(null,null,Hn.BLACK,null,null))}get(t){let e=this.root;for(;!e.isEmpty();){let i=this.comparator(t,e.key);if(i===0)return e.value;i<0?e=e.left:i>0&&(e=e.right)}return null}indexOf(t){let e=0,i=this.root;for(;!i.isEmpty();){let r=this.comparator(t,i.key);if(r===0)return e+i.left.size;r<0?i=i.left:(e+=i.left.size+1,i=i.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(t){return this.root.inorderTraversal(t)}forEach(t){this.inorderTraversal((e,i)=>(t(e,i),!1))}toString(){let t=[];return this.inorderTraversal((e,i)=>(t.push(`${e}:${i}`),!1)),`{${t.join(", ")}}`}reverseTraversal(t){return this.root.reverseTraversal(t)}getIterator(){return new no(this.root,null,this.comparator,!1)}getIteratorFrom(t){return new no(this.root,t,this.comparator,!1)}getReverseIterator(){return new no(this.root,null,this.comparator,!0)}getReverseIteratorFrom(t){return new no(this.root,t,this.comparator,!0)}},no=class{constructor(t,e,i,r){this.isReverse=r,this.nodeStack=[];let s=1;for(;!t.isEmpty();)if(s=e?i(t.key,e):1,e&&r&&(s*=-1),s<0)t=this.isReverse?t.left:t.right;else{if(s===0){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}getNext(){let t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;let t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}}},Hn=class n{constructor(t,e,i,r,s){this.key=t,this.value=e,this.color=i??n.RED,this.left=r??n.EMPTY,this.right=s??n.EMPTY,this.size=this.left.size+1+this.right.size}copy(t,e,i,r,s){return new n(t??this.key,e??this.value,i??this.color,r??this.left,s??this.right)}isEmpty(){return!1}inorderTraversal(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)}reverseTraversal(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(t,e,i){let r=this,s=i(t,r.key);return r=s<0?r.copy(null,null,null,r.left.insert(t,e,i),null):s===0?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,i)),r.fixUp()}removeMin(){if(this.left.isEmpty())return n.EMPTY;let t=this;return t.left.isRed()||t.left.left.isRed()||(t=t.moveRedLeft()),t=t.copy(null,null,null,t.left.removeMin(),null),t.fixUp()}remove(t,e){let i,r=this;if(e(t,r.key)<0)r.left.isEmpty()||r.left.isRed()||r.left.left.isRed()||(r=r.moveRedLeft()),r=r.copy(null,null,null,r.left.remove(t,e),null);else{if(r.left.isRed()&&(r=r.rotateRight()),r.right.isEmpty()||r.right.isRed()||r.right.left.isRed()||(r=r.moveRedRight()),e(t,r.key)===0){if(r.right.isEmpty())return n.EMPTY;i=r.right.min(),r=r.copy(i.key,i.value,null,null,r.right.removeMin())}r=r.copy(null,null,null,null,r.right.remove(t,e))}return r.fixUp()}isRed(){return this.color}fixUp(){let t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t}moveRedLeft(){let t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t}moveRedRight(){let t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t}rotateLeft(){let t=this.copy(null,null,n.RED,null,this.right.left);return this.right.copy(null,null,this.color,t,null)}rotateRight(){let t=this.copy(null,null,n.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,t)}colorFlip(){let t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)}checkMaxDepth(){let t=this.check();return Math.pow(2,t)<=this.size+1}check(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw J();let t=this.left.check();if(t!==this.right.check())throw J();return t+(this.isRed()?0:1)}};Hn.EMPTY=null,Hn.RED=!0,Hn.BLACK=!1;Hn.EMPTY=new class{constructor(){this.size=0}get key(){throw J()}get value(){throw J()}get color(){throw J()}get left(){throw J()}get right(){throw J()}copy(t,e,i,r,s){return this}insert(t,e,i){return new Hn(t,e)}remove(t,e){return this}isEmpty(){return!0}inorderTraversal(t){return!1}reverseTraversal(t){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};var It=class n{constructor(t){this.comparator=t,this.data=new Vt(this.comparator)}has(t){return this.data.get(t)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(t){return this.data.indexOf(t)}forEach(t){this.data.inorderTraversal((e,i)=>(t(e),!1))}forEachInRange(t,e){let i=this.data.getIteratorFrom(t[0]);for(;i.hasNext();){let r=i.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}}forEachWhile(t,e){let i;for(i=e!==void 0?this.data.getIteratorFrom(e):this.data.getIterator();i.hasNext();)if(!t(i.getNext().key))return}firstAfterOrEqual(t){let e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null}getIterator(){return new Zl(this.data.getIterator())}getIteratorFrom(t){return new Zl(this.data.getIteratorFrom(t))}add(t){return this.copy(this.data.remove(t).insert(t,!0))}delete(t){return this.has(t)?this.copy(this.data.remove(t)):this}isEmpty(){return this.data.isEmpty()}unionWith(t){let e=this;return e.size<t.size&&(e=t,t=this),t.forEach(i=>{e=e.add(i)}),e}isEqual(t){if(!(t instanceof n)||this.size!==t.size)return!1;let e=this.data.getIterator(),i=t.data.getIterator();for(;e.hasNext();){let r=e.getNext().key,s=i.getNext().key;if(this.comparator(r,s)!==0)return!1}return!0}toArray(){let t=[];return this.forEach(e=>{t.push(e)}),t}toString(){let t=[];return this.forEach(e=>t.push(e)),"SortedSet("+t.toString()+")"}copy(t){let e=new n(this.comparator);return e.data=t,e}},Zl=class{constructor(t){this.iter=t}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}};function $s(n){return n.hasNext()?n.getNext():void 0}var cn=class n{constructor(t){this.fields=t,t.sort(Xt.comparator)}static empty(){return new n([])}unionWith(t){let e=new It(Xt.comparator);for(let i of this.fields)e=e.add(i);for(let i of t)e=e.add(i);return new n(e.toArray())}covers(t){for(let e of this.fields)if(e.isPrefixOf(t))return!0;return!1}isEqual(t){return oo(this.fields,t.fields,(e,i)=>e.isEqual(i))}};var tu=class extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}};function Sv(){return typeof atob<"u"}var Zt=class n{constructor(t){this.binaryString=t}static fromBase64String(t){let e=function(r){try{return atob(r)}catch(s){throw typeof DOMException<"u"&&s instanceof DOMException?new tu("Invalid base64 string: "+s):s}}(t);return new n(e)}static fromUint8Array(t){let e=function(r){let s="";for(let o=0;o<r.length;++o)s+=String.fromCharCode(r[o]);return s}(t);return new n(e)}[Symbol.iterator](){let t=0;return{next:()=>t<this.binaryString.length?{value:this.binaryString.charCodeAt(t++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(e){return btoa(e)}(this.binaryString)}toUint8Array(){return function(e){let i=new Uint8Array(e.length);for(let r=0;r<e.length;r++)i[r]=e.charCodeAt(r);return i}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(t){return at(this.binaryString,t.binaryString)}isEqual(t){return this.binaryString===t.binaryString}};Zt.EMPTY_BYTE_STRING=new Zt("");var iA=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function vi(n){if(Z(!!n),typeof n=="string"){let t=0,e=iA.exec(n);if(Z(!!e),e[1]){let r=e[1];r=(r+"000000000").substr(0,9),t=Number(r)}let i=new Date(n);return{seconds:Math.floor(i.getTime()/1e3),nanos:t}}return{seconds:Lt(n.seconds),nanos:Lt(n.nanos)}}function Lt(n){return typeof n=="number"?n:typeof n=="string"?Number(n):0}function er(n){return typeof n=="string"?Zt.fromBase64String(n):Zt.fromUint8Array(n)}function Wu(n){var t,e;return((e=(((t=n?.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||e===void 0?void 0:e.stringValue)==="server_timestamp"}function bg(n){let t=n.mapValue.fields.__previous_value__;return Wu(t)?bg(t):t}function Ya(n){let t=vi(n.mapValue.fields.__local_write_time__.timestampValue);return new Ut(t.seconds,t.nanos)}var Cf=class{constructor(t,e,i,r,s,o,a,c,l){this.databaseId=t,this.appId=e,this.persistenceKey=i,this.host=r,this.ssl=s,this.forceLongPolling=o,this.autoDetectLongPolling=a,this.longPollingOptions=c,this.useFetchStreams=l}},nr=class n{constructor(t,e){this.projectId=t,this.database=e||"(default)"}static empty(){return new n("","")}get isDefaultDatabase(){return this.database==="(default)"}isEqual(t){return t instanceof n&&t.projectId===this.projectId&&t.database===this.database}};var Xi={mapValue:{fields:{__type__:{stringValue:"__max__"}}}},ql={nullValue:"NULL_VALUE"};function ts(n){return"nullValue"in n?0:"booleanValue"in n?1:"integerValue"in n||"doubleValue"in n?2:"timestampValue"in n?3:"stringValue"in n?5:"bytesValue"in n?6:"referenceValue"in n?7:"geoPointValue"in n?8:"arrayValue"in n?9:"mapValue"in n?Wu(n)?4:Av(n)?9007199254740991:Hu(n)?10:11:J()}function Kn(n,t){if(n===t)return!0;let e=ts(n);if(e!==ts(t))return!1;switch(e){case 0:case 9007199254740991:return!0;case 1:return n.booleanValue===t.booleanValue;case 4:return Ya(n).isEqual(Ya(t));case 3:return function(r,s){if(typeof r.timestampValue=="string"&&typeof s.timestampValue=="string"&&r.timestampValue.length===s.timestampValue.length)return r.timestampValue===s.timestampValue;let o=vi(r.timestampValue),a=vi(s.timestampValue);return o.seconds===a.seconds&&o.nanos===a.nanos}(n,t);case 5:return n.stringValue===t.stringValue;case 6:return function(r,s){return er(r.bytesValue).isEqual(er(s.bytesValue))}(n,t);case 7:return n.referenceValue===t.referenceValue;case 8:return function(r,s){return Lt(r.geoPointValue.latitude)===Lt(s.geoPointValue.latitude)&&Lt(r.geoPointValue.longitude)===Lt(s.geoPointValue.longitude)}(n,t);case 2:return function(r,s){if("integerValue"in r&&"integerValue"in s)return Lt(r.integerValue)===Lt(s.integerValue);if("doubleValue"in r&&"doubleValue"in s){let o=Lt(r.doubleValue),a=Lt(s.doubleValue);return o===a?$a(o)===$a(a):isNaN(o)&&isNaN(a)}return!1}(n,t);case 9:return oo(n.arrayValue.values||[],t.arrayValue.values||[],Kn);case 10:case 11:return function(r,s){let o=r.mapValue.fields||{},a=s.mapValue.fields||{};if(g0(o)!==g0(a))return!1;for(let c in o)if(o.hasOwnProperty(c)&&(a[c]===void 0||!Kn(o[c],a[c])))return!1;return!0}(n,t);default:return J()}}function Qa(n,t){return(n.values||[]).find(e=>Kn(e,t))!==void 0}function ir(n,t){if(n===t)return 0;let e=ts(n),i=ts(t);if(e!==i)return at(e,i);switch(e){case 0:case 9007199254740991:return 0;case 1:return at(n.booleanValue,t.booleanValue);case 2:return function(s,o){let a=Lt(s.integerValue||s.doubleValue),c=Lt(o.integerValue||o.doubleValue);return a<c?-1:a>c?1:a===c?0:isNaN(a)?isNaN(c)?0:-1:1}(n,t);case 3:return m0(n.timestampValue,t.timestampValue);case 4:return m0(Ya(n),Ya(t));case 5:return at(n.stringValue,t.stringValue);case 6:return function(s,o){let a=er(s),c=er(o);return a.compareTo(c)}(n.bytesValue,t.bytesValue);case 7:return function(s,o){let a=s.split("/"),c=o.split("/");for(let l=0;l<a.length&&l<c.length;l++){let h=at(a[l],c[l]);if(h!==0)return h}return at(a.length,c.length)}(n.referenceValue,t.referenceValue);case 8:return function(s,o){let a=at(Lt(s.latitude),Lt(o.latitude));return a!==0?a:at(Lt(s.longitude),Lt(o.longitude))}(n.geoPointValue,t.geoPointValue);case 9:return _0(n.arrayValue,t.arrayValue);case 10:return function(s,o){var a,c,l,h;let d=s.fields||{},p=o.fields||{},g=(a=d.value)===null||a===void 0?void 0:a.arrayValue,y=(c=p.value)===null||c===void 0?void 0:c.arrayValue,v=at(((l=g?.values)===null||l===void 0?void 0:l.length)||0,((h=y?.values)===null||h===void 0?void 0:h.length)||0);return v!==0?v:_0(g,y)}(n.mapValue,t.mapValue);case 11:return function(s,o){if(s===Xi.mapValue&&o===Xi.mapValue)return 0;if(s===Xi.mapValue)return 1;if(o===Xi.mapValue)return-1;let a=s.fields||{},c=Object.keys(a),l=o.fields||{},h=Object.keys(l);c.sort(),h.sort();for(let d=0;d<c.length&&d<h.length;++d){let p=at(c[d],h[d]);if(p!==0)return p;let g=ir(a[c[d]],l[h[d]]);if(g!==0)return g}return at(c.length,h.length)}(n.mapValue,t.mapValue);default:throw J()}}function m0(n,t){if(typeof n=="string"&&typeof t=="string"&&n.length===t.length)return at(n,t);let e=vi(n),i=vi(t),r=at(e.seconds,i.seconds);return r!==0?r:at(e.nanos,i.nanos)}function _0(n,t){let e=n.values||[],i=t.values||[];for(let r=0;r<e.length&&r<i.length;++r){let s=ir(e[r],i[r]);if(s)return s}return at(e.length,i.length)}function co(n){return Pf(n)}function Pf(n){return"nullValue"in n?"null":"booleanValue"in n?""+n.booleanValue:"integerValue"in n?""+n.integerValue:"doubleValue"in n?""+n.doubleValue:"timestampValue"in n?function(e){let i=vi(e);return`time(${i.seconds},${i.nanos})`}(n.timestampValue):"stringValue"in n?n.stringValue:"bytesValue"in n?function(e){return er(e).toBase64()}(n.bytesValue):"referenceValue"in n?function(e){return K.fromName(e).toString()}(n.referenceValue):"geoPointValue"in n?function(e){return`geo(${e.latitude},${e.longitude})`}(n.geoPointValue):"arrayValue"in n?function(e){let i="[",r=!0;for(let s of e.values||[])r?r=!1:i+=",",i+=Pf(s);return i+"]"}(n.arrayValue):"mapValue"in n?function(e){let i=Object.keys(e.fields||{}).sort(),r="{",s=!0;for(let o of i)s?s=!1:r+=",",r+=`${o}:${Pf(e.fields[o])}`;return r+"}"}(n.mapValue):J()}function es(n,t){return{referenceValue:`projects/${n.projectId}/databases/${n.database}/documents/${t.path.canonicalString()}`}}function kf(n){return!!n&&"integerValue"in n}function Xa(n){return!!n&&"arrayValue"in n}function y0(n){return!!n&&"nullValue"in n}function v0(n){return!!n&&"doubleValue"in n&&isNaN(Number(n.doubleValue))}function Wl(n){return!!n&&"mapValue"in n}function Hu(n){var t,e;return((e=(((t=n?.mapValue)===null||t===void 0?void 0:t.fields)||{}).__type__)===null||e===void 0?void 0:e.stringValue)==="__vector__"}function ja(n){if(n.geoPointValue)return{geoPointValue:Object.assign({},n.geoPointValue)};if(n.timestampValue&&typeof n.timestampValue=="object")return{timestampValue:Object.assign({},n.timestampValue)};if(n.mapValue){let t={mapValue:{fields:{}}};return hs(n.mapValue.fields,(e,i)=>t.mapValue.fields[e]=ja(i)),t}if(n.arrayValue){let t={arrayValue:{values:[]}};for(let e=0;e<(n.arrayValue.values||[]).length;++e)t.arrayValue.values[e]=ja(n.arrayValue.values[e]);return t}return Object.assign({},n)}function Av(n){return(((n.mapValue||{}).fields||{}).__type__||{}).stringValue==="__max__"}var Cv={mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{}}}}};function rA(n){return"nullValue"in n?ql:"booleanValue"in n?{booleanValue:!1}:"integerValue"in n||"doubleValue"in n?{doubleValue:NaN}:"timestampValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"stringValue"in n?{stringValue:""}:"bytesValue"in n?{bytesValue:""}:"referenceValue"in n?es(nr.empty(),K.empty()):"geoPointValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"arrayValue"in n?{arrayValue:{}}:"mapValue"in n?Hu(n)?Cv:{mapValue:{}}:J()}function sA(n){return"nullValue"in n?{booleanValue:!1}:"booleanValue"in n?{doubleValue:NaN}:"integerValue"in n||"doubleValue"in n?{timestampValue:{seconds:Number.MIN_SAFE_INTEGER}}:"timestampValue"in n?{stringValue:""}:"stringValue"in n?{bytesValue:""}:"bytesValue"in n?es(nr.empty(),K.empty()):"referenceValue"in n?{geoPointValue:{latitude:-90,longitude:-180}}:"geoPointValue"in n?{arrayValue:{}}:"arrayValue"in n?Cv:"mapValue"in n?Hu(n)?{mapValue:{}}:Xi:J()}function b0(n,t){let e=ir(n.value,t.value);return e!==0?e:n.inclusive&&!t.inclusive?-1:!n.inclusive&&t.inclusive?1:0}function x0(n,t){let e=ir(n.value,t.value);return e!==0?e:n.inclusive&&!t.inclusive?1:!n.inclusive&&t.inclusive?-1:0}var Ne=class n{constructor(t){this.value=t}static empty(){return new n({mapValue:{}})}field(t){if(t.isEmpty())return this.value;{let e=this.value;for(let i=0;i<t.length-1;++i)if(e=(e.mapValue.fields||{})[t.get(i)],!Wl(e))return null;return e=(e.mapValue.fields||{})[t.lastSegment()],e||null}}set(t,e){this.getFieldsMap(t.popLast())[t.lastSegment()]=ja(e)}setAll(t){let e=Xt.emptyPath(),i={},r=[];t.forEach((o,a)=>{if(!e.isImmediateParentOf(a)){let c=this.getFieldsMap(e);this.applyChanges(c,i,r),i={},r=[],e=a.popLast()}o?i[a.lastSegment()]=ja(o):r.push(a.lastSegment())});let s=this.getFieldsMap(e);this.applyChanges(s,i,r)}delete(t){let e=this.field(t.popLast());Wl(e)&&e.mapValue.fields&&delete e.mapValue.fields[t.lastSegment()]}isEqual(t){return Kn(this.value,t.value)}getFieldsMap(t){let e=this.value;e.mapValue.fields||(e.mapValue={fields:{}});for(let i=0;i<t.length;++i){let r=e.mapValue.fields[t.get(i)];Wl(r)&&r.mapValue.fields||(r={mapValue:{fields:{}}},e.mapValue.fields[t.get(i)]=r),e=r}return e.mapValue.fields}applyChanges(t,e,i){hs(e,(r,s)=>t[r]=s);for(let r of i)delete t[r]}clone(){return new n(ja(this.value))}};function Pv(n){let t=[];return hs(n.fields,(e,i)=>{let r=new Xt([e]);if(Wl(i)){let s=Pv(i.mapValue).fields;if(s.length===0)t.push(r);else for(let o of s)t.push(r.child(o))}else t.push(r)}),new cn(t)}var oe=class n{constructor(t,e,i,r,s,o,a){this.key=t,this.documentType=e,this.version=i,this.readTime=r,this.createTime=s,this.data=o,this.documentState=a}static newInvalidDocument(t){return new n(t,0,it.min(),it.min(),it.min(),Ne.empty(),0)}static newFoundDocument(t,e,i,r){return new n(t,1,e,it.min(),i,r,0)}static newNoDocument(t,e){return new n(t,2,e,it.min(),it.min(),Ne.empty(),0)}static newUnknownDocument(t,e){return new n(t,3,e,it.min(),it.min(),Ne.empty(),2)}convertToFoundDocument(t,e){return!this.createTime.isEqual(it.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=t),this.version=t,this.documentType=1,this.data=e,this.documentState=0,this}convertToNoDocument(t){return this.version=t,this.documentType=2,this.data=Ne.empty(),this.documentState=0,this}convertToUnknownDocument(t){return this.version=t,this.documentType=3,this.data=Ne.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=it.min(),this}setReadTime(t){return this.readTime=t,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(t){return t instanceof n&&this.key.isEqual(t.key)&&this.version.isEqual(t.version)&&this.documentType===t.documentType&&this.documentState===t.documentState&&this.data.isEqual(t.data)}mutableCopy(){return new n(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}};var Yn=class{constructor(t,e){this.position=t,this.inclusive=e}};function w0(n,t,e){let i=0;for(let r=0;r<n.position.length;r++){let s=t[r],o=n.position[r];if(s.field.isKeyField()?i=K.comparator(K.fromName(o.referenceValue),e.key):i=ir(o,e.data.field(s.field)),s.dir==="desc"&&(i*=-1),i!==0)break}return i}function T0(n,t){if(n===null)return t===null;if(t===null||n.inclusive!==t.inclusive||n.position.length!==t.position.length)return!1;for(let e=0;e<n.position.length;e++)if(!Kn(n.position[e],t.position[e]))return!1;return!0}var ns=class{constructor(t,e="asc"){this.field=t,this.dir=e}};function oA(n,t){return n.dir===t.dir&&n.field.isEqual(t.field)}var eu=class{},pt=class n extends eu{constructor(t,e,i){super(),this.field=t,this.op=e,this.value=i}static create(t,e,i){return t.isKeyField()?e==="in"||e==="not-in"?this.createKeyFieldInFilter(t,e,i):new Mf(t,e,i):e==="array-contains"?new Nf(t,i):e==="in"?new nu(t,i):e==="not-in"?new Ff(t,i):e==="array-contains-any"?new Lf(t,i):new n(t,e,i)}static createKeyFieldInFilter(t,e,i){return e==="in"?new Of(t,i):new Vf(t,i)}matches(t){let e=t.data.field(this.field);return this.op==="!="?e!==null&&this.matchesComparison(ir(e,this.value)):e!==null&&ts(this.value)===ts(e)&&this.matchesComparison(ir(e,this.value))}matchesComparison(t){switch(this.op){case"<":return t<0;case"<=":return t<=0;case"==":return t===0;case"!=":return t!==0;case">":return t>0;case">=":return t>=0;default:return J()}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}},Tt=class n extends eu{constructor(t,e){super(),this.filters=t,this.op=e,this.ae=null}static create(t,e){return new n(t,e)}matches(t){return lo(this)?this.filters.find(e=>!e.matches(t))===void 0:this.filters.find(e=>e.matches(t))!==void 0}getFlattenedFilters(){return this.ae!==null||(this.ae=this.filters.reduce((t,e)=>t.concat(e.getFlattenedFilters()),[])),this.ae}getFilters(){return Object.assign([],this.filters)}};function lo(n){return n.op==="and"}function Rf(n){return n.op==="or"}function xg(n){return kv(n)&&lo(n)}function kv(n){for(let t of n.filters)if(t instanceof Tt)return!1;return!0}function Df(n){if(n instanceof pt)return n.field.canonicalString()+n.op.toString()+co(n.value);if(xg(n))return n.filters.map(t=>Df(t)).join(",");{let t=n.filters.map(e=>Df(e)).join(",");return`${n.op}(${t})`}}function Rv(n,t){return n instanceof pt?function(i,r){return r instanceof pt&&i.op===r.op&&i.field.isEqual(r.field)&&Kn(i.value,r.value)}(n,t):n instanceof Tt?function(i,r){return r instanceof Tt&&i.op===r.op&&i.filters.length===r.filters.length?i.filters.reduce((s,o,a)=>s&&Rv(o,r.filters[a]),!0):!1}(n,t):void J()}function Dv(n,t){let e=n.filters.concat(t);return Tt.create(e,n.op)}function Mv(n){return n instanceof pt?function(e){return`${e.field.canonicalString()} ${e.op} ${co(e.value)}`}(n):n instanceof Tt?function(e){return e.op.toString()+" {"+e.getFilters().map(Mv).join(" ,")+"}"}(n):"Filter"}var Mf=class extends pt{constructor(t,e,i){super(t,e,i),this.key=K.fromName(i.referenceValue)}matches(t){let e=K.comparator(t.key,this.key);return this.matchesComparison(e)}},Of=class extends pt{constructor(t,e){super(t,"in",e),this.keys=Ov("in",e)}matches(t){return this.keys.some(e=>e.isEqual(t.key))}},Vf=class extends pt{constructor(t,e){super(t,"not-in",e),this.keys=Ov("not-in",e)}matches(t){return!this.keys.some(e=>e.isEqual(t.key))}};function Ov(n,t){var e;return(((e=t.arrayValue)===null||e===void 0?void 0:e.values)||[]).map(i=>K.fromName(i.referenceValue))}var Nf=class extends pt{constructor(t,e){super(t,"array-contains",e)}matches(t){let e=t.data.field(this.field);return Xa(e)&&Qa(e.arrayValue,this.value)}},nu=class extends pt{constructor(t,e){super(t,"in",e)}matches(t){let e=t.data.field(this.field);return e!==null&&Qa(this.value.arrayValue,e)}},Ff=class extends pt{constructor(t,e){super(t,"not-in",e)}matches(t){if(Qa(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;let e=t.data.field(this.field);return e!==null&&!Qa(this.value.arrayValue,e)}},Lf=class extends pt{constructor(t,e){super(t,"array-contains-any",e)}matches(t){let e=t.data.field(this.field);return!(!Xa(e)||!e.arrayValue.values)&&e.arrayValue.values.some(i=>Qa(this.value.arrayValue,i))}};var Bf=class{constructor(t,e=null,i=[],r=[],s=null,o=null,a=null){this.path=t,this.collectionGroup=e,this.orderBy=i,this.filters=r,this.limit=s,this.startAt=o,this.endAt=a,this.ue=null}};function zf(n,t=null,e=[],i=[],r=null,s=null,o=null){return new Bf(n,t,e,i,r,s,o)}function is(n){let t=$(n);if(t.ue===null){let e=t.path.canonicalString();t.collectionGroup!==null&&(e+="|cg:"+t.collectionGroup),e+="|f:",e+=t.filters.map(i=>Df(i)).join(","),e+="|ob:",e+=t.orderBy.map(i=>function(s){return s.field.canonicalString()+s.dir}(i)).join(","),gc(t.limit)||(e+="|l:",e+=t.limit),t.startAt&&(e+="|lb:",e+=t.startAt.inclusive?"b:":"a:",e+=t.startAt.position.map(i=>co(i)).join(",")),t.endAt&&(e+="|ub:",e+=t.endAt.inclusive?"a:":"b:",e+=t.endAt.position.map(i=>co(i)).join(",")),t.ue=e}return t.ue}function mc(n,t){if(n.limit!==t.limit||n.orderBy.length!==t.orderBy.length)return!1;for(let e=0;e<n.orderBy.length;e++)if(!oA(n.orderBy[e],t.orderBy[e]))return!1;if(n.filters.length!==t.filters.length)return!1;for(let e=0;e<n.filters.length;e++)if(!Rv(n.filters[e],t.filters[e]))return!1;return n.collectionGroup===t.collectionGroup&&!!n.path.isEqual(t.path)&&!!T0(n.startAt,t.startAt)&&T0(n.endAt,t.endAt)}function iu(n){return K.isDocumentKey(n.path)&&n.collectionGroup===null&&n.filters.length===0}function ru(n,t){return n.filters.filter(e=>e instanceof pt&&e.field.isEqual(t))}function E0(n,t,e){let i=ql,r=!0;for(let s of ru(n,t)){let o=ql,a=!0;switch(s.op){case"<":case"<=":o=rA(s.value);break;case"==":case"in":case">=":o=s.value;break;case">":o=s.value,a=!1;break;case"!=":case"not-in":o=ql}b0({value:i,inclusive:r},{value:o,inclusive:a})<0&&(i=o,r=a)}if(e!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(t)){let o=e.position[s];b0({value:i,inclusive:r},{value:o,inclusive:e.inclusive})<0&&(i=o,r=e.inclusive);break}}return{value:i,inclusive:r}}function I0(n,t,e){let i=Xi,r=!0;for(let s of ru(n,t)){let o=Xi,a=!0;switch(s.op){case">=":case">":o=sA(s.value),a=!1;break;case"==":case"in":case"<=":o=s.value;break;case"<":o=s.value,a=!1;break;case"!=":case"not-in":o=Xi}x0({value:i,inclusive:r},{value:o,inclusive:a})>0&&(i=o,r=a)}if(e!==null){for(let s=0;s<n.orderBy.length;++s)if(n.orderBy[s].field.isEqual(t)){let o=e.position[s];x0({value:i,inclusive:r},{value:o,inclusive:e.inclusive})>0&&(i=o,r=e.inclusive);break}}return{value:i,inclusive:r}}var Mn=class{constructor(t,e=null,i=[],r=[],s=null,o="F",a=null,c=null){this.path=t,this.collectionGroup=e,this.explicitOrderBy=i,this.filters=r,this.limit=s,this.limitType=o,this.startAt=a,this.endAt=c,this.ce=null,this.le=null,this.he=null,this.startAt,this.endAt}};function Vv(n,t,e,i,r,s,o,a){return new Mn(n,t,e,i,r,s,o,a)}function Io(n){return new Mn(n)}function S0(n){return n.filters.length===0&&n.limit===null&&n.startAt==null&&n.endAt==null&&(n.explicitOrderBy.length===0||n.explicitOrderBy.length===1&&n.explicitOrderBy[0].field.isKeyField())}function wg(n){return n.collectionGroup!==null}function ro(n){let t=$(n);if(t.ce===null){t.ce=[];let e=new Set;for(let s of t.explicitOrderBy)t.ce.push(s),e.add(s.field.canonicalString());let i=t.explicitOrderBy.length>0?t.explicitOrderBy[t.explicitOrderBy.length-1].dir:"asc";(function(o){let a=new It(Xt.comparator);return o.filters.forEach(c=>{c.getFlattenedFilters().forEach(l=>{l.isInequality()&&(a=a.add(l.field))})}),a})(t).forEach(s=>{e.has(s.canonicalString())||s.isKeyField()||t.ce.push(new ns(s,i))}),e.has(Xt.keyField().canonicalString())||t.ce.push(new ns(Xt.keyField(),i))}return t.ce}function je(n){let t=$(n);return t.le||(t.le=aA(t,ro(n))),t.le}function aA(n,t){if(n.limitType==="F")return zf(n.path,n.collectionGroup,t,n.filters,n.limit,n.startAt,n.endAt);{t=t.map(r=>{let s=r.dir==="desc"?"asc":"desc";return new ns(r.field,s)});let e=n.endAt?new Yn(n.endAt.position,n.endAt.inclusive):null,i=n.startAt?new Yn(n.startAt.position,n.startAt.inclusive):null;return zf(n.path,n.collectionGroup,t,n.filters,n.limit,e,i)}}function jf(n,t){let e=n.filters.concat([t]);return new Mn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),e,n.limit,n.limitType,n.startAt,n.endAt)}function su(n,t,e){return new Mn(n.path,n.collectionGroup,n.explicitOrderBy.slice(),n.filters.slice(),t,e,n.startAt,n.endAt)}function _c(n,t){return mc(je(n),je(t))&&n.limitType===t.limitType}function Nv(n){return`${is(je(n))}|lt:${n.limitType}`}function Js(n){return`Query(target=${function(e){let i=e.path.canonicalString();return e.collectionGroup!==null&&(i+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(i+=`, filters: [${e.filters.map(r=>Mv(r)).join(", ")}]`),gc(e.limit)||(i+=", limit: "+e.limit),e.orderBy.length>0&&(i+=`, orderBy: [${e.orderBy.map(r=>function(o){return`${o.field.canonicalString()} (${o.dir})`}(r)).join(", ")}]`),e.startAt&&(i+=", startAt: ",i+=e.startAt.inclusive?"b:":"a:",i+=e.startAt.position.map(r=>co(r)).join(",")),e.endAt&&(i+=", endAt: ",i+=e.endAt.inclusive?"a:":"b:",i+=e.endAt.position.map(r=>co(r)).join(",")),`Target(${i})`}(je(n))}; limitType=${n.limitType})`}function yc(n,t){return t.isFoundDocument()&&function(i,r){let s=r.key.path;return i.collectionGroup!==null?r.key.hasCollectionId(i.collectionGroup)&&i.path.isPrefixOf(s):K.isDocumentKey(i.path)?i.path.isEqual(s):i.path.isImmediateParentOf(s)}(n,t)&&function(i,r){for(let s of ro(i))if(!s.field.isKeyField()&&r.data.field(s.field)===null)return!1;return!0}(n,t)&&function(i,r){for(let s of i.filters)if(!s.matches(r))return!1;return!0}(n,t)&&function(i,r){return!(i.startAt&&!function(o,a,c){let l=w0(o,a,c);return o.inclusive?l<=0:l<0}(i.startAt,ro(i),r)||i.endAt&&!function(o,a,c){let l=w0(o,a,c);return o.inclusive?l>=0:l>0}(i.endAt,ro(i),r))}(n,t)}function Fv(n){return n.collectionGroup||(n.path.length%2==1?n.path.lastSegment():n.path.get(n.path.length-2))}function Lv(n){return(t,e)=>{let i=!1;for(let r of ro(n)){let s=cA(r,t,e);if(s!==0)return s;i=i||r.field.isKeyField()}return 0}}function cA(n,t,e){let i=n.field.isKeyField()?K.comparator(t.key,e.key):function(s,o,a){let c=o.data.field(s),l=a.data.field(s);return c!==null&&l!==null?ir(c,l):J()}(n.field,t,e);switch(n.dir){case"asc":return i;case"desc":return-1*i;default:return J()}}var Qn=class{constructor(t,e){this.mapKeyFn=t,this.equalsFn=e,this.inner={},this.innerSize=0}get(t){let e=this.mapKeyFn(t),i=this.inner[e];if(i!==void 0){for(let[r,s]of i)if(this.equalsFn(r,t))return s}}has(t){return this.get(t)!==void 0}set(t,e){let i=this.mapKeyFn(t),r=this.inner[i];if(r===void 0)return this.inner[i]=[[t,e]],void this.innerSize++;for(let s=0;s<r.length;s++)if(this.equalsFn(r[s][0],t))return void(r[s]=[t,e]);r.push([t,e]),this.innerSize++}delete(t){let e=this.mapKeyFn(t),i=this.inner[e];if(i===void 0)return!1;for(let r=0;r<i.length;r++)if(this.equalsFn(i[r][0],t))return i.length===1?delete this.inner[e]:i.splice(r,1),this.innerSize--,!0;return!1}forEach(t){hs(this.inner,(e,i)=>{for(let[r,s]of i)t(r,s)})}isEmpty(){return Iv(this.inner)}size(){return this.innerSize}};var lA=new Vt(K.comparator);function Ye(){return lA}var Bv=new Vt(K.comparator);function Ba(...n){let t=Bv;for(let e of n)t=t.insert(e.key,e);return t}function zv(n){let t=Bv;return n.forEach((e,i)=>t=t.insert(e,i.overlayedDocument)),t}function Wn(){return Ua()}function jv(){return Ua()}function Ua(){return new Qn(n=>n.toString(),(n,t)=>n.isEqual(t))}var uA=new Vt(K.comparator),hA=new It(K.comparator);function lt(...n){let t=hA;for(let e of n)t=t.add(e);return t}var dA=new It(at);function Tg(){return dA}function Eg(n,t){if(n.useProto3Json){if(isNaN(t))return{doubleValue:"NaN"};if(t===1/0)return{doubleValue:"Infinity"};if(t===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:$a(t)?"-0":t}}function Uv(n){return{integerValue:""+n}}function qv(n,t){return bv(t)?Uv(t):Eg(n,t)}var uo=class{constructor(){this._=void 0}};function fA(n,t,e){return n instanceof rr?function(r,s){let o={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return s&&Wu(s)&&(s=bg(s)),s&&(o.fields.__previous_value__=s),{mapValue:o}}(e,t):n instanceof bi?Hv(n,t):n instanceof xi?Gv(n,t):function(r,s){let o=Wv(r,s),a=A0(o)+A0(r.Pe);return kf(o)&&kf(r.Pe)?Uv(a):Eg(r.serializer,a)}(n,t)}function pA(n,t,e){return n instanceof bi?Hv(n,t):n instanceof xi?Gv(n,t):e}function Wv(n,t){return n instanceof sr?function(i){return kf(i)||function(s){return!!s&&"doubleValue"in s}(i)}(t)?t:{integerValue:0}:null}var rr=class extends uo{},bi=class extends uo{constructor(t){super(),this.elements=t}};function Hv(n,t){let e=$v(t);for(let i of n.elements)e.some(r=>Kn(r,i))||e.push(i);return{arrayValue:{values:e}}}var xi=class extends uo{constructor(t){super(),this.elements=t}};function Gv(n,t){let e=$v(t);for(let i of n.elements)e=e.filter(r=>!Kn(r,i));return{arrayValue:{values:e}}}var sr=class extends uo{constructor(t,e){super(),this.serializer=t,this.Pe=e}};function A0(n){return Lt(n.integerValue||n.doubleValue)}function $v(n){return Xa(n)&&n.arrayValue.values?n.arrayValue.values.slice():[]}var rs=class{constructor(t,e){this.field=t,this.transform=e}};function gA(n,t){return n.field.isEqual(t.field)&&function(i,r){return i instanceof bi&&r instanceof bi||i instanceof xi&&r instanceof xi?oo(i.elements,r.elements,Kn):i instanceof sr&&r instanceof sr?Kn(i.Pe,r.Pe):i instanceof rr&&r instanceof rr}(n.transform,t.transform)}var Uf=class{constructor(t,e){this.version=t,this.transformResults=e}},Kt=class n{constructor(t,e){this.updateTime=t,this.exists=e}static none(){return new n}static exists(t){return new n(void 0,t)}static updateTime(t){return new n(t)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(t){return this.exists===t.exists&&(this.updateTime?!!t.updateTime&&this.updateTime.isEqual(t.updateTime):!t.updateTime)}};function Hl(n,t){return n.updateTime!==void 0?t.isFoundDocument()&&t.version.isEqual(n.updateTime):n.exists===void 0||n.exists===t.isFoundDocument()}var ho=class{};function Kv(n,t){if(!n.hasLocalMutations||t&&t.fields.length===0)return null;if(t===null)return n.isNoDocument()?new ar(n.key,Kt.none()):new or(n.key,n.data,Kt.none());{let e=n.data,i=Ne.empty(),r=new It(Xt.comparator);for(let s of t.fields)if(!r.has(s)){let o=e.field(s);o===null&&s.length>1&&(s=s.popLast(),o=e.field(s)),o===null?i.delete(s):i.set(s,o),r=r.add(s)}return new On(n.key,i,new cn(r.toArray()),Kt.none())}}function mA(n,t,e){n instanceof or?function(r,s,o){let a=r.value.clone(),c=P0(r.fieldTransforms,s,o.transformResults);a.setAll(c),s.convertToFoundDocument(o.version,a).setHasCommittedMutations()}(n,t,e):n instanceof On?function(r,s,o){if(!Hl(r.precondition,s))return void s.convertToUnknownDocument(o.version);let a=P0(r.fieldTransforms,s,o.transformResults),c=s.data;c.setAll(Yv(r)),c.setAll(a),s.convertToFoundDocument(o.version,c).setHasCommittedMutations()}(n,t,e):function(r,s,o){s.convertToNoDocument(o.version).setHasCommittedMutations()}(0,t,e)}function qa(n,t,e,i){return n instanceof or?function(s,o,a,c){if(!Hl(s.precondition,o))return a;let l=s.value.clone(),h=k0(s.fieldTransforms,c,o);return l.setAll(h),o.convertToFoundDocument(o.version,l).setHasLocalMutations(),null}(n,t,e,i):n instanceof On?function(s,o,a,c){if(!Hl(s.precondition,o))return a;let l=k0(s.fieldTransforms,c,o),h=o.data;return h.setAll(Yv(s)),h.setAll(l),o.convertToFoundDocument(o.version,h).setHasLocalMutations(),a===null?null:a.unionWith(s.fieldMask.fields).unionWith(s.fieldTransforms.map(d=>d.field))}(n,t,e,i):function(s,o,a){return Hl(s.precondition,o)?(o.convertToNoDocument(o.version).setHasLocalMutations(),null):a}(n,t,e)}function _A(n,t){let e=null;for(let i of n.fieldTransforms){let r=t.data.field(i.field),s=Wv(i.transform,r||null);s!=null&&(e===null&&(e=Ne.empty()),e.set(i.field,s))}return e||null}function C0(n,t){return n.type===t.type&&!!n.key.isEqual(t.key)&&!!n.precondition.isEqual(t.precondition)&&!!function(i,r){return i===void 0&&r===void 0||!(!i||!r)&&oo(i,r,(s,o)=>gA(s,o))}(n.fieldTransforms,t.fieldTransforms)&&(n.type===0?n.value.isEqual(t.value):n.type!==1||n.data.isEqual(t.data)&&n.fieldMask.isEqual(t.fieldMask))}var or=class extends ho{constructor(t,e,i,r=[]){super(),this.key=t,this.value=e,this.precondition=i,this.fieldTransforms=r,this.type=0}getFieldMask(){return null}},On=class extends ho{constructor(t,e,i,r,s=[]){super(),this.key=t,this.data=e,this.fieldMask=i,this.precondition=r,this.fieldTransforms=s,this.type=1}getFieldMask(){return this.fieldMask}};function Yv(n){let t=new Map;return n.fieldMask.fields.forEach(e=>{if(!e.isEmpty()){let i=n.data.field(e);t.set(e,i)}}),t}function P0(n,t,e){let i=new Map;Z(n.length===e.length);for(let r=0;r<e.length;r++){let s=n[r],o=s.transform,a=t.data.field(s.field);i.set(s.field,pA(o,a,e[r]))}return i}function k0(n,t,e){let i=new Map;for(let r of n){let s=r.transform,o=e.data.field(r.field);i.set(r.field,fA(s,o,t))}return i}var ar=class extends ho{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}},Ja=class extends ho{constructor(t,e){super(),this.key=t,this.precondition=e,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}};var Za=class{constructor(t,e,i,r){this.batchId=t,this.localWriteTime=e,this.baseMutations=i,this.mutations=r}applyToRemoteDocument(t,e){let i=e.mutationResults;for(let r=0;r<this.mutations.length;r++){let s=this.mutations[r];s.key.isEqual(t.key)&&mA(s,t,i[r])}}applyToLocalView(t,e){for(let i of this.baseMutations)i.key.isEqual(t.key)&&(e=qa(i,t,e,this.localWriteTime));for(let i of this.mutations)i.key.isEqual(t.key)&&(e=qa(i,t,e,this.localWriteTime));return e}applyToLocalDocumentSet(t,e){let i=jv();return this.mutations.forEach(r=>{let s=t.get(r.key),o=s.overlayedDocument,a=this.applyToLocalView(o,s.mutatedFields);a=e.has(r.key)?null:a;let c=Kv(o,a);c!==null&&i.set(r.key,c),o.isValidDocument()||o.convertToNoDocument(it.min())}),i}keys(){return this.mutations.reduce((t,e)=>t.add(e.key),lt())}isEqual(t){return this.batchId===t.batchId&&oo(this.mutations,t.mutations,(e,i)=>C0(e,i))&&oo(this.baseMutations,t.baseMutations,(e,i)=>C0(e,i))}},qf=class n{constructor(t,e,i,r){this.batch=t,this.commitVersion=e,this.mutationResults=i,this.docVersions=r}static from(t,e,i){Z(t.mutations.length===i.length);let r=function(){return uA}(),s=t.mutations;for(let o=0;o<s.length;o++)r=r.insert(s[o].key,i[o].version);return new n(t,e,i,r)}};var tc=class{constructor(t,e){this.largestBatchId=t,this.mutation=e}getKey(){return this.mutation.key}isEqual(t){return t!==null&&this.mutation===t.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}};var Wf=class{constructor(t,e){this.count=t,this.unchangedNames=e}};var ne,gt;function Qv(n){switch(n){default:return J();case z.CANCELLED:case z.UNKNOWN:case z.DEADLINE_EXCEEDED:case z.RESOURCE_EXHAUSTED:case z.INTERNAL:case z.UNAVAILABLE:case z.UNAUTHENTICATED:return!1;case z.INVALID_ARGUMENT:case z.NOT_FOUND:case z.ALREADY_EXISTS:case z.PERMISSION_DENIED:case z.FAILED_PRECONDITION:case z.ABORTED:case z.OUT_OF_RANGE:case z.UNIMPLEMENTED:case z.DATA_LOSS:return!0}}function Xv(n){if(n===void 0)return Qt("GRPC error has no .code"),z.UNKNOWN;switch(n){case ne.OK:return z.OK;case ne.CANCELLED:return z.CANCELLED;case ne.UNKNOWN:return z.UNKNOWN;case ne.DEADLINE_EXCEEDED:return z.DEADLINE_EXCEEDED;case ne.RESOURCE_EXHAUSTED:return z.RESOURCE_EXHAUSTED;case ne.INTERNAL:return z.INTERNAL;case ne.UNAVAILABLE:return z.UNAVAILABLE;case ne.UNAUTHENTICATED:return z.UNAUTHENTICATED;case ne.INVALID_ARGUMENT:return z.INVALID_ARGUMENT;case ne.NOT_FOUND:return z.NOT_FOUND;case ne.ALREADY_EXISTS:return z.ALREADY_EXISTS;case ne.PERMISSION_DENIED:return z.PERMISSION_DENIED;case ne.FAILED_PRECONDITION:return z.FAILED_PRECONDITION;case ne.ABORTED:return z.ABORTED;case ne.OUT_OF_RANGE:return z.OUT_OF_RANGE;case ne.UNIMPLEMENTED:return z.UNIMPLEMENTED;case ne.DATA_LOSS:return z.DATA_LOSS;default:return J()}}(gt=ne||(ne={}))[gt.OK=0]="OK",gt[gt.CANCELLED=1]="CANCELLED",gt[gt.UNKNOWN=2]="UNKNOWN",gt[gt.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",gt[gt.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",gt[gt.NOT_FOUND=5]="NOT_FOUND",gt[gt.ALREADY_EXISTS=6]="ALREADY_EXISTS",gt[gt.PERMISSION_DENIED=7]="PERMISSION_DENIED",gt[gt.UNAUTHENTICATED=16]="UNAUTHENTICATED",gt[gt.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",gt[gt.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",gt[gt.ABORTED=10]="ABORTED",gt[gt.OUT_OF_RANGE=11]="OUT_OF_RANGE",gt[gt.UNIMPLEMENTED=12]="UNIMPLEMENTED",gt[gt.INTERNAL=13]="INTERNAL",gt[gt.UNAVAILABLE=14]="UNAVAILABLE",gt[gt.DATA_LOSS=15]="DATA_LOSS";var R0=null;function Jv(){return new TextEncoder}var yA=new Gi([4294967295,4294967295],0);function D0(n){let t=Jv().encode(n),e=new sf;return e.update(t),new Uint8Array(e.digest())}function M0(n){let t=new DataView(n.buffer),e=t.getUint32(0,!0),i=t.getUint32(4,!0),r=t.getUint32(8,!0),s=t.getUint32(12,!0);return[new Gi([e,i],0),new Gi([r,s],0)]}var Hf=class n{constructor(t,e,i){if(this.bitmap=t,this.padding=e,this.hashCount=i,e<0||e>=8)throw new Jr(`Invalid padding: ${e}`);if(i<0)throw new Jr(`Invalid hash count: ${i}`);if(t.length>0&&this.hashCount===0)throw new Jr(`Invalid hash count: ${i}`);if(t.length===0&&e!==0)throw new Jr(`Invalid padding when bitmap length is 0: ${e}`);this.Ie=8*t.length-e,this.Te=Gi.fromNumber(this.Ie)}Ee(t,e,i){let r=t.add(e.multiply(Gi.fromNumber(i)));return r.compare(yA)===1&&(r=new Gi([r.getBits(0),r.getBits(1)],0)),r.modulo(this.Te).toNumber()}de(t){return(this.bitmap[Math.floor(t/8)]&1<<t%8)!=0}mightContain(t){if(this.Ie===0)return!1;let e=D0(t),[i,r]=M0(e);for(let s=0;s<this.hashCount;s++){let o=this.Ee(i,r,s);if(!this.de(o))return!1}return!0}static create(t,e,i){let r=t%8==0?0:8-t%8,s=new Uint8Array(Math.ceil(t/8)),o=new n(s,r,e);return i.forEach(a=>o.insert(a)),o}insert(t){if(this.Ie===0)return;let e=D0(t),[i,r]=M0(e);for(let s=0;s<this.hashCount;s++){let o=this.Ee(i,r,s);this.Ae(o)}}Ae(t){let e=Math.floor(t/8),i=t%8;this.bitmap[e]|=1<<i}},Jr=class extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}};var ec=class n{constructor(t,e,i,r,s){this.snapshotVersion=t,this.targetChanges=e,this.targetMismatches=i,this.documentUpdates=r,this.resolvedLimboDocuments=s}static createSynthesizedRemoteEventForCurrentChange(t,e,i){let r=new Map;return r.set(t,nc.createSynthesizedTargetChangeForCurrentChange(t,e,i)),new n(it.min(),r,new Vt(at),Ye(),lt())}},nc=class n{constructor(t,e,i,r,s){this.resumeToken=t,this.current=e,this.addedDocuments=i,this.modifiedDocuments=r,this.removedDocuments=s}static createSynthesizedTargetChangeForCurrentChange(t,e,i){return new n(i,e,lt(),lt(),lt())}};var so=class{constructor(t,e,i,r){this.Re=t,this.removedTargetIds=e,this.key=i,this.Ve=r}},ou=class{constructor(t,e){this.targetId=t,this.me=e}},au=class{constructor(t,e,i=Zt.EMPTY_BYTE_STRING,r=null){this.state=t,this.targetIds=e,this.resumeToken=i,this.cause=r}},cu=class{constructor(){this.fe=0,this.ge=V0(),this.pe=Zt.EMPTY_BYTE_STRING,this.ye=!1,this.we=!0}get current(){return this.ye}get resumeToken(){return this.pe}get Se(){return this.fe!==0}get be(){return this.we}De(t){t.approximateByteSize()>0&&(this.we=!0,this.pe=t)}ve(){let t=lt(),e=lt(),i=lt();return this.ge.forEach((r,s)=>{switch(s){case 0:t=t.add(r);break;case 2:e=e.add(r);break;case 1:i=i.add(r);break;default:J()}}),new nc(this.pe,this.ye,t,e,i)}Ce(){this.we=!1,this.ge=V0()}Fe(t,e){this.we=!0,this.ge=this.ge.insert(t,e)}Me(t){this.we=!0,this.ge=this.ge.remove(t)}xe(){this.fe+=1}Oe(){this.fe-=1,Z(this.fe>=0)}Ne(){this.we=!0,this.ye=!0}},Gf=class{constructor(t){this.Le=t,this.Be=new Map,this.ke=Ye(),this.qe=O0(),this.Qe=new Vt(at)}Ke(t){for(let e of t.Re)t.Ve&&t.Ve.isFoundDocument()?this.$e(e,t.Ve):this.Ue(e,t.key,t.Ve);for(let e of t.removedTargetIds)this.Ue(e,t.key,t.Ve)}We(t){this.forEachTarget(t,e=>{let i=this.Ge(e);switch(t.state){case 0:this.ze(e)&&i.De(t.resumeToken);break;case 1:i.Oe(),i.Se||i.Ce(),i.De(t.resumeToken);break;case 2:i.Oe(),i.Se||this.removeTarget(e);break;case 3:this.ze(e)&&(i.Ne(),i.De(t.resumeToken));break;case 4:this.ze(e)&&(this.je(e),i.De(t.resumeToken));break;default:J()}})}forEachTarget(t,e){t.targetIds.length>0?t.targetIds.forEach(e):this.Be.forEach((i,r)=>{this.ze(r)&&e(r)})}He(t){let e=t.targetId,i=t.me.count,r=this.Je(e);if(r){let s=r.target;if(iu(s))if(i===0){let o=new K(s.path);this.Ue(e,o,oe.newNoDocument(o,it.min()))}else Z(i===1);else{let o=this.Ye(e);if(o!==i){let a=this.Ze(t),c=a?this.Xe(a,t,o):1;if(c!==0){this.je(e);let l=c===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Qe=this.Qe.insert(e,l)}R0?.et(function(h,d,p,g,y){var v,w,k,R,M,F;let V={localCacheCount:h,existenceFilterCount:d.count,databaseId:p.database,projectId:p.projectId},L=d.unchangedNames;return L&&(V.bloomFilter={applied:y===0,hashCount:(v=L?.hashCount)!==null&&v!==void 0?v:0,bitmapLength:(R=(k=(w=L?.bits)===null||w===void 0?void 0:w.bitmap)===null||k===void 0?void 0:k.length)!==null&&R!==void 0?R:0,padding:(F=(M=L?.bits)===null||M===void 0?void 0:M.padding)!==null&&F!==void 0?F:0,mightContain:I=>{var b;return(b=g?.mightContain(I))!==null&&b!==void 0&&b}}),V}(o,t.me,this.Le.tt(),a,c))}}}}Ze(t){let e=t.me.unchangedNames;if(!e||!e.bits)return null;let{bits:{bitmap:i="",padding:r=0},hashCount:s=0}=e,o,a;try{o=er(i).toUint8Array()}catch(c){if(c instanceof tu)return yn("Decoding the base64 bloom filter in existence filter failed ("+c.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw c}try{a=new Hf(o,r,s)}catch(c){return yn(c instanceof Jr?"BloomFilter error: ":"Applying bloom filter failed: ",c),null}return a.Ie===0?null:a}Xe(t,e,i){return e.me.count===i-this.nt(t,e.targetId)?0:2}nt(t,e){let i=this.Le.getRemoteKeysForTarget(e),r=0;return i.forEach(s=>{let o=this.Le.tt(),a=`projects/${o.projectId}/databases/${o.database}/documents/${s.path.canonicalString()}`;t.mightContain(a)||(this.Ue(e,s,null),r++)}),r}rt(t){let e=new Map;this.Be.forEach((s,o)=>{let a=this.Je(o);if(a){if(s.current&&iu(a.target)){let c=new K(a.target.path);this.ke.get(c)!==null||this.it(o,c)||this.Ue(o,c,oe.newNoDocument(c,t))}s.be&&(e.set(o,s.ve()),s.Ce())}});let i=lt();this.qe.forEach((s,o)=>{let a=!0;o.forEachWhile(c=>{let l=this.Je(c);return!l||l.purpose==="TargetPurposeLimboResolution"||(a=!1,!1)}),a&&(i=i.add(s))}),this.ke.forEach((s,o)=>o.setReadTime(t));let r=new ec(t,e,this.Qe,this.ke,i);return this.ke=Ye(),this.qe=O0(),this.Qe=new Vt(at),r}$e(t,e){if(!this.ze(t))return;let i=this.it(t,e.key)?2:0;this.Ge(t).Fe(e.key,i),this.ke=this.ke.insert(e.key,e),this.qe=this.qe.insert(e.key,this.st(e.key).add(t))}Ue(t,e,i){if(!this.ze(t))return;let r=this.Ge(t);this.it(t,e)?r.Fe(e,1):r.Me(e),this.qe=this.qe.insert(e,this.st(e).delete(t)),i&&(this.ke=this.ke.insert(e,i))}removeTarget(t){this.Be.delete(t)}Ye(t){let e=this.Ge(t).ve();return this.Le.getRemoteKeysForTarget(t).size+e.addedDocuments.size-e.removedDocuments.size}xe(t){this.Ge(t).xe()}Ge(t){let e=this.Be.get(t);return e||(e=new cu,this.Be.set(t,e)),e}st(t){let e=this.qe.get(t);return e||(e=new It(at),this.qe=this.qe.insert(t,e)),e}ze(t){let e=this.Je(t)!==null;return e||H("WatchChangeAggregator","Detected inactive target",t),e}Je(t){let e=this.Be.get(t);return e&&e.Se?null:this.Le.ot(t)}je(t){this.Be.set(t,new cu),this.Le.getRemoteKeysForTarget(t).forEach(e=>{this.Ue(t,e,null)})}it(t,e){return this.Le.getRemoteKeysForTarget(t).has(e)}};function O0(){return new Vt(K.comparator)}function V0(){return new Vt(K.comparator)}var vA={asc:"ASCENDING",desc:"DESCENDING"},bA={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},xA={and:"AND",or:"OR"},$f=class{constructor(t,e){this.databaseId=t,this.useProto3Json=e}};function Kf(n,t){return n.useProto3Json||gc(t)?t:{value:t}}function fo(n,t){return n.useProto3Json?`${new Date(1e3*t.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+t.nanoseconds).slice(-9)}Z`:{seconds:""+t.seconds,nanos:t.nanoseconds}}function Zv(n,t){return n.useProto3Json?t.toBase64():t.toUint8Array()}function wA(n,t){return fo(n,t.toTimestamp())}function Jt(n){return Z(!!n),it.fromTimestamp(function(e){let i=vi(e);return new Ut(i.seconds,i.nanos)}(n))}function Ig(n,t){return Yf(n,t).canonicalString()}function Yf(n,t){let e=function(r){return new mt(["projects",r.projectId,"databases",r.database])}(n).child("documents");return t===void 0?e:e.child(t)}function tb(n){let t=mt.fromString(n);return Z(ub(t)),t}function ic(n,t){return Ig(n.databaseId,t.path)}function Gn(n,t){let e=tb(t);if(e.get(1)!==n.databaseId.projectId)throw new q(z.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+e.get(1)+" vs "+n.databaseId.projectId);if(e.get(3)!==n.databaseId.database)throw new q(z.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+e.get(3)+" vs "+n.databaseId.database);return new K(ib(e))}function eb(n,t){return Ig(n.databaseId,t)}function nb(n){let t=tb(n);return t.length===4?mt.emptyPath():ib(t)}function Qf(n){return new mt(["projects",n.databaseId.projectId,"databases",n.databaseId.database]).canonicalString()}function ib(n){return Z(n.length>4&&n.get(4)==="documents"),n.popFirst(5)}function N0(n,t,e){return{name:ic(n,t),fields:e.value.mapValue.fields}}function rb(n,t,e){let i=Gn(n,t.name),r=Jt(t.updateTime),s=t.createTime?Jt(t.createTime):it.min(),o=new Ne({mapValue:{fields:t.fields}}),a=oe.newFoundDocument(i,r,s,o);return e&&a.setHasCommittedMutations(),e?a.setHasCommittedMutations():a}function TA(n,t){return"found"in t?function(i,r){Z(!!r.found),r.found.name,r.found.updateTime;let s=Gn(i,r.found.name),o=Jt(r.found.updateTime),a=r.found.createTime?Jt(r.found.createTime):it.min(),c=new Ne({mapValue:{fields:r.found.fields}});return oe.newFoundDocument(s,o,a,c)}(n,t):"missing"in t?function(i,r){Z(!!r.missing),Z(!!r.readTime);let s=Gn(i,r.missing),o=Jt(r.readTime);return oe.newNoDocument(s,o)}(n,t):J()}function EA(n,t){let e;if("targetChange"in t){t.targetChange;let i=function(l){return l==="NO_CHANGE"?0:l==="ADD"?1:l==="REMOVE"?2:l==="CURRENT"?3:l==="RESET"?4:J()}(t.targetChange.targetChangeType||"NO_CHANGE"),r=t.targetChange.targetIds||[],s=function(l,h){return l.useProto3Json?(Z(h===void 0||typeof h=="string"),Zt.fromBase64String(h||"")):(Z(h===void 0||h instanceof Buffer||h instanceof Uint8Array),Zt.fromUint8Array(h||new Uint8Array))}(n,t.targetChange.resumeToken),o=t.targetChange.cause,a=o&&function(l){let h=l.code===void 0?z.UNKNOWN:Xv(l.code);return new q(h,l.message||"")}(o);e=new au(i,r,s,a||null)}else if("documentChange"in t){t.documentChange;let i=t.documentChange;i.document,i.document.name,i.document.updateTime;let r=Gn(n,i.document.name),s=Jt(i.document.updateTime),o=i.document.createTime?Jt(i.document.createTime):it.min(),a=new Ne({mapValue:{fields:i.document.fields}}),c=oe.newFoundDocument(r,s,o,a),l=i.targetIds||[],h=i.removedTargetIds||[];e=new so(l,h,c.key,c)}else if("documentDelete"in t){t.documentDelete;let i=t.documentDelete;i.document;let r=Gn(n,i.document),s=i.readTime?Jt(i.readTime):it.min(),o=oe.newNoDocument(r,s),a=i.removedTargetIds||[];e=new so([],a,o.key,o)}else if("documentRemove"in t){t.documentRemove;let i=t.documentRemove;i.document;let r=Gn(n,i.document),s=i.removedTargetIds||[];e=new so([],s,r,null)}else{if(!("filter"in t))return J();{t.filter;let i=t.filter;i.targetId;let{count:r=0,unchangedNames:s}=i,o=new Wf(r,s),a=i.targetId;e=new ou(a,o)}}return e}function rc(n,t){let e;if(t instanceof or)e={update:N0(n,t.key,t.value)};else if(t instanceof ar)e={delete:ic(n,t.key)};else if(t instanceof On)e={update:N0(n,t.key,t.data),updateMask:kA(t.fieldMask)};else{if(!(t instanceof Ja))return J();e={verify:ic(n,t.key)}}return t.fieldTransforms.length>0&&(e.updateTransforms=t.fieldTransforms.map(i=>function(s,o){let a=o.transform;if(a instanceof rr)return{fieldPath:o.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(a instanceof bi)return{fieldPath:o.field.canonicalString(),appendMissingElements:{values:a.elements}};if(a instanceof xi)return{fieldPath:o.field.canonicalString(),removeAllFromArray:{values:a.elements}};if(a instanceof sr)return{fieldPath:o.field.canonicalString(),increment:a.Pe};throw J()}(0,i))),t.precondition.isNone||(e.currentDocument=function(r,s){return s.updateTime!==void 0?{updateTime:wA(r,s.updateTime)}:s.exists!==void 0?{exists:s.exists}:J()}(n,t.precondition)),e}function Xf(n,t){let e=t.currentDocument?function(s){return s.updateTime!==void 0?Kt.updateTime(Jt(s.updateTime)):s.exists!==void 0?Kt.exists(s.exists):Kt.none()}(t.currentDocument):Kt.none(),i=t.updateTransforms?t.updateTransforms.map(r=>function(o,a){let c=null;if("setToServerValue"in a)Z(a.setToServerValue==="REQUEST_TIME"),c=new rr;else if("appendMissingElements"in a){let h=a.appendMissingElements.values||[];c=new bi(h)}else if("removeAllFromArray"in a){let h=a.removeAllFromArray.values||[];c=new xi(h)}else"increment"in a?c=new sr(o,a.increment):J();let l=Xt.fromServerFormat(a.fieldPath);return new rs(l,c)}(n,r)):[];if(t.update){t.update.name;let r=Gn(n,t.update.name),s=new Ne({mapValue:{fields:t.update.fields}});if(t.updateMask){let o=function(c){let l=c.fieldPaths||[];return new cn(l.map(h=>Xt.fromServerFormat(h)))}(t.updateMask);return new On(r,s,o,e,i)}return new or(r,s,e,i)}if(t.delete){let r=Gn(n,t.delete);return new ar(r,e)}if(t.verify){let r=Gn(n,t.verify);return new Ja(r,e)}return J()}function IA(n,t){return n&&n.length>0?(Z(t!==void 0),n.map(e=>function(r,s){let o=r.updateTime?Jt(r.updateTime):Jt(s);return o.isEqual(it.min())&&(o=Jt(s)),new Uf(o,r.transformResults||[])}(e,t))):[]}function sb(n,t){return{documents:[eb(n,t.path)]}}function ob(n,t){let e={structuredQuery:{}},i=t.path,r;t.collectionGroup!==null?(r=i,e.structuredQuery.from=[{collectionId:t.collectionGroup,allDescendants:!0}]):(r=i.popLast(),e.structuredQuery.from=[{collectionId:i.lastSegment()}]),e.parent=eb(n,r);let s=function(l){if(l.length!==0)return lb(Tt.create(l,"and"))}(t.filters);s&&(e.structuredQuery.where=s);let o=function(l){if(l.length!==0)return l.map(h=>function(p){return{field:Zs(p.field),direction:AA(p.dir)}}(h))}(t.orderBy);o&&(e.structuredQuery.orderBy=o);let a=Kf(n,t.limit);return a!==null&&(e.structuredQuery.limit=a),t.startAt&&(e.structuredQuery.startAt=function(l){return{before:l.inclusive,values:l.position}}(t.startAt)),t.endAt&&(e.structuredQuery.endAt=function(l){return{before:!l.inclusive,values:l.position}}(t.endAt)),{_t:e,parent:r}}function ab(n){let t=nb(n.parent),e=n.structuredQuery,i=e.from?e.from.length:0,r=null;if(i>0){Z(i===1);let h=e.from[0];h.allDescendants?r=h.collectionId:t=t.child(h.collectionId)}let s=[];e.where&&(s=function(d){let p=cb(d);return p instanceof Tt&&xg(p)?p.getFilters():[p]}(e.where));let o=[];e.orderBy&&(o=function(d){return d.map(p=>function(y){return new ns(to(y.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(p))}(e.orderBy));let a=null;e.limit&&(a=function(d){let p;return p=typeof d=="object"?d.value:d,gc(p)?null:p}(e.limit));let c=null;e.startAt&&(c=function(d){let p=!!d.before,g=d.values||[];return new Yn(g,p)}(e.startAt));let l=null;return e.endAt&&(l=function(d){let p=!d.before,g=d.values||[];return new Yn(g,p)}(e.endAt)),Vv(t,r,o,s,a,"F",c,l)}function SA(n,t){let e=function(r){switch(r){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return J()}}(t.purpose);return e==null?null:{"goog-listen-tags":e}}function cb(n){return n.unaryFilter!==void 0?function(e){switch(e.unaryFilter.op){case"IS_NAN":let i=to(e.unaryFilter.field);return pt.create(i,"==",{doubleValue:NaN});case"IS_NULL":let r=to(e.unaryFilter.field);return pt.create(r,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":let s=to(e.unaryFilter.field);return pt.create(s,"!=",{doubleValue:NaN});case"IS_NOT_NULL":let o=to(e.unaryFilter.field);return pt.create(o,"!=",{nullValue:"NULL_VALUE"});default:return J()}}(n):n.fieldFilter!==void 0?function(e){return pt.create(to(e.fieldFilter.field),function(r){switch(r){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";default:return J()}}(e.fieldFilter.op),e.fieldFilter.value)}(n):n.compositeFilter!==void 0?function(e){return Tt.create(e.compositeFilter.filters.map(i=>cb(i)),function(r){switch(r){case"AND":return"and";case"OR":return"or";default:return J()}}(e.compositeFilter.op))}(n):J()}function AA(n){return vA[n]}function CA(n){return bA[n]}function PA(n){return xA[n]}function Zs(n){return{fieldPath:n.canonicalString()}}function to(n){return Xt.fromServerFormat(n.fieldPath)}function lb(n){return n instanceof pt?function(e){if(e.op==="=="){if(v0(e.value))return{unaryFilter:{field:Zs(e.field),op:"IS_NAN"}};if(y0(e.value))return{unaryFilter:{field:Zs(e.field),op:"IS_NULL"}}}else if(e.op==="!="){if(v0(e.value))return{unaryFilter:{field:Zs(e.field),op:"IS_NOT_NAN"}};if(y0(e.value))return{unaryFilter:{field:Zs(e.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Zs(e.field),op:CA(e.op),value:e.value}}}(n):n instanceof Tt?function(e){let i=e.getFilters().map(r=>lb(r));return i.length===1?i[0]:{compositeFilter:{op:PA(e.op),filters:i}}}(n):J()}function kA(n){let t=[];return n.fields.forEach(e=>t.push(e.canonicalString())),{fieldPaths:t}}function ub(n){return n.length>=4&&n.get(0)==="projects"&&n.get(2)==="databases"}var po=class n{constructor(t,e,i,r,s=it.min(),o=it.min(),a=Zt.EMPTY_BYTE_STRING,c=null){this.target=t,this.targetId=e,this.purpose=i,this.sequenceNumber=r,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=o,this.resumeToken=a,this.expectedCount=c}withSequenceNumber(t){return new n(this.target,this.targetId,this.purpose,t,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(t,e){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,e,this.lastLimboFreeSnapshotVersion,t,null)}withExpectedCount(t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,t)}withLastLimboFreeSnapshotVersion(t){return new n(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,t,this.resumeToken,this.expectedCount)}};var lu=class{constructor(t){this.ct=t}};function RA(n,t){let e;if(t.document)e=rb(n.ct,t.document,!!t.hasCommittedMutations);else if(t.noDocument){let i=K.fromSegments(t.noDocument.path),r=os(t.noDocument.readTime);e=oe.newNoDocument(i,r),t.hasCommittedMutations&&e.setHasCommittedMutations()}else{if(!t.unknownDocument)return J();{let i=K.fromSegments(t.unknownDocument.path),r=os(t.unknownDocument.version);e=oe.newUnknownDocument(i,r)}}return t.readTime&&e.setReadTime(function(r){let s=new Ut(r[0],r[1]);return it.fromTimestamp(s)}(t.readTime)),e}function F0(n,t){let e=t.key,i={prefixPath:e.getCollectionPath().popLast().toArray(),collectionGroup:e.collectionGroup,documentId:e.path.lastSegment(),readTime:uu(t.readTime),hasCommittedMutations:t.hasCommittedMutations};if(t.isFoundDocument())i.document=function(s,o){return{name:ic(s,o.key),fields:o.data.value.mapValue.fields,updateTime:fo(s,o.version.toTimestamp()),createTime:fo(s,o.createTime.toTimestamp())}}(n.ct,t);else if(t.isNoDocument())i.noDocument={path:e.path.toArray(),readTime:ss(t.version)};else{if(!t.isUnknownDocument())return J();i.unknownDocument={path:e.path.toArray(),version:ss(t.version)}}return i}function uu(n){let t=n.toTimestamp();return[t.seconds,t.nanoseconds]}function ss(n){let t=n.toTimestamp();return{seconds:t.seconds,nanoseconds:t.nanoseconds}}function os(n){let t=new Ut(n.seconds,n.nanoseconds);return it.fromTimestamp(t)}function Yr(n,t){let e=(t.baseMutations||[]).map(s=>Xf(n.ct,s));for(let s=0;s<t.mutations.length-1;++s){let o=t.mutations[s];if(s+1<t.mutations.length&&t.mutations[s+1].transform!==void 0){let a=t.mutations[s+1];o.updateTransforms=a.transform.fieldTransforms,t.mutations.splice(s+1,1),++s}}let i=t.mutations.map(s=>Xf(n.ct,s)),r=Ut.fromMillis(t.localWriteTimeMs);return new Za(t.batchId,r,e,i)}function za(n){let t=os(n.readTime),e=n.lastLimboFreeSnapshotVersion!==void 0?os(n.lastLimboFreeSnapshotVersion):it.min(),i;return i=function(s){return s.documents!==void 0}(n.query)?function(s){return Z(s.documents.length===1),je(Io(nb(s.documents[0])))}(n.query):function(s){return je(ab(s))}(n.query),new po(i,n.targetId,"TargetPurposeListen",n.lastListenSequenceNumber,t,e,Zt.fromBase64String(n.resumeToken))}function hb(n,t){let e=ss(t.snapshotVersion),i=ss(t.lastLimboFreeSnapshotVersion),r;r=iu(t.target)?sb(n.ct,t.target):ob(n.ct,t.target)._t;let s=t.resumeToken.toBase64();return{targetId:t.targetId,canonicalId:is(t.target),readTime:e,resumeToken:s,lastListenSequenceNumber:t.sequenceNumber,lastLimboFreeSnapshotVersion:i,query:r}}function Sg(n){let t=ab({parent:n.parent,structuredQuery:n.structuredQuery});return n.limitType==="LAST"?su(t,t.limit,"L"):t}function df(n,t){return new tc(t.largestBatchId,Xf(n.ct,t.overlayMutation))}function L0(n,t){let e=t.path.lastSegment();return[n,ze(t.path.popLast()),e]}function B0(n,t,e,i){return{indexId:n,uid:t,sequenceNumber:e,readTime:ss(i.readTime),documentKey:ze(i.documentKey.path),largestBatchId:i.largestBatchId}}var Jf=class{getBundleMetadata(t,e){return z0(t).get(e).next(i=>{if(i)return function(s){return{id:s.bundleId,createTime:os(s.createTime),version:s.version}}(i)})}saveBundleMetadata(t,e){return z0(t).put(function(r){return{bundleId:r.id,createTime:ss(Jt(r.createTime)),version:r.version}}(e))}getNamedQuery(t,e){return j0(t).get(e).next(i=>{if(i)return function(s){return{name:s.name,query:Sg(s.bundledQuery),readTime:os(s.readTime)}}(i)})}saveNamedQuery(t,e){return j0(t).put(function(r){return{name:r.name,readTime:ss(Jt(r.readTime)),bundledQuery:r.bundledQuery}}(e))}};function z0(n){return he(n,"bundles")}function j0(n){return he(n,"namedQueries")}var hu=class n{constructor(t,e){this.serializer=t,this.userId=e}static lt(t,e){let i=e.uid||"";return new n(t,i)}getOverlay(t,e){return Va(t).get(L0(this.userId,e)).next(i=>i?df(this.serializer,i):null)}getOverlays(t,e){let i=Wn();return B.forEach(e,r=>this.getOverlay(t,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(t,e,i){let r=[];return i.forEach((s,o)=>{let a=new tc(e,o);r.push(this.ht(t,a))}),B.waitFor(r)}removeOverlaysForBatchId(t,e,i){let r=new Set;e.forEach(o=>r.add(ze(o.getCollectionPath())));let s=[];return r.forEach(o=>{let a=IDBKeyRange.bound([this.userId,o,i],[this.userId,o,i+1],!1,!0);s.push(Va(t).j("collectionPathOverlayIndex",a))}),B.waitFor(s)}getOverlaysForCollection(t,e,i){let r=Wn(),s=ze(e),o=IDBKeyRange.bound([this.userId,s,i],[this.userId,s,Number.POSITIVE_INFINITY],!0);return Va(t).U("collectionPathOverlayIndex",o).next(a=>{for(let c of a){let l=df(this.serializer,c);r.set(l.getKey(),l)}return r})}getOverlaysForCollectionGroup(t,e,i,r){let s=Wn(),o,a=IDBKeyRange.bound([this.userId,e,i],[this.userId,e,Number.POSITIVE_INFINITY],!0);return Va(t).J({index:"collectionGroupOverlayIndex",range:a},(c,l,h)=>{let d=df(this.serializer,l);s.size()<r||d.largestBatchId===o?(s.set(d.getKey(),d),o=d.largestBatchId):h.done()}).next(()=>s)}ht(t,e){return Va(t).put(function(r,s,o){let[a,c,l]=L0(s,o.mutation.key);return{userId:s,collectionPath:c,documentId:l,collectionGroup:o.mutation.key.getCollectionGroup(),largestBatchId:o.largestBatchId,overlayMutation:rc(r.ct,o.mutation)}}(this.serializer,this.userId,e))}};function Va(n){return he(n,"documentOverlays")}var Zf=class{Pt(t){return he(t,"globals")}getSessionToken(t){return this.Pt(t).get("sessionToken").next(e=>{let i=e?.value;return i?Zt.fromUint8Array(i):Zt.EMPTY_BYTE_STRING})}setSessionToken(t,e){return this.Pt(t).put({name:"sessionToken",value:e.toUint8Array()})}};var _i=class{constructor(){}It(t,e){this.Tt(t,e),e.Et()}Tt(t,e){if("nullValue"in t)this.dt(e,5);else if("booleanValue"in t)this.dt(e,10),e.At(t.booleanValue?1:0);else if("integerValue"in t)this.dt(e,15),e.At(Lt(t.integerValue));else if("doubleValue"in t){let i=Lt(t.doubleValue);isNaN(i)?this.dt(e,13):(this.dt(e,15),$a(i)?e.At(0):e.At(i))}else if("timestampValue"in t){let i=t.timestampValue;this.dt(e,20),typeof i=="string"&&(i=vi(i)),e.Rt(`${i.seconds||""}`),e.At(i.nanos||0)}else if("stringValue"in t)this.Vt(t.stringValue,e),this.ft(e);else if("bytesValue"in t)this.dt(e,30),e.gt(er(t.bytesValue)),this.ft(e);else if("referenceValue"in t)this.yt(t.referenceValue,e);else if("geoPointValue"in t){let i=t.geoPointValue;this.dt(e,45),e.At(i.latitude||0),e.At(i.longitude||0)}else"mapValue"in t?Av(t)?this.dt(e,Number.MAX_SAFE_INTEGER):Hu(t)?this.wt(t.mapValue,e):(this.St(t.mapValue,e),this.ft(e)):"arrayValue"in t?(this.bt(t.arrayValue,e),this.ft(e)):J()}Vt(t,e){this.dt(e,25),this.Dt(t,e)}Dt(t,e){e.Rt(t)}St(t,e){let i=t.fields||{};this.dt(e,55);for(let r of Object.keys(i))this.Vt(r,e),this.Tt(i[r],e)}wt(t,e){var i,r;let s=t.fields||{};this.dt(e,53);let o="value",a=((r=(i=s[o].arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.length)||0;this.dt(e,15),e.At(Lt(a)),this.Vt(o,e),this.Tt(s[o],e)}bt(t,e){let i=t.values||[];this.dt(e,50);for(let r of i)this.Tt(r,e)}yt(t,e){this.dt(e,37),K.fromName(t).path.forEach(i=>{this.dt(e,60),this.Dt(i,e)})}dt(t,e){t.At(e)}ft(t){t.At(2)}};_i.vt=new _i;function DA(n){if(n===0)return 8;let t=0;return!(n>>4)&&(t+=4,n<<=4),!(n>>6)&&(t+=2,n<<=2),!(n>>7)&&(t+=1),t}function U0(n){let t=64-function(i){let r=0;for(let s=0;s<8;++s){let o=DA(255&i[s]);if(r+=o,o!==8)break}return r}(n);return Math.ceil(t/8)}var tp=class{constructor(){this.buffer=new Uint8Array(1024),this.position=0}Ct(t){let e=t[Symbol.iterator](),i=e.next();for(;!i.done;)this.Ft(i.value),i=e.next();this.Mt()}xt(t){let e=t[Symbol.iterator](),i=e.next();for(;!i.done;)this.Ot(i.value),i=e.next();this.Nt()}Lt(t){for(let e of t){let i=e.charCodeAt(0);if(i<128)this.Ft(i);else if(i<2048)this.Ft(960|i>>>6),this.Ft(128|63&i);else if(e<"\uD800"||"\uDBFF"<e)this.Ft(480|i>>>12),this.Ft(128|63&i>>>6),this.Ft(128|63&i);else{let r=e.codePointAt(0);this.Ft(240|r>>>18),this.Ft(128|63&r>>>12),this.Ft(128|63&r>>>6),this.Ft(128|63&r)}}this.Mt()}Bt(t){for(let e of t){let i=e.charCodeAt(0);if(i<128)this.Ot(i);else if(i<2048)this.Ot(960|i>>>6),this.Ot(128|63&i);else if(e<"\uD800"||"\uDBFF"<e)this.Ot(480|i>>>12),this.Ot(128|63&i>>>6),this.Ot(128|63&i);else{let r=e.codePointAt(0);this.Ot(240|r>>>18),this.Ot(128|63&r>>>12),this.Ot(128|63&r>>>6),this.Ot(128|63&r)}}this.Nt()}kt(t){let e=this.qt(t),i=U0(e);this.Qt(1+i),this.buffer[this.position++]=255&i;for(let r=e.length-i;r<e.length;++r)this.buffer[this.position++]=255&e[r]}Kt(t){let e=this.qt(t),i=U0(e);this.Qt(1+i),this.buffer[this.position++]=~(255&i);for(let r=e.length-i;r<e.length;++r)this.buffer[this.position++]=~(255&e[r])}$t(){this.Ut(255),this.Ut(255)}Wt(){this.Gt(255),this.Gt(255)}reset(){this.position=0}seed(t){this.Qt(t.length),this.buffer.set(t,this.position),this.position+=t.length}zt(){return this.buffer.slice(0,this.position)}qt(t){let e=function(s){let o=new DataView(new ArrayBuffer(8));return o.setFloat64(0,s,!1),new Uint8Array(o.buffer)}(t),i=(128&e[0])!=0;e[0]^=i?255:128;for(let r=1;r<e.length;++r)e[r]^=i?255:0;return e}Ft(t){let e=255&t;e===0?(this.Ut(0),this.Ut(255)):e===255?(this.Ut(255),this.Ut(0)):this.Ut(e)}Ot(t){let e=255&t;e===0?(this.Gt(0),this.Gt(255)):e===255?(this.Gt(255),this.Gt(0)):this.Gt(t)}Mt(){this.Ut(0),this.Ut(1)}Nt(){this.Gt(0),this.Gt(1)}Ut(t){this.Qt(1),this.buffer[this.position++]=t}Gt(t){this.Qt(1),this.buffer[this.position++]=~t}Qt(t){let e=t+this.position;if(e<=this.buffer.length)return;let i=2*this.buffer.length;i<e&&(i=e);let r=new Uint8Array(i);r.set(this.buffer),this.buffer=r}},ep=class{constructor(t){this.jt=t}gt(t){this.jt.Ct(t)}Rt(t){this.jt.Lt(t)}At(t){this.jt.kt(t)}Et(){this.jt.$t()}},np=class{constructor(t){this.jt=t}gt(t){this.jt.xt(t)}Rt(t){this.jt.Bt(t)}At(t){this.jt.Kt(t)}Et(){this.jt.Wt()}},Qr=class{constructor(){this.jt=new tp,this.Ht=new ep(this.jt),this.Jt=new np(this.jt)}seed(t){this.jt.seed(t)}Yt(t){return t===0?this.Ht:this.Jt}zt(){return this.jt.zt()}reset(){this.jt.reset()}};var Xr=class n{constructor(t,e,i,r){this.indexId=t,this.documentKey=e,this.arrayValue=i,this.directionalValue=r}Zt(){let t=this.directionalValue.length,e=t===0||this.directionalValue[t-1]===255?t+1:t,i=new Uint8Array(e);return i.set(this.directionalValue,0),e!==t?i.set([0],this.directionalValue.length):++i[i.length-1],new n(this.indexId,this.documentKey,this.arrayValue,i)}};function $i(n,t){let e=n.indexId-t.indexId;return e!==0?e:(e=q0(n.arrayValue,t.arrayValue),e!==0?e:(e=q0(n.directionalValue,t.directionalValue),e!==0?e:K.comparator(n.documentKey,t.documentKey)))}function q0(n,t){for(let e=0;e<n.length&&e<t.length;++e){let i=n[e]-t[e];if(i!==0)return i}return n.length-t.length}var du=class{constructor(t){this.Xt=new It((e,i)=>Xt.comparator(e.field,i.field)),this.collectionId=t.collectionGroup!=null?t.collectionGroup:t.path.lastSegment(),this.en=t.orderBy,this.tn=[];for(let e of t.filters){let i=e;i.isInequality()?this.Xt=this.Xt.add(i):this.tn.push(i)}}get nn(){return this.Xt.size>1}rn(t){if(Z(t.collectionGroup===this.collectionId),this.nn)return!1;let e=Tf(t);if(e!==void 0&&!this.sn(e))return!1;let i=$r(t),r=new Set,s=0,o=0;for(;s<i.length&&this.sn(i[s]);++s)r=r.add(i[s].fieldPath.canonicalString());if(s===i.length)return!0;if(this.Xt.size>0){let a=this.Xt.getIterator().getNext();if(!r.has(a.field.canonicalString())){let c=i[s];if(!this.on(a,c)||!this._n(this.en[o++],c))return!1}++s}for(;s<i.length;++s){let a=i[s];if(o>=this.en.length||!this._n(this.en[o++],a))return!1}return!0}an(){if(this.nn)return null;let t=new It(Xt.comparator),e=[];for(let i of this.tn)if(!i.field.isKeyField())if(i.op==="array-contains"||i.op==="array-contains-any")e.push(new io(i.field,2));else{if(t.has(i.field))continue;t=t.add(i.field),e.push(new io(i.field,0))}for(let i of this.en)i.field.isKeyField()||t.has(i.field)||(t=t.add(i.field),e.push(new io(i.field,i.dir==="asc"?0:1)));return new ao(ao.UNKNOWN_ID,this.collectionId,e,Ga.empty())}sn(t){for(let e of this.tn)if(this.on(e,t))return!0;return!1}on(t,e){if(t===void 0||!t.field.isEqual(e.fieldPath))return!1;let i=t.op==="array-contains"||t.op==="array-contains-any";return e.kind===2===i}_n(t,e){return!!t.field.isEqual(e.fieldPath)&&(e.kind===0&&t.dir==="asc"||e.kind===1&&t.dir==="desc")}};function db(n){var t,e;if(Z(n instanceof pt||n instanceof Tt),n instanceof pt){if(n instanceof nu){let r=((e=(t=n.value.arrayValue)===null||t===void 0?void 0:t.values)===null||e===void 0?void 0:e.map(s=>pt.create(n.field,"==",s)))||[];return Tt.create(r,"or")}return n}let i=n.filters.map(r=>db(r));return Tt.create(i,n.op)}function MA(n){if(n.getFilters().length===0)return[];let t=sp(db(n));return Z(fb(t)),ip(t)||rp(t)?[t]:t.getFilters()}function ip(n){return n instanceof pt}function rp(n){return n instanceof Tt&&xg(n)}function fb(n){return ip(n)||rp(n)||function(e){if(e instanceof Tt&&Rf(e)){for(let i of e.getFilters())if(!ip(i)&&!rp(i))return!1;return!0}return!1}(n)}function sp(n){if(Z(n instanceof pt||n instanceof Tt),n instanceof pt)return n;if(n.filters.length===1)return sp(n.filters[0]);let t=n.filters.map(i=>sp(i)),e=Tt.create(t,n.op);return e=fu(e),fb(e)?e:(Z(e instanceof Tt),Z(lo(e)),Z(e.filters.length>1),e.filters.reduce((i,r)=>Ag(i,r)))}function Ag(n,t){let e;return Z(n instanceof pt||n instanceof Tt),Z(t instanceof pt||t instanceof Tt),e=n instanceof pt?t instanceof pt?function(r,s){return Tt.create([r,s],"and")}(n,t):W0(n,t):t instanceof pt?W0(t,n):function(r,s){if(Z(r.filters.length>0&&s.filters.length>0),lo(r)&&lo(s))return Dv(r,s.getFilters());let o=Rf(r)?r:s,a=Rf(r)?s:r,c=o.filters.map(l=>Ag(l,a));return Tt.create(c,"or")}(n,t),fu(e)}function W0(n,t){if(lo(t))return Dv(t,n.getFilters());{let e=t.filters.map(i=>Ag(n,i));return Tt.create(e,"or")}}function fu(n){if(Z(n instanceof pt||n instanceof Tt),n instanceof pt)return n;let t=n.getFilters();if(t.length===1)return fu(t[0]);if(kv(n))return n;let e=t.map(r=>fu(r)),i=[];return e.forEach(r=>{r instanceof pt?i.push(r):r instanceof Tt&&(r.op===n.op?i.push(...r.filters):i.push(r))}),i.length===1?i[0]:Tt.create(i,n.op)}var op=class{constructor(){this.un=new sc}addToCollectionParentIndex(t,e){return this.un.add(e),B.resolve()}getCollectionParents(t,e){return B.resolve(this.un.getEntries(e))}addFieldIndex(t,e){return B.resolve()}deleteFieldIndex(t,e){return B.resolve()}deleteAllFieldIndexes(t){return B.resolve()}createTargetIndexes(t,e){return B.resolve()}getDocumentsMatchingTarget(t,e){return B.resolve(null)}getIndexType(t,e){return B.resolve(0)}getFieldIndexes(t,e){return B.resolve([])}getNextCollectionGroupToUpdate(t){return B.resolve(null)}getMinOffset(t,e){return B.resolve(vn.min())}getMinOffsetFromCollectionGroup(t,e){return B.resolve(vn.min())}updateCollectionGroup(t,e,i){return B.resolve()}updateIndexEntries(t,e){return B.resolve()}},sc=class{constructor(){this.index={}}add(t){let e=t.lastSegment(),i=t.popLast(),r=this.index[e]||new It(mt.comparator),s=!r.has(i);return this.index[e]=r.add(i),s}has(t){let e=t.lastSegment(),i=t.popLast(),r=this.index[e];return r&&r.has(i)}getEntries(t){return(this.index[t]||new It(mt.comparator)).toArray()}};var Ll=new Uint8Array(0),ap=class{constructor(t,e){this.databaseId=e,this.cn=new sc,this.ln=new Qn(i=>is(i),(i,r)=>mc(i,r)),this.uid=t.uid||""}addToCollectionParentIndex(t,e){if(!this.cn.has(e)){let i=e.lastSegment(),r=e.popLast();t.addOnCommittedListener(()=>{this.cn.add(e)});let s={collectionId:i,parent:ze(r)};return H0(t).put(s)}return B.resolve()}getCollectionParents(t,e){let i=[],r=IDBKeyRange.bound([e,""],[gv(e),""],!1,!0);return H0(t).U(r).next(s=>{for(let o of s){if(o.collectionId!==e)break;i.push(qn(o.parent))}return i})}addFieldIndex(t,e){let i=Na(t),r=function(a){return{indexId:a.indexId,collectionGroup:a.collectionGroup,fields:a.fields.map(c=>[c.fieldPath.canonicalString(),c.kind])}}(e);delete r.indexId;let s=i.add(r);if(e.indexState){let o=Ys(t);return s.next(a=>{o.put(B0(a,this.uid,e.indexState.sequenceNumber,e.indexState.offset))})}return s.next()}deleteFieldIndex(t,e){let i=Na(t),r=Ys(t),s=Ks(t);return i.delete(e.indexId).next(()=>r.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0))).next(()=>s.delete(IDBKeyRange.bound([e.indexId],[e.indexId+1],!1,!0)))}deleteAllFieldIndexes(t){let e=Na(t),i=Ks(t),r=Ys(t);return e.j().next(()=>i.j()).next(()=>r.j())}createTargetIndexes(t,e){return B.forEach(this.hn(e),i=>this.getIndexType(t,i).next(r=>{if(r===0||r===1){let s=new du(i).an();if(s!=null)return this.addFieldIndex(t,s)}}))}getDocumentsMatchingTarget(t,e){let i=Ks(t),r=!0,s=new Map;return B.forEach(this.hn(e),o=>this.Pn(t,o).next(a=>{r&&(r=!!a),s.set(o,a)})).next(()=>{if(r){let o=lt(),a=[];return B.forEach(s,(c,l)=>{H("IndexedDbIndexManager",`Using index ${function(M){return`id=${M.indexId}|cg=${M.collectionGroup}|f=${M.fields.map(F=>`${F.fieldPath}:${F.kind}`).join(",")}`}(c)} to execute ${is(e)}`);let h=function(M,F){let V=Tf(F);if(V===void 0)return null;for(let L of ru(M,V.fieldPath))switch(L.op){case"array-contains-any":return L.value.arrayValue.values||[];case"array-contains":return[L.value]}return null}(l,c),d=function(M,F){let V=new Map;for(let L of $r(F))for(let I of ru(M,L.fieldPath))switch(I.op){case"==":case"in":V.set(L.fieldPath.canonicalString(),I.value);break;case"not-in":case"!=":return V.set(L.fieldPath.canonicalString(),I.value),Array.from(V.values())}return null}(l,c),p=function(M,F){let V=[],L=!0;for(let I of $r(F)){let b=I.kind===0?E0(M,I.fieldPath,M.startAt):I0(M,I.fieldPath,M.startAt);V.push(b.value),L&&(L=b.inclusive)}return new Yn(V,L)}(l,c),g=function(M,F){let V=[],L=!0;for(let I of $r(F)){let b=I.kind===0?I0(M,I.fieldPath,M.endAt):E0(M,I.fieldPath,M.endAt);V.push(b.value),L&&(L=b.inclusive)}return new Yn(V,L)}(l,c),y=this.In(c,l,p),v=this.In(c,l,g),w=this.Tn(c,l,d),k=this.En(c.indexId,h,y,p.inclusive,v,g.inclusive,w);return B.forEach(k,R=>i.G(R,e.limit).next(M=>{M.forEach(F=>{let V=K.fromSegments(F.documentKey);o.has(V)||(o=o.add(V),a.push(V))})}))}).next(()=>a)}return B.resolve(null)})}hn(t){let e=this.ln.get(t);return e||(t.filters.length===0?e=[t]:e=MA(Tt.create(t.filters,"and")).map(i=>zf(t.path,t.collectionGroup,t.orderBy,i.getFilters(),t.limit,t.startAt,t.endAt)),this.ln.set(t,e),e)}En(t,e,i,r,s,o,a){let c=(e!=null?e.length:1)*Math.max(i.length,s.length),l=c/(e!=null?e.length:1),h=[];for(let d=0;d<c;++d){let p=e?this.dn(e[d/l]):Ll,g=this.An(t,p,i[d%l],r),y=this.Rn(t,p,s[d%l],o),v=a.map(w=>this.An(t,p,w,!0));h.push(...this.createRange(g,y,v))}return h}An(t,e,i,r){let s=new Xr(t,K.empty(),e,i);return r?s:s.Zt()}Rn(t,e,i,r){let s=new Xr(t,K.empty(),e,i);return r?s.Zt():s}Pn(t,e){let i=new du(e),r=e.collectionGroup!=null?e.collectionGroup:e.path.lastSegment();return this.getFieldIndexes(t,r).next(s=>{let o=null;for(let a of s)i.rn(a)&&(!o||a.fields.length>o.fields.length)&&(o=a);return o})}getIndexType(t,e){let i=2,r=this.hn(e);return B.forEach(r,s=>this.Pn(t,s).next(o=>{o?i!==0&&o.fields.length<function(c){let l=new It(Xt.comparator),h=!1;for(let d of c.filters)for(let p of d.getFlattenedFilters())p.field.isKeyField()||(p.op==="array-contains"||p.op==="array-contains-any"?h=!0:l=l.add(p.field));for(let d of c.orderBy)d.field.isKeyField()||(l=l.add(d.field));return l.size+(h?1:0)}(s)&&(i=1):i=0})).next(()=>function(o){return o.limit!==null}(e)&&r.length>1&&i===2?1:i)}Vn(t,e){let i=new Qr;for(let r of $r(t)){let s=e.data.field(r.fieldPath);if(s==null)return null;let o=i.Yt(r.kind);_i.vt.It(s,o)}return i.zt()}dn(t){let e=new Qr;return _i.vt.It(t,e.Yt(0)),e.zt()}mn(t,e){let i=new Qr;return _i.vt.It(es(this.databaseId,e),i.Yt(function(s){let o=$r(s);return o.length===0?0:o[o.length-1].kind}(t))),i.zt()}Tn(t,e,i){if(i===null)return[];let r=[];r.push(new Qr);let s=0;for(let o of $r(t)){let a=i[s++];for(let c of r)if(this.fn(e,o.fieldPath)&&Xa(a))r=this.gn(r,o,a);else{let l=c.Yt(o.kind);_i.vt.It(a,l)}}return this.pn(r)}In(t,e,i){return this.Tn(t,e,i.position)}pn(t){let e=[];for(let i=0;i<t.length;++i)e[i]=t[i].zt();return e}gn(t,e,i){let r=[...t],s=[];for(let o of i.arrayValue.values||[])for(let a of r){let c=new Qr;c.seed(a.zt()),_i.vt.It(o,c.Yt(e.kind)),s.push(c)}return s}fn(t,e){return!!t.filters.find(i=>i instanceof pt&&i.field.isEqual(e)&&(i.op==="in"||i.op==="not-in"))}getFieldIndexes(t,e){let i=Na(t),r=Ys(t);return(e?i.U("collectionGroupIndex",IDBKeyRange.bound(e,e)):i.U()).next(s=>{let o=[];return B.forEach(s,a=>r.get([a.indexId,this.uid]).next(c=>{o.push(function(h,d){let p=d?new Ga(d.sequenceNumber,new vn(os(d.readTime),new K(qn(d.documentKey)),d.largestBatchId)):Ga.empty(),g=h.fields.map(([y,v])=>new io(Xt.fromServerFormat(y),v));return new ao(h.indexId,h.collectionGroup,g,p)}(a,c))})).next(()=>o)})}getNextCollectionGroupToUpdate(t){return this.getFieldIndexes(t).next(e=>e.length===0?null:(e.sort((i,r)=>{let s=i.indexState.sequenceNumber-r.indexState.sequenceNumber;return s!==0?s:at(i.collectionGroup,r.collectionGroup)}),e[0].collectionGroup))}updateCollectionGroup(t,e,i){let r=Na(t),s=Ys(t);return this.yn(t).next(o=>r.U("collectionGroupIndex",IDBKeyRange.bound(e,e)).next(a=>B.forEach(a,c=>s.put(B0(c.indexId,this.uid,o,i)))))}updateIndexEntries(t,e){let i=new Map;return B.forEach(e,(r,s)=>{let o=i.get(r.collectionGroup);return(o?B.resolve(o):this.getFieldIndexes(t,r.collectionGroup)).next(a=>(i.set(r.collectionGroup,a),B.forEach(a,c=>this.wn(t,r,c).next(l=>{let h=this.Sn(s,c);return l.isEqual(h)?B.resolve():this.bn(t,s,c,l,h)}))))})}Dn(t,e,i,r){return Ks(t).put({indexId:r.indexId,uid:this.uid,arrayValue:r.arrayValue,directionalValue:r.directionalValue,orderedDocumentKey:this.mn(i,e.key),documentKey:e.key.path.toArray()})}vn(t,e,i,r){return Ks(t).delete([r.indexId,this.uid,r.arrayValue,r.directionalValue,this.mn(i,e.key),e.key.path.toArray()])}wn(t,e,i){let r=Ks(t),s=new It($i);return r.J({index:"documentKeyIndex",range:IDBKeyRange.only([i.indexId,this.uid,this.mn(i,e)])},(o,a)=>{s=s.add(new Xr(i.indexId,e,a.arrayValue,a.directionalValue))}).next(()=>s)}Sn(t,e){let i=new It($i),r=this.Vn(e,t);if(r==null)return i;let s=Tf(e);if(s!=null){let o=t.data.field(s.fieldPath);if(Xa(o))for(let a of o.arrayValue.values||[])i=i.add(new Xr(e.indexId,t.key,this.dn(a),r))}else i=i.add(new Xr(e.indexId,t.key,Ll,r));return i}bn(t,e,i,r,s){H("IndexedDbIndexManager","Updating index entries for document '%s'",e.key);let o=[];return function(c,l,h,d,p){let g=c.getIterator(),y=l.getIterator(),v=$s(g),w=$s(y);for(;v||w;){let k=!1,R=!1;if(v&&w){let M=h(v,w);M<0?R=!0:M>0&&(k=!0)}else v!=null?R=!0:k=!0;k?(d(w),w=$s(y)):R?(p(v),v=$s(g)):(v=$s(g),w=$s(y))}}(r,s,$i,a=>{o.push(this.Dn(t,e,i,a))},a=>{o.push(this.vn(t,e,i,a))}),B.waitFor(o)}yn(t){let e=1;return Ys(t).J({index:"sequenceNumberIndex",reverse:!0,range:IDBKeyRange.upperBound([this.uid,Number.MAX_SAFE_INTEGER])},(i,r,s)=>{s.done(),e=r.sequenceNumber+1}).next(()=>e)}createRange(t,e,i){i=i.sort((o,a)=>$i(o,a)).filter((o,a,c)=>!a||$i(o,c[a-1])!==0);let r=[];r.push(t);for(let o of i){let a=$i(o,t),c=$i(o,e);if(a===0)r[0]=t.Zt();else if(a>0&&c<0)r.push(o),r.push(o.Zt());else if(c>0)break}r.push(e);let s=[];for(let o=0;o<r.length;o+=2){if(this.Cn(r[o],r[o+1]))return[];let a=[r[o].indexId,this.uid,r[o].arrayValue,r[o].directionalValue,Ll,[]],c=[r[o+1].indexId,this.uid,r[o+1].arrayValue,r[o+1].directionalValue,Ll,[]];s.push(IDBKeyRange.bound(a,c))}return s}Cn(t,e){return $i(t,e)>0}getMinOffsetFromCollectionGroup(t,e){return this.getFieldIndexes(t,e).next(G0)}getMinOffset(t,e){return B.mapArray(this.hn(e),i=>this.Pn(t,i).next(r=>r||J())).next(G0)}};function H0(n){return he(n,"collectionParents")}function Ks(n){return he(n,"indexEntries")}function Na(n){return he(n,"indexConfiguration")}function Ys(n){return he(n,"indexState")}function G0(n){Z(n.length!==0);let t=n[0].indexState.offset,e=t.largestBatchId;for(let i=1;i<n.length;i++){let r=n[i].indexState.offset;_g(r,t)<0&&(t=r),e<r.largestBatchId&&(e=r.largestBatchId)}return new vn(t.readTime,t.documentKey,e)}var $0={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},_n=class n{constructor(t,e,i){this.cacheSizeCollectionThreshold=t,this.percentileToCollect=e,this.maximumSequenceNumbersToCollect=i}static withCacheSize(t){return new n(t,n.DEFAULT_COLLECTION_PERCENTILE,n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}};function pb(n,t,e){let i=n.store("mutations"),r=n.store("documentMutations"),s=[],o=IDBKeyRange.only(e.batchId),a=0,c=i.J({range:o},(h,d,p)=>(a++,p.delete()));s.push(c.next(()=>{Z(a===1)}));let l=[];for(let h of e.mutations){let d=xv(t,h.key.path,e.batchId);s.push(r.delete(d)),l.push(h.key)}return B.waitFor(s).next(()=>l)}function pu(n){if(!n)return 0;let t;if(n.document)t=n.document;else if(n.unknownDocument)t=n.unknownDocument;else{if(!n.noDocument)throw J();t=n.noDocument}return JSON.stringify(t).length}_n.DEFAULT_COLLECTION_PERCENTILE=10,_n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,_n.DEFAULT=new _n(41943040,_n.DEFAULT_COLLECTION_PERCENTILE,_n.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),_n.DISABLED=new _n(-1,0,0);var gu=class n{constructor(t,e,i,r){this.userId=t,this.serializer=e,this.indexManager=i,this.referenceDelegate=r,this.Fn={}}static lt(t,e,i,r){Z(t.uid!=="");let s=t.isAuthenticated()?t.uid:"";return new n(s,e,i,r)}checkEmpty(t){let e=!0,i=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return Ki(t).J({index:"userMutationsIndex",range:i},(r,s,o)=>{e=!1,o.done()}).next(()=>e)}addMutationBatch(t,e,i,r){let s=eo(t),o=Ki(t);return o.add({}).next(a=>{Z(typeof a=="number");let c=new Za(a,e,i,r),l=function(g,y,v){let w=v.baseMutations.map(R=>rc(g.ct,R)),k=v.mutations.map(R=>rc(g.ct,R));return{userId:y,batchId:v.batchId,localWriteTimeMs:v.localWriteTime.toMillis(),baseMutations:w,mutations:k}}(this.serializer,this.userId,c),h=[],d=new It((p,g)=>at(p.canonicalString(),g.canonicalString()));for(let p of r){let g=xv(this.userId,p.key.path,a);d=d.add(p.key.path.popLast()),h.push(o.put(l)),h.push(s.put(g,BS))}return d.forEach(p=>{h.push(this.indexManager.addToCollectionParentIndex(t,p))}),t.addOnCommittedListener(()=>{this.Fn[a]=c.keys()}),B.waitFor(h).next(()=>c)})}lookupMutationBatch(t,e){return Ki(t).get(e).next(i=>i?(Z(i.userId===this.userId),Yr(this.serializer,i)):null)}Mn(t,e){return this.Fn[e]?B.resolve(this.Fn[e]):this.lookupMutationBatch(t,e).next(i=>{if(i){let r=i.keys();return this.Fn[e]=r,r}return null})}getNextMutationBatchAfterBatchId(t,e){let i=e+1,r=IDBKeyRange.lowerBound([this.userId,i]),s=null;return Ki(t).J({index:"userMutationsIndex",range:r},(o,a,c)=>{a.userId===this.userId&&(Z(a.batchId>=i),s=Yr(this.serializer,a)),c.done()}).next(()=>s)}getHighestUnacknowledgedBatchId(t){let e=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),i=-1;return Ki(t).J({index:"userMutationsIndex",range:e,reverse:!0},(r,s,o)=>{i=s.batchId,o.done()}).next(()=>i)}getAllMutationBatches(t){let e=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return Ki(t).U("userMutationsIndex",e).next(i=>i.map(r=>Yr(this.serializer,r)))}getAllMutationBatchesAffectingDocumentKey(t,e){let i=Ul(this.userId,e.path),r=IDBKeyRange.lowerBound(i),s=[];return eo(t).J({range:r},(o,a,c)=>{let[l,h,d]=o,p=qn(h);if(l===this.userId&&e.path.isEqual(p))return Ki(t).get(d).next(g=>{if(!g)throw J();Z(g.userId===this.userId),s.push(Yr(this.serializer,g))});c.done()}).next(()=>s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new It(at),r=[];return e.forEach(s=>{let o=Ul(this.userId,s.path),a=IDBKeyRange.lowerBound(o),c=eo(t).J({range:a},(l,h,d)=>{let[p,g,y]=l,v=qn(g);p===this.userId&&s.path.isEqual(v)?i=i.add(y):d.done()});r.push(c)}),B.waitFor(r).next(()=>this.xn(t,i))}getAllMutationBatchesAffectingQuery(t,e){let i=e.path,r=i.length+1,s=Ul(this.userId,i),o=IDBKeyRange.lowerBound(s),a=new It(at);return eo(t).J({range:o},(c,l,h)=>{let[d,p,g]=c,y=qn(p);d===this.userId&&i.isPrefixOf(y)?y.length===r&&(a=a.add(g)):h.done()}).next(()=>this.xn(t,a))}xn(t,e){let i=[],r=[];return e.forEach(s=>{r.push(Ki(t).get(s).next(o=>{if(o===null)throw J();Z(o.userId===this.userId),i.push(Yr(this.serializer,o))}))}),B.waitFor(r).next(()=>i)}removeMutationBatch(t,e){return pb(t._e,this.userId,e).next(i=>(t.addOnCommittedListener(()=>{this.On(e.batchId)}),B.forEach(i,r=>this.referenceDelegate.markPotentiallyOrphaned(t,r))))}On(t){delete this.Fn[t]}performConsistencyCheck(t){return this.checkEmpty(t).next(e=>{if(!e)return B.resolve();let i=IDBKeyRange.lowerBound(function(o){return[o]}(this.userId)),r=[];return eo(t).J({range:i},(s,o,a)=>{if(s[0]===this.userId){let c=qn(s[1]);r.push(c)}else a.done()}).next(()=>{Z(r.length===0)})})}containsKey(t,e){return gb(t,this.userId,e)}Nn(t){return mb(t).get(this.userId).next(e=>e||{userId:this.userId,lastAcknowledgedBatchId:-1,lastStreamToken:""})}};function gb(n,t,e){let i=Ul(t,e.path),r=i[1],s=IDBKeyRange.lowerBound(i),o=!1;return eo(n).J({range:s,H:!0},(a,c,l)=>{let[h,d,p]=a;h===t&&d===r&&(o=!0),l.done()}).next(()=>o)}function Ki(n){return he(n,"mutations")}function eo(n){return he(n,"documentMutations")}function mb(n){return he(n,"mutationQueues")}var go=class n{constructor(t){this.Ln=t}next(){return this.Ln+=2,this.Ln}static Bn(){return new n(0)}static kn(){return new n(-1)}};var cp=class{constructor(t,e){this.referenceDelegate=t,this.serializer=e}allocateTargetId(t){return this.qn(t).next(e=>{let i=new go(e.highestTargetId);return e.highestTargetId=i.next(),this.Qn(t,e).next(()=>e.highestTargetId)})}getLastRemoteSnapshotVersion(t){return this.qn(t).next(e=>it.fromTimestamp(new Ut(e.lastRemoteSnapshotVersion.seconds,e.lastRemoteSnapshotVersion.nanoseconds)))}getHighestSequenceNumber(t){return this.qn(t).next(e=>e.highestListenSequenceNumber)}setTargetsMetadata(t,e,i){return this.qn(t).next(r=>(r.highestListenSequenceNumber=e,i&&(r.lastRemoteSnapshotVersion=i.toTimestamp()),e>r.highestListenSequenceNumber&&(r.highestListenSequenceNumber=e),this.Qn(t,r)))}addTargetData(t,e){return this.Kn(t,e).next(()=>this.qn(t).next(i=>(i.targetCount+=1,this.$n(e,i),this.Qn(t,i))))}updateTargetData(t,e){return this.Kn(t,e)}removeTargetData(t,e){return this.removeMatchingKeysForTargetId(t,e.targetId).next(()=>Qs(t).delete(e.targetId)).next(()=>this.qn(t)).next(i=>(Z(i.targetCount>0),i.targetCount-=1,this.Qn(t,i)))}removeTargets(t,e,i){let r=0,s=[];return Qs(t).J((o,a)=>{let c=za(a);c.sequenceNumber<=e&&i.get(c.targetId)===null&&(r++,s.push(this.removeTargetData(t,c)))}).next(()=>B.waitFor(s)).next(()=>r)}forEachTarget(t,e){return Qs(t).J((i,r)=>{let s=za(r);e(s)})}qn(t){return K0(t).get("targetGlobalKey").next(e=>(Z(e!==null),e))}Qn(t,e){return K0(t).put("targetGlobalKey",e)}Kn(t,e){return Qs(t).put(hb(this.serializer,e))}$n(t,e){let i=!1;return t.targetId>e.highestTargetId&&(e.highestTargetId=t.targetId,i=!0),t.sequenceNumber>e.highestListenSequenceNumber&&(e.highestListenSequenceNumber=t.sequenceNumber,i=!0),i}getTargetCount(t){return this.qn(t).next(e=>e.targetCount)}getTargetData(t,e){let i=is(e),r=IDBKeyRange.bound([i,Number.NEGATIVE_INFINITY],[i,Number.POSITIVE_INFINITY]),s=null;return Qs(t).J({range:r,index:"queryTargetsIndex"},(o,a,c)=>{let l=za(a);mc(e,l.target)&&(s=l,c.done())}).next(()=>s)}addMatchingKeys(t,e,i){let r=[],s=Yi(t);return e.forEach(o=>{let a=ze(o.path);r.push(s.put({targetId:i,path:a})),r.push(this.referenceDelegate.addReference(t,i,o))}),B.waitFor(r)}removeMatchingKeys(t,e,i){let r=Yi(t);return B.forEach(e,s=>{let o=ze(s.path);return B.waitFor([r.delete([i,o]),this.referenceDelegate.removeReference(t,i,s)])})}removeMatchingKeysForTargetId(t,e){let i=Yi(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return i.delete(r)}getMatchingKeysForTargetId(t,e){let i=IDBKeyRange.bound([e],[e+1],!1,!0),r=Yi(t),s=lt();return r.J({range:i,H:!0},(o,a,c)=>{let l=qn(o[1]),h=new K(l);s=s.add(h)}).next(()=>s)}containsKey(t,e){let i=ze(e.path),r=IDBKeyRange.bound([i],[gv(i)],!1,!0),s=0;return Yi(t).J({index:"documentTargetsIndex",H:!0,range:r},([o,a],c,l)=>{o!==0&&(s++,l.done())}).next(()=>s>0)}ot(t,e){return Qs(t).get(e).next(i=>i?za(i):null)}};function Qs(n){return he(n,"targets")}function K0(n){return he(n,"targetGlobal")}function Yi(n){return he(n,"targetDocuments")}function Y0([n,t],[e,i]){let r=at(n,e);return r===0?at(t,i):r}var lp=class{constructor(t){this.Un=t,this.buffer=new It(Y0),this.Wn=0}Gn(){return++this.Wn}zn(t){let e=[t,this.Gn()];if(this.buffer.size<this.Un)this.buffer=this.buffer.add(e);else{let i=this.buffer.last();Y0(e,i)<0&&(this.buffer=this.buffer.delete(i).add(e))}}get maxValue(){return this.buffer.last()[0]}},up=class{constructor(t,e,i){this.garbageCollector=t,this.asyncQueue=e,this.localStore=i,this.jn=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.Hn(6e4)}stop(){this.jn&&(this.jn.cancel(),this.jn=null)}get started(){return this.jn!==null}Hn(t){H("LruGarbageCollector",`Garbage collection scheduled in ${t}ms`),this.jn=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",t,()=>U(this,null,function*(){this.jn=null;try{yield this.localStore.collectGarbage(this.garbageCollector)}catch(e){ur(e)?H("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",e):yield lr(e)}yield this.Hn(3e5)}))}},hp=class{constructor(t,e){this.Jn=t,this.params=e}calculateTargetCount(t,e){return this.Jn.Yn(t).next(i=>Math.floor(e/100*i))}nthSequenceNumber(t,e){if(e===0)return B.resolve(an.oe);let i=new lp(e);return this.Jn.forEachTarget(t,r=>i.zn(r.sequenceNumber)).next(()=>this.Jn.Zn(t,r=>i.zn(r))).next(()=>i.maxValue)}removeTargets(t,e,i){return this.Jn.removeTargets(t,e,i)}removeOrphanedDocuments(t,e){return this.Jn.removeOrphanedDocuments(t,e)}collect(t,e){return this.params.cacheSizeCollectionThreshold===-1?(H("LruGarbageCollector","Garbage collection skipped; disabled"),B.resolve($0)):this.getCacheSize(t).next(i=>i<this.params.cacheSizeCollectionThreshold?(H("LruGarbageCollector",`Garbage collection skipped; Cache size ${i} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),$0):this.Xn(t,e))}getCacheSize(t){return this.Jn.getCacheSize(t)}Xn(t,e){let i,r,s,o,a,c,l,h=Date.now();return this.calculateTargetCount(t,this.params.percentileToCollect).next(d=>(d>this.params.maximumSequenceNumbersToCollect?(H("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${d}`),r=this.params.maximumSequenceNumbersToCollect):r=d,o=Date.now(),this.nthSequenceNumber(t,r))).next(d=>(i=d,a=Date.now(),this.removeTargets(t,i,e))).next(d=>(s=d,c=Date.now(),this.removeOrphanedDocuments(t,i))).next(d=>(l=Date.now(),Xs()<=Un.DEBUG&&H("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${o-h}ms
	Determined least recently used ${r} in `+(a-o)+`ms
	Removed ${s} targets in `+(c-a)+`ms
	Removed ${d} documents in `+(l-c)+`ms
Total Duration: ${l-h}ms`),B.resolve({didRun:!0,sequenceNumbersCollected:r,targetsRemoved:s,documentsRemoved:d})))}};function OA(n,t){return new hp(n,t)}var dp=class{constructor(t,e){this.db=t,this.garbageCollector=OA(this,e)}Yn(t){let e=this.er(t);return this.db.getTargetCache().getTargetCount(t).next(i=>e.next(r=>i+r))}er(t){let e=0;return this.Zn(t,i=>{e++}).next(()=>e)}forEachTarget(t,e){return this.db.getTargetCache().forEachTarget(t,e)}Zn(t,e){return this.tr(t,(i,r)=>e(r))}addReference(t,e,i){return Bl(t,i)}removeReference(t,e,i){return Bl(t,i)}removeTargets(t,e,i){return this.db.getTargetCache().removeTargets(t,e,i)}markPotentiallyOrphaned(t,e){return Bl(t,e)}nr(t,e){return function(r,s){let o=!1;return mb(r).Y(a=>gb(r,a,s).next(c=>(c&&(o=!0),B.resolve(!c)))).next(()=>o)}(t,e)}removeOrphanedDocuments(t,e){let i=this.db.getRemoteDocumentCache().newChangeBuffer(),r=[],s=0;return this.tr(t,(o,a)=>{if(a<=e){let c=this.nr(t,o).next(l=>{if(!l)return s++,i.getEntry(t,o).next(()=>(i.removeEntry(o,it.min()),Yi(t).delete(function(d){return[0,ze(d.path)]}(o))))});r.push(c)}}).next(()=>B.waitFor(r)).next(()=>i.apply(t)).next(()=>s)}removeTarget(t,e){let i=e.withSequenceNumber(t.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(t,i)}updateLimboDocument(t,e){return Bl(t,e)}tr(t,e){let i=Yi(t),r,s=an.oe;return i.J({index:"documentTargetsIndex"},([o,a],{path:c,sequenceNumber:l})=>{o===0?(s!==an.oe&&e(new K(qn(r)),s),s=l,r=c):s=an.oe}).next(()=>{s!==an.oe&&e(new K(qn(r)),s)})}getCacheSize(t){return this.db.getRemoteDocumentCache().getSize(t)}};function Bl(n,t){return Yi(n).put(function(i,r){return{targetId:0,path:ze(i.path),sequenceNumber:r}}(t,n.currentSequenceNumber))}var mu=class{constructor(){this.changes=new Qn(t=>t.toString(),(t,e)=>t.isEqual(e)),this.changesApplied=!1}addEntry(t){this.assertNotApplied(),this.changes.set(t.key,t)}removeEntry(t,e){this.assertNotApplied(),this.changes.set(t,oe.newInvalidDocument(t).setReadTime(e))}getEntry(t,e){this.assertNotApplied();let i=this.changes.get(e);return i!==void 0?B.resolve(i):this.getFromCache(t,e)}getEntries(t,e){return this.getAllFromCache(t,e)}apply(t){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(t)}assertNotApplied(){}};var fp=class{constructor(t){this.serializer=t}setIndexManager(t){this.indexManager=t}addEntry(t,e,i){return Gr(t).put(i)}removeEntry(t,e,i){return Gr(t).delete(function(s,o){let a=s.path.toArray();return[a.slice(0,a.length-2),a[a.length-2],uu(o),a[a.length-1]]}(e,i))}updateMetadata(t,e){return this.getMetadata(t).next(i=>(i.byteSize+=e,this.rr(t,i)))}getEntry(t,e){let i=oe.newInvalidDocument(e);return Gr(t).J({index:"documentKeyIndex",range:IDBKeyRange.only(Fa(e))},(r,s)=>{i=this.ir(e,s)}).next(()=>i)}sr(t,e){let i={size:0,document:oe.newInvalidDocument(e)};return Gr(t).J({index:"documentKeyIndex",range:IDBKeyRange.only(Fa(e))},(r,s)=>{i={document:this.ir(e,s),size:pu(s)}}).next(()=>i)}getEntries(t,e){let i=Ye();return this._r(t,e,(r,s)=>{let o=this.ir(r,s);i=i.insert(r,o)}).next(()=>i)}ar(t,e){let i=Ye(),r=new Vt(K.comparator);return this._r(t,e,(s,o)=>{let a=this.ir(s,o);i=i.insert(s,a),r=r.insert(s,pu(o))}).next(()=>({documents:i,ur:r}))}_r(t,e,i){if(e.isEmpty())return B.resolve();let r=new It(J0);e.forEach(c=>r=r.add(c));let s=IDBKeyRange.bound(Fa(r.first()),Fa(r.last())),o=r.getIterator(),a=o.getNext();return Gr(t).J({index:"documentKeyIndex",range:s},(c,l,h)=>{let d=K.fromSegments([...l.prefixPath,l.collectionGroup,l.documentId]);for(;a&&J0(a,d)<0;)i(a,null),a=o.getNext();a&&a.isEqual(d)&&(i(a,l),a=o.hasNext()?o.getNext():null),a?h.$(Fa(a)):h.done()}).next(()=>{for(;a;)i(a,null),a=o.hasNext()?o.getNext():null})}getDocumentsMatchingQuery(t,e,i,r,s){let o=e.path,a=[o.popLast().toArray(),o.lastSegment(),uu(i.readTime),i.documentKey.path.isEmpty()?"":i.documentKey.path.lastSegment()],c=[o.popLast().toArray(),o.lastSegment(),[Number.MAX_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],""];return Gr(t).U(IDBKeyRange.bound(a,c,!0)).next(l=>{s?.incrementDocumentReadCount(l.length);let h=Ye();for(let d of l){let p=this.ir(K.fromSegments(d.prefixPath.concat(d.collectionGroup,d.documentId)),d);p.isFoundDocument()&&(yc(e,p)||r.has(p.key))&&(h=h.insert(p.key,p))}return h})}getAllFromCollectionGroup(t,e,i,r){let s=Ye(),o=X0(e,i),a=X0(e,vn.max());return Gr(t).J({index:"collectionGroupIndex",range:IDBKeyRange.bound(o,a,!0)},(c,l,h)=>{let d=this.ir(K.fromSegments(l.prefixPath.concat(l.collectionGroup,l.documentId)),l);s=s.insert(d.key,d),s.size===r&&h.done()}).next(()=>s)}newChangeBuffer(t){return new pp(this,!!t&&t.trackRemovals)}getSize(t){return this.getMetadata(t).next(e=>e.byteSize)}getMetadata(t){return Q0(t).get("remoteDocumentGlobalKey").next(e=>(Z(!!e),e))}rr(t,e){return Q0(t).put("remoteDocumentGlobalKey",e)}ir(t,e){if(e){let i=RA(this.serializer,e);if(!(i.isNoDocument()&&i.version.isEqual(it.min())))return i}return oe.newInvalidDocument(t)}};function _b(n){return new fp(n)}var pp=class extends mu{constructor(t,e){super(),this.cr=t,this.trackRemovals=e,this.lr=new Qn(i=>i.toString(),(i,r)=>i.isEqual(r))}applyChanges(t){let e=[],i=0,r=new It((s,o)=>at(s.canonicalString(),o.canonicalString()));return this.changes.forEach((s,o)=>{let a=this.lr.get(s);if(e.push(this.cr.removeEntry(t,s,a.readTime)),o.isValidDocument()){let c=F0(this.cr.serializer,o);r=r.add(s.path.popLast());let l=pu(c);i+=l-a.size,e.push(this.cr.addEntry(t,s,c))}else if(i-=a.size,this.trackRemovals){let c=F0(this.cr.serializer,o.convertToNoDocument(it.min()));e.push(this.cr.addEntry(t,s,c))}}),r.forEach(s=>{e.push(this.cr.indexManager.addToCollectionParentIndex(t,s))}),e.push(this.cr.updateMetadata(t,i)),B.waitFor(e)}getFromCache(t,e){return this.cr.sr(t,e).next(i=>(this.lr.set(e,{size:i.size,readTime:i.document.readTime}),i.document))}getAllFromCache(t,e){return this.cr.ar(t,e).next(({documents:i,ur:r})=>(r.forEach((s,o)=>{this.lr.set(s,{size:o,readTime:i.get(s).readTime})}),i))}};function Q0(n){return he(n,"remoteDocumentGlobal")}function Gr(n){return he(n,"remoteDocumentsV14")}function Fa(n){let t=n.path.toArray();return[t.slice(0,t.length-2),t[t.length-2],t[t.length-1]]}function X0(n,t){let e=t.documentKey.path.toArray();return[n,uu(t.readTime),e.slice(0,e.length-2),e.length>0?e[e.length-1]:""]}function J0(n,t){let e=n.path.toArray(),i=t.path.toArray(),r=0;for(let s=0;s<e.length-2&&s<i.length-2;++s)if(r=at(e[s],i[s]),r)return r;return r=at(e.length,i.length),r||(r=at(e[e.length-2],i[i.length-2]),r||at(e[e.length-1],i[i.length-1]))}var gp=class{constructor(t,e){this.overlayedDocument=t,this.mutatedFields=e}};var _u=class{constructor(t,e,i,r){this.remoteDocumentCache=t,this.mutationQueue=e,this.documentOverlayCache=i,this.indexManager=r}getDocument(t,e){let i=null;return this.documentOverlayCache.getOverlay(t,e).next(r=>(i=r,this.remoteDocumentCache.getEntry(t,e))).next(r=>(i!==null&&qa(i.mutation,r,cn.empty(),Ut.now()),r))}getDocuments(t,e){return this.remoteDocumentCache.getEntries(t,e).next(i=>this.getLocalViewOfDocuments(t,i,lt()).next(()=>i))}getLocalViewOfDocuments(t,e,i=lt()){let r=Wn();return this.populateOverlays(t,r,e).next(()=>this.computeViews(t,e,r,i).next(s=>{let o=Ba();return s.forEach((a,c)=>{o=o.insert(a,c.overlayedDocument)}),o}))}getOverlayedDocuments(t,e){let i=Wn();return this.populateOverlays(t,i,e).next(()=>this.computeViews(t,e,i,lt()))}populateOverlays(t,e,i){let r=[];return i.forEach(s=>{e.has(s)||r.push(s)}),this.documentOverlayCache.getOverlays(t,r).next(s=>{s.forEach((o,a)=>{e.set(o,a)})})}computeViews(t,e,i,r){let s=Ye(),o=Ua(),a=function(){return Ua()}();return e.forEach((c,l)=>{let h=i.get(l.key);r.has(l.key)&&(h===void 0||h.mutation instanceof On)?s=s.insert(l.key,l):h!==void 0?(o.set(l.key,h.mutation.getFieldMask()),qa(h.mutation,l,h.mutation.getFieldMask(),Ut.now())):o.set(l.key,cn.empty())}),this.recalculateAndSaveOverlays(t,s).next(c=>(c.forEach((l,h)=>o.set(l,h)),e.forEach((l,h)=>{var d;return a.set(l,new gp(h,(d=o.get(l))!==null&&d!==void 0?d:null))}),a))}recalculateAndSaveOverlays(t,e){let i=Ua(),r=new Vt((o,a)=>o-a),s=lt();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(t,e).next(o=>{for(let a of o)a.keys().forEach(c=>{let l=e.get(c);if(l===null)return;let h=i.get(c)||cn.empty();h=a.applyToLocalView(l,h),i.set(c,h);let d=(r.get(a.batchId)||lt()).add(c);r=r.insert(a.batchId,d)})}).next(()=>{let o=[],a=r.getReverseIterator();for(;a.hasNext();){let c=a.getNext(),l=c.key,h=c.value,d=jv();h.forEach(p=>{if(!s.has(p)){let g=Kv(e.get(p),i.get(p));g!==null&&d.set(p,g),s=s.add(p)}}),o.push(this.documentOverlayCache.saveOverlays(t,l,d))}return B.waitFor(o)}).next(()=>i)}recalculateAndSaveOverlaysForDocumentKeys(t,e){return this.remoteDocumentCache.getEntries(t,e).next(i=>this.recalculateAndSaveOverlays(t,i))}getDocumentsMatchingQuery(t,e,i,r){return function(o){return K.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(e)?this.getDocumentsMatchingDocumentQuery(t,e.path):wg(e)?this.getDocumentsMatchingCollectionGroupQuery(t,e,i,r):this.getDocumentsMatchingCollectionQuery(t,e,i,r)}getNextDocuments(t,e,i,r){return this.remoteDocumentCache.getAllFromCollectionGroup(t,e,i,r).next(s=>{let o=r-s.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(t,e,i.largestBatchId,r-s.size):B.resolve(Wn()),a=-1,c=s;return o.next(l=>B.forEach(l,(h,d)=>(a<d.largestBatchId&&(a=d.largestBatchId),s.get(h)?B.resolve():this.remoteDocumentCache.getEntry(t,h).next(p=>{c=c.insert(h,p)}))).next(()=>this.populateOverlays(t,l,s)).next(()=>this.computeViews(t,c,l,lt())).next(h=>({batchId:a,changes:zv(h)})))})}getDocumentsMatchingDocumentQuery(t,e){return this.getDocument(t,new K(e)).next(i=>{let r=Ba();return i.isFoundDocument()&&(r=r.insert(i.key,i)),r})}getDocumentsMatchingCollectionGroupQuery(t,e,i,r){let s=e.collectionGroup,o=Ba();return this.indexManager.getCollectionParents(t,s).next(a=>B.forEach(a,c=>{let l=function(d,p){return new Mn(p,null,d.explicitOrderBy.slice(),d.filters.slice(),d.limit,d.limitType,d.startAt,d.endAt)}(e,c.child(s));return this.getDocumentsMatchingCollectionQuery(t,l,i,r).next(h=>{h.forEach((d,p)=>{o=o.insert(d,p)})})}).next(()=>o))}getDocumentsMatchingCollectionQuery(t,e,i,r){let s;return this.documentOverlayCache.getOverlaysForCollection(t,e.path,i.largestBatchId).next(o=>(s=o,this.remoteDocumentCache.getDocumentsMatchingQuery(t,e,i,s,r))).next(o=>{s.forEach((c,l)=>{let h=l.getKey();o.get(h)===null&&(o=o.insert(h,oe.newInvalidDocument(h)))});let a=Ba();return o.forEach((c,l)=>{let h=s.get(c);h!==void 0&&qa(h.mutation,l,cn.empty(),Ut.now()),yc(e,l)&&(a=a.insert(c,l))}),a})}};var mp=class{constructor(t){this.serializer=t,this.hr=new Map,this.Pr=new Map}getBundleMetadata(t,e){return B.resolve(this.hr.get(e))}saveBundleMetadata(t,e){return this.hr.set(e.id,function(r){return{id:r.id,version:r.version,createTime:Jt(r.createTime)}}(e)),B.resolve()}getNamedQuery(t,e){return B.resolve(this.Pr.get(e))}saveNamedQuery(t,e){return this.Pr.set(e.name,function(r){return{name:r.name,query:Sg(r.bundledQuery),readTime:Jt(r.readTime)}}(e)),B.resolve()}};var _p=class{constructor(){this.overlays=new Vt(K.comparator),this.Ir=new Map}getOverlay(t,e){return B.resolve(this.overlays.get(e))}getOverlays(t,e){let i=Wn();return B.forEach(e,r=>this.getOverlay(t,r).next(s=>{s!==null&&i.set(r,s)})).next(()=>i)}saveOverlays(t,e,i){return i.forEach((r,s)=>{this.ht(t,e,s)}),B.resolve()}removeOverlaysForBatchId(t,e,i){let r=this.Ir.get(i);return r!==void 0&&(r.forEach(s=>this.overlays=this.overlays.remove(s)),this.Ir.delete(i)),B.resolve()}getOverlaysForCollection(t,e,i){let r=Wn(),s=e.length+1,o=new K(e.child("")),a=this.overlays.getIteratorFrom(o);for(;a.hasNext();){let c=a.getNext().value,l=c.getKey();if(!e.isPrefixOf(l.path))break;l.path.length===s&&c.largestBatchId>i&&r.set(c.getKey(),c)}return B.resolve(r)}getOverlaysForCollectionGroup(t,e,i,r){let s=new Vt((l,h)=>l-h),o=this.overlays.getIterator();for(;o.hasNext();){let l=o.getNext().value;if(l.getKey().getCollectionGroup()===e&&l.largestBatchId>i){let h=s.get(l.largestBatchId);h===null&&(h=Wn(),s=s.insert(l.largestBatchId,h)),h.set(l.getKey(),l)}}let a=Wn(),c=s.getIterator();for(;c.hasNext()&&(c.getNext().value.forEach((l,h)=>a.set(l,h)),!(a.size()>=r)););return B.resolve(a)}ht(t,e,i){let r=this.overlays.get(i.key);if(r!==null){let o=this.Ir.get(r.largestBatchId).delete(i.key);this.Ir.set(r.largestBatchId,o)}this.overlays=this.overlays.insert(i.key,new tc(e,i));let s=this.Ir.get(e);s===void 0&&(s=lt(),this.Ir.set(e,s)),this.Ir.set(e,s.add(i.key))}};var yp=class{constructor(){this.sessionToken=Zt.EMPTY_BYTE_STRING}getSessionToken(t){return B.resolve(this.sessionToken)}setSessionToken(t,e){return this.sessionToken=e,B.resolve()}};var oc=class{constructor(){this.Tr=new It(ie.Er),this.dr=new It(ie.Ar)}isEmpty(){return this.Tr.isEmpty()}addReference(t,e){let i=new ie(t,e);this.Tr=this.Tr.add(i),this.dr=this.dr.add(i)}Rr(t,e){t.forEach(i=>this.addReference(i,e))}removeReference(t,e){this.Vr(new ie(t,e))}mr(t,e){t.forEach(i=>this.removeReference(i,e))}gr(t){let e=new K(new mt([])),i=new ie(e,t),r=new ie(e,t+1),s=[];return this.dr.forEachInRange([i,r],o=>{this.Vr(o),s.push(o.key)}),s}pr(){this.Tr.forEach(t=>this.Vr(t))}Vr(t){this.Tr=this.Tr.delete(t),this.dr=this.dr.delete(t)}yr(t){let e=new K(new mt([])),i=new ie(e,t),r=new ie(e,t+1),s=lt();return this.dr.forEachInRange([i,r],o=>{s=s.add(o.key)}),s}containsKey(t){let e=new ie(t,0),i=this.Tr.firstAfterOrEqual(e);return i!==null&&t.isEqual(i.key)}},ie=class{constructor(t,e){this.key=t,this.wr=e}static Er(t,e){return K.comparator(t.key,e.key)||at(t.wr,e.wr)}static Ar(t,e){return at(t.wr,e.wr)||K.comparator(t.key,e.key)}};var vp=class{constructor(t,e){this.indexManager=t,this.referenceDelegate=e,this.mutationQueue=[],this.Sr=1,this.br=new It(ie.Er)}checkEmpty(t){return B.resolve(this.mutationQueue.length===0)}addMutationBatch(t,e,i,r){let s=this.Sr;this.Sr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];let o=new Za(s,e,i,r);this.mutationQueue.push(o);for(let a of r)this.br=this.br.add(new ie(a.key,s)),this.indexManager.addToCollectionParentIndex(t,a.key.path.popLast());return B.resolve(o)}lookupMutationBatch(t,e){return B.resolve(this.Dr(e))}getNextMutationBatchAfterBatchId(t,e){let i=e+1,r=this.vr(i),s=r<0?0:r;return B.resolve(this.mutationQueue.length>s?this.mutationQueue[s]:null)}getHighestUnacknowledgedBatchId(){return B.resolve(this.mutationQueue.length===0?-1:this.Sr-1)}getAllMutationBatches(t){return B.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(t,e){let i=new ie(e,0),r=new ie(e,Number.POSITIVE_INFINITY),s=[];return this.br.forEachInRange([i,r],o=>{let a=this.Dr(o.wr);s.push(a)}),B.resolve(s)}getAllMutationBatchesAffectingDocumentKeys(t,e){let i=new It(at);return e.forEach(r=>{let s=new ie(r,0),o=new ie(r,Number.POSITIVE_INFINITY);this.br.forEachInRange([s,o],a=>{i=i.add(a.wr)})}),B.resolve(this.Cr(i))}getAllMutationBatchesAffectingQuery(t,e){let i=e.path,r=i.length+1,s=i;K.isDocumentKey(s)||(s=s.child(""));let o=new ie(new K(s),0),a=new It(at);return this.br.forEachWhile(c=>{let l=c.key.path;return!!i.isPrefixOf(l)&&(l.length===r&&(a=a.add(c.wr)),!0)},o),B.resolve(this.Cr(a))}Cr(t){let e=[];return t.forEach(i=>{let r=this.Dr(i);r!==null&&e.push(r)}),e}removeMutationBatch(t,e){Z(this.Fr(e.batchId,"removed")===0),this.mutationQueue.shift();let i=this.br;return B.forEach(e.mutations,r=>{let s=new ie(r.key,e.batchId);return i=i.delete(s),this.referenceDelegate.markPotentiallyOrphaned(t,r.key)}).next(()=>{this.br=i})}On(t){}containsKey(t,e){let i=new ie(e,0),r=this.br.firstAfterOrEqual(i);return B.resolve(e.isEqual(r&&r.key))}performConsistencyCheck(t){return this.mutationQueue.length,B.resolve()}Fr(t,e){return this.vr(t)}vr(t){return this.mutationQueue.length===0?0:t-this.mutationQueue[0].batchId}Dr(t){let e=this.vr(t);return e<0||e>=this.mutationQueue.length?null:this.mutationQueue[e]}};var bp=class{constructor(t){this.Mr=t,this.docs=function(){return new Vt(K.comparator)}(),this.size=0}setIndexManager(t){this.indexManager=t}addEntry(t,e){let i=e.key,r=this.docs.get(i),s=r?r.size:0,o=this.Mr(e);return this.docs=this.docs.insert(i,{document:e.mutableCopy(),size:o}),this.size+=o-s,this.indexManager.addToCollectionParentIndex(t,i.path.popLast())}removeEntry(t){let e=this.docs.get(t);e&&(this.docs=this.docs.remove(t),this.size-=e.size)}getEntry(t,e){let i=this.docs.get(e);return B.resolve(i?i.document.mutableCopy():oe.newInvalidDocument(e))}getEntries(t,e){let i=Ye();return e.forEach(r=>{let s=this.docs.get(r);i=i.insert(r,s?s.document.mutableCopy():oe.newInvalidDocument(r))}),B.resolve(i)}getDocumentsMatchingQuery(t,e,i,r){let s=Ye(),o=e.path,a=new K(o.child("")),c=this.docs.getIteratorFrom(a);for(;c.hasNext();){let{key:l,value:{document:h}}=c.getNext();if(!o.isPrefixOf(l.path))break;l.path.length>o.length+1||_g(_v(h),i)<=0||(r.has(h.key)||yc(e,h))&&(s=s.insert(h.key,h.mutableCopy()))}return B.resolve(s)}getAllFromCollectionGroup(t,e,i,r){J()}Or(t,e){return B.forEach(this.docs,i=>e(i))}newChangeBuffer(t){return new xp(this)}getSize(t){return B.resolve(this.size)}},xp=class extends mu{constructor(t){super(),this.cr=t}applyChanges(t){let e=[];return this.changes.forEach((i,r)=>{r.isValidDocument()?e.push(this.cr.addEntry(t,r)):this.cr.removeEntry(i)}),B.waitFor(e)}getFromCache(t,e){return this.cr.getEntry(t,e)}getAllFromCache(t,e){return this.cr.getEntries(t,e)}};var wp=class{constructor(t){this.persistence=t,this.Nr=new Qn(e=>is(e),mc),this.lastRemoteSnapshotVersion=it.min(),this.highestTargetId=0,this.Lr=0,this.Br=new oc,this.targetCount=0,this.kr=go.Bn()}forEachTarget(t,e){return this.Nr.forEach((i,r)=>e(r)),B.resolve()}getLastRemoteSnapshotVersion(t){return B.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(t){return B.resolve(this.Lr)}allocateTargetId(t){return this.highestTargetId=this.kr.next(),B.resolve(this.highestTargetId)}setTargetsMetadata(t,e,i){return i&&(this.lastRemoteSnapshotVersion=i),e>this.Lr&&(this.Lr=e),B.resolve()}Kn(t){this.Nr.set(t.target,t);let e=t.targetId;e>this.highestTargetId&&(this.kr=new go(e),this.highestTargetId=e),t.sequenceNumber>this.Lr&&(this.Lr=t.sequenceNumber)}addTargetData(t,e){return this.Kn(e),this.targetCount+=1,B.resolve()}updateTargetData(t,e){return this.Kn(e),B.resolve()}removeTargetData(t,e){return this.Nr.delete(e.target),this.Br.gr(e.targetId),this.targetCount-=1,B.resolve()}removeTargets(t,e,i){let r=0,s=[];return this.Nr.forEach((o,a)=>{a.sequenceNumber<=e&&i.get(a.targetId)===null&&(this.Nr.delete(o),s.push(this.removeMatchingKeysForTargetId(t,a.targetId)),r++)}),B.waitFor(s).next(()=>r)}getTargetCount(t){return B.resolve(this.targetCount)}getTargetData(t,e){let i=this.Nr.get(e)||null;return B.resolve(i)}addMatchingKeys(t,e,i){return this.Br.Rr(e,i),B.resolve()}removeMatchingKeys(t,e,i){this.Br.mr(e,i);let r=this.persistence.referenceDelegate,s=[];return r&&e.forEach(o=>{s.push(r.markPotentiallyOrphaned(t,o))}),B.waitFor(s)}removeMatchingKeysForTargetId(t,e){return this.Br.gr(e),B.resolve()}getMatchingKeysForTargetId(t,e){let i=this.Br.yr(e);return B.resolve(i)}containsKey(t,e){return B.resolve(this.Br.containsKey(e))}};var yu=class{constructor(t,e){this.qr={},this.overlays={},this.Qr=new an(0),this.Kr=!1,this.Kr=!0,this.$r=new yp,this.referenceDelegate=t(this),this.Ur=new wp(this),this.indexManager=new op,this.remoteDocumentCache=function(r){return new bp(r)}(i=>this.referenceDelegate.Wr(i)),this.serializer=new lu(e),this.Gr=new mp(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.Kr=!1,Promise.resolve()}get started(){return this.Kr}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(t){return this.indexManager}getDocumentOverlayCache(t){let e=this.overlays[t.toKey()];return e||(e=new _p,this.overlays[t.toKey()]=e),e}getMutationQueue(t,e){let i=this.qr[t.toKey()];return i||(i=new vp(e,this.referenceDelegate),this.qr[t.toKey()]=i),i}getGlobalsCache(){return this.$r}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Gr}runTransaction(t,e,i){H("MemoryPersistence","Starting transaction:",t);let r=new Tp(this.Qr.next());return this.referenceDelegate.zr(),i(r).next(s=>this.referenceDelegate.jr(r).next(()=>s)).toPromise().then(s=>(r.raiseOnCommittedEvent(),s))}Hr(t,e){return B.or(Object.values(this.qr).map(i=>()=>i.containsKey(t,e)))}},Tp=class extends Xl{constructor(t){super(),this.currentSequenceNumber=t}},vu=class n{constructor(t){this.persistence=t,this.Jr=new oc,this.Yr=null}static Zr(t){return new n(t)}get Xr(){if(this.Yr)return this.Yr;throw J()}addReference(t,e,i){return this.Jr.addReference(i,e),this.Xr.delete(i.toString()),B.resolve()}removeReference(t,e,i){return this.Jr.removeReference(i,e),this.Xr.add(i.toString()),B.resolve()}markPotentiallyOrphaned(t,e){return this.Xr.add(e.toString()),B.resolve()}removeTarget(t,e){this.Jr.gr(e.targetId).forEach(r=>this.Xr.add(r.toString()));let i=this.persistence.getTargetCache();return i.getMatchingKeysForTargetId(t,e.targetId).next(r=>{r.forEach(s=>this.Xr.add(s.toString()))}).next(()=>i.removeTargetData(t,e))}zr(){this.Yr=new Set}jr(t){let e=this.persistence.getRemoteDocumentCache().newChangeBuffer();return B.forEach(this.Xr,i=>{let r=K.fromPath(i);return this.ei(t,r).next(s=>{s||e.removeEntry(r,it.min())})}).next(()=>(this.Yr=null,e.apply(t)))}updateLimboDocument(t,e){return this.ei(t,e).next(i=>{i?this.Xr.delete(e.toString()):this.Xr.add(e.toString())})}Wr(t){return 0}ei(t,e){return B.or([()=>B.resolve(this.Jr.containsKey(e)),()=>this.persistence.getTargetCache().containsKey(t,e),()=>this.persistence.Hr(t,e)])}};var Ep=class{constructor(t){this.serializer=t}O(t,e,i,r){let s=new Jl("createOrUpgrade",e);i<1&&r>=1&&(function(c){c.createObjectStore("owner")}(t),function(c){c.createObjectStore("mutationQueues",{keyPath:"userId"}),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",p0,{unique:!0}),c.createObjectStore("documentMutations")}(t),Z0(t),function(c){c.createObjectStore("remoteDocuments")}(t));let o=B.resolve();return i<3&&r>=3&&(i!==0&&(function(c){c.deleteObjectStore("targetDocuments"),c.deleteObjectStore("targets"),c.deleteObjectStore("targetGlobal")}(t),Z0(t)),o=o.next(()=>function(c){let l=c.store("targetGlobal"),h={highestTargetId:0,highestListenSequenceNumber:0,lastRemoteSnapshotVersion:it.min().toTimestamp(),targetCount:0};return l.put("targetGlobalKey",h)}(s))),i<4&&r>=4&&(i!==0&&(o=o.next(()=>function(c,l){return l.store("mutations").U().next(h=>{c.deleteObjectStore("mutations"),c.createObjectStore("mutations",{keyPath:"batchId",autoIncrement:!0}).createIndex("userMutationsIndex",p0,{unique:!0});let d=l.store("mutations"),p=h.map(g=>d.put(g));return B.waitFor(p)})}(t,s))),o=o.next(()=>{(function(c){c.createObjectStore("clientMetadata",{keyPath:"clientId"})})(t)})),i<5&&r>=5&&(o=o.next(()=>this.ni(s))),i<6&&r>=6&&(o=o.next(()=>(function(c){c.createObjectStore("remoteDocumentGlobal")}(t),this.ri(s)))),i<7&&r>=7&&(o=o.next(()=>this.ii(s))),i<8&&r>=8&&(o=o.next(()=>this.si(t,s))),i<9&&r>=9&&(o=o.next(()=>{(function(c){c.objectStoreNames.contains("remoteDocumentChanges")&&c.deleteObjectStore("remoteDocumentChanges")})(t)})),i<10&&r>=10&&(o=o.next(()=>this.oi(s))),i<11&&r>=11&&(o=o.next(()=>{(function(c){c.createObjectStore("bundles",{keyPath:"bundleId"})})(t),function(c){c.createObjectStore("namedQueries",{keyPath:"name"})}(t)})),i<12&&r>=12&&(o=o.next(()=>{(function(c){let l=c.createObjectStore("documentOverlays",{keyPath:XS});l.createIndex("collectionPathOverlayIndex",JS,{unique:!1}),l.createIndex("collectionGroupOverlayIndex",ZS,{unique:!1})})(t)})),i<13&&r>=13&&(o=o.next(()=>function(c){let l=c.createObjectStore("remoteDocumentsV14",{keyPath:zS});l.createIndex("documentKeyIndex",jS),l.createIndex("collectionGroupIndex",US)}(t)).next(()=>this._i(t,s)).next(()=>t.deleteObjectStore("remoteDocuments"))),i<14&&r>=14&&(o=o.next(()=>this.ai(t,s))),i<15&&r>=15&&(o=o.next(()=>function(c){c.createObjectStore("indexConfiguration",{keyPath:"indexId",autoIncrement:!0}).createIndex("collectionGroupIndex","collectionGroup",{unique:!1}),c.createObjectStore("indexState",{keyPath:$S}).createIndex("sequenceNumberIndex",KS,{unique:!1}),c.createObjectStore("indexEntries",{keyPath:YS}).createIndex("documentKeyIndex",QS,{unique:!1})}(t))),i<16&&r>=16&&(o=o.next(()=>{e.objectStore("indexState").clear()}).next(()=>{e.objectStore("indexEntries").clear()})),i<17&&r>=17&&(o=o.next(()=>{(function(c){c.createObjectStore("globals",{keyPath:"name"})})(t)})),o}ri(t){let e=0;return t.store("remoteDocuments").J((i,r)=>{e+=pu(r)}).next(()=>{let i={byteSize:e};return t.store("remoteDocumentGlobal").put("remoteDocumentGlobalKey",i)})}ni(t){let e=t.store("mutationQueues"),i=t.store("mutations");return e.U().next(r=>B.forEach(r,s=>{let o=IDBKeyRange.bound([s.userId,-1],[s.userId,s.lastAcknowledgedBatchId]);return i.U("userMutationsIndex",o).next(a=>B.forEach(a,c=>{Z(c.userId===s.userId);let l=Yr(this.serializer,c);return pb(t,s.userId,l).next(()=>{})}))}))}ii(t){let e=t.store("targetDocuments"),i=t.store("remoteDocuments");return t.store("targetGlobal").get("targetGlobalKey").next(r=>{let s=[];return i.J((o,a)=>{let c=new mt(o),l=function(d){return[0,ze(d)]}(c);s.push(e.get(l).next(h=>h?B.resolve():(d=>e.put({targetId:0,path:ze(d),sequenceNumber:r.highestListenSequenceNumber}))(c)))}).next(()=>B.waitFor(s))})}si(t,e){t.createObjectStore("collectionParents",{keyPath:GS});let i=e.store("collectionParents"),r=new sc,s=o=>{if(r.add(o)){let a=o.lastSegment(),c=o.popLast();return i.put({collectionId:a,parent:ze(c)})}};return e.store("remoteDocuments").J({H:!0},(o,a)=>{let c=new mt(o);return s(c.popLast())}).next(()=>e.store("documentMutations").J({H:!0},([o,a,c],l)=>{let h=qn(a);return s(h.popLast())}))}oi(t){let e=t.store("targets");return e.J((i,r)=>{let s=za(r),o=hb(this.serializer,s);return e.put(o)})}_i(t,e){let i=e.store("remoteDocuments"),r=[];return i.J((s,o)=>{let a=e.store("remoteDocumentsV14"),c=function(d){return d.document?new K(mt.fromString(d.document.name).popFirst(5)):d.noDocument?K.fromSegments(d.noDocument.path):d.unknownDocument?K.fromSegments(d.unknownDocument.path):J()}(o).path.toArray(),l={prefixPath:c.slice(0,c.length-2),collectionGroup:c[c.length-2],documentId:c[c.length-1],readTime:o.readTime||[0,0],unknownDocument:o.unknownDocument,noDocument:o.noDocument,document:o.document,hasCommittedMutations:!!o.hasCommittedMutations};r.push(a.put(l))}).next(()=>B.waitFor(r))}ai(t,e){let i=e.store("mutations"),r=_b(this.serializer),s=new yu(vu.Zr,this.serializer.ct);return i.U().next(o=>{let a=new Map;return o.forEach(c=>{var l;let h=(l=a.get(c.userId))!==null&&l!==void 0?l:lt();Yr(this.serializer,c).keys().forEach(d=>h=h.add(d)),a.set(c.userId,h)}),B.forEach(a,(c,l)=>{let h=new re(l),d=hu.lt(this.serializer,h),p=s.getIndexManager(h),g=gu.lt(h,this.serializer,p,s.referenceDelegate);return new _u(r,g,d,p).recalculateAndSaveOverlaysForDocumentKeys(new Ka(e,an.oe),c).next()})})}};function Z0(n){n.createObjectStore("targetDocuments",{keyPath:WS}).createIndex("documentTargetsIndex",HS,{unique:!0}),n.createObjectStore("targets",{keyPath:"targetId"}).createIndex("queryTargetsIndex",qS,{unique:!0}),n.createObjectStore("targetGlobal")}var ff="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",Ip=class n{constructor(t,e,i,r,s,o,a,c,l,h,d=17){if(this.allowTabSynchronization=t,this.persistenceKey=e,this.clientId=i,this.ui=s,this.window=o,this.document=a,this.ci=l,this.li=h,this.hi=d,this.Qr=null,this.Kr=!1,this.isPrimary=!1,this.networkEnabled=!0,this.Pi=null,this.inForeground=!1,this.Ii=null,this.Ti=null,this.Ei=Number.NEGATIVE_INFINITY,this.di=p=>Promise.resolve(),!n.D())throw new q(z.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new dp(this,r),this.Ai=e+"main",this.serializer=new lu(c),this.Ri=new tr(this.Ai,this.hi,new Ep(this.serializer)),this.$r=new Zf,this.Ur=new cp(this.referenceDelegate,this.serializer),this.remoteDocumentCache=_b(this.serializer),this.Gr=new Jf,this.window&&this.window.localStorage?this.Vi=this.window.localStorage:(this.Vi=null,h===!1&&Qt("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}start(){return this.mi().then(()=>{if(!this.isPrimary&&!this.allowTabSynchronization)throw new q(z.FAILED_PRECONDITION,ff);return this.fi(),this.gi(),this.pi(),this.runTransaction("getHighestListenSequenceNumber","readonly",t=>this.Ur.getHighestSequenceNumber(t))}).then(t=>{this.Qr=new an(t,this.ci)}).then(()=>{this.Kr=!0}).catch(t=>(this.Ri&&this.Ri.close(),Promise.reject(t)))}yi(t){return this.di=e=>U(this,null,function*(){if(this.started)return t(e)}),t(this.isPrimary)}setDatabaseDeletedListener(t){this.Ri.L(e=>U(this,null,function*(){e.newVersion===null&&(yield t())}))}setNetworkEnabled(t){this.networkEnabled!==t&&(this.networkEnabled=t,this.ui.enqueueAndForget(()=>U(this,null,function*(){this.started&&(yield this.mi())})))}mi(){return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",t=>zl(t).put({clientId:this.clientId,updateTimeMs:Date.now(),networkEnabled:this.networkEnabled,inForeground:this.inForeground}).next(()=>{if(this.isPrimary)return this.wi(t).next(e=>{e||(this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)))})}).next(()=>this.Si(t)).next(e=>this.isPrimary&&!e?this.bi(t).next(()=>!1):!!e&&this.Di(t).next(()=>!0))).catch(t=>{if(ur(t))return H("IndexedDbPersistence","Failed to extend owner lease: ",t),this.isPrimary;if(!this.allowTabSynchronization)throw t;return H("IndexedDbPersistence","Releasing owner lease after error during lease refresh",t),!1}).then(t=>{this.isPrimary!==t&&this.ui.enqueueRetryable(()=>this.di(t)),this.isPrimary=t})}wi(t){return La(t).get("owner").next(e=>B.resolve(this.vi(e)))}Ci(t){return zl(t).delete(this.clientId)}Fi(){return U(this,null,function*(){if(this.isPrimary&&!this.Mi(this.Ei,18e5)){this.Ei=Date.now();let t=yield this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",e=>{let i=he(e,"clientMetadata");return i.U().next(r=>{let s=this.xi(r,18e5),o=r.filter(a=>s.indexOf(a)===-1);return B.forEach(o,a=>i.delete(a.clientId)).next(()=>o)})}).catch(()=>[]);if(this.Vi)for(let e of t)this.Vi.removeItem(this.Oi(e.clientId))}})}pi(){this.Ti=this.ui.enqueueAfterDelay("client_metadata_refresh",4e3,()=>this.mi().then(()=>this.Fi()).then(()=>this.pi()))}vi(t){return!!t&&t.ownerId===this.clientId}Si(t){return this.li?B.resolve(!0):La(t).get("owner").next(e=>{if(e!==null&&this.Mi(e.leaseTimestampMs,5e3)&&!this.Ni(e.ownerId)){if(this.vi(e)&&this.networkEnabled)return!0;if(!this.vi(e)){if(!e.allowTabSynchronization)throw new q(z.FAILED_PRECONDITION,ff);return!1}}return!(!this.networkEnabled||!this.inForeground)||zl(t).U().next(i=>this.xi(i,5e3).find(r=>{if(this.clientId!==r.clientId){let s=!this.networkEnabled&&r.networkEnabled,o=!this.inForeground&&r.inForeground,a=this.networkEnabled===r.networkEnabled;if(s||o&&a)return!0}return!1})===void 0)}).next(e=>(this.isPrimary!==e&&H("IndexedDbPersistence",`Client ${e?"is":"is not"} eligible for a primary lease.`),e))}shutdown(){return U(this,null,function*(){this.Kr=!1,this.Li(),this.Ti&&(this.Ti.cancel(),this.Ti=null),this.Bi(),this.ki(),yield this.Ri.runTransaction("shutdown","readwrite",["owner","clientMetadata"],t=>{let e=new Ka(t,an.oe);return this.bi(e).next(()=>this.Ci(e))}),this.Ri.close(),this.qi()})}xi(t,e){return t.filter(i=>this.Mi(i.updateTimeMs,e)&&!this.Ni(i.clientId))}Qi(){return this.runTransaction("getActiveClients","readonly",t=>zl(t).U().next(e=>this.xi(e,18e5).map(i=>i.clientId)))}get started(){return this.Kr}getGlobalsCache(){return this.$r}getMutationQueue(t,e){return gu.lt(t,this.serializer,e,this.referenceDelegate)}getTargetCache(){return this.Ur}getRemoteDocumentCache(){return this.remoteDocumentCache}getIndexManager(t){return new ap(t,this.serializer.ct.databaseId)}getDocumentOverlayCache(t){return hu.lt(this.serializer,t)}getBundleCache(){return this.Gr}runTransaction(t,e,i){H("IndexedDbPersistence","Starting transaction:",t);let r=e==="readonly"?"readonly":"readwrite",s=function(c){return c===17?nA:c===16?eA:c===15?vg:c===14?Ev:c===13?Tv:c===12?tA:c===11?wv:void J()}(this.hi),o;return this.Ri.runTransaction(t,r,s,a=>(o=new Ka(a,this.Qr?this.Qr.next():an.oe),e==="readwrite-primary"?this.wi(o).next(c=>!!c||this.Si(o)).next(c=>{if(!c)throw Qt(`Failed to obtain primary lease for action '${t}'.`),this.isPrimary=!1,this.ui.enqueueRetryable(()=>this.di(!1)),new q(z.FAILED_PRECONDITION,yv);return i(o)}).next(c=>this.Di(o).next(()=>c)):this.Ki(o).next(()=>i(o)))).then(a=>(o.raiseOnCommittedEvent(),a))}Ki(t){return La(t).get("owner").next(e=>{if(e!==null&&this.Mi(e.leaseTimestampMs,5e3)&&!this.Ni(e.ownerId)&&!this.vi(e)&&!(this.li||this.allowTabSynchronization&&e.allowTabSynchronization))throw new q(z.FAILED_PRECONDITION,ff)})}Di(t){let e={ownerId:this.clientId,allowTabSynchronization:this.allowTabSynchronization,leaseTimestampMs:Date.now()};return La(t).put("owner",e)}static D(){return tr.D()}bi(t){let e=La(t);return e.get("owner").next(i=>this.vi(i)?(H("IndexedDbPersistence","Releasing primary lease."),e.delete("owner")):B.resolve())}Mi(t,e){let i=Date.now();return!(t<i-e)&&(!(t>i)||(Qt(`Detected an update time that is in the future: ${t} > ${i}`),!1))}fi(){this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Ii=()=>{this.ui.enqueueAndForget(()=>(this.inForeground=this.document.visibilityState==="visible",this.mi()))},this.document.addEventListener("visibilitychange",this.Ii),this.inForeground=this.document.visibilityState==="visible")}Bi(){this.Ii&&(this.document.removeEventListener("visibilitychange",this.Ii),this.Ii=null)}gi(){var t;typeof((t=this.window)===null||t===void 0?void 0:t.addEventListener)=="function"&&(this.Pi=()=>{this.Li();let e=/(?:Version|Mobile)\/1[456]/;Ld()&&(navigator.appVersion.match(e)||navigator.userAgent.match(e))&&this.ui.enterRestrictedMode(!0),this.ui.enqueueAndForget(()=>this.shutdown())},this.window.addEventListener("pagehide",this.Pi))}ki(){this.Pi&&(this.window.removeEventListener("pagehide",this.Pi),this.Pi=null)}Ni(t){var e;try{let i=((e=this.Vi)===null||e===void 0?void 0:e.getItem(this.Oi(t)))!==null;return H("IndexedDbPersistence",`Client '${t}' ${i?"is":"is not"} zombied in LocalStorage`),i}catch(i){return Qt("IndexedDbPersistence","Failed to get zombied client id.",i),!1}}Li(){if(this.Vi)try{this.Vi.setItem(this.Oi(this.clientId),String(Date.now()))}catch(t){Qt("Failed to set zombie client id.",t)}}qi(){if(this.Vi)try{this.Vi.removeItem(this.Oi(this.clientId))}catch{}}Oi(t){return`firestore_zombie_${this.persistenceKey}_${t}`}};function La(n){return he(n,"owner")}function zl(n){return he(n,"clientMetadata")}function Cg(n,t){let e=n.projectId;return n.isDefaultDatabase||(e+="."+n.database),"firestore/"+t+"/"+e+"/"}var Sp=class n{constructor(t,e,i,r){this.targetId=t,this.fromCache=e,this.$i=i,this.Ui=r}static Wi(t,e){let i=lt(),r=lt();for(let s of e.docChanges)switch(s.type){case 0:i=i.add(s.doc.key);break;case 1:r=r.add(s.doc.key)}return new n(t,e.fromCache,i,r)}};var Ap=class{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(t){this._documentReadCount+=t}};var bu=class{constructor(){this.Gi=!1,this.zi=!1,this.ji=100,this.Hi=function(){return Ld()?8:vv(ka())>0?6:4}()}initialize(t,e){this.Ji=t,this.indexManager=e,this.Gi=!0}getDocumentsMatchingQuery(t,e,i,r){let s={result:null};return this.Yi(t,e).next(o=>{s.result=o}).next(()=>{if(!s.result)return this.Zi(t,e,r,i).next(o=>{s.result=o})}).next(()=>{if(s.result)return;let o=new Ap;return this.Xi(t,e,o).next(a=>{if(s.result=a,this.zi)return this.es(t,e,o,a.size)})}).next(()=>s.result)}es(t,e,i,r){return i.documentReadCount<this.ji?(Xs()<=Un.DEBUG&&H("QueryEngine","SDK will not create cache indexes for query:",Js(e),"since it only creates cache indexes for collection contains","more than or equal to",this.ji,"documents"),B.resolve()):(Xs()<=Un.DEBUG&&H("QueryEngine","Query:",Js(e),"scans",i.documentReadCount,"local documents and returns",r,"documents as results."),i.documentReadCount>this.Hi*r?(Xs()<=Un.DEBUG&&H("QueryEngine","The SDK decides to create cache indexes for query:",Js(e),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(t,je(e))):B.resolve())}Yi(t,e){if(S0(e))return B.resolve(null);let i=je(e);return this.indexManager.getIndexType(t,i).next(r=>r===0?null:(e.limit!==null&&r===1&&(e=su(e,null,"F"),i=je(e)),this.indexManager.getDocumentsMatchingTarget(t,i).next(s=>{let o=lt(...s);return this.Ji.getDocuments(t,o).next(a=>this.indexManager.getMinOffset(t,i).next(c=>{let l=this.ts(e,a);return this.ns(e,l,o,c.readTime)?this.Yi(t,su(e,null,"F")):this.rs(t,l,e,c)}))})))}Zi(t,e,i,r){return S0(e)||r.isEqual(it.min())?B.resolve(null):this.Ji.getDocuments(t,i).next(s=>{let o=this.ts(e,s);return this.ns(e,o,i,r)?B.resolve(null):(Xs()<=Un.DEBUG&&H("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Js(e)),this.rs(t,o,e,mv(r,-1)).next(a=>a))})}ts(t,e){let i=new It(Lv(t));return e.forEach((r,s)=>{yc(t,s)&&(i=i.add(s))}),i}ns(t,e,i,r){if(t.limit===null)return!1;if(i.size!==e.size)return!0;let s=t.limitType==="F"?e.last():e.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(r)>0)}Xi(t,e,i){return Xs()<=Un.DEBUG&&H("QueryEngine","Using full collection scan to execute query:",Js(e)),this.Ji.getDocumentsMatchingQuery(t,e,vn.min(),i)}rs(t,e,i,r){return this.Ji.getDocumentsMatchingQuery(t,i,r).next(s=>(e.forEach(o=>{s=s.insert(o.key,o)}),s))}};var Cp=class{constructor(t,e,i,r){this.persistence=t,this.ss=e,this.serializer=r,this.os=new Vt(at),this._s=new Qn(s=>is(s),mc),this.us=new Map,this.cs=t.getRemoteDocumentCache(),this.Ur=t.getTargetCache(),this.Gr=t.getBundleCache(),this.ls(i)}ls(t){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(t),this.indexManager=this.persistence.getIndexManager(t),this.mutationQueue=this.persistence.getMutationQueue(t,this.indexManager),this.localDocuments=new _u(this.cs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.cs.setIndexManager(this.indexManager),this.ss.initialize(this.localDocuments,this.indexManager)}collectGarbage(t){return this.persistence.runTransaction("Collect garbage","readwrite-primary",e=>t.collect(e,this.os))}};function yb(n,t,e,i){return new Cp(n,t,e,i)}function vb(n,t){return U(this,null,function*(){let e=$(n);return yield e.persistence.runTransaction("Handle user change","readonly",i=>{let r;return e.mutationQueue.getAllMutationBatches(i).next(s=>(r=s,e.ls(t),e.mutationQueue.getAllMutationBatches(i))).next(s=>{let o=[],a=[],c=lt();for(let l of r){o.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}for(let l of s){a.push(l.batchId);for(let h of l.mutations)c=c.add(h.key)}return e.localDocuments.getDocuments(i,c).next(l=>({hs:l,removedBatchIds:o,addedBatchIds:a}))})})})}function VA(n,t){let e=$(n);return e.persistence.runTransaction("Acknowledge batch","readwrite-primary",i=>{let r=t.batch.keys(),s=e.cs.newChangeBuffer({trackRemovals:!0});return function(a,c,l,h){let d=l.batch,p=d.keys(),g=B.resolve();return p.forEach(y=>{g=g.next(()=>h.getEntry(c,y)).next(v=>{let w=l.docVersions.get(y);Z(w!==null),v.version.compareTo(w)<0&&(d.applyToRemoteDocument(v,l),v.isValidDocument()&&(v.setReadTime(l.commitVersion),h.addEntry(v)))})}),g.next(()=>a.mutationQueue.removeMutationBatch(c,d))}(e,i,t,s).next(()=>s.apply(i)).next(()=>e.mutationQueue.performConsistencyCheck(i)).next(()=>e.documentOverlayCache.removeOverlaysForBatchId(i,r,t.batch.batchId)).next(()=>e.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(i,function(a){let c=lt();for(let l=0;l<a.mutationResults.length;++l)a.mutationResults[l].transformResults.length>0&&(c=c.add(a.batch.mutations[l].key));return c}(t))).next(()=>e.localDocuments.getDocuments(i,r))})}function bb(n){let t=$(n);return t.persistence.runTransaction("Get last remote snapshot version","readonly",e=>t.Ur.getLastRemoteSnapshotVersion(e))}function NA(n,t){let e=$(n),i=t.snapshotVersion,r=e.os;return e.persistence.runTransaction("Apply remote event","readwrite-primary",s=>{let o=e.cs.newChangeBuffer({trackRemovals:!0});r=e.os;let a=[];t.targetChanges.forEach((h,d)=>{let p=r.get(d);if(!p)return;a.push(e.Ur.removeMatchingKeys(s,h.removedDocuments,d).next(()=>e.Ur.addMatchingKeys(s,h.addedDocuments,d)));let g=p.withSequenceNumber(s.currentSequenceNumber);t.targetMismatches.get(d)!==null?g=g.withResumeToken(Zt.EMPTY_BYTE_STRING,it.min()).withLastLimboFreeSnapshotVersion(it.min()):h.resumeToken.approximateByteSize()>0&&(g=g.withResumeToken(h.resumeToken,i)),r=r.insert(d,g),function(v,w,k){return v.resumeToken.approximateByteSize()===0||w.snapshotVersion.toMicroseconds()-v.snapshotVersion.toMicroseconds()>=3e8?!0:k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(p,g,h)&&a.push(e.Ur.updateTargetData(s,g))});let c=Ye(),l=lt();if(t.documentUpdates.forEach(h=>{t.resolvedLimboDocuments.has(h)&&a.push(e.persistence.referenceDelegate.updateLimboDocument(s,h))}),a.push(xb(s,o,t.documentUpdates).next(h=>{c=h.Ps,l=h.Is})),!i.isEqual(it.min())){let h=e.Ur.getLastRemoteSnapshotVersion(s).next(d=>e.Ur.setTargetsMetadata(s,s.currentSequenceNumber,i));a.push(h)}return B.waitFor(a).next(()=>o.apply(s)).next(()=>e.localDocuments.getLocalViewOfDocuments(s,c,l)).next(()=>c)}).then(s=>(e.os=r,s))}function xb(n,t,e){let i=lt(),r=lt();return e.forEach(s=>i=i.add(s)),t.getEntries(n,i).next(s=>{let o=Ye();return e.forEach((a,c)=>{let l=s.get(a);c.isFoundDocument()!==l.isFoundDocument()&&(r=r.add(a)),c.isNoDocument()&&c.version.isEqual(it.min())?(t.removeEntry(a,c.readTime),o=o.insert(a,c)):!l.isValidDocument()||c.version.compareTo(l.version)>0||c.version.compareTo(l.version)===0&&l.hasPendingWrites?(t.addEntry(c),o=o.insert(a,c)):H("LocalStore","Ignoring outdated watch update for ",a,". Current version:",l.version," Watch version:",c.version)}),{Ps:o,Is:r}})}function FA(n,t){let e=$(n);return e.persistence.runTransaction("Get next mutation batch","readonly",i=>(t===void 0&&(t=-1),e.mutationQueue.getNextMutationBatchAfterBatchId(i,t)))}function mo(n,t){let e=$(n);return e.persistence.runTransaction("Allocate target","readwrite",i=>{let r;return e.Ur.getTargetData(i,t).next(s=>s?(r=s,B.resolve(r)):e.Ur.allocateTargetId(i).next(o=>(r=new po(t,o,"TargetPurposeListen",i.currentSequenceNumber),e.Ur.addTargetData(i,r).next(()=>r))))}).then(i=>{let r=e.os.get(i.targetId);return(r===null||i.snapshotVersion.compareTo(r.snapshotVersion)>0)&&(e.os=e.os.insert(i.targetId,i),e._s.set(t,i.targetId)),i})}function _o(n,t,e){return U(this,null,function*(){let i=$(n),r=i.os.get(t),s=e?"readwrite":"readwrite-primary";try{e||(yield i.persistence.runTransaction("Release target",s,o=>i.persistence.referenceDelegate.removeTarget(o,r)))}catch(o){if(!ur(o))throw o;H("LocalStore",`Failed to update sequence numbers for target ${t}: ${o}`)}i.os=i.os.remove(t),i._s.delete(r.target)})}function xu(n,t,e){let i=$(n),r=it.min(),s=lt();return i.persistence.runTransaction("Execute query","readwrite",o=>function(c,l,h){let d=$(c),p=d._s.get(h);return p!==void 0?B.resolve(d.os.get(p)):d.Ur.getTargetData(l,h)}(i,o,je(t)).next(a=>{if(a)return r=a.lastLimboFreeSnapshotVersion,i.Ur.getMatchingKeysForTargetId(o,a.targetId).next(c=>{s=c})}).next(()=>i.ss.getDocumentsMatchingQuery(o,t,e?r:it.min(),e?s:lt())).next(a=>(Eb(i,Fv(t),a),{documents:a,Ts:s})))}function wb(n,t){let e=$(n),i=$(e.Ur),r=e.os.get(t);return r?Promise.resolve(r.target):e.persistence.runTransaction("Get target data","readonly",s=>i.ot(s,t).next(o=>o?o.target:null))}function Tb(n,t){let e=$(n),i=e.us.get(t)||it.min();return e.persistence.runTransaction("Get new document changes","readonly",r=>e.cs.getAllFromCollectionGroup(r,t,mv(i,-1),Number.MAX_SAFE_INTEGER)).then(r=>(Eb(e,t,r),r))}function Eb(n,t,e){let i=n.us.get(t)||it.min();e.forEach((r,s)=>{s.readTime.compareTo(i)>0&&(i=s.readTime)}),n.us.set(t,i)}function LA(n,t,e,i){return U(this,null,function*(){let r=$(n),s=lt(),o=Ye();for(let l of e){let h=t.Es(l.metadata.name);l.document&&(s=s.add(h));let d=t.ds(l);d.setReadTime(t.As(l.metadata.readTime)),o=o.insert(h,d)}let a=r.cs.newChangeBuffer({trackRemovals:!0}),c=yield mo(r,function(h){return je(Io(mt.fromString(`__bundle__/docs/${h}`)))}(i));return r.persistence.runTransaction("Apply bundle documents","readwrite",l=>xb(l,a,o).next(h=>(a.apply(l),h)).next(h=>r.Ur.removeMatchingKeysForTargetId(l,c.targetId).next(()=>r.Ur.addMatchingKeys(l,s,c.targetId)).next(()=>r.localDocuments.getLocalViewOfDocuments(l,h.Ps,h.Is)).next(()=>h.Ps)))})}function BA(i,r){return U(this,arguments,function*(n,t,e=lt()){let s=yield mo(n,je(Sg(t.bundledQuery))),o=$(n);return o.persistence.runTransaction("Save named query","readwrite",a=>{let c=Jt(t.readTime);if(s.snapshotVersion.compareTo(c)>=0)return o.Gr.saveNamedQuery(a,t);let l=s.withResumeToken(Zt.EMPTY_BYTE_STRING,c);return o.os=o.os.insert(l.targetId,l),o.Ur.updateTargetData(a,l).next(()=>o.Ur.removeMatchingKeysForTargetId(a,s.targetId)).next(()=>o.Ur.addMatchingKeys(a,e,s.targetId)).next(()=>o.Gr.saveNamedQuery(a,t))})})}function tv(n,t){return`firestore_clients_${n}_${t}`}function ev(n,t,e){let i=`firestore_mutations_${n}_${e}`;return t.isAuthenticated()&&(i+=`_${t.uid}`),i}function pf(n,t){return`firestore_targets_${n}_${t}`}var wu=class n{constructor(t,e,i,r){this.user=t,this.batchId=e,this.state=i,this.error=r}static Rs(t,e,i){let r=JSON.parse(i),s,o=typeof r=="object"&&["pending","acknowledged","rejected"].indexOf(r.state)!==-1&&(r.error===void 0||typeof r.error=="object");return o&&r.error&&(o=typeof r.error.message=="string"&&typeof r.error.code=="string",o&&(s=new q(r.error.code,r.error.message))),o?new n(t,e,r.state,s):(Qt("SharedClientState",`Failed to parse mutation state for ID '${e}': ${i}`),null)}Vs(){let t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}},Wa=class n{constructor(t,e,i){this.targetId=t,this.state=e,this.error=i}static Rs(t,e){let i=JSON.parse(e),r,s=typeof i=="object"&&["not-current","current","rejected"].indexOf(i.state)!==-1&&(i.error===void 0||typeof i.error=="object");return s&&i.error&&(s=typeof i.error.message=="string"&&typeof i.error.code=="string",s&&(r=new q(i.error.code,i.error.message))),s?new n(t,i.state,r):(Qt("SharedClientState",`Failed to parse target state for ID '${t}': ${e}`),null)}Vs(){let t={state:this.state,updateTimeMs:Date.now()};return this.error&&(t.error={code:this.error.code,message:this.error.message}),JSON.stringify(t)}},Tu=class n{constructor(t,e){this.clientId=t,this.activeTargetIds=e}static Rs(t,e){let i=JSON.parse(e),r=typeof i=="object"&&i.activeTargetIds instanceof Array,s=Tg();for(let o=0;r&&o<i.activeTargetIds.length;++o)r=bv(i.activeTargetIds[o]),s=s.add(i.activeTargetIds[o]);return r?new n(t,s):(Qt("SharedClientState",`Failed to parse client data for instance '${t}': ${e}`),null)}},Pp=class n{constructor(t,e){this.clientId=t,this.onlineState=e}static Rs(t){let e=JSON.parse(t);return typeof e=="object"&&["Unknown","Online","Offline"].indexOf(e.onlineState)!==-1&&typeof e.clientId=="string"?new n(e.clientId,e.onlineState):(Qt("SharedClientState",`Failed to parse online state: ${t}`),null)}},ac=class{constructor(){this.activeTargetIds=Tg()}fs(t){this.activeTargetIds=this.activeTargetIds.add(t)}gs(t){this.activeTargetIds=this.activeTargetIds.delete(t)}Vs(){let t={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(t)}},Ha=class{constructor(t,e,i,r,s){this.window=t,this.ui=e,this.persistenceKey=i,this.ps=r,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.ys=this.ws.bind(this),this.Ss=new Vt(at),this.started=!1,this.bs=[];let o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Ds=tv(this.persistenceKey,this.ps),this.vs=function(c){return`firestore_sequence_number_${c}`}(this.persistenceKey),this.Ss=this.Ss.insert(this.ps,new ac),this.Cs=new RegExp(`^firestore_clients_${o}_([^_]*)$`),this.Fs=new RegExp(`^firestore_mutations_${o}_(\\d+)(?:_(.*))?$`),this.Ms=new RegExp(`^firestore_targets_${o}_(\\d+)$`),this.xs=function(c){return`firestore_online_state_${c}`}(this.persistenceKey),this.Os=function(c){return`firestore_bundle_loaded_v2_${c}`}(this.persistenceKey),this.window.addEventListener("storage",this.ys)}static D(t){return!(!t||!t.localStorage)}start(){return U(this,null,function*(){let t=yield this.syncEngine.Qi();for(let i of t){if(i===this.ps)continue;let r=this.getItem(tv(this.persistenceKey,i));if(r){let s=Tu.Rs(i,r);s&&(this.Ss=this.Ss.insert(s.clientId,s))}}this.Ns();let e=this.storage.getItem(this.xs);if(e){let i=this.Ls(e);i&&this.Bs(i)}for(let i of this.bs)this.ws(i);this.bs=[],this.window.addEventListener("pagehide",()=>this.shutdown()),this.started=!0})}writeSequenceNumber(t){this.setItem(this.vs,JSON.stringify(t))}getAllActiveQueryTargets(){return this.ks(this.Ss)}isActiveQueryTarget(t){let e=!1;return this.Ss.forEach((i,r)=>{r.activeTargetIds.has(t)&&(e=!0)}),e}addPendingMutation(t){this.qs(t,"pending")}updateMutationState(t,e,i){this.qs(t,e,i),this.Qs(t)}addLocalQueryTarget(t,e=!0){let i="not-current";if(this.isActiveQueryTarget(t)){let r=this.storage.getItem(pf(this.persistenceKey,t));if(r){let s=Wa.Rs(t,r);s&&(i=s.state)}}return e&&this.Ks.fs(t),this.Ns(),i}removeLocalQueryTarget(t){this.Ks.gs(t),this.Ns()}isLocalQueryTarget(t){return this.Ks.activeTargetIds.has(t)}clearQueryState(t){this.removeItem(pf(this.persistenceKey,t))}updateQueryState(t,e,i){this.$s(t,e,i)}handleUserChange(t,e,i){e.forEach(r=>{this.Qs(r)}),this.currentUser=t,i.forEach(r=>{this.addPendingMutation(r)})}setOnlineState(t){this.Us(t)}notifyBundleLoaded(t){this.Ws(t)}shutdown(){this.started&&(this.window.removeEventListener("storage",this.ys),this.removeItem(this.Ds),this.started=!1)}getItem(t){let e=this.storage.getItem(t);return H("SharedClientState","READ",t,e),e}setItem(t,e){H("SharedClientState","SET",t,e),this.storage.setItem(t,e)}removeItem(t){H("SharedClientState","REMOVE",t),this.storage.removeItem(t)}ws(t){let e=t;if(e.storageArea===this.storage){if(H("SharedClientState","EVENT",e.key,e.newValue),e.key===this.Ds)return void Qt("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.ui.enqueueRetryable(()=>U(this,null,function*(){if(this.started){if(e.key!==null){if(this.Cs.test(e.key)){if(e.newValue==null){let i=this.Gs(e.key);return this.zs(i,null)}{let i=this.js(e.key,e.newValue);if(i)return this.zs(i.clientId,i)}}else if(this.Fs.test(e.key)){if(e.newValue!==null){let i=this.Hs(e.key,e.newValue);if(i)return this.Js(i)}}else if(this.Ms.test(e.key)){if(e.newValue!==null){let i=this.Ys(e.key,e.newValue);if(i)return this.Zs(i)}}else if(e.key===this.xs){if(e.newValue!==null){let i=this.Ls(e.newValue);if(i)return this.Bs(i)}}else if(e.key===this.vs){let i=function(s){let o=an.oe;if(s!=null)try{let a=JSON.parse(s);Z(typeof a=="number"),o=a}catch(a){Qt("SharedClientState","Failed to read sequence number from WebStorage",a)}return o}(e.newValue);i!==an.oe&&this.sequenceNumberHandler(i)}else if(e.key===this.Os){let i=this.Xs(e.newValue);yield Promise.all(i.map(r=>this.syncEngine.eo(r)))}}}else this.bs.push(e)}))}}get Ks(){return this.Ss.get(this.ps)}Ns(){this.setItem(this.Ds,this.Ks.Vs())}qs(t,e,i){let r=new wu(this.currentUser,t,e,i),s=ev(this.persistenceKey,this.currentUser,t);this.setItem(s,r.Vs())}Qs(t){let e=ev(this.persistenceKey,this.currentUser,t);this.removeItem(e)}Us(t){let e={clientId:this.ps,onlineState:t};this.storage.setItem(this.xs,JSON.stringify(e))}$s(t,e,i){let r=pf(this.persistenceKey,t),s=new Wa(t,e,i);this.setItem(r,s.Vs())}Ws(t){let e=JSON.stringify(Array.from(t));this.setItem(this.Os,e)}Gs(t){let e=this.Cs.exec(t);return e?e[1]:null}js(t,e){let i=this.Gs(t);return Tu.Rs(i,e)}Hs(t,e){let i=this.Fs.exec(t),r=Number(i[1]),s=i[2]!==void 0?i[2]:null;return wu.Rs(new re(s),r,e)}Ys(t,e){let i=this.Ms.exec(t),r=Number(i[1]);return Wa.Rs(r,e)}Ls(t){return Pp.Rs(t)}Xs(t){return JSON.parse(t)}Js(t){return U(this,null,function*(){if(t.user.uid===this.currentUser.uid)return this.syncEngine.no(t.batchId,t.state,t.error);H("SharedClientState",`Ignoring mutation for non-active user ${t.user.uid}`)})}Zs(t){return this.syncEngine.ro(t.targetId,t.state,t.error)}zs(t,e){let i=e?this.Ss.insert(t,e):this.Ss.remove(t),r=this.ks(this.Ss),s=this.ks(i),o=[],a=[];return s.forEach(c=>{r.has(c)||o.push(c)}),r.forEach(c=>{s.has(c)||a.push(c)}),this.syncEngine.io(o,a).then(()=>{this.Ss=i})}Bs(t){this.Ss.get(t.clientId)&&this.onlineStateHandler(t.onlineState)}ks(t){let e=Tg();return t.forEach((i,r)=>{e=e.unionWith(r.activeTargetIds)}),e}},Eu=class{constructor(){this.so=new ac,this.oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(t){}updateMutationState(t,e,i){}addLocalQueryTarget(t,e=!0){return e&&this.so.fs(t),this.oo[t]||"not-current"}updateQueryState(t,e,i){this.oo[t]=e}removeLocalQueryTarget(t){this.so.gs(t)}isLocalQueryTarget(t){return this.so.activeTargetIds.has(t)}clearQueryState(t){delete this.oo[t]}getAllActiveQueryTargets(){return this.so.activeTargetIds}isActiveQueryTarget(t){return this.so.activeTargetIds.has(t)}start(){return this.so=new ac,Promise.resolve()}handleUserChange(t,e,i){}setOnlineState(t){}shutdown(){}writeSequenceNumber(t){}notifyBundleLoaded(t){}};var kp=class{_o(t){}shutdown(){}};var Iu=class{constructor(){this.ao=()=>this.uo(),this.co=()=>this.lo(),this.ho=[],this.Po()}_o(t){this.ho.push(t)}shutdown(){window.removeEventListener("online",this.ao),window.removeEventListener("offline",this.co)}Po(){window.addEventListener("online",this.ao),window.addEventListener("offline",this.co)}uo(){H("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(let t of this.ho)t(0)}lo(){H("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(let t of this.ho)t(1)}static D(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}};var jl=null;function gf(){return jl===null?jl=function(){return 268435456+Math.round(2147483648*Math.random())}():jl++,"0x"+jl.toString(16)}var zA={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};var Rp=class{constructor(t){this.Io=t.Io,this.To=t.To}Eo(t){this.Ao=t}Ro(t){this.Vo=t}mo(t){this.fo=t}onMessage(t){this.po=t}close(){this.To()}send(t){this.Io(t)}yo(){this.Ao()}wo(){this.Vo()}So(t){this.fo(t)}bo(t){this.po(t)}};var Ve="WebChannelConnection",Dp=class extends class{constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;let i=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),s=encodeURIComponent(this.databaseId.database);this.Do=i+"://"+e.host,this.vo=`projects/${r}/databases/${s}`,this.Co=this.databaseId.database==="(default)"?`project_id=${r}`:`project_id=${r}&database_id=${s}`}get Fo(){return!1}Mo(e,i,r,s,o){let a=gf(),c=this.xo(e,i.toUriEncodedString());H("RestConnection",`Sending RPC '${e}' ${a}:`,c,r);let l={"google-cloud-resource-prefix":this.vo,"x-goog-request-params":this.Co};return this.Oo(l,s,o),this.No(e,c,l,r).then(h=>(H("RestConnection",`Received RPC '${e}' ${a}: `,h),h),h=>{throw yn("RestConnection",`RPC '${e}' ${a} failed with error: `,h,"url: ",c,"request:",r),h})}Lo(e,i,r,s,o,a){return this.Mo(e,i,r,s,o)}Oo(e,i,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+Eo}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),i&&i.headers.forEach((s,o)=>e[o]=s),r&&r.headers.forEach((s,o)=>e[o]=s)}xo(e,i){let r=zA[e];return`${this.Do}/v1/${i}:${r}`}terminate(){}}{constructor(t){super(t),this.forceLongPolling=t.forceLongPolling,this.autoDetectLongPolling=t.autoDetectLongPolling,this.useFetchStreams=t.useFetchStreams,this.longPollingOptions=t.longPollingOptions}No(t,e,i,r){let s=gf();return new Promise((o,a)=>{let c=new of;c.setWithCredentials(!0),c.listenOnce(cf.COMPLETE,()=>{try{switch(c.getLastErrorCode()){case Oa.NO_ERROR:let h=c.getResponseJson();H(Ve,`XHR for RPC '${t}' ${s} received:`,JSON.stringify(h)),o(h);break;case Oa.TIMEOUT:H(Ve,`RPC '${t}' ${s} timed out`),a(new q(z.DEADLINE_EXCEEDED,"Request time out"));break;case Oa.HTTP_ERROR:let d=c.getStatus();if(H(Ve,`RPC '${t}' ${s} failed with status:`,d,"response text:",c.getResponseText()),d>0){let p=c.getResponseJson();Array.isArray(p)&&(p=p[0]);let g=p?.error;if(g&&g.status&&g.message){let y=function(w){let k=w.toLowerCase().replace(/_/g,"-");return Object.values(z).indexOf(k)>=0?k:z.UNKNOWN}(g.status);a(new q(y,g.message))}else a(new q(z.UNKNOWN,"Server responded with status "+c.getStatus()))}else a(new q(z.UNAVAILABLE,"Connection failed."));break;default:J()}}finally{H(Ve,`RPC '${t}' ${s} completed.`)}});let l=JSON.stringify(r);H(Ve,`RPC '${t}' ${s} sending request:`,r),c.send(e,"POST",l,i,15)})}Bo(t,e,i){let r=gf(),s=[this.Do,"/","google.firestore.v1.Firestore","/",t,"/channel"],o=hf(),a=uf(),c={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},l=this.longPollingOptions.timeoutSeconds;l!==void 0&&(c.longPollingTimeout=Math.round(1e3*l)),this.useFetchStreams&&(c.xmlHttpFactory=new af({})),this.Oo(c.initMessageHeaders,e,i),c.encodeInitMessageHeaders=!0;let h=s.join("");H(Ve,`Creating RPC '${t}' stream ${r}: ${h}`,c);let d=o.createWebChannel(h,c),p=!1,g=!1,y=new Rp({Io:w=>{g?H(Ve,`Not sending because RPC '${t}' stream ${r} is closed:`,w):(p||(H(Ve,`Opening RPC '${t}' stream ${r} transport.`),d.open(),p=!0),H(Ve,`RPC '${t}' stream ${r} sending:`,w),d.send(w))},To:()=>d.close()}),v=(w,k,R)=>{w.listen(k,M=>{try{R(M)}catch(F){setTimeout(()=>{throw F},0)}})};return v(d,Gs.EventType.OPEN,()=>{g||(H(Ve,`RPC '${t}' stream ${r} transport opened.`),y.yo())}),v(d,Gs.EventType.CLOSE,()=>{g||(g=!0,H(Ve,`RPC '${t}' stream ${r} transport closed`),y.So())}),v(d,Gs.EventType.ERROR,w=>{g||(g=!0,yn(Ve,`RPC '${t}' stream ${r} transport errored:`,w),y.So(new q(z.UNAVAILABLE,"The operation could not be completed")))}),v(d,Gs.EventType.MESSAGE,w=>{var k;if(!g){let R=w.data[0];Z(!!R);let M=R,F=M.error||((k=M[0])===null||k===void 0?void 0:k.error);if(F){H(Ve,`RPC '${t}' stream ${r} received error:`,F);let V=F.status,L=function(E){let A=ne[E];if(A!==void 0)return Xv(A)}(V),I=F.message;L===void 0&&(L=z.INTERNAL,I="Unknown error status: "+V+" with message "+F.message),g=!0,y.So(new q(L,I)),d.close()}else H(Ve,`RPC '${t}' stream ${r} received:`,R),y.bo(R)}}),v(a,lf.STAT_EVENT,w=>{w.stat===Fl.PROXY?H(Ve,`RPC '${t}' stream ${r} detected buffering proxy`):w.stat===Fl.NOPROXY&&H(Ve,`RPC '${t}' stream ${r} detected no buffering proxy`)}),setTimeout(()=>{y.wo()},0),y}};function Ib(){return typeof window<"u"?window:null}function Gl(){return typeof document<"u"?document:null}function vc(n){return new $f(n,!0)}var cc=class{constructor(t,e,i=1e3,r=1.5,s=6e4){this.ui=t,this.timerId=e,this.ko=i,this.qo=r,this.Qo=s,this.Ko=0,this.$o=null,this.Uo=Date.now(),this.reset()}reset(){this.Ko=0}Wo(){this.Ko=this.Qo}Go(t){this.cancel();let e=Math.floor(this.Ko+this.zo()),i=Math.max(0,Date.now()-this.Uo),r=Math.max(0,e-i);r>0&&H("ExponentialBackoff",`Backing off for ${r} ms (base delay: ${this.Ko} ms, delay with jitter: ${e} ms, last attempt: ${i} ms ago)`),this.$o=this.ui.enqueueAfterDelay(this.timerId,r,()=>(this.Uo=Date.now(),t())),this.Ko*=this.qo,this.Ko<this.ko&&(this.Ko=this.ko),this.Ko>this.Qo&&(this.Ko=this.Qo)}jo(){this.$o!==null&&(this.$o.skipDelay(),this.$o=null)}cancel(){this.$o!==null&&(this.$o.cancel(),this.$o=null)}zo(){return(Math.random()-.5)*this.Ko}};var Su=class{constructor(t,e,i,r,s,o,a,c){this.ui=t,this.Ho=i,this.Jo=r,this.connection=s,this.authCredentialsProvider=o,this.appCheckCredentialsProvider=a,this.listener=c,this.state=0,this.Yo=0,this.Zo=null,this.Xo=null,this.stream=null,this.e_=0,this.t_=new cc(t,e)}n_(){return this.state===1||this.state===5||this.r_()}r_(){return this.state===2||this.state===3}start(){this.e_=0,this.state!==4?this.auth():this.i_()}stop(){return U(this,null,function*(){this.n_()&&(yield this.close(0))})}s_(){this.state=0,this.t_.reset()}o_(){this.r_()&&this.Zo===null&&(this.Zo=this.ui.enqueueAfterDelay(this.Ho,6e4,()=>this.__()))}a_(t){this.u_(),this.stream.send(t)}__(){return U(this,null,function*(){if(this.r_())return this.close(0)})}u_(){this.Zo&&(this.Zo.cancel(),this.Zo=null)}c_(){this.Xo&&(this.Xo.cancel(),this.Xo=null)}close(t,e){return U(this,null,function*(){this.u_(),this.c_(),this.t_.cancel(),this.Yo++,t!==4?this.t_.reset():e&&e.code===z.RESOURCE_EXHAUSTED?(Qt(e.toString()),Qt("Using maximum backoff delay to prevent overloading the backend."),this.t_.Wo()):e&&e.code===z.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.l_(),this.stream.close(),this.stream=null),this.state=t,yield this.listener.mo(e)})}l_(){}auth(){this.state=1;let t=this.h_(this.Yo),e=this.Yo;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([i,r])=>{this.Yo===e&&this.P_(i,r)},i=>{t(()=>{let r=new q(z.UNKNOWN,"Fetching auth token failed: "+i.message);return this.I_(r)})})}P_(t,e){let i=this.h_(this.Yo);this.stream=this.T_(t,e),this.stream.Eo(()=>{i(()=>this.listener.Eo())}),this.stream.Ro(()=>{i(()=>(this.state=2,this.Xo=this.ui.enqueueAfterDelay(this.Jo,1e4,()=>(this.r_()&&(this.state=3),Promise.resolve())),this.listener.Ro()))}),this.stream.mo(r=>{i(()=>this.I_(r))}),this.stream.onMessage(r=>{i(()=>++this.e_==1?this.E_(r):this.onNext(r))})}i_(){this.state=5,this.t_.Go(()=>U(this,null,function*(){this.state=0,this.start()}))}I_(t){return H("PersistentStream",`close with error: ${t}`),this.stream=null,this.close(4,t)}h_(t){return e=>{this.ui.enqueueAndForget(()=>this.Yo===t?e():(H("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}},Mp=class extends Su{constructor(t,e,i,r,s,o){super(t,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",e,i,r,o),this.serializer=s}T_(t,e){return this.connection.Bo("Listen",t,e)}E_(t){return this.onNext(t)}onNext(t){this.t_.reset();let e=EA(this.serializer,t),i=function(s){if(!("targetChange"in s))return it.min();let o=s.targetChange;return o.targetIds&&o.targetIds.length?it.min():o.readTime?Jt(o.readTime):it.min()}(t);return this.listener.d_(e,i)}A_(t){let e={};e.database=Qf(this.serializer),e.addTarget=function(s,o){let a,c=o.target;if(a=iu(c)?{documents:sb(s,c)}:{query:ob(s,c)._t},a.targetId=o.targetId,o.resumeToken.approximateByteSize()>0){a.resumeToken=Zv(s,o.resumeToken);let l=Kf(s,o.expectedCount);l!==null&&(a.expectedCount=l)}else if(o.snapshotVersion.compareTo(it.min())>0){a.readTime=fo(s,o.snapshotVersion.toTimestamp());let l=Kf(s,o.expectedCount);l!==null&&(a.expectedCount=l)}return a}(this.serializer,t);let i=SA(this.serializer,t);i&&(e.labels=i),this.a_(e)}R_(t){let e={};e.database=Qf(this.serializer),e.removeTarget=t,this.a_(e)}},Op=class extends Su{constructor(t,e,i,r,s,o){super(t,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",e,i,r,o),this.serializer=s}get V_(){return this.e_>0}start(){this.lastStreamToken=void 0,super.start()}l_(){this.V_&&this.m_([])}T_(t,e){return this.connection.Bo("Write",t,e)}E_(t){return Z(!!t.streamToken),this.lastStreamToken=t.streamToken,Z(!t.writeResults||t.writeResults.length===0),this.listener.f_()}onNext(t){Z(!!t.streamToken),this.lastStreamToken=t.streamToken,this.t_.reset();let e=IA(t.writeResults,t.commitTime),i=Jt(t.commitTime);return this.listener.g_(i,e)}p_(){let t={};t.database=Qf(this.serializer),this.a_(t)}m_(t){let e={streamToken:this.lastStreamToken,writes:t.map(i=>rc(this.serializer,i))};this.a_(e)}};var Vp=class extends class{}{constructor(t,e,i,r){super(),this.authCredentials=t,this.appCheckCredentials=e,this.connection=i,this.serializer=r,this.y_=!1}w_(){if(this.y_)throw new q(z.FAILED_PRECONDITION,"The client has already been terminated.")}Mo(t,e,i,r){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([s,o])=>this.connection.Mo(t,Yf(e,i),r,s,o)).catch(s=>{throw s.name==="FirebaseError"?(s.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),s):new q(z.UNKNOWN,s.toString())})}Lo(t,e,i,r,s){return this.w_(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([o,a])=>this.connection.Lo(t,Yf(e,i),r,o,a,s)).catch(o=>{throw o.name==="FirebaseError"?(o.code===z.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),o):new q(z.UNKNOWN,o.toString())})}terminate(){this.y_=!0,this.connection.terminate()}},Np=class{constructor(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state="Unknown",this.S_=0,this.b_=null,this.D_=!0}v_(){this.S_===0&&(this.C_("Unknown"),this.b_=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.b_=null,this.F_("Backend didn't respond within 10 seconds."),this.C_("Offline"),Promise.resolve())))}M_(t){this.state==="Online"?this.C_("Unknown"):(this.S_++,this.S_>=1&&(this.x_(),this.F_(`Connection failed 1 times. Most recent error: ${t.toString()}`),this.C_("Offline")))}set(t){this.x_(),this.S_=0,t==="Online"&&(this.D_=!1),this.C_(t)}C_(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))}F_(t){let e=`Could not reach Cloud Firestore backend. ${t}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.D_?(Qt(e),this.D_=!1):H("OnlineStateTracker",e)}x_(){this.b_!==null&&(this.b_.cancel(),this.b_=null)}};var Fp=class{constructor(t,e,i,r,s){this.localStore=t,this.datastore=e,this.asyncQueue=i,this.remoteSyncer={},this.O_=[],this.N_=new Map,this.L_=new Set,this.B_=[],this.k_=s,this.k_._o(o=>{i.enqueueAndForget(()=>U(this,null,function*(){hr(this)&&(H("RemoteStore","Restarting streams for network reachability change."),yield function(c){return U(this,null,function*(){let l=$(c);l.L_.add(4),yield So(l),l.q_.set("Unknown"),l.L_.delete(4),yield bc(l)})}(this))}))}),this.q_=new Np(i,r)}};function bc(n){return U(this,null,function*(){if(hr(n))for(let t of n.B_)yield t(!0)})}function So(n){return U(this,null,function*(){for(let t of n.B_)yield t(!1)})}function Gu(n,t){let e=$(n);e.N_.has(t.targetId)||(e.N_.set(t.targetId,t),Rg(e)?kg(e):Co(e).r_()&&Pg(e,t))}function yo(n,t){let e=$(n),i=Co(e);e.N_.delete(t),i.r_()&&Sb(e,t),e.N_.size===0&&(i.r_()?i.o_():hr(e)&&e.q_.set("Unknown"))}function Pg(n,t){if(n.Q_.xe(t.targetId),t.resumeToken.approximateByteSize()>0||t.snapshotVersion.compareTo(it.min())>0){let e=n.remoteSyncer.getRemoteKeysForTarget(t.targetId).size;t=t.withExpectedCount(e)}Co(n).A_(t)}function Sb(n,t){n.Q_.xe(t),Co(n).R_(t)}function kg(n){n.Q_=new Gf({getRemoteKeysForTarget:t=>n.remoteSyncer.getRemoteKeysForTarget(t),ot:t=>n.N_.get(t)||null,tt:()=>n.datastore.serializer.databaseId}),Co(n).start(),n.q_.v_()}function Rg(n){return hr(n)&&!Co(n).n_()&&n.N_.size>0}function hr(n){return $(n).L_.size===0}function Ab(n){n.Q_=void 0}function jA(n){return U(this,null,function*(){n.q_.set("Online")})}function UA(n){return U(this,null,function*(){n.N_.forEach((t,e)=>{Pg(n,t)})})}function qA(n,t){return U(this,null,function*(){Ab(n),Rg(n)?(n.q_.M_(t),kg(n)):n.q_.set("Unknown")})}function WA(n,t,e){return U(this,null,function*(){if(n.q_.set("Online"),t instanceof au&&t.state===2&&t.cause)try{yield function(r,s){return U(this,null,function*(){let o=s.cause;for(let a of s.targetIds)r.N_.has(a)&&(yield r.remoteSyncer.rejectListen(a,o),r.N_.delete(a),r.Q_.removeTarget(a))})}(n,t)}catch(i){H("RemoteStore","Failed to remove targets %s: %s ",t.targetIds.join(","),i),yield Au(n,i)}else if(t instanceof so?n.Q_.Ke(t):t instanceof ou?n.Q_.He(t):n.Q_.We(t),!e.isEqual(it.min()))try{let i=yield bb(n.localStore);e.compareTo(i)>=0&&(yield function(s,o){let a=s.Q_.rt(o);return a.targetChanges.forEach((c,l)=>{if(c.resumeToken.approximateByteSize()>0){let h=s.N_.get(l);h&&s.N_.set(l,h.withResumeToken(c.resumeToken,o))}}),a.targetMismatches.forEach((c,l)=>{let h=s.N_.get(c);if(!h)return;s.N_.set(c,h.withResumeToken(Zt.EMPTY_BYTE_STRING,h.snapshotVersion)),Sb(s,c);let d=new po(h.target,c,l,h.sequenceNumber);Pg(s,d)}),s.remoteSyncer.applyRemoteEvent(a)}(n,e))}catch(i){H("RemoteStore","Failed to raise snapshot:",i),yield Au(n,i)}})}function Au(n,t,e){return U(this,null,function*(){if(!ur(t))throw t;n.L_.add(1),yield So(n),n.q_.set("Offline"),e||(e=()=>bb(n.localStore)),n.asyncQueue.enqueueRetryable(()=>U(this,null,function*(){H("RemoteStore","Retrying IndexedDB access"),yield e(),n.L_.delete(1),yield bc(n)}))})}function Cb(n,t){return t().catch(e=>Au(n,e,t))}function Ao(n){return U(this,null,function*(){let t=$(n),e=cr(t),i=t.O_.length>0?t.O_[t.O_.length-1].batchId:-1;for(;HA(t);)try{let r=yield FA(t.localStore,i);if(r===null){t.O_.length===0&&e.o_();break}i=r.batchId,GA(t,r)}catch(r){yield Au(t,r)}Pb(t)&&kb(t)})}function HA(n){return hr(n)&&n.O_.length<10}function GA(n,t){n.O_.push(t);let e=cr(n);e.r_()&&e.V_&&e.m_(t.mutations)}function Pb(n){return hr(n)&&!cr(n).n_()&&n.O_.length>0}function kb(n){cr(n).start()}function $A(n){return U(this,null,function*(){cr(n).p_()})}function KA(n){return U(this,null,function*(){let t=cr(n);for(let e of n.O_)t.m_(e.mutations)})}function YA(n,t,e){return U(this,null,function*(){let i=n.O_.shift(),r=qf.from(i,t,e);yield Cb(n,()=>n.remoteSyncer.applySuccessfulWrite(r)),yield Ao(n)})}function QA(n,t){return U(this,null,function*(){t&&cr(n).V_&&(yield function(i,r){return U(this,null,function*(){if(function(o){return Qv(o)&&o!==z.ABORTED}(r.code)){let s=i.O_.shift();cr(i).s_(),yield Cb(i,()=>i.remoteSyncer.rejectFailedWrite(s.batchId,r)),yield Ao(i)}})}(n,t)),Pb(n)&&kb(n)})}function nv(n,t){return U(this,null,function*(){let e=$(n);e.asyncQueue.verifyOperationInProgress(),H("RemoteStore","RemoteStore received new credentials");let i=hr(e);e.L_.add(3),yield So(e),i&&e.q_.set("Unknown"),yield e.remoteSyncer.handleCredentialChange(t),e.L_.delete(3),yield bc(e)})}function Lp(n,t){return U(this,null,function*(){let e=$(n);t?(e.L_.delete(2),yield bc(e)):t||(e.L_.add(2),yield So(e),e.q_.set("Unknown"))})}function Co(n){return n.K_||(n.K_=function(e,i,r){let s=$(e);return s.w_(),new Mp(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Eo:jA.bind(null,n),Ro:UA.bind(null,n),mo:qA.bind(null,n),d_:WA.bind(null,n)}),n.B_.push(t=>U(this,null,function*(){t?(n.K_.s_(),Rg(n)?kg(n):n.q_.set("Unknown")):(yield n.K_.stop(),Ab(n))}))),n.K_}function cr(n){return n.U_||(n.U_=function(e,i,r){let s=$(e);return s.w_(),new Op(i,s.connection,s.authCredentials,s.appCheckCredentials,s.serializer,r)}(n.datastore,n.asyncQueue,{Eo:()=>Promise.resolve(),Ro:$A.bind(null,n),mo:QA.bind(null,n),f_:KA.bind(null,n),g_:YA.bind(null,n)}),n.B_.push(t=>U(this,null,function*(){t?(n.U_.s_(),yield Ao(n)):(yield n.U_.stop(),n.O_.length>0&&(H("RemoteStore",`Stopping write stream with ${n.O_.length} pending writes`),n.O_=[]))}))),n.U_}var Bp=class n{constructor(t,e,i,r,s){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=i,this.op=r,this.removalCallback=s,this.deferred=new se,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(o=>{})}get promise(){return this.deferred.promise}static createAndSchedule(t,e,i,r,s){let o=Date.now()+i,a=new n(t,e,o,r,s);return a.start(i),a}start(t){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),t)}skipDelay(){return this.handleDelayElapsed()}cancel(t){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new q(z.CANCELLED,"Operation cancelled"+(t?": "+t:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(t=>this.deferred.resolve(t))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}};function Po(n,t){if(Qt("AsyncQueue",`${t}: ${n}`),ur(n))return new q(z.UNAVAILABLE,`${t}: ${n}`);throw n}var Cu=class n{constructor(t){this.comparator=t?(e,i)=>t(e,i)||K.comparator(e.key,i.key):(e,i)=>K.comparator(e.key,i.key),this.keyedMap=Ba(),this.sortedSet=new Vt(this.comparator)}static emptySet(t){return new n(t.comparator)}has(t){return this.keyedMap.get(t)!=null}get(t){return this.keyedMap.get(t)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(t){let e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1}get size(){return this.sortedSet.size}forEach(t){this.sortedSet.inorderTraversal((e,i)=>(t(e),!1))}add(t){let e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))}delete(t){let e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this}isEqual(t){if(!(t instanceof n)||this.size!==t.size)return!1;let e=this.sortedSet.getIterator(),i=t.sortedSet.getIterator();for(;e.hasNext();){let r=e.getNext().key,s=i.getNext().key;if(!r.isEqual(s))return!1}return!0}toString(){let t=[];return this.forEach(e=>{t.push(e.toString())}),t.length===0?"DocumentSet ()":`DocumentSet (
  `+t.join(`  
`)+`
)`}copy(t,e){let i=new n;return i.comparator=this.comparator,i.keyedMap=t,i.sortedSet=e,i}};var Pu=class{constructor(){this.W_=new Vt(K.comparator)}track(t){let e=t.doc.key,i=this.W_.get(e);i?t.type!==0&&i.type===3?this.W_=this.W_.insert(e,t):t.type===3&&i.type!==1?this.W_=this.W_.insert(e,{type:i.type,doc:t.doc}):t.type===2&&i.type===2?this.W_=this.W_.insert(e,{type:2,doc:t.doc}):t.type===2&&i.type===0?this.W_=this.W_.insert(e,{type:0,doc:t.doc}):t.type===1&&i.type===0?this.W_=this.W_.remove(e):t.type===1&&i.type===2?this.W_=this.W_.insert(e,{type:1,doc:i.doc}):t.type===0&&i.type===1?this.W_=this.W_.insert(e,{type:2,doc:t.doc}):J():this.W_=this.W_.insert(e,t)}G_(){let t=[];return this.W_.inorderTraversal((e,i)=>{t.push(i)}),t}},vo=class n{constructor(t,e,i,r,s,o,a,c,l){this.query=t,this.docs=e,this.oldDocs=i,this.docChanges=r,this.mutatedKeys=s,this.fromCache=o,this.syncStateChanged=a,this.excludesMetadataChanges=c,this.hasCachedResults=l}static fromInitialDocuments(t,e,i,r,s){let o=[];return e.forEach(a=>{o.push({type:0,doc:a})}),new n(t,e,Cu.emptySet(e),o,i,r,!0,!1,s)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(t){if(!(this.fromCache===t.fromCache&&this.hasCachedResults===t.hasCachedResults&&this.syncStateChanged===t.syncStateChanged&&this.mutatedKeys.isEqual(t.mutatedKeys)&&_c(this.query,t.query)&&this.docs.isEqual(t.docs)&&this.oldDocs.isEqual(t.oldDocs)))return!1;let e=this.docChanges,i=t.docChanges;if(e.length!==i.length)return!1;for(let r=0;r<e.length;r++)if(e[r].type!==i[r].type||!e[r].doc.isEqual(i[r].doc))return!1;return!0}};var zp=class{constructor(){this.z_=void 0,this.j_=[]}H_(){return this.j_.some(t=>t.J_())}},jp=class{constructor(){this.queries=iv(),this.onlineState="Unknown",this.Y_=new Set}terminate(){(function(e,i){let r=$(e),s=r.queries;r.queries=iv(),s.forEach((o,a)=>{for(let c of a.j_)c.onError(i)})})(this,new q(z.ABORTED,"Firestore shutting down"))}};function iv(){return new Qn(n=>Nv(n),_c)}function Dg(n,t){return U(this,null,function*(){let e=$(n),i=3,r=t.query,s=e.queries.get(r);s?!s.H_()&&t.J_()&&(i=2):(s=new zp,i=t.J_()?0:1);try{switch(i){case 0:s.z_=yield e.onListen(r,!0);break;case 1:s.z_=yield e.onListen(r,!1);break;case 2:yield e.onFirstRemoteStoreListen(r)}}catch(o){let a=Po(o,`Initialization of query '${Js(t.query)}' failed`);return void t.onError(a)}e.queries.set(r,s),s.j_.push(t),t.Z_(e.onlineState),s.z_&&t.X_(s.z_)&&Og(e)})}function Mg(n,t){return U(this,null,function*(){let e=$(n),i=t.query,r=3,s=e.queries.get(i);if(s){let o=s.j_.indexOf(t);o>=0&&(s.j_.splice(o,1),s.j_.length===0?r=t.J_()?0:1:!s.H_()&&t.J_()&&(r=2))}switch(r){case 0:return e.queries.delete(i),e.onUnlisten(i,!0);case 1:return e.queries.delete(i),e.onUnlisten(i,!1);case 2:return e.onLastRemoteStoreUnlisten(i);default:return}})}function XA(n,t){let e=$(n),i=!1;for(let r of t){let s=r.query,o=e.queries.get(s);if(o){for(let a of o.j_)a.X_(r)&&(i=!0);o.z_=r}}i&&Og(e)}function JA(n,t,e){let i=$(n),r=i.queries.get(t);if(r)for(let s of r.j_)s.onError(e);i.queries.delete(t)}function Og(n){n.Y_.forEach(t=>{t.next()})}var Up,rv;(rv=Up||(Up={})).ea="default",rv.Cache="cache";var lc=class{constructor(t,e,i){this.query=t,this.ta=e,this.na=!1,this.ra=null,this.onlineState="Unknown",this.options=i||{}}X_(t){if(!this.options.includeMetadataChanges){let i=[];for(let r of t.docChanges)r.type!==3&&i.push(r);t=new vo(t.query,t.docs,t.oldDocs,i,t.mutatedKeys,t.fromCache,t.syncStateChanged,!0,t.hasCachedResults)}let e=!1;return this.na?this.ia(t)&&(this.ta.next(t),e=!0):this.sa(t,this.onlineState)&&(this.oa(t),e=!0),this.ra=t,e}onError(t){this.ta.error(t)}Z_(t){this.onlineState=t;let e=!1;return this.ra&&!this.na&&this.sa(this.ra,t)&&(this.oa(this.ra),e=!0),e}sa(t,e){if(!t.fromCache||!this.J_())return!0;let i=e!=="Offline";return(!this.options._a||!i)&&(!t.docs.isEmpty()||t.hasCachedResults||e==="Offline")}ia(t){if(t.docChanges.length>0)return!0;let e=this.ra&&this.ra.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&this.options.includeMetadataChanges===!0}oa(t){t=vo.fromInitialDocuments(t.query,t.docs,t.mutatedKeys,t.fromCache,t.hasCachedResults),this.na=!0,this.ta.next(t)}J_(){return this.options.source!==Up.Cache}};var qp=class{constructor(t,e){this.aa=t,this.byteLength=e}ua(){return"metadata"in this.aa}};var ku=class{constructor(t){this.serializer=t}Es(t){return Gn(this.serializer,t)}ds(t){return t.metadata.exists?rb(this.serializer,t.document,!1):oe.newNoDocument(this.Es(t.metadata.name),this.As(t.metadata.readTime))}As(t){return Jt(t)}},Wp=class{constructor(t,e,i){this.ca=t,this.localStore=e,this.serializer=i,this.queries=[],this.documents=[],this.collectionGroups=new Set,this.progress=Rb(t)}la(t){this.progress.bytesLoaded+=t.byteLength;let e=this.progress.documentsLoaded;if(t.aa.namedQuery)this.queries.push(t.aa.namedQuery);else if(t.aa.documentMetadata){this.documents.push({metadata:t.aa.documentMetadata}),t.aa.documentMetadata.exists||++e;let i=mt.fromString(t.aa.documentMetadata.name);this.collectionGroups.add(i.get(i.length-2))}else t.aa.document&&(this.documents[this.documents.length-1].document=t.aa.document,++e);return e!==this.progress.documentsLoaded?(this.progress.documentsLoaded=e,Object.assign({},this.progress)):null}ha(t){let e=new Map,i=new ku(this.serializer);for(let r of t)if(r.metadata.queries){let s=i.Es(r.metadata.name);for(let o of r.metadata.queries){let a=(e.get(o)||lt()).add(s);e.set(o,a)}}return e}complete(){return U(this,null,function*(){let t=yield LA(this.localStore,new ku(this.serializer),this.documents,this.ca.id),e=this.ha(this.documents);for(let i of this.queries)yield BA(this.localStore,i,e.get(i.name));return this.progress.taskState="Success",{progress:this.progress,Pa:this.collectionGroups,Ia:t}})}};function Rb(n){return{taskState:"Running",documentsLoaded:0,bytesLoaded:0,totalDocuments:n.totalDocuments,totalBytes:n.totalBytes}}var Ru=class{constructor(t){this.key=t}},Du=class{constructor(t){this.key=t}},Mu=class{constructor(t,e){this.query=t,this.Ta=e,this.Ea=null,this.hasCachedResults=!1,this.current=!1,this.da=lt(),this.mutatedKeys=lt(),this.Aa=Lv(t),this.Ra=new Cu(this.Aa)}get Va(){return this.Ta}ma(t,e){let i=e?e.fa:new Pu,r=e?e.Ra:this.Ra,s=e?e.mutatedKeys:this.mutatedKeys,o=r,a=!1,c=this.query.limitType==="F"&&r.size===this.query.limit?r.last():null,l=this.query.limitType==="L"&&r.size===this.query.limit?r.first():null;if(t.inorderTraversal((h,d)=>{let p=r.get(h),g=yc(this.query,d)?d:null,y=!!p&&this.mutatedKeys.has(p.key),v=!!g&&(g.hasLocalMutations||this.mutatedKeys.has(g.key)&&g.hasCommittedMutations),w=!1;p&&g?p.data.isEqual(g.data)?y!==v&&(i.track({type:3,doc:g}),w=!0):this.ga(p,g)||(i.track({type:2,doc:g}),w=!0,(c&&this.Aa(g,c)>0||l&&this.Aa(g,l)<0)&&(a=!0)):!p&&g?(i.track({type:0,doc:g}),w=!0):p&&!g&&(i.track({type:1,doc:p}),w=!0,(c||l)&&(a=!0)),w&&(g?(o=o.add(g),s=v?s.add(h):s.delete(h)):(o=o.delete(h),s=s.delete(h)))}),this.query.limit!==null)for(;o.size>this.query.limit;){let h=this.query.limitType==="F"?o.last():o.first();o=o.delete(h.key),s=s.delete(h.key),i.track({type:1,doc:h})}return{Ra:o,fa:i,ns:a,mutatedKeys:s}}ga(t,e){return t.hasLocalMutations&&e.hasCommittedMutations&&!e.hasLocalMutations}applyChanges(t,e,i,r){let s=this.Ra;this.Ra=t.Ra,this.mutatedKeys=t.mutatedKeys;let o=t.fa.G_();o.sort((h,d)=>function(g,y){let v=w=>{switch(w){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return J()}};return v(g)-v(y)}(h.type,d.type)||this.Aa(h.doc,d.doc)),this.pa(i),r=r!=null&&r;let a=e&&!r?this.ya():[],c=this.da.size===0&&this.current&&!r?1:0,l=c!==this.Ea;return this.Ea=c,o.length!==0||l?{snapshot:new vo(this.query,t.Ra,s,o,t.mutatedKeys,c===0,l,!1,!!i&&i.resumeToken.approximateByteSize()>0),wa:a}:{wa:a}}Z_(t){return this.current&&t==="Offline"?(this.current=!1,this.applyChanges({Ra:this.Ra,fa:new Pu,mutatedKeys:this.mutatedKeys,ns:!1},!1)):{wa:[]}}Sa(t){return!this.Ta.has(t)&&!!this.Ra.has(t)&&!this.Ra.get(t).hasLocalMutations}pa(t){t&&(t.addedDocuments.forEach(e=>this.Ta=this.Ta.add(e)),t.modifiedDocuments.forEach(e=>{}),t.removedDocuments.forEach(e=>this.Ta=this.Ta.delete(e)),this.current=t.current)}ya(){if(!this.current)return[];let t=this.da;this.da=lt(),this.Ra.forEach(i=>{this.Sa(i.key)&&(this.da=this.da.add(i.key))});let e=[];return t.forEach(i=>{this.da.has(i)||e.push(new Du(i))}),this.da.forEach(i=>{t.has(i)||e.push(new Ru(i))}),e}ba(t){this.Ta=t.Ts,this.da=lt();let e=this.ma(t.documents);return this.applyChanges(e,!0)}Da(){return vo.fromInitialDocuments(this.query,this.Ra,this.mutatedKeys,this.Ea===0,this.hasCachedResults)}},Hp=class{constructor(t,e,i){this.query=t,this.targetId=e,this.view=i}},Gp=class{constructor(t){this.key=t,this.va=!1}},$p=class{constructor(t,e,i,r,s,o){this.localStore=t,this.remoteStore=e,this.eventManager=i,this.sharedClientState=r,this.currentUser=s,this.maxConcurrentLimboResolutions=o,this.Ca={},this.Fa=new Qn(a=>Nv(a),_c),this.Ma=new Map,this.xa=new Set,this.Oa=new Vt(K.comparator),this.Na=new Map,this.La=new oc,this.Ba={},this.ka=new Map,this.qa=go.kn(),this.onlineState="Unknown",this.Qa=void 0}get isPrimaryClient(){return this.Qa===!0}};function ZA(n,t,e=!0){return U(this,null,function*(){let i=$u(n),r,s=i.Fa.get(t);return s?(i.sharedClientState.addLocalQueryTarget(s.targetId),r=s.view.Da()):r=yield Db(i,t,e,!0),r})}function tC(n,t){return U(this,null,function*(){let e=$u(n);yield Db(e,t,!0,!1)})}function Db(n,t,e,i){return U(this,null,function*(){let r=yield mo(n.localStore,je(t)),s=r.targetId,o=n.sharedClientState.addLocalQueryTarget(s,e),a;return i&&(a=yield Vg(n,t,s,o==="current",r.resumeToken)),n.isPrimaryClient&&e&&Gu(n.remoteStore,r),a})}function Vg(n,t,e,i,r){return U(this,null,function*(){n.Ka=(d,p,g)=>function(v,w,k,R){return U(this,null,function*(){let M=w.view.ma(k);M.ns&&(M=yield xu(v.localStore,w.query,!1).then(({documents:I})=>w.view.ma(I,M)));let F=R&&R.targetChanges.get(w.targetId),V=R&&R.targetMismatches.get(w.targetId)!=null,L=w.view.applyChanges(M,v.isPrimaryClient,F,V);return Kp(v,w.targetId,L.wa),L.snapshot})}(n,d,p,g);let s=yield xu(n.localStore,t,!0),o=new Mu(t,s.Ts),a=o.ma(s.documents),c=nc.createSynthesizedTargetChangeForCurrentChange(e,i&&n.onlineState!=="Offline",r),l=o.applyChanges(a,n.isPrimaryClient,c);Kp(n,e,l.wa);let h=new Hp(t,e,o);return n.Fa.set(t,h),n.Ma.has(e)?n.Ma.get(e).push(t):n.Ma.set(e,[t]),l.snapshot})}function eC(n,t,e){return U(this,null,function*(){let i=$(n),r=i.Fa.get(t),s=i.Ma.get(r.targetId);if(s.length>1)return i.Ma.set(r.targetId,s.filter(o=>!_c(o,t))),void i.Fa.delete(t);i.isPrimaryClient?(i.sharedClientState.removeLocalQueryTarget(r.targetId),i.sharedClientState.isActiveQueryTarget(r.targetId)||(yield _o(i.localStore,r.targetId,!1).then(()=>{i.sharedClientState.clearQueryState(r.targetId),e&&yo(i.remoteStore,r.targetId),bo(i,r.targetId)}).catch(lr))):(bo(i,r.targetId),yield _o(i.localStore,r.targetId,!0))})}function nC(n,t){return U(this,null,function*(){let e=$(n),i=e.Fa.get(t),r=e.Ma.get(i.targetId);e.isPrimaryClient&&r.length===1&&(e.sharedClientState.removeLocalQueryTarget(i.targetId),yo(e.remoteStore,i.targetId))})}function iC(n,t,e){return U(this,null,function*(){let i=Bg(n);try{let r=yield function(o,a){let c=$(o),l=Ut.now(),h=a.reduce((g,y)=>g.add(y.key),lt()),d,p;return c.persistence.runTransaction("Locally write mutations","readwrite",g=>{let y=Ye(),v=lt();return c.cs.getEntries(g,h).next(w=>{y=w,y.forEach((k,R)=>{R.isValidDocument()||(v=v.add(k))})}).next(()=>c.localDocuments.getOverlayedDocuments(g,y)).next(w=>{d=w;let k=[];for(let R of a){let M=_A(R,d.get(R.key).overlayedDocument);M!=null&&k.push(new On(R.key,M,Pv(M.value.mapValue),Kt.exists(!0)))}return c.mutationQueue.addMutationBatch(g,l,k,a)}).next(w=>{p=w;let k=w.applyToLocalDocumentSet(d,v);return c.documentOverlayCache.saveOverlays(g,w.batchId,k)})}).then(()=>({batchId:p.batchId,changes:zv(d)}))}(i.localStore,t);i.sharedClientState.addPendingMutation(r.batchId),function(o,a,c){let l=o.Ba[o.currentUser.toKey()];l||(l=new Vt(at)),l=l.insert(a,c),o.Ba[o.currentUser.toKey()]=l}(i,r.batchId,e),yield Ei(i,r.changes),yield Ao(i.remoteStore)}catch(r){let s=Po(r,"Failed to persist write");e.reject(s)}})}function Mb(n,t){return U(this,null,function*(){let e=$(n);try{let i=yield NA(e.localStore,t);t.targetChanges.forEach((r,s)=>{let o=e.Na.get(s);o&&(Z(r.addedDocuments.size+r.modifiedDocuments.size+r.removedDocuments.size<=1),r.addedDocuments.size>0?o.va=!0:r.modifiedDocuments.size>0?Z(o.va):r.removedDocuments.size>0&&(Z(o.va),o.va=!1))}),yield Ei(e,i,t)}catch(i){yield lr(i)}})}function sv(n,t,e){let i=$(n);if(i.isPrimaryClient&&e===0||!i.isPrimaryClient&&e===1){let r=[];i.Fa.forEach((s,o)=>{let a=o.view.Z_(t);a.snapshot&&r.push(a.snapshot)}),function(o,a){let c=$(o);c.onlineState=a;let l=!1;c.queries.forEach((h,d)=>{for(let p of d.j_)p.Z_(a)&&(l=!0)}),l&&Og(c)}(i.eventManager,t),r.length&&i.Ca.d_(r),i.onlineState=t,i.isPrimaryClient&&i.sharedClientState.setOnlineState(t)}}function rC(n,t,e){return U(this,null,function*(){let i=$(n);i.sharedClientState.updateQueryState(t,"rejected",e);let r=i.Na.get(t),s=r&&r.key;if(s){let o=new Vt(K.comparator);o=o.insert(s,oe.newNoDocument(s,it.min()));let a=lt().add(s),c=new ec(it.min(),new Map,new Vt(at),o,a);yield Mb(i,c),i.Oa=i.Oa.remove(s),i.Na.delete(t),Lg(i)}else yield _o(i.localStore,t,!1).then(()=>bo(i,t,e)).catch(lr)})}function sC(n,t){return U(this,null,function*(){let e=$(n),i=t.batch.batchId;try{let r=yield VA(e.localStore,t);Fg(e,i,null),Ng(e,i),e.sharedClientState.updateMutationState(i,"acknowledged"),yield Ei(e,r)}catch(r){yield lr(r)}})}function oC(n,t,e){return U(this,null,function*(){let i=$(n);try{let r=yield function(o,a){let c=$(o);return c.persistence.runTransaction("Reject batch","readwrite-primary",l=>{let h;return c.mutationQueue.lookupMutationBatch(l,a).next(d=>(Z(d!==null),h=d.keys(),c.mutationQueue.removeMutationBatch(l,d))).next(()=>c.mutationQueue.performConsistencyCheck(l)).next(()=>c.documentOverlayCache.removeOverlaysForBatchId(l,h,a)).next(()=>c.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(l,h)).next(()=>c.localDocuments.getDocuments(l,h))})}(i.localStore,t);Fg(i,t,e),Ng(i,t),i.sharedClientState.updateMutationState(t,"rejected",e),yield Ei(i,r)}catch(r){yield lr(r)}})}function aC(n,t){return U(this,null,function*(){let e=$(n);hr(e.remoteStore)||H("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled.");try{let i=yield function(o){let a=$(o);return a.persistence.runTransaction("Get highest unacknowledged batch id","readonly",c=>a.mutationQueue.getHighestUnacknowledgedBatchId(c))}(e.localStore);if(i===-1)return void t.resolve();let r=e.ka.get(i)||[];r.push(t),e.ka.set(i,r)}catch(i){let r=Po(i,"Initialization of waitForPendingWrites() operation failed");t.reject(r)}})}function Ng(n,t){(n.ka.get(t)||[]).forEach(e=>{e.resolve()}),n.ka.delete(t)}function Fg(n,t,e){let i=$(n),r=i.Ba[i.currentUser.toKey()];if(r){let s=r.get(t);s&&(e?s.reject(e):s.resolve(),r=r.remove(t)),i.Ba[i.currentUser.toKey()]=r}}function bo(n,t,e=null){n.sharedClientState.removeLocalQueryTarget(t);for(let i of n.Ma.get(t))n.Fa.delete(i),e&&n.Ca.$a(i,e);n.Ma.delete(t),n.isPrimaryClient&&n.La.gr(t).forEach(i=>{n.La.containsKey(i)||Ob(n,i)})}function Ob(n,t){n.xa.delete(t.path.canonicalString());let e=n.Oa.get(t);e!==null&&(yo(n.remoteStore,e),n.Oa=n.Oa.remove(t),n.Na.delete(e),Lg(n))}function Kp(n,t,e){for(let i of e)i instanceof Ru?(n.La.addReference(i.key,t),cC(n,i)):i instanceof Du?(H("SyncEngine","Document no longer in limbo: "+i.key),n.La.removeReference(i.key,t),n.La.containsKey(i.key)||Ob(n,i.key)):J()}function cC(n,t){let e=t.key,i=e.path.canonicalString();n.Oa.get(e)||n.xa.has(i)||(H("SyncEngine","New document in limbo: "+e),n.xa.add(i),Lg(n))}function Lg(n){for(;n.xa.size>0&&n.Oa.size<n.maxConcurrentLimboResolutions;){let t=n.xa.values().next().value;n.xa.delete(t);let e=new K(mt.fromString(t)),i=n.qa.next();n.Na.set(i,new Gp(e)),n.Oa=n.Oa.insert(e,i),Gu(n.remoteStore,new po(je(Io(e.path)),i,"TargetPurposeLimboResolution",an.oe))}}function Ei(n,t,e){return U(this,null,function*(){let i=$(n),r=[],s=[],o=[];i.Fa.isEmpty()||(i.Fa.forEach((a,c)=>{o.push(i.Ka(c,t,e).then(l=>{var h;if((l||e)&&i.isPrimaryClient){let d=l?!l.fromCache:(h=e?.targetChanges.get(c.targetId))===null||h===void 0?void 0:h.current;i.sharedClientState.updateQueryState(c.targetId,d?"current":"not-current")}if(l){r.push(l);let d=Sp.Wi(c.targetId,l);s.push(d)}}))}),yield Promise.all(o),i.Ca.d_(r),yield function(c,l){return U(this,null,function*(){let h=$(c);try{yield h.persistence.runTransaction("notifyLocalViewChanges","readwrite",d=>B.forEach(l,p=>B.forEach(p.$i,g=>h.persistence.referenceDelegate.addReference(d,p.targetId,g)).next(()=>B.forEach(p.Ui,g=>h.persistence.referenceDelegate.removeReference(d,p.targetId,g)))))}catch(d){if(!ur(d))throw d;H("LocalStore","Failed to update sequence numbers: "+d)}for(let d of l){let p=d.targetId;if(!d.fromCache){let g=h.os.get(p),y=g.snapshotVersion,v=g.withLastLimboFreeSnapshotVersion(y);h.os=h.os.insert(p,v)}}})}(i.localStore,s))})}function lC(n,t){return U(this,null,function*(){let e=$(n);if(!e.currentUser.isEqual(t)){H("SyncEngine","User change. New user:",t.toKey());let i=yield vb(e.localStore,t);e.currentUser=t,function(s,o){s.ka.forEach(a=>{a.forEach(c=>{c.reject(new q(z.CANCELLED,o))})}),s.ka.clear()}(e,"'waitForPendingWrites' promise is rejected due to a user change."),e.sharedClientState.handleUserChange(t,i.removedBatchIds,i.addedBatchIds),yield Ei(e,i.hs)}})}function uC(n,t){let e=$(n),i=e.Na.get(t);if(i&&i.va)return lt().add(i.key);{let r=lt(),s=e.Ma.get(t);if(!s)return r;for(let o of s){let a=e.Fa.get(o);r=r.unionWith(a.view.Va)}return r}}function hC(n,t){return U(this,null,function*(){let e=$(n),i=yield xu(e.localStore,t.query,!0),r=t.view.ba(i);return e.isPrimaryClient&&Kp(e,t.targetId,r.wa),r})}function dC(n,t){return U(this,null,function*(){let e=$(n);return Tb(e.localStore,t).then(i=>Ei(e,i))})}function fC(n,t,e,i){return U(this,null,function*(){let r=$(n),s=yield function(a,c){let l=$(a),h=$(l.mutationQueue);return l.persistence.runTransaction("Lookup mutation documents","readonly",d=>h.Mn(d,c).next(p=>p?l.localDocuments.getDocuments(d,p):B.resolve(null)))}(r.localStore,t);s!==null?(e==="pending"?yield Ao(r.remoteStore):e==="acknowledged"||e==="rejected"?(Fg(r,t,i||null),Ng(r,t),function(a,c){$($(a).mutationQueue).On(c)}(r.localStore,t)):J(),yield Ei(r,s)):H("SyncEngine","Cannot apply mutation batch with id: "+t)})}function pC(n,t){return U(this,null,function*(){let e=$(n);if($u(e),Bg(e),t===!0&&e.Qa!==!0){let i=e.sharedClientState.getAllActiveQueryTargets(),r=yield ov(e,i.toArray());e.Qa=!0,yield Lp(e.remoteStore,!0);for(let s of r)Gu(e.remoteStore,s)}else if(t===!1&&e.Qa!==!1){let i=[],r=Promise.resolve();e.Ma.forEach((s,o)=>{e.sharedClientState.isLocalQueryTarget(o)?i.push(o):r=r.then(()=>(bo(e,o),_o(e.localStore,o,!0))),yo(e.remoteStore,o)}),yield r,yield ov(e,i),function(o){let a=$(o);a.Na.forEach((c,l)=>{yo(a.remoteStore,l)}),a.La.pr(),a.Na=new Map,a.Oa=new Vt(K.comparator)}(e),e.Qa=!1,yield Lp(e.remoteStore,!1)}})}function ov(n,t,e){return U(this,null,function*(){let i=$(n),r=[],s=[];for(let o of t){let a,c=i.Ma.get(o);if(c&&c.length!==0){a=yield mo(i.localStore,je(c[0]));for(let l of c){let h=i.Fa.get(l),d=yield hC(i,h);d.snapshot&&s.push(d.snapshot)}}else{let l=yield wb(i.localStore,o);a=yield mo(i.localStore,l),yield Vg(i,Vb(l),o,!1,a.resumeToken)}r.push(a)}return i.Ca.d_(s),r})}function Vb(n){return Vv(n.path,n.collectionGroup,n.orderBy,n.filters,n.limit,"F",n.startAt,n.endAt)}function gC(n){return function(e){return $($(e).persistence).Qi()}($(n).localStore)}function mC(n,t,e,i){return U(this,null,function*(){let r=$(n);if(r.Qa)return void H("SyncEngine","Ignoring unexpected query state notification.");let s=r.Ma.get(t);if(s&&s.length>0)switch(e){case"current":case"not-current":{let o=yield Tb(r.localStore,Fv(s[0])),a=ec.createSynthesizedRemoteEventForCurrentChange(t,e==="current",Zt.EMPTY_BYTE_STRING);yield Ei(r,o,a);break}case"rejected":yield _o(r.localStore,t,!0),bo(r,t,i);break;default:J()}})}function _C(n,t,e){return U(this,null,function*(){let i=$u(n);if(i.Qa){for(let r of t){if(i.Ma.has(r)&&i.sharedClientState.isActiveQueryTarget(r)){H("SyncEngine","Adding an already active target "+r);continue}let s=yield wb(i.localStore,r),o=yield mo(i.localStore,s);yield Vg(i,Vb(s),o.targetId,!1,o.resumeToken),Gu(i.remoteStore,o)}for(let r of e)i.Ma.has(r)&&(yield _o(i.localStore,r,!1).then(()=>{yo(i.remoteStore,r),bo(i,r)}).catch(lr))}})}function $u(n){let t=$(n);return t.remoteStore.remoteSyncer.applyRemoteEvent=Mb.bind(null,t),t.remoteStore.remoteSyncer.getRemoteKeysForTarget=uC.bind(null,t),t.remoteStore.remoteSyncer.rejectListen=rC.bind(null,t),t.Ca.d_=XA.bind(null,t.eventManager),t.Ca.$a=JA.bind(null,t.eventManager),t}function Bg(n){let t=$(n);return t.remoteStore.remoteSyncer.applySuccessfulWrite=sC.bind(null,t),t.remoteStore.remoteSyncer.rejectFailedWrite=oC.bind(null,t),t}function yC(n,t,e){let i=$(n);(function(s,o,a){return U(this,null,function*(){try{let c=yield o.getMetadata();if(yield function(g,y){let v=$(g),w=Jt(y.createTime);return v.persistence.runTransaction("hasNewerBundle","readonly",k=>v.Gr.getBundleMetadata(k,y.id)).then(k=>!!k&&k.createTime.compareTo(w)>=0)}(s.localStore,c))return yield o.close(),a._completeWith(function(g){return{taskState:"Success",documentsLoaded:g.totalDocuments,bytesLoaded:g.totalBytes,totalDocuments:g.totalDocuments,totalBytes:g.totalBytes}}(c)),Promise.resolve(new Set);a._updateProgress(Rb(c));let l=new Wp(c,s.localStore,o.serializer),h=yield o.Ua();for(;h;){let p=yield l.la(h);p&&a._updateProgress(p),h=yield o.Ua()}let d=yield l.complete();return yield Ei(s,d.Ia,void 0),yield function(g,y){let v=$(g);return v.persistence.runTransaction("Save bundle","readwrite",w=>v.Gr.saveBundleMetadata(w,y))}(s.localStore,c),a._completeWith(d.progress),Promise.resolve(d.Pa)}catch(c){return yn("SyncEngine",`Loading bundle failed with ${c}`),a._failWith(c),Promise.resolve(new Set)}})})(i,t,e).then(r=>{i.sharedClientState.notifyBundleLoaded(r)})}var uc=class{constructor(){this.synchronizeTabs=!1}initialize(t){return U(this,null,function*(){this.serializer=vc(t.databaseInfo.databaseId),this.sharedClientState=this.createSharedClientState(t),this.persistence=this.createPersistence(t),yield this.persistence.start(),this.localStore=this.createLocalStore(t),this.gcScheduler=this.createGarbageCollectionScheduler(t,this.localStore),this.indexBackfillerScheduler=this.createIndexBackfillerScheduler(t,this.localStore)})}createGarbageCollectionScheduler(t,e){return null}createIndexBackfillerScheduler(t,e){return null}createLocalStore(t){return yb(this.persistence,new bu,t.initialUser,this.serializer)}createPersistence(t){return new yu(vu.Zr,this.serializer)}createSharedClientState(t){return new Eu}terminate(){return U(this,null,function*(){var t,e;(t=this.gcScheduler)===null||t===void 0||t.stop(),(e=this.indexBackfillerScheduler)===null||e===void 0||e.stop(),this.sharedClientState.shutdown(),yield this.persistence.shutdown()})}};var Ou=class n extends uc{constructor(t,e,i){super(),this.Wa=t,this.cacheSizeBytes=e,this.forceOwnership=i,this.synchronizeTabs=!1}initialize(t){return U(this,null,function*(){yield kd(n.prototype,this,"initialize").call(this,t),yield this.Wa.initialize(this,t),yield Bg(this.Wa.syncEngine),yield Ao(this.Wa.remoteStore),yield this.persistence.yi(()=>(this.gcScheduler&&!this.gcScheduler.started&&this.gcScheduler.start(),this.indexBackfillerScheduler&&!this.indexBackfillerScheduler.started&&this.indexBackfillerScheduler.start(),Promise.resolve()))})}createLocalStore(t){return yb(this.persistence,new bu,t.initialUser,this.serializer)}createGarbageCollectionScheduler(t,e){let i=this.persistence.referenceDelegate.garbageCollector;return new up(i,t.asyncQueue,e)}createIndexBackfillerScheduler(t,e){let i=new Af(e,this.persistence);return new Sf(t.asyncQueue,i)}createPersistence(t){let e=Cg(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey),i=this.cacheSizeBytes!==void 0?_n.withCacheSize(this.cacheSizeBytes):_n.DEFAULT;return new Ip(this.synchronizeTabs,e,t.clientId,i,t.asyncQueue,Ib(),Gl(),this.serializer,this.sharedClientState,!!this.forceOwnership)}createSharedClientState(t){return new Eu}},Yp=class n extends Ou{constructor(t,e){super(t,e,!1),this.Wa=t,this.cacheSizeBytes=e,this.synchronizeTabs=!0}initialize(t){return U(this,null,function*(){yield kd(n.prototype,this,"initialize").call(this,t);let e=this.Wa.syncEngine;this.sharedClientState instanceof Ha&&(this.sharedClientState.syncEngine={no:fC.bind(null,e),ro:mC.bind(null,e),io:_C.bind(null,e),Qi:gC.bind(null,e),eo:dC.bind(null,e)},yield this.sharedClientState.start()),yield this.persistence.yi(i=>U(this,null,function*(){yield pC(this.Wa.syncEngine,i),this.gcScheduler&&(i&&!this.gcScheduler.started?this.gcScheduler.start():i||this.gcScheduler.stop()),this.indexBackfillerScheduler&&(i&&!this.indexBackfillerScheduler.started?this.indexBackfillerScheduler.start():i||this.indexBackfillerScheduler.stop())}))})}createSharedClientState(t){let e=Ib();if(!Ha.D(e))throw new q(z.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");let i=Cg(t.databaseInfo.databaseId,t.databaseInfo.persistenceKey);return new Ha(e,t.asyncQueue,i,t.clientId,t.initialUser)}},hc=class{initialize(t,e){return U(this,null,function*(){this.localStore||(this.localStore=t.localStore,this.sharedClientState=t.sharedClientState,this.datastore=this.createDatastore(e),this.remoteStore=this.createRemoteStore(e),this.eventManager=this.createEventManager(e),this.syncEngine=this.createSyncEngine(e,!t.synchronizeTabs),this.sharedClientState.onlineStateHandler=i=>sv(this.syncEngine,i,1),this.remoteStore.remoteSyncer.handleCredentialChange=lC.bind(null,this.syncEngine),yield Lp(this.remoteStore,this.syncEngine.isPrimaryClient))})}createEventManager(t){return function(){return new jp}()}createDatastore(t){let e=vc(t.databaseInfo.databaseId),i=function(s){return new Dp(s)}(t.databaseInfo);return function(s,o,a,c){return new Vp(s,o,a,c)}(t.authCredentials,t.appCheckCredentials,i,e)}createRemoteStore(t){return function(i,r,s,o,a){return new Fp(i,r,s,o,a)}(this.localStore,this.datastore,t.asyncQueue,e=>sv(this.syncEngine,e,0),function(){return Iu.D()?new Iu:new kp}())}createSyncEngine(t,e){return function(r,s,o,a,c,l,h){let d=new $p(r,s,o,a,c,l);return h&&(d.Qa=!0),d}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,t.initialUser,t.maxConcurrentLimboResolutions,e)}terminate(){return U(this,null,function*(){var t,e;yield function(r){return U(this,null,function*(){let s=$(r);H("RemoteStore","RemoteStore shutting down."),s.L_.add(5),yield So(s),s.k_.shutdown(),s.q_.set("Unknown")})}(this.remoteStore),(t=this.datastore)===null||t===void 0||t.terminate(),(e=this.eventManager)===null||e===void 0||e.terminate()})}};function av(n,t=10240){let e=0;return{read(){return U(this,null,function*(){if(e<n.byteLength){let r={value:n.slice(e,e+t),done:!1};return e+=t,r}return{done:!0}})},cancel(){return U(this,null,function*(){})},releaseLock(){},closed:Promise.resolve()}}var xo=class{constructor(t){this.observer=t,this.muted=!1}next(t){this.observer.next&&this.Ga(this.observer.next,t)}error(t){this.observer.error?this.Ga(this.observer.error,t):Qt("Uncaught Error in snapshot listener:",t.toString())}za(){this.muted=!0}Ga(t,e){this.muted||setTimeout(()=>{this.muted||t(e)},0)}};var Qp=class{constructor(t,e){this.ja=t,this.serializer=e,this.metadata=new se,this.buffer=new Uint8Array,this.Ha=function(){return new TextDecoder("utf-8")}(),this.Ja().then(i=>{i&&i.ua()?this.metadata.resolve(i.aa.metadata):this.metadata.reject(new Error(`The first element of the bundle is not a metadata, it is
             ${JSON.stringify(i?.aa)}`))},i=>this.metadata.reject(i))}close(){return this.ja.cancel()}getMetadata(){return U(this,null,function*(){return this.metadata.promise})}Ua(){return U(this,null,function*(){return yield this.getMetadata(),this.Ja()})}Ja(){return U(this,null,function*(){let t=yield this.Ya();if(t===null)return null;let e=this.Ha.decode(t),i=Number(e);isNaN(i)&&this.Za(`length string (${e}) is not valid number`);let r=yield this.Xa(i);return new qp(JSON.parse(r),t.length+i)})}eu(){return this.buffer.findIndex(t=>t===123)}Ya(){return U(this,null,function*(){for(;this.eu()<0&&!(yield this.tu()););if(this.buffer.length===0)return null;let t=this.eu();t<0&&this.Za("Reached the end of bundle when a length string is expected.");let e=this.buffer.slice(0,t);return this.buffer=this.buffer.slice(t),e})}Xa(t){return U(this,null,function*(){for(;this.buffer.length<t;)(yield this.tu())&&this.Za("Reached the end of bundle when more is expected.");let e=this.Ha.decode(this.buffer.slice(0,t));return this.buffer=this.buffer.slice(t),e})}Za(t){throw this.ja.cancel(),new Error(`Invalid bundle format: ${t}`)}tu(){return U(this,null,function*(){let t=yield this.ja.read();if(!t.done){let e=new Uint8Array(this.buffer.length+t.value.length);e.set(this.buffer),e.set(t.value,this.buffer.length),this.buffer=e}return t.done})}};var Xp=class{constructor(t){this.datastore=t,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastTransactionError=null,this.writtenDocs=new Set}lookup(t){return U(this,null,function*(){if(this.ensureCommitNotCalled(),this.mutations.length>0)throw this.lastTransactionError=new q(z.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes."),this.lastTransactionError;let e=yield function(r,s){return U(this,null,function*(){let o=$(r),a={documents:s.map(d=>ic(o.serializer,d))},c=yield o.Lo("BatchGetDocuments",o.serializer.databaseId,mt.emptyPath(),a,s.length),l=new Map;c.forEach(d=>{let p=TA(o.serializer,d);l.set(p.key.toString(),p)});let h=[];return s.forEach(d=>{let p=l.get(d.toString());Z(!!p),h.push(p)}),h})}(this.datastore,t);return e.forEach(i=>this.recordVersion(i)),e})}set(t,e){this.write(e.toMutation(t,this.precondition(t))),this.writtenDocs.add(t.toString())}update(t,e){try{this.write(e.toMutation(t,this.preconditionForUpdate(t)))}catch(i){this.lastTransactionError=i}this.writtenDocs.add(t.toString())}delete(t){this.write(new ar(t,this.precondition(t))),this.writtenDocs.add(t.toString())}commit(){return U(this,null,function*(){if(this.ensureCommitNotCalled(),this.lastTransactionError)throw this.lastTransactionError;let t=this.readVersions;this.mutations.forEach(e=>{t.delete(e.key.toString())}),t.forEach((e,i)=>{let r=K.fromPath(i);this.mutations.push(new Ja(r,this.precondition(r)))}),yield function(i,r){return U(this,null,function*(){let s=$(i),o={writes:r.map(a=>rc(s.serializer,a))};yield s.Mo("Commit",s.serializer.databaseId,mt.emptyPath(),o)})}(this.datastore,this.mutations),this.committed=!0})}recordVersion(t){let e;if(t.isFoundDocument())e=t.version;else{if(!t.isNoDocument())throw J();e=it.min()}let i=this.readVersions.get(t.key.toString());if(i){if(!e.isEqual(i))throw new q(z.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(t.key.toString(),e)}precondition(t){let e=this.readVersions.get(t.toString());return!this.writtenDocs.has(t.toString())&&e?e.isEqual(it.min())?Kt.exists(!1):Kt.updateTime(e):Kt.none()}preconditionForUpdate(t){let e=this.readVersions.get(t.toString());if(!this.writtenDocs.has(t.toString())&&e){if(e.isEqual(it.min()))throw new q(z.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return Kt.updateTime(e)}return Kt.exists(!0)}write(t){this.ensureCommitNotCalled(),this.mutations.push(t)}ensureCommitNotCalled(){}};var Jp=class{constructor(t,e,i,r,s){this.asyncQueue=t,this.datastore=e,this.options=i,this.updateFunction=r,this.deferred=s,this.nu=i.maxAttempts,this.t_=new cc(this.asyncQueue,"transaction_retry")}ru(){this.nu-=1,this.iu()}iu(){this.t_.Go(()=>U(this,null,function*(){let t=new Xp(this.datastore),e=this.su(t);e&&e.then(i=>{this.asyncQueue.enqueueAndForget(()=>t.commit().then(()=>{this.deferred.resolve(i)}).catch(r=>{this.ou(r)}))}).catch(i=>{this.ou(i)})}))}su(t){try{let e=this.updateFunction(t);return!gc(e)&&e.catch&&e.then?e:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(e){return this.deferred.reject(e),null}}ou(t){this.nu>0&&this._u(t)?(this.nu-=1,this.asyncQueue.enqueueAndForget(()=>(this.iu(),Promise.resolve()))):this.deferred.reject(t)}_u(t){if(t.name==="FirebaseError"){let e=t.code;return e==="aborted"||e==="failed-precondition"||e==="already-exists"||!Qv(e)}return!1}};var Zp=class{constructor(t,e,i,r){this.authCredentials=t,this.appCheckCredentials=e,this.asyncQueue=i,this.databaseInfo=r,this.user=re.UNAUTHENTICATED,this.clientId=Yl.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this.authCredentials.start(i,s=>U(this,null,function*(){H("FirestoreClient","Received user=",s.uid),yield this.authCredentialListener(s),this.user=s})),this.appCheckCredentials.start(i,s=>(H("FirestoreClient","Received new app check token=",s),this.appCheckCredentialListener(s,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(t){this.authCredentialListener=t}setAppCheckTokenChangeListener(t){this.appCheckCredentialListener=t}verifyNotTerminated(){if(this.asyncQueue.isShuttingDown)throw new q(z.FAILED_PRECONDITION,"The client has already been terminated.")}terminate(){this.asyncQueue.enterRestrictedMode();let t=new se;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(()=>U(this,null,function*(){try{this._onlineComponents&&(yield this._onlineComponents.terminate()),this._offlineComponents&&(yield this._offlineComponents.terminate()),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),t.resolve()}catch(e){let i=Po(e,"Failed to shutdown persistence");t.reject(i)}})),t.promise}};function $l(n,t){return U(this,null,function*(){n.asyncQueue.verifyOperationInProgress(),H("FirestoreClient","Initializing OfflineComponentProvider");let e=n.configuration;yield t.initialize(e);let i=e.initialUser;n.setCredentialChangeListener(r=>U(this,null,function*(){i.isEqual(r)||(yield vb(t.localStore,r),i=r)})),t.persistence.setDatabaseDeletedListener(()=>n.terminate()),n._offlineComponents=t})}function tg(n,t){return U(this,null,function*(){n.asyncQueue.verifyOperationInProgress();let e=yield zg(n);H("FirestoreClient","Initializing OnlineComponentProvider"),yield t.initialize(e,n.configuration),n.setCredentialChangeListener(i=>nv(t.remoteStore,i)),n.setAppCheckTokenChangeListener((i,r)=>nv(t.remoteStore,r)),n._onlineComponents=t})}function Nb(n){return n.name==="FirebaseError"?n.code===z.FAILED_PRECONDITION||n.code===z.UNIMPLEMENTED:!(typeof DOMException<"u"&&n instanceof DOMException)||n.code===22||n.code===20||n.code===11}function zg(n){return U(this,null,function*(){if(!n._offlineComponents)if(n._uninitializedComponentsProvider){H("FirestoreClient","Using user provided OfflineComponentProvider");try{yield $l(n,n._uninitializedComponentsProvider._offline)}catch(t){let e=t;if(!Nb(e))throw e;yn("Error using user provided cache. Falling back to memory cache: "+e),yield $l(n,new uc)}}else H("FirestoreClient","Using default OfflineComponentProvider"),yield $l(n,new uc);return n._offlineComponents})}function Ku(n){return U(this,null,function*(){return n._onlineComponents||(n._uninitializedComponentsProvider?(H("FirestoreClient","Using user provided OnlineComponentProvider"),yield tg(n,n._uninitializedComponentsProvider._online)):(H("FirestoreClient","Using default OnlineComponentProvider"),yield tg(n,new hc))),n._onlineComponents})}function Fb(n){return zg(n).then(t=>t.persistence)}function jg(n){return zg(n).then(t=>t.localStore)}function Lb(n){return Ku(n).then(t=>t.remoteStore)}function Ug(n){return Ku(n).then(t=>t.syncEngine)}function vC(n){return Ku(n).then(t=>t.datastore)}function wo(n){return U(this,null,function*(){let t=yield Ku(n),e=t.eventManager;return e.onListen=ZA.bind(null,t.syncEngine),e.onUnlisten=eC.bind(null,t.syncEngine),e.onFirstRemoteStoreListen=tC.bind(null,t.syncEngine),e.onLastRemoteStoreUnlisten=nC.bind(null,t.syncEngine),e})}function bC(n){return n.asyncQueue.enqueue(()=>U(this,null,function*(){let t=yield Fb(n),e=yield Lb(n);return t.setNetworkEnabled(!0),function(r){let s=$(r);return s.L_.delete(0),bc(s)}(e)}))}function xC(n){return n.asyncQueue.enqueue(()=>U(this,null,function*(){let t=yield Fb(n),e=yield Lb(n);return t.setNetworkEnabled(!1),function(r){return U(this,null,function*(){let s=$(r);s.L_.add(0),yield So(s),s.q_.set("Offline")})}(e)}))}function wC(n,t){let e=new se;return n.asyncQueue.enqueueAndForget(()=>U(this,null,function*(){return function(r,s,o){return U(this,null,function*(){try{let a=yield function(l,h){let d=$(l);return d.persistence.runTransaction("read document","readonly",p=>d.localDocuments.getDocument(p,h))}(r,s);a.isFoundDocument()?o.resolve(a):a.isNoDocument()?o.resolve(null):o.reject(new q(z.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)"))}catch(a){let c=Po(a,`Failed to get document '${s} from cache`);o.reject(c)}})}(yield jg(n),t,e)})),e.promise}function Bb(n,t,e={}){let i=new se;return n.asyncQueue.enqueueAndForget(()=>U(this,null,function*(){return function(s,o,a,c,l){let h=new xo({next:p=>{o.enqueueAndForget(()=>Mg(s,d));let g=p.docs.has(a);!g&&p.fromCache?l.reject(new q(z.UNAVAILABLE,"Failed to get document because the client is offline.")):g&&p.fromCache&&c&&c.source==="server"?l.reject(new q(z.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):l.resolve(p)},error:p=>l.reject(p)}),d=new lc(Io(a.path),h,{includeMetadataChanges:!0,_a:!0});return Dg(s,d)}(yield wo(n),n.asyncQueue,t,e,i)})),i.promise}function TC(n,t){let e=new se;return n.asyncQueue.enqueueAndForget(()=>U(this,null,function*(){return function(r,s,o){return U(this,null,function*(){try{let a=yield xu(r,s,!0),c=new Mu(s,a.Ts),l=c.ma(a.documents),h=c.applyChanges(l,!1);o.resolve(h.snapshot)}catch(a){let c=Po(a,`Failed to execute query '${s} against cache`);o.reject(c)}})}(yield jg(n),t,e)})),e.promise}function zb(n,t,e={}){let i=new se;return n.asyncQueue.enqueueAndForget(()=>U(this,null,function*(){return function(s,o,a,c,l){let h=new xo({next:p=>{o.enqueueAndForget(()=>Mg(s,d)),p.fromCache&&c.source==="server"?l.reject(new q(z.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):l.resolve(p)},error:p=>l.reject(p)}),d=new lc(a,h,{includeMetadataChanges:!0,_a:!0});return Dg(s,d)}(yield wo(n),n.asyncQueue,t,e,i)})),i.promise}function EC(n,t){let e=new xo(t);return n.asyncQueue.enqueueAndForget(()=>U(this,null,function*(){return function(r,s){$(r).Y_.add(s),s.next()}(yield wo(n),e)})),()=>{e.za(),n.asyncQueue.enqueueAndForget(()=>U(this,null,function*(){return function(r,s){$(r).Y_.delete(s)}(yield wo(n),e)}))}}function IC(n,t,e,i){let r=function(o,a){let c;return c=typeof o=="string"?Jv().encode(o):o,function(h,d){return new Qp(h,d)}(function(h,d){if(h instanceof Uint8Array)return av(h,d);if(h instanceof ArrayBuffer)return av(new Uint8Array(h),d);if(h instanceof ReadableStream)return h.getReader();throw new Error("Source of `toByteStreamReader` has to be a ArrayBuffer or ReadableStream")}(c),a)}(e,vc(t));n.asyncQueue.enqueueAndForget(()=>U(this,null,function*(){yC(yield Ug(n),r,i)}))}function SC(n,t){return n.asyncQueue.enqueue(()=>U(this,null,function*(){return function(i,r){let s=$(i);return s.persistence.runTransaction("Get named query","readonly",o=>s.Gr.getNamedQuery(o,r))}(yield jg(n),t)}))}function jb(n){let t={};return n.timeoutSeconds!==void 0&&(t.timeoutSeconds=n.timeoutSeconds),t}var cv=new Map;function qg(n,t,e){if(!e)throw new q(z.INVALID_ARGUMENT,`Function ${n}() cannot be called with an empty ${t}.`)}function Wg(n,t,e,i){if(t===!0&&i===!0)throw new q(z.INVALID_ARGUMENT,`${n} and ${e} cannot be used together.`)}function lv(n){if(!K.isDocumentKey(n))throw new q(z.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${n} has ${n.length}.`)}function uv(n){if(K.isDocumentKey(n))throw new q(z.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${n} has ${n.length}.`)}function Yu(n){if(n===void 0)return"undefined";if(n===null)return"null";if(typeof n=="string")return n.length>20&&(n=`${n.substring(0,20)}...`),JSON.stringify(n);if(typeof n=="number"||typeof n=="boolean")return""+n;if(typeof n=="object"){if(n instanceof Array)return"an array";{let t=function(i){return i.constructor?i.constructor.name:null}(n);return t?`a custom ${t} object`:"an object"}}return typeof n=="function"?"a function":J()}function _t(n,t){if("_delegate"in n&&(n=n._delegate),!(n instanceof t)){if(t.name===n.constructor.name)throw new q(z.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{let e=Yu(n);throw new q(z.INVALID_ARGUMENT,`Expected type '${t.name}', but it was: ${e}`)}}return n}function Ub(n,t){if(t<=0)throw new q(z.INVALID_ARGUMENT,`Function ${n}() requires a positive number, but it was: ${t}.`)}var Vu=class{constructor(t){var e,i;if(t.host===void 0){if(t.ssl!==void 0)throw new q(z.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=t.host,this.ssl=(e=t.ssl)===null||e===void 0||e;if(this.credentials=t.credentials,this.ignoreUndefinedProperties=!!t.ignoreUndefinedProperties,this.localCache=t.localCache,t.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(t.cacheSizeBytes!==-1&&t.cacheSizeBytes<1048576)throw new q(z.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=t.cacheSizeBytes}Wg("experimentalForceLongPolling",t.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",t.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!t.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:t.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!t.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=jb((i=t.experimentalLongPollingOptions)!==null&&i!==void 0?i:{}),function(s){if(s.timeoutSeconds!==void 0){if(isNaN(s.timeoutSeconds))throw new q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (must not be NaN)`);if(s.timeoutSeconds<5)throw new q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (minimum allowed value is 5)`);if(s.timeoutSeconds>30)throw new q(z.INVALID_ARGUMENT,`invalid long polling timeout: ${s.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!t.useFetchStreams}isEqual(t){return this.host===t.host&&this.ssl===t.ssl&&this.credentials===t.credentials&&this.cacheSizeBytes===t.cacheSizeBytes&&this.experimentalForceLongPolling===t.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===t.experimentalAutoDetectLongPolling&&function(i,r){return i.timeoutSeconds===r.timeoutSeconds}(this.experimentalLongPollingOptions,t.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===t.ignoreUndefinedProperties&&this.useFetchStreams===t.useFetchStreams}},as=class{constructor(t,e,i,r){this._authCredentials=t,this._appCheckCredentials=e,this._databaseId=i,this._app=r,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new Vu({}),this._settingsFrozen=!1}get app(){if(!this._app)throw new q(z.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!==void 0}_setSettings(t){if(this._settingsFrozen)throw new q(z.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new Vu(t),t.credentials!==void 0&&(this._authCredentials=function(i){if(!i)return new mf;switch(i.type){case"firstParty":return new bf(i.sessionIndex||"0",i.iamToken||null,i.authTokenFactory||null);case"provider":return i.client;default:throw new q(z.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(t.credentials))}_getSettings(){return this._settings}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(e){let i=cv.get(e);i&&(H("ComponentProvider","Removing Datastore"),cv.delete(e),i.terminate())}(this),Promise.resolve()}};function qb(n,t,e,i={}){var r;let s=(n=_t(n,as))._getSettings(),o=`${t}:${e}`;if(s.host!=="firestore.googleapis.com"&&s.host!==o&&yn("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used."),n._setSettings(Object.assign(Object.assign({},s),{host:o,ssl:!1})),i.mockUserToken){let a,c;if(typeof i.mockUserToken=="string")a=i.mockUserToken,c=re.MOCK_USER;else{a=Ny(i.mockUserToken,(r=n._app)===null||r===void 0?void 0:r.options.projectId);let l=i.mockUserToken.sub||i.mockUserToken.user_id;if(!l)throw new q(z.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");c=new re(l)}n._authCredentials=new _f(new Kl(a,c))}}var Se=class n{constructor(t,e,i){this.converter=e,this._query=i,this.type="query",this.firestore=t}withConverter(t){return new n(this.firestore,t,this._query)}},Pt=class n{constructor(t,e,i){this.converter=e,this._key=i,this.type="document",this.firestore=t}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new $n(this.firestore,this.converter,this._key.path.popLast())}withConverter(t){return new n(this.firestore,t,this._key)}},$n=class n extends Se{constructor(t,e,i){super(t,e,Io(i)),this._path=i,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){let t=this._path.popLast();return t.isEmpty()?null:new Pt(this.firestore,null,new K(t))}withConverter(t){return new n(this.firestore,t,this._path)}};function Hg(n,t,...e){if(n=jt(n),qg("collection","path",t),n instanceof as){let i=mt.fromString(t,...e);return uv(i),new $n(n,null,i)}{if(!(n instanceof Pt||n instanceof $n))throw new q(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(mt.fromString(t,...e));return uv(i),new $n(n.firestore,null,i)}}function Wb(n,t){if(n=_t(n,as),qg("collectionGroup","collection id",t),t.indexOf("/")>=0)throw new q(z.INVALID_ARGUMENT,`Invalid collection ID '${t}' passed to function collectionGroup(). Collection IDs must not contain '/'.`);return new Se(n,null,function(i){return new Mn(mt.emptyPath(),i)}(t))}function xc(n,t,...e){if(n=jt(n),arguments.length===1&&(t=Yl.newId()),qg("doc","path",t),n instanceof as){let i=mt.fromString(t,...e);return lv(i),new Pt(n,null,new K(i))}{if(!(n instanceof Pt||n instanceof $n))throw new q(z.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");let i=n._path.child(mt.fromString(t,...e));return lv(i),new Pt(n.firestore,n instanceof $n?n.converter:null,new K(i))}}function Gg(n,t){return n=jt(n),t=jt(t),(n instanceof Pt||n instanceof $n)&&(t instanceof Pt||t instanceof $n)&&n.firestore===t.firestore&&n.path===t.path&&n.converter===t.converter}function $g(n,t){return n=jt(n),t=jt(t),n instanceof Se&&t instanceof Se&&n.firestore===t.firestore&&_c(n._query,t._query)&&n.converter===t.converter}var eg=class{constructor(){this.au=Promise.resolve(),this.uu=[],this.cu=!1,this.lu=[],this.hu=null,this.Pu=!1,this.Iu=!1,this.Tu=[],this.t_=new cc(this,"async_queue_retry"),this.Eu=()=>{let e=Gl();e&&H("AsyncQueue","Visibility state changed to "+e.visibilityState),this.t_.jo()};let t=Gl();t&&typeof t.addEventListener=="function"&&t.addEventListener("visibilitychange",this.Eu)}get isShuttingDown(){return this.cu}enqueueAndForget(t){this.enqueue(t)}enqueueAndForgetEvenWhileRestricted(t){this.du(),this.Au(t)}enterRestrictedMode(t){if(!this.cu){this.cu=!0,this.Iu=t||!1;let e=Gl();e&&typeof e.removeEventListener=="function"&&e.removeEventListener("visibilitychange",this.Eu)}}enqueue(t){if(this.du(),this.cu)return new Promise(()=>{});let e=new se;return this.Au(()=>this.cu&&this.Iu?Promise.resolve():(t().then(e.resolve,e.reject),e.promise)).then(()=>e.promise)}enqueueRetryable(t){this.enqueueAndForget(()=>(this.uu.push(t),this.Ru()))}Ru(){return U(this,null,function*(){if(this.uu.length!==0){try{yield this.uu[0](),this.uu.shift(),this.t_.reset()}catch(t){if(!ur(t))throw t;H("AsyncQueue","Operation failed with retryable error: "+t)}this.uu.length>0&&this.t_.Go(()=>this.Ru())}})}Au(t){let e=this.au.then(()=>(this.Pu=!0,t().catch(i=>{this.hu=i,this.Pu=!1;let r=function(o){let a=o.message||"";return o.stack&&(a=o.stack.includes(o.message)?o.stack:o.message+`
`+o.stack),a}(i);throw Qt("INTERNAL UNHANDLED ERROR: ",r),i}).then(i=>(this.Pu=!1,i))));return this.au=e,e}enqueueAfterDelay(t,e,i){this.du(),this.Tu.indexOf(t)>-1&&(e=0);let r=Bp.createAndSchedule(this,t,e,i,s=>this.Vu(s));return this.lu.push(r),r}du(){this.hu&&J()}verifyOperationInProgress(){}mu(){return U(this,null,function*(){let t;do t=this.au,yield t;while(t!==this.au)})}fu(t){for(let e of this.lu)if(e.timerId===t)return!0;return!1}gu(t){return this.mu().then(()=>{this.lu.sort((e,i)=>e.targetTimeMs-i.targetTimeMs);for(let e of this.lu)if(e.skipDelay(),t!=="all"&&e.timerId===t)break;return this.mu()})}pu(t){this.Tu.push(t)}Vu(t){let e=this.lu.indexOf(t);this.lu.splice(e,1)}};function ng(n){return function(e,i){if(typeof e!="object"||e===null)return!1;let r=e;for(let s of i)if(s in r&&typeof r[s]=="function")return!0;return!1}(n,["next","error","complete"])}var ig=class{constructor(){this._progressObserver={},this._taskCompletionResolver=new se,this._lastProgress={taskState:"Running",totalBytes:0,totalDocuments:0,bytesLoaded:0,documentsLoaded:0}}onProgress(t,e,i){this._progressObserver={next:t,error:e,complete:i}}catch(t){return this._taskCompletionResolver.promise.catch(t)}then(t,e){return this._taskCompletionResolver.promise.then(t,e)}_completeWith(t){this._updateProgress(t),this._progressObserver.complete&&this._progressObserver.complete(),this._taskCompletionResolver.resolve(t)}_failWith(t){this._lastProgress.taskState="Error",this._progressObserver.next&&this._progressObserver.next(this._lastProgress),this._progressObserver.error&&this._progressObserver.error(t),this._taskCompletionResolver.reject(t)}_updateProgress(t){this._lastProgress=t,this._progressObserver.next&&this._progressObserver.next(t)}};var Hb=-1,Bt=class extends as{constructor(t,e,i,r){super(t,e,i,r),this.type="firestore",this._queue=function(){return new eg}(),this._persistenceKey=r?.name||"[DEFAULT]"}_terminate(){return this._firestoreClient||Gb(this),this._firestoreClient.terminate()}};function de(n){return n._firestoreClient||Gb(n),n._firestoreClient.verifyNotTerminated(),n._firestoreClient}function Gb(n){var t,e,i;let r=n._freezeSettings(),s=function(a,c,l,h){return new Cf(a,c,l,h.host,h.ssl,h.experimentalForceLongPolling,h.experimentalAutoDetectLongPolling,jb(h.experimentalLongPollingOptions),h.useFetchStreams)}(n._databaseId,((t=n._app)===null||t===void 0?void 0:t.options.appId)||"",n._persistenceKey,r);n._firestoreClient=new Zp(n._authCredentials,n._appCheckCredentials,n._queue,s),!((e=r.localCache)===null||e===void 0)&&e._offlineComponentProvider&&(!((i=r.localCache)===null||i===void 0)&&i._onlineComponentProvider)&&(n._firestoreClient._uninitializedComponentsProvider={_offlineKind:r.localCache.kind,_offline:r.localCache._offlineComponentProvider,_online:r.localCache._onlineComponentProvider})}function $b(n,t){nx(n=_t(n,Bt));let e=de(n);if(e._uninitializedComponentsProvider)throw new q(z.FAILED_PRECONDITION,"SDK cache is already specified.");yn("enableIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let i=n._freezeSettings(),r=new hc;return Yb(e,r,new Ou(r,i.cacheSizeBytes,t?.forceOwnership))}function Kb(n){nx(n=_t(n,Bt));let t=de(n);if(t._uninitializedComponentsProvider)throw new q(z.FAILED_PRECONDITION,"SDK cache is already specified.");yn("enableMultiTabIndexedDbPersistence() will be deprecated in the future, you can use `FirestoreSettings.cache` instead.");let e=n._freezeSettings(),i=new hc;return Yb(t,i,new Yp(i,e.cacheSizeBytes))}function Yb(n,t,e){let i=new se;return n.asyncQueue.enqueue(()=>U(this,null,function*(){try{yield $l(n,e),yield tg(n,t),i.resolve()}catch(r){let s=r;if(!Nb(s))throw s;yn("Error enabling indexeddb cache. Falling back to memory cache: "+s),i.reject(s)}})).then(()=>i.promise)}function Qb(n){if(n._initialized&&!n._terminated)throw new q(z.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");let t=new se;return n._queue.enqueueAndForgetEvenWhileRestricted(()=>U(this,null,function*(){try{yield function(i){return U(this,null,function*(){if(!tr.D())return Promise.resolve();let r=i+"main";yield tr.delete(r)})}(Cg(n._databaseId,n._persistenceKey)),t.resolve()}catch(e){t.reject(e)}})),t.promise}function Xb(n){return function(e){let i=new se;return e.asyncQueue.enqueueAndForget(()=>U(this,null,function*(){return aC(yield Ug(e),i)})),i.promise}(de(n=_t(n,Bt)))}function Jb(n){return bC(de(n=_t(n,Bt)))}function Zb(n){return xC(de(n=_t(n,Bt)))}function tx(n,t){let e=de(n=_t(n,Bt)),i=new ig;return IC(e,n._databaseId,t,i),i}function ex(n,t){return SC(de(n=_t(n,Bt)),t).then(e=>e?new Se(n,null,e.query):null)}function nx(n){if(n._initialized||n._terminated)throw new q(z.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}var Xn=class n{constructor(t){this._byteString=t}static fromBase64String(t){try{return new n(Zt.fromBase64String(t))}catch(e){throw new q(z.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+e)}}static fromUint8Array(t){return new n(Zt.fromUint8Array(t))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(t){return this._byteString.isEqual(t._byteString)}};var Vn=class{constructor(...t){for(let e=0;e<t.length;++e)if(t[e].length===0)throw new q(z.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Xt(t)}isEqual(t){return this._internalPath.isEqual(t._internalPath)}};var wi=class{constructor(t){this._methodName=t}};var cs=class{constructor(t,e){if(!isFinite(t)||t<-90||t>90)throw new q(z.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new q(z.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}get latitude(){return this._lat}get longitude(){return this._long}isEqual(t){return this._lat===t._lat&&this._long===t._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(t){return at(this._lat,t._lat)||at(this._long,t._long)}};var dc=class{constructor(t){this._values=(t||[]).map(e=>e)}toArray(){return this._values.map(t=>t)}isEqual(t){return function(i,r){if(i.length!==r.length)return!1;for(let s=0;s<i.length;++s)if(i[s]!==r[s])return!1;return!0}(this._values,t._values)}};var AC=/^__.*__$/,rg=class{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return this.fieldMask!==null?new On(t,this.data,this.fieldMask,e,this.fieldTransforms):new or(t,this.data,e,this.fieldTransforms)}},Nu=class{constructor(t,e,i){this.data=t,this.fieldMask=e,this.fieldTransforms=i}toMutation(t,e){return new On(t,this.data,this.fieldMask,e,this.fieldTransforms)}};function ix(n){switch(n){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw J()}}var Fu=class n{constructor(t,e,i,r,s,o){this.settings=t,this.databaseId=e,this.serializer=i,this.ignoreUndefinedProperties=r,s===void 0&&this.yu(),this.fieldTransforms=s||[],this.fieldMask=o||[]}get path(){return this.settings.path}get wu(){return this.settings.wu}Su(t){return new n(Object.assign(Object.assign({},this.settings),t),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}bu(t){var e;let i=(e=this.path)===null||e===void 0?void 0:e.child(t),r=this.Su({path:i,Du:!1});return r.vu(t),r}Cu(t){var e;let i=(e=this.path)===null||e===void 0?void 0:e.child(t),r=this.Su({path:i,Du:!1});return r.yu(),r}Fu(t){return this.Su({path:void 0,Du:!0})}Mu(t){return Lu(t,this.settings.methodName,this.settings.xu||!1,this.path,this.settings.Ou)}contains(t){return this.fieldMask.find(e=>t.isPrefixOf(e))!==void 0||this.fieldTransforms.find(e=>t.isPrefixOf(e.field))!==void 0}yu(){if(this.path)for(let t=0;t<this.path.length;t++)this.vu(this.path.get(t))}vu(t){if(t.length===0)throw this.Mu("Document fields must not be empty");if(ix(this.wu)&&AC.test(t))throw this.Mu('Document fields cannot begin and end with "__"')}},sg=class{constructor(t,e,i){this.databaseId=t,this.ignoreUndefinedProperties=e,this.serializer=i||vc(t)}Nu(t,e,i,r=!1){return new Fu({wu:t,methodName:e,Ou:i,path:Xt.emptyPath(),Du:!1,xu:r},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}};function ds(n){let t=n._freezeSettings(),e=vc(n._databaseId);return new sg(n._databaseId,!!t.ignoreUndefinedProperties,e)}function Qu(n,t,e,i,r,s={}){let o=n.Nu(s.merge||s.mergeFields?2:0,t,e,r);Qg("Data must be an object, but it was:",o,i);let a=ox(i,o),c,l;if(s.merge)c=new cn(o.fieldMask),l=o.fieldTransforms;else if(s.mergeFields){let h=[];for(let d of s.mergeFields){let p=ug(t,d,e);if(!o.contains(p))throw new q(z.INVALID_ARGUMENT,`Field '${p}' is specified in your field mask but missing from your input data.`);cx(h,p)||h.push(p)}c=new cn(h),l=o.fieldTransforms.filter(d=>c.covers(d.field))}else c=null,l=o.fieldTransforms;return new rg(new Ne(a),c,l)}var fc=class n extends wi{_toFieldTransform(t){if(t.wu!==2)throw t.wu===1?t.Mu(`${this._methodName}() can only appear at the top level of your update data`):t.Mu(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return t.fieldMask.push(t.path),null}isEqual(t){return t instanceof n}};function rx(n,t,e){return new Fu({wu:3,Ou:t.settings.Ou,methodName:n._methodName,Du:e},t.databaseId,t.serializer,t.ignoreUndefinedProperties)}var og=class n extends wi{_toFieldTransform(t){return new rs(t.path,new rr)}isEqual(t){return t instanceof n}},ag=class n extends wi{constructor(t,e){super(t),this.Lu=e}_toFieldTransform(t){let e=rx(this,t,!0),i=this.Lu.map(s=>fs(s,e)),r=new bi(i);return new rs(t.path,r)}isEqual(t){return t instanceof n&&Bd(this.Lu,t.Lu)}},cg=class n extends wi{constructor(t,e){super(t),this.Lu=e}_toFieldTransform(t){let e=rx(this,t,!0),i=this.Lu.map(s=>fs(s,e)),r=new xi(i);return new rs(t.path,r)}isEqual(t){return t instanceof n&&Bd(this.Lu,t.Lu)}},lg=class n extends wi{constructor(t,e){super(t),this.Bu=e}_toFieldTransform(t){let e=new sr(t.serializer,qv(t.serializer,this.Bu));return new rs(t.path,e)}isEqual(t){return t instanceof n&&this.Bu===t.Bu}};function Kg(n,t,e,i){let r=n.Nu(1,t,e);Qg("Data must be an object, but it was:",r,i);let s=[],o=Ne.empty();hs(i,(c,l)=>{let h=Xg(t,c,e);l=jt(l);let d=r.Cu(h);if(l instanceof fc)s.push(h);else{let p=fs(l,d);p!=null&&(s.push(h),o.set(h,p))}});let a=new cn(s);return new Nu(o,a,r.fieldTransforms)}function Yg(n,t,e,i,r,s){let o=n.Nu(1,t,e),a=[ug(t,i,e)],c=[r];if(s.length%2!=0)throw new q(z.INVALID_ARGUMENT,`Function ${t}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let p=0;p<s.length;p+=2)a.push(ug(t,s[p])),c.push(s[p+1]);let l=[],h=Ne.empty();for(let p=a.length-1;p>=0;--p)if(!cx(l,a[p])){let g=a[p],y=c[p];y=jt(y);let v=o.Cu(g);if(y instanceof fc)l.push(g);else{let w=fs(y,v);w!=null&&(l.push(g),h.set(g,w))}}let d=new cn(l);return new Nu(h,d,o.fieldTransforms)}function sx(n,t,e,i=!1){return fs(e,n.Nu(i?4:3,t))}function fs(n,t){if(ax(n=jt(n)))return Qg("Unsupported field value:",t,n),ox(n,t);if(n instanceof wi)return function(i,r){if(!ix(r.wu))throw r.Mu(`${i._methodName}() can only be used with update() and set()`);if(!r.path)throw r.Mu(`${i._methodName}() is not currently supported inside arrays`);let s=i._toFieldTransform(r);s&&r.fieldTransforms.push(s)}(n,t),null;if(n===void 0&&t.ignoreUndefinedProperties)return null;if(t.path&&t.fieldMask.push(t.path),n instanceof Array){if(t.settings.Du&&t.wu!==4)throw t.Mu("Nested arrays are not supported");return function(i,r){let s=[],o=0;for(let a of i){let c=fs(a,r.Fu(o));c==null&&(c={nullValue:"NULL_VALUE"}),s.push(c),o++}return{arrayValue:{values:s}}}(n,t)}return function(i,r){if((i=jt(i))===null)return{nullValue:"NULL_VALUE"};if(typeof i=="number")return qv(r.serializer,i);if(typeof i=="boolean")return{booleanValue:i};if(typeof i=="string")return{stringValue:i};if(i instanceof Date){let s=Ut.fromDate(i);return{timestampValue:fo(r.serializer,s)}}if(i instanceof Ut){let s=new Ut(i.seconds,1e3*Math.floor(i.nanoseconds/1e3));return{timestampValue:fo(r.serializer,s)}}if(i instanceof cs)return{geoPointValue:{latitude:i.latitude,longitude:i.longitude}};if(i instanceof Xn)return{bytesValue:Zv(r.serializer,i._byteString)};if(i instanceof Pt){let s=r.databaseId,o=i.firestore._databaseId;if(!o.isEqual(s))throw r.Mu(`Document reference is for database ${o.projectId}/${o.database} but should be for database ${s.projectId}/${s.database}`);return{referenceValue:Ig(i.firestore._databaseId||r.databaseId,i._key.path)}}if(i instanceof dc)return function(o,a){return{mapValue:{fields:{__type__:{stringValue:"__vector__"},value:{arrayValue:{values:o.toArray().map(c=>{if(typeof c!="number")throw a.Mu("VectorValues must only contain numeric values.");return Eg(a.serializer,c)})}}}}}}(i,r);throw r.Mu(`Unsupported field value: ${Yu(i)}`)}(n,t)}function ox(n,t){let e={};return Iv(n)?t.path&&t.path.length>0&&t.fieldMask.push(t.path):hs(n,(i,r)=>{let s=fs(r,t.bu(i));s!=null&&(e[i]=s)}),{mapValue:{fields:e}}}function ax(n){return!(typeof n!="object"||n===null||n instanceof Array||n instanceof Date||n instanceof Ut||n instanceof cs||n instanceof Xn||n instanceof Pt||n instanceof wi||n instanceof dc)}function Qg(n,t,e){if(!ax(e)||!function(r){return typeof r=="object"&&r!==null&&(Object.getPrototypeOf(r)===Object.prototype||Object.getPrototypeOf(r)===null)}(e)){let i=Yu(e);throw i==="an object"?t.Mu(n+" a custom object"):t.Mu(n+" "+i)}}function ug(n,t,e){if((t=jt(t))instanceof Vn)return t._internalPath;if(typeof t=="string")return Xg(n,t);throw Lu("Field path arguments must be of type string or ",n,!1,void 0,e)}var CC=new RegExp("[~\\*/\\[\\]]");function Xg(n,t,e){if(t.search(CC)>=0)throw Lu(`Invalid field path (${t}). Paths must not contain '~', '*', '/', '[', or ']'`,n,!1,void 0,e);try{return new Vn(...t.split("."))._internalPath}catch{throw Lu(`Invalid field path (${t}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,n,!1,void 0,e)}}function Lu(n,t,e,i,r){let s=i&&!i.isEmpty(),o=r!==void 0,a=`Function ${t}() called with invalid data`;e&&(a+=" (via `toFirestore()`)"),a+=". ";let c="";return(s||o)&&(c+=" (found",s&&(c+=` in field ${i}`),o&&(c+=` in document ${r}`),c+=")"),new q(z.INVALID_ARGUMENT,a+n+c)}function cx(n,t){return n.some(e=>e.isEqual(t))}var ls=class{constructor(t,e,i,r,s){this._firestore=t,this._userDataWriter=e,this._key=i,this._document=r,this._converter=s}get id(){return this._key.path.lastSegment()}get ref(){return new Pt(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){let t=new hg(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(t)}return this._userDataWriter.convertValue(this._document.data.value)}}get(t){if(this._document){let e=this._document.data.field(Xu("DocumentSnapshot.get",t));if(e!==null)return this._userDataWriter.convertValue(e)}}},hg=class extends ls{data(){return super.data()}};function Xu(n,t){return typeof t=="string"?Xg(n,t):t instanceof Vn?t._internalPath:t._delegate._internalPath}function lx(n){if(n.limitType==="L"&&n.explicitOrderBy.length===0)throw new q(z.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var pc=class{},us=class extends pc{};function Ii(n,t,...e){let i=[];t instanceof pc&&i.push(t),i=i.concat(e),function(s){let o=s.filter(c=>c instanceof dg).length,a=s.filter(c=>c instanceof Bu).length;if(o>1||o>0&&a>0)throw new q(z.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(i);for(let r of i)n=r._apply(n);return n}var Bu=class n extends us{constructor(t,e,i){super(),this._field=t,this._op=e,this._value=i,this.type="where"}static _create(t,e,i){return new n(t,e,i)}_apply(t){let e=this._parse(t);return vx(t._query,e),new Se(t.firestore,t.converter,jf(t._query,e))}_parse(t){let e=ds(t.firestore);return function(s,o,a,c,l,h,d){let p;if(l.isKeyField()){if(h==="array-contains"||h==="array-contains-any")throw new q(z.INVALID_ARGUMENT,`Invalid Query. You can't perform '${h}' queries on documentId().`);if(h==="in"||h==="not-in"){dv(d,h);let g=[];for(let y of d)g.push(hv(c,s,y));p={arrayValue:{values:g}}}else p=hv(c,s,d)}else h!=="in"&&h!=="not-in"&&h!=="array-contains-any"||dv(d,h),p=sx(a,o,d,h==="in"||h==="not-in");return pt.create(l,h,p)}(t._query,"where",e,t.firestore._databaseId,this._field,this._op,this._value)}};function ux(n,t,e){let i=t,r=Xu("where",n);return Bu._create(r,i,e)}var dg=class n extends pc{constructor(t,e){super(),this.type=t,this._queryConstraints=e}static _create(t,e){return new n(t,e)}_parse(t){let e=this._queryConstraints.map(i=>i._parse(t)).filter(i=>i.getFilters().length>0);return e.length===1?e[0]:Tt.create(e,this._getOperator())}_apply(t){let e=this._parse(t);return e.getFilters().length===0?t:(function(r,s){let o=r,a=s.getFlattenedFilters();for(let c of a)vx(o,c),o=jf(o,c)}(t._query,e),new Se(t.firestore,t.converter,jf(t._query,e)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}};var fg=class n extends us{constructor(t,e){super(),this._field=t,this._direction=e,this.type="orderBy"}static _create(t,e){return new n(t,e)}_apply(t){let e=function(r,s,o){if(r.startAt!==null)throw new q(z.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(r.endAt!==null)throw new q(z.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");return new ns(s,o)}(t._query,this._field,this._direction);return new Se(t.firestore,t.converter,function(r,s){let o=r.explicitOrderBy.concat([s]);return new Mn(r.path,r.collectionGroup,o,r.filters.slice(),r.limit,r.limitType,r.startAt,r.endAt)}(t._query,e))}};function hx(n,t="asc"){let e=t,i=Xu("orderBy",n);return fg._create(i,e)}var zu=class n extends us{constructor(t,e,i){super(),this.type=t,this._limit=e,this._limitType=i}static _create(t,e,i){return new n(t,e,i)}_apply(t){return new Se(t.firestore,t.converter,su(t._query,this._limit,this._limitType))}};function dx(n){return Ub("limit",n),zu._create("limit",n,"F")}function fx(n){return Ub("limitToLast",n),zu._create("limitToLast",n,"L")}var ju=class n extends us{constructor(t,e,i){super(),this.type=t,this._docOrFields=e,this._inclusive=i}static _create(t,e,i){return new n(t,e,i)}_apply(t){let e=yx(t,this.type,this._docOrFields,this._inclusive);return new Se(t.firestore,t.converter,function(r,s){return new Mn(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,s,r.endAt)}(t._query,e))}};function px(...n){return ju._create("startAt",n,!0)}function gx(...n){return ju._create("startAfter",n,!1)}var Uu=class n extends us{constructor(t,e,i){super(),this.type=t,this._docOrFields=e,this._inclusive=i}static _create(t,e,i){return new n(t,e,i)}_apply(t){let e=yx(t,this.type,this._docOrFields,this._inclusive);return new Se(t.firestore,t.converter,function(r,s){return new Mn(r.path,r.collectionGroup,r.explicitOrderBy.slice(),r.filters.slice(),r.limit,r.limitType,r.startAt,s)}(t._query,e))}};function mx(...n){return Uu._create("endBefore",n,!1)}function _x(...n){return Uu._create("endAt",n,!0)}function yx(n,t,e,i){if(e[0]=jt(e[0]),e[0]instanceof ls)return function(s,o,a,c,l){if(!c)throw new q(z.NOT_FOUND,`Can't use a DocumentSnapshot that doesn't exist for ${a}().`);let h=[];for(let d of ro(s))if(d.field.isKeyField())h.push(es(o,c.key));else{let p=c.data.field(d.field);if(Wu(p))throw new q(z.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+d.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(p===null){let g=d.field.canonicalString();throw new q(z.INVALID_ARGUMENT,`Invalid query. You are trying to start or end a query using a document for which the field '${g}' (used as the orderBy) does not exist.`)}h.push(p)}return new Yn(h,l)}(n._query,n.firestore._databaseId,t,e[0]._document,i);{let r=ds(n.firestore);return function(o,a,c,l,h,d){let p=o.explicitOrderBy;if(h.length>p.length)throw new q(z.INVALID_ARGUMENT,`Too many arguments provided to ${l}(). The number of arguments must be less than or equal to the number of orderBy() clauses`);let g=[];for(let y=0;y<h.length;y++){let v=h[y];if(p[y].field.isKeyField()){if(typeof v!="string")throw new q(z.INVALID_ARGUMENT,`Invalid query. Expected a string for document ID in ${l}(), but got a ${typeof v}`);if(!wg(o)&&v.indexOf("/")!==-1)throw new q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection and ordering by documentId(), the value passed to ${l}() must be a plain document ID, but '${v}' contains a slash.`);let w=o.path.child(mt.fromString(v));if(!K.isDocumentKey(w))throw new q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group and ordering by documentId(), the value passed to ${l}() must result in a valid document path, but '${w}' is not because it contains an odd number of segments.`);let k=new K(w);g.push(es(a,k))}else{let w=sx(c,l,v);g.push(w)}}return new Yn(g,d)}(n._query,n.firestore._databaseId,r,t,e,i)}}function hv(n,t,e){if(typeof(e=jt(e))=="string"){if(e==="")throw new q(z.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!wg(t)&&e.indexOf("/")!==-1)throw new q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${e}' contains a '/' character.`);let i=t.path.child(mt.fromString(e));if(!K.isDocumentKey(i))throw new q(z.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${i}' is not because it has an odd number of segments (${i.length}).`);return es(n,new K(i))}if(e instanceof Pt)return es(n,e._key);throw new q(z.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${Yu(e)}.`)}function dv(n,t){if(!Array.isArray(n)||n.length===0)throw new q(z.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${t.toString()}' filters.`)}function vx(n,t){let e=function(r,s){for(let o of r)for(let a of o.getFlattenedFilters())if(s.indexOf(a.op)>=0)return a.op;return null}(n.filters,function(r){switch(r){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(t.op));if(e!==null)throw e===t.op?new q(z.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${t.op.toString()}' filter.`):new q(z.INVALID_ARGUMENT,`Invalid query. You cannot use '${t.op.toString()}' filters with '${e.toString()}' filters.`)}var To=class{convertValue(t,e="none"){switch(ts(t)){case 0:return null;case 1:return t.booleanValue;case 2:return Lt(t.integerValue||t.doubleValue);case 3:return this.convertTimestamp(t.timestampValue);case 4:return this.convertServerTimestamp(t,e);case 5:return t.stringValue;case 6:return this.convertBytes(er(t.bytesValue));case 7:return this.convertReference(t.referenceValue);case 8:return this.convertGeoPoint(t.geoPointValue);case 9:return this.convertArray(t.arrayValue,e);case 11:return this.convertObject(t.mapValue,e);case 10:return this.convertVectorValue(t.mapValue);default:throw J()}}convertObject(t,e){return this.convertObjectMap(t.fields,e)}convertObjectMap(t,e="none"){let i={};return hs(t,(r,s)=>{i[r]=this.convertValue(s,e)}),i}convertVectorValue(t){var e,i,r;let s=(r=(i=(e=t.fields)===null||e===void 0?void 0:e.value.arrayValue)===null||i===void 0?void 0:i.values)===null||r===void 0?void 0:r.map(o=>Lt(o.doubleValue));return new dc(s)}convertGeoPoint(t){return new cs(Lt(t.latitude),Lt(t.longitude))}convertArray(t,e){return(t.values||[]).map(i=>this.convertValue(i,e))}convertServerTimestamp(t,e){switch(e){case"previous":let i=bg(t);return i==null?null:this.convertValue(i,e);case"estimate":return this.convertTimestamp(Ya(t));default:return null}}convertTimestamp(t){let e=vi(t);return new Ut(e.seconds,e.nanos)}convertDocumentKey(t,e){let i=mt.fromString(t);Z(ub(i));let r=new nr(i.get(1),i.get(3)),s=new K(i.popFirst(5));return r.isEqual(e)||Qt(`Document ${s} contains a document reference within a different database (${r.projectId}/${r.database}) which is not supported. It will be treated as a reference in the current database (${e.projectId}/${e.database}) instead.`),s}};function Ju(n,t,e){let i;return i=n?e&&(e.merge||e.mergeFields)?n.toFirestore(t,e):n.toFirestore(t):t,i}var pg=class extends To{constructor(t){super(),this.firestore=t}convertBytes(t){return new Xn(t)}convertReference(t){let e=this.convertDocumentKey(t,this.firestore._databaseId);return new Pt(this.firestore,null,e)}};var yi=class{constructor(t,e){this.hasPendingWrites=t,this.fromCache=e}isEqual(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache}},bn=class extends ls{constructor(t,e,i,r,s,o){super(t,e,i,r,o),this._firestore=t,this._firestoreImpl=t,this.metadata=s}exists(){return super.exists()}data(t={}){if(this._document){if(this._converter){let e=new Ji(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(e,t)}return this._userDataWriter.convertValue(this._document.data.value,t.serverTimestamps)}}get(t,e={}){if(this._document){let i=this._document.data.field(Xu("DocumentSnapshot.get",t));if(i!==null)return this._userDataWriter.convertValue(i,e.serverTimestamps)}}},Ji=class extends bn{data(t={}){return super.data(t)}},Nn=class{constructor(t,e,i,r){this._firestore=t,this._userDataWriter=e,this._snapshot=r,this.metadata=new yi(r.hasPendingWrites,r.fromCache),this.query=i}get docs(){let t=[];return this.forEach(e=>t.push(e)),t}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(t,e){this._snapshot.docs.forEach(i=>{t.call(e,new Ji(this._firestore,this._userDataWriter,i.key,i,new yi(this._snapshot.mutatedKeys.has(i.key),this._snapshot.fromCache),this.query.converter))})}docChanges(t={}){let e=!!t.includeMetadataChanges;if(e&&this._snapshot.excludesMetadataChanges)throw new q(z.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===e||(this._cachedChanges=function(r,s){if(r._snapshot.oldDocs.isEmpty()){let o=0;return r._snapshot.docChanges.map(a=>{let c=new Ji(r._firestore,r._userDataWriter,a.doc.key,a.doc,new yi(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter);return a.doc,{type:"added",doc:c,oldIndex:-1,newIndex:o++}})}{let o=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(a=>s||a.type!==3).map(a=>{let c=new Ji(r._firestore,r._userDataWriter,a.doc.key,a.doc,new yi(r._snapshot.mutatedKeys.has(a.doc.key),r._snapshot.fromCache),r.query.converter),l=-1,h=-1;return a.type!==0&&(l=o.indexOf(a.doc.key),o=o.delete(a.doc.key)),a.type!==1&&(o=o.add(a.doc),h=o.indexOf(a.doc.key)),{type:PC(a.type),doc:c,oldIndex:l,newIndex:h}})}}(this,e),this._cachedChangesIncludeMetadataChanges=e),this._cachedChanges}};function PC(n){switch(n){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return J()}}function Jg(n,t){return n instanceof bn&&t instanceof bn?n._firestore===t._firestore&&n._key.isEqual(t._key)&&(n._document===null?t._document===null:n._document.isEqual(t._document))&&n._converter===t._converter:n instanceof Nn&&t instanceof Nn&&n._firestore===t._firestore&&$g(n.query,t.query)&&n.metadata.isEqual(t.metadata)&&n._snapshot.isEqual(t._snapshot)}function bx(n){n=_t(n,Pt);let t=_t(n.firestore,Bt);return Bb(de(t),n._key).then(e=>nm(t,n,e))}var Ti=class extends To{constructor(t){super(),this.firestore=t}convertBytes(t){return new Xn(t)}convertReference(t){let e=this.convertDocumentKey(t,this.firestore._databaseId);return new Pt(this.firestore,null,e)}};function xx(n){n=_t(n,Pt);let t=_t(n.firestore,Bt),e=de(t),i=new Ti(t);return wC(e,n._key).then(r=>new bn(t,i,n._key,r,new yi(r!==null&&r.hasLocalMutations,!0),n.converter))}function wx(n){n=_t(n,Pt);let t=_t(n.firestore,Bt);return Bb(de(t),n._key,{source:"server"}).then(e=>nm(t,n,e))}function Tx(n){n=_t(n,Se);let t=_t(n.firestore,Bt),e=de(t),i=new Ti(t);return lx(n._query),zb(e,n._query).then(r=>new Nn(t,i,n,r))}function Ex(n){n=_t(n,Se);let t=_t(n.firestore,Bt),e=de(t),i=new Ti(t);return TC(e,n._query).then(r=>new Nn(t,i,n,r))}function Ix(n){n=_t(n,Se);let t=_t(n.firestore,Bt),e=de(t),i=new Ti(t);return zb(e,n._query,{source:"server"}).then(r=>new Nn(t,i,n,r))}function Zg(n,t,e){n=_t(n,Pt);let i=_t(n.firestore,Bt),r=Ju(n.converter,t,e);return ko(i,[Qu(ds(i),"setDoc",n._key,r,n.converter!==null,e).toMutation(n._key,Kt.none())])}function tm(n,t,e,...i){n=_t(n,Pt);let r=_t(n.firestore,Bt),s=ds(r),o;return o=typeof(t=jt(t))=="string"||t instanceof Vn?Yg(s,"updateDoc",n._key,t,e,i):Kg(s,"updateDoc",n._key,t),ko(r,[o.toMutation(n._key,Kt.exists(!0))])}function Sx(n){return ko(_t(n.firestore,Bt),[new ar(n._key,Kt.none())])}function Ax(n,t){let e=_t(n.firestore,Bt),i=xc(n),r=Ju(n.converter,t);return ko(e,[Qu(ds(n.firestore),"addDoc",i._key,r,n.converter!==null,{}).toMutation(i._key,Kt.exists(!1))]).then(()=>i)}function em(n,...t){var e,i,r;n=jt(n);let s={includeMetadataChanges:!1,source:"default"},o=0;typeof t[o]!="object"||ng(t[o])||(s=t[o],o++);let a={includeMetadataChanges:s.includeMetadataChanges,source:s.source};if(ng(t[o])){let d=t[o];t[o]=(e=d.next)===null||e===void 0?void 0:e.bind(d),t[o+1]=(i=d.error)===null||i===void 0?void 0:i.bind(d),t[o+2]=(r=d.complete)===null||r===void 0?void 0:r.bind(d)}let c,l,h;if(n instanceof Pt)l=_t(n.firestore,Bt),h=Io(n._key.path),c={next:d=>{t[o]&&t[o](nm(l,n,d))},error:t[o+1],complete:t[o+2]};else{let d=_t(n,Se);l=_t(d.firestore,Bt),h=d._query;let p=new Ti(l);c={next:g=>{t[o]&&t[o](new Nn(l,p,d,g))},error:t[o+1],complete:t[o+2]},lx(n._query)}return function(p,g,y,v){let w=new xo(v),k=new lc(g,w,y);return p.asyncQueue.enqueueAndForget(()=>U(this,null,function*(){return Dg(yield wo(p),k)})),()=>{w.za(),p.asyncQueue.enqueueAndForget(()=>U(this,null,function*(){return Mg(yield wo(p),k)}))}}(de(l),h,a,c)}function Cx(n,t){return EC(de(n=_t(n,Bt)),ng(t)?t:{next:t})}function ko(n,t){return function(i,r){let s=new se;return i.asyncQueue.enqueueAndForget(()=>U(this,null,function*(){return iC(yield Ug(i),r,s)})),s.promise}(de(n),t)}function nm(n,t,e){let i=e.docs.get(t._key),r=new Ti(n);return new bn(n,r,t._key,i,new yi(e.hasPendingWrites,e.fromCache),t.converter)}var kC={maxAttempts:5};var qu=class{constructor(t,e){this._firestore=t,this._commitHandler=e,this._mutations=[],this._committed=!1,this._dataReader=ds(t)}set(t,e,i){this._verifyNotCommitted();let r=Qi(t,this._firestore),s=Ju(r.converter,e,i),o=Qu(this._dataReader,"WriteBatch.set",r._key,s,r.converter!==null,i);return this._mutations.push(o.toMutation(r._key,Kt.none())),this}update(t,e,i,...r){this._verifyNotCommitted();let s=Qi(t,this._firestore),o;return o=typeof(e=jt(e))=="string"||e instanceof Vn?Yg(this._dataReader,"WriteBatch.update",s._key,e,i,r):Kg(this._dataReader,"WriteBatch.update",s._key,e),this._mutations.push(o.toMutation(s._key,Kt.exists(!0))),this}delete(t){this._verifyNotCommitted();let e=Qi(t,this._firestore);return this._mutations=this._mutations.concat(new ar(e._key,Kt.none())),this}commit(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()}_verifyNotCommitted(){if(this._committed)throw new q(z.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")}};function Qi(n,t){if((n=jt(n)).firestore!==t)throw new q(z.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return n}var gg=class extends class{constructor(e,i){this._firestore=e,this._transaction=i,this._dataReader=ds(e)}get(e){let i=Qi(e,this._firestore),r=new pg(this._firestore);return this._transaction.lookup([i._key]).then(s=>{if(!s||s.length!==1)return J();let o=s[0];if(o.isFoundDocument())return new ls(this._firestore,r,o.key,o,i.converter);if(o.isNoDocument())return new ls(this._firestore,r,i._key,null,i.converter);throw J()})}set(e,i,r){let s=Qi(e,this._firestore),o=Ju(s.converter,i,r),a=Qu(this._dataReader,"Transaction.set",s._key,o,s.converter!==null,r);return this._transaction.set(s._key,a),this}update(e,i,r,...s){let o=Qi(e,this._firestore),a;return a=typeof(i=jt(i))=="string"||i instanceof Vn?Yg(this._dataReader,"Transaction.update",o._key,i,r,s):Kg(this._dataReader,"Transaction.update",o._key,i),this._transaction.update(o._key,a),this}delete(e){let i=Qi(e,this._firestore);return this._transaction.delete(i._key),this}}{constructor(t,e){super(t,e),this._firestore=t}get(t){let e=Qi(t,this._firestore),i=new Ti(this._firestore);return super.get(t).then(r=>new bn(this._firestore,i,e._key,r._document,new yi(!1,!1),e.converter))}};function Px(n,t,e){n=_t(n,Bt);let i=Object.assign(Object.assign({},kC),e);return function(s){if(s.maxAttempts<1)throw new q(z.INVALID_ARGUMENT,"Max attempts must be at least 1")}(i),function(s,o,a){let c=new se;return s.asyncQueue.enqueueAndForget(()=>U(this,null,function*(){let l=yield vC(s);new Jp(s.asyncQueue,l,a,o,c).ru()})),c.promise}(de(n),r=>t(new gg(n,r)),i)}function kx(){return new fc("deleteField")}function Rx(){return new og("serverTimestamp")}function Dx(...n){return new ag("arrayUnion",n)}function Mx(...n){return new cg("arrayRemove",n)}function Ox(n){return new lg("increment",n)}(function(t,e=!0){(function(r){Eo=r})(By),Ra(new qr("firestore",(i,{instanceIdentifier:r,options:s})=>{let o=i.getProvider("app").getImmediate(),a=new Bt(new yf(i.getProvider("auth-internal")),new wf(i.getProvider("app-check-internal")),function(l,h){if(!Object.prototype.hasOwnProperty.apply(l.options,["projectId"]))throw new q(z.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new nr(l.options.projectId,h)}(o,r),o);return s=Object.assign({useFetchStreams:e},s),a._setSettings(s),a},"PUBLIC").setMultipleInstances(!0)),Ui(h0,"4.7.2",t),Ui(h0,"4.7.2","esm2017")})();var RC="@firebase/firestore-compat",DC="0.3.37";function cm(n,t){if(t===void 0)return{merge:!1};if(t.mergeFields!==void 0&&t.merge!==void 0)throw new q("invalid-argument",`Invalid options passed to function ${n}(): You cannot specify both "merge" and "mergeFields".`);return t}function Vx(){if(typeof Uint8Array>"u")throw new q("unimplemented","Uint8Arrays are not available in this environment.")}function Nx(){if(!Sv())throw new q("unimplemented","Blobs are unavailable in Firestore in this environment.")}var Zu=class n{constructor(t){this._delegate=t}static fromBase64String(t){return Nx(),new n(Xn.fromBase64String(t))}static fromUint8Array(t){return Vx(),new n(Xn.fromUint8Array(t))}toBase64(){return Nx(),this._delegate.toBase64()}toUint8Array(){return Vx(),this._delegate.toUint8Array()}isEqual(t){return this._delegate.isEqual(t._delegate)}toString(){return"Blob(base64: "+this.toBase64()+")"}};function im(n){return MC(n,["next","error","complete"])}function MC(n,t){if(typeof n!="object"||n===null)return!1;let e=n;for(let i of t)if(i in e&&typeof e[i]=="function")return!0;return!1}var rm=class{enableIndexedDbPersistence(t,e){return $b(t._delegate,{forceOwnership:e})}enableMultiTabIndexedDbPersistence(t){return Kb(t._delegate)}clearIndexedDbPersistence(t){return Qb(t._delegate)}},th=class{constructor(t,e,i){this._delegate=e,this._persistenceProvider=i,this.INTERNAL={delete:()=>this.terminate()},t instanceof nr||(this._appCompat=t)}get _databaseId(){return this._delegate._databaseId}settings(t){let e=this._delegate._getSettings();!t.merge&&e.host!==t.host&&yn("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),t.merge&&(t=Object.assign(Object.assign({},e),t),delete t.merge),this._delegate._setSettings(t)}useEmulator(t,e,i={}){qb(this._delegate,t,e,i)}enableNetwork(){return Jb(this._delegate)}disableNetwork(){return Zb(this._delegate)}enablePersistence(t){let e=!1,i=!1;return t&&(e=!!t.synchronizeTabs,i=!!t.experimentalForceOwningTab,Wg("synchronizeTabs",e,"experimentalForceOwningTab",i)),e?this._persistenceProvider.enableMultiTabIndexedDbPersistence(this):this._persistenceProvider.enableIndexedDbPersistence(this,i)}clearPersistence(){return this._persistenceProvider.clearIndexedDbPersistence(this)}terminate(){return this._appCompat&&(this._appCompat._removeServiceInstance("firestore-compat"),this._appCompat._removeServiceInstance("firestore")),this._delegate._delete()}waitForPendingWrites(){return Xb(this._delegate)}onSnapshotsInSync(t){return Cx(this._delegate,t)}get app(){if(!this._appCompat)throw new q("failed-precondition","Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._appCompat}collection(t){try{return new Mo(this,Hg(this._delegate,t))}catch(e){throw Ue(e,"collection()","Firestore.collection()")}}doc(t){try{return new Jn(this,xc(this._delegate,t))}catch(e){throw Ue(e,"doc()","Firestore.doc()")}}collectionGroup(t){try{return new _s(this,Wb(this._delegate,t))}catch(e){throw Ue(e,"collectionGroup()","Firestore.collectionGroup()")}}runTransaction(t){return Px(this._delegate,e=>t(new eh(this,e)))}batch(){return de(this._delegate),new nh(new qu(this._delegate,t=>ko(this._delegate,t)))}loadBundle(t){return tx(this._delegate,t)}namedQuery(t){return ex(this._delegate,t).then(e=>e?new _s(this,e):null)}},Ro=class extends To{constructor(t){super(),this.firestore=t}convertBytes(t){return new Zu(new Xn(t))}convertReference(t){let e=this.convertDocumentKey(t,this.firestore._databaseId);return Jn.forKey(e,this.firestore,null)}};function OC(n){fv(n)}var eh=class{constructor(t,e){this._firestore=t,this._delegate=e,this._userDataWriter=new Ro(t)}get(t){let e=ps(t);return this._delegate.get(e).then(i=>new gs(this._firestore,new bn(this._firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,e.converter)))}set(t,e,i){let r=ps(t);return i?(cm("Transaction.set",i),this._delegate.set(r,e,i)):this._delegate.set(r,e),this}update(t,e,i,...r){let s=ps(t);return arguments.length===2?this._delegate.update(s,e):this._delegate.update(s,e,i,...r),this}delete(t){let e=ps(t);return this._delegate.delete(e),this}},nh=class{constructor(t){this._delegate=t}set(t,e,i){let r=ps(t);return i?(cm("WriteBatch.set",i),this._delegate.set(r,e,i)):this._delegate.set(r,e),this}update(t,e,i,...r){let s=ps(t);return arguments.length===2?this._delegate.update(s,e):this._delegate.update(s,e,i,...r),this}delete(t){let e=ps(t);return this._delegate.delete(e),this}commit(){return this._delegate.commit()}},Do=class n{constructor(t,e,i){this._firestore=t,this._userDataWriter=e,this._delegate=i}fromFirestore(t,e){let i=new Ji(this._firestore._delegate,this._userDataWriter,t._key,t._document,t.metadata,null);return this._delegate.fromFirestore(new ms(this._firestore,i),e??{})}toFirestore(t,e){return e?this._delegate.toFirestore(t,e):this._delegate.toFirestore(t)}static getInstance(t,e){let i=n.INSTANCES,r=i.get(t);r||(r=new WeakMap,i.set(t,r));let s=r.get(e);return s||(s=new n(t,new Ro(t),e),r.set(e,s)),s}};Do.INSTANCES=new WeakMap;var Jn=class n{constructor(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Ro(t)}static forPath(t,e,i){if(t.length%2!==0)throw new q("invalid-argument",`Invalid document reference. Document references must have an even number of segments, but ${t.canonicalString()} has ${t.length}`);return new n(e,new Pt(e._delegate,i,new K(t)))}static forKey(t,e,i){return new n(e,new Pt(e._delegate,i,t))}get id(){return this._delegate.id}get parent(){return new Mo(this.firestore,this._delegate.parent)}get path(){return this._delegate.path}collection(t){try{return new Mo(this.firestore,Hg(this._delegate,t))}catch(e){throw Ue(e,"collection()","DocumentReference.collection()")}}isEqual(t){return t=jt(t),t instanceof Pt?Gg(this._delegate,t):!1}set(t,e){e=cm("DocumentReference.set",e);try{return e?Zg(this._delegate,t,e):Zg(this._delegate,t)}catch(i){throw Ue(i,"setDoc()","DocumentReference.set()")}}update(t,e,...i){try{return arguments.length===1?tm(this._delegate,t):tm(this._delegate,t,e,...i)}catch(r){throw Ue(r,"updateDoc()","DocumentReference.update()")}}delete(){return Sx(this._delegate)}onSnapshot(...t){let e=Fx(t),i=Lx(t,r=>new gs(this.firestore,new bn(this.firestore._delegate,this._userDataWriter,r._key,r._document,r.metadata,this._delegate.converter)));return em(this._delegate,e,i)}get(t){let e;return t?.source==="cache"?e=xx(this._delegate):t?.source==="server"?e=wx(this._delegate):e=bx(this._delegate),e.then(i=>new gs(this.firestore,new bn(this.firestore._delegate,this._userDataWriter,i._key,i._document,i.metadata,this._delegate.converter)))}withConverter(t){return new n(this.firestore,t?this._delegate.withConverter(Do.getInstance(this.firestore,t)):this._delegate.withConverter(null))}};function Ue(n,t,e){return n.message=n.message.replace(t,e),n}function Fx(n){for(let t of n)if(typeof t=="object"&&!im(t))return t;return{}}function Lx(n,t){var e,i;let r;return im(n[0])?r=n[0]:im(n[1])?r=n[1]:typeof n[0]=="function"?r={next:n[0],error:n[1],complete:n[2]}:r={next:n[1],error:n[2],complete:n[3]},{next:s=>{r.next&&r.next(t(s))},error:(e=r.error)===null||e===void 0?void 0:e.bind(r),complete:(i=r.complete)===null||i===void 0?void 0:i.bind(r)}}var gs=class{constructor(t,e){this._firestore=t,this._delegate=e}get ref(){return new Jn(this._firestore,this._delegate.ref)}get id(){return this._delegate.id}get metadata(){return this._delegate.metadata}get exists(){return this._delegate.exists()}data(t){return this._delegate.data(t)}get(t,e){return this._delegate.get(t,e)}isEqual(t){return Jg(this._delegate,t._delegate)}},ms=class extends gs{data(t){let e=this._delegate.data(t);return this._delegate._converter||pv(e!==void 0,"Document in a QueryDocumentSnapshot should exist"),e}},_s=class n{constructor(t,e){this.firestore=t,this._delegate=e,this._userDataWriter=new Ro(t)}where(t,e,i){try{return new n(this.firestore,Ii(this._delegate,ux(t,e,i)))}catch(r){throw Ue(r,/(orderBy|where)\(\)/,"Query.$1()")}}orderBy(t,e){try{return new n(this.firestore,Ii(this._delegate,hx(t,e)))}catch(i){throw Ue(i,/(orderBy|where)\(\)/,"Query.$1()")}}limit(t){try{return new n(this.firestore,Ii(this._delegate,dx(t)))}catch(e){throw Ue(e,"limit()","Query.limit()")}}limitToLast(t){try{return new n(this.firestore,Ii(this._delegate,fx(t)))}catch(e){throw Ue(e,"limitToLast()","Query.limitToLast()")}}startAt(...t){try{return new n(this.firestore,Ii(this._delegate,px(...t)))}catch(e){throw Ue(e,"startAt()","Query.startAt()")}}startAfter(...t){try{return new n(this.firestore,Ii(this._delegate,gx(...t)))}catch(e){throw Ue(e,"startAfter()","Query.startAfter()")}}endBefore(...t){try{return new n(this.firestore,Ii(this._delegate,mx(...t)))}catch(e){throw Ue(e,"endBefore()","Query.endBefore()")}}endAt(...t){try{return new n(this.firestore,Ii(this._delegate,_x(...t)))}catch(e){throw Ue(e,"endAt()","Query.endAt()")}}isEqual(t){return $g(this._delegate,t._delegate)}get(t){let e;return t?.source==="cache"?e=Ex(this._delegate):t?.source==="server"?e=Ix(this._delegate):e=Tx(this._delegate),e.then(i=>new wc(this.firestore,new Nn(this.firestore._delegate,this._userDataWriter,this._delegate,i._snapshot)))}onSnapshot(...t){let e=Fx(t),i=Lx(t,r=>new wc(this.firestore,new Nn(this.firestore._delegate,this._userDataWriter,this._delegate,r._snapshot)));return em(this._delegate,e,i)}withConverter(t){return new n(this.firestore,t?this._delegate.withConverter(Do.getInstance(this.firestore,t)):this._delegate.withConverter(null))}},sm=class{constructor(t,e){this._firestore=t,this._delegate=e}get type(){return this._delegate.type}get doc(){return new ms(this._firestore,this._delegate.doc)}get oldIndex(){return this._delegate.oldIndex}get newIndex(){return this._delegate.newIndex}},wc=class{constructor(t,e){this._firestore=t,this._delegate=e}get query(){return new _s(this._firestore,this._delegate.query)}get metadata(){return this._delegate.metadata}get size(){return this._delegate.size}get empty(){return this._delegate.empty}get docs(){return this._delegate.docs.map(t=>new ms(this._firestore,t))}docChanges(t){return this._delegate.docChanges(t).map(e=>new sm(this._firestore,e))}forEach(t,e){this._delegate.forEach(i=>{t.call(e,new ms(this._firestore,i))})}isEqual(t){return Jg(this._delegate,t._delegate)}},Mo=class n extends _s{constructor(t,e){super(t,e),this.firestore=t,this._delegate=e}get id(){return this._delegate.id}get path(){return this._delegate.path}get parent(){let t=this._delegate.parent;return t?new Jn(this.firestore,t):null}doc(t){try{return t===void 0?new Jn(this.firestore,xc(this._delegate)):new Jn(this.firestore,xc(this._delegate,t))}catch(e){throw Ue(e,"doc()","CollectionReference.doc()")}}add(t){return Ax(this._delegate,t).then(e=>new Jn(this.firestore,e))}isEqual(t){return Gg(this._delegate,t._delegate)}withConverter(t){return new n(this.firestore,t?this._delegate.withConverter(Do.getInstance(this.firestore,t)):this._delegate.withConverter(null))}};function ps(n){return _t(n,Pt)}var om=class n{constructor(...t){this._delegate=new Vn(...t)}static documentId(){return new n(Xt.keyField().canonicalString())}isEqual(t){return t=jt(t),t instanceof Vn?this._delegate._internalPath.isEqual(t._internalPath):!1}};var am=class n{constructor(t){this._delegate=t}static serverTimestamp(){let t=Rx();return t._methodName="FieldValue.serverTimestamp",new n(t)}static delete(){let t=kx();return t._methodName="FieldValue.delete",new n(t)}static arrayUnion(...t){let e=Dx(...t);return e._methodName="FieldValue.arrayUnion",new n(e)}static arrayRemove(...t){let e=Mx(...t);return e._methodName="FieldValue.arrayRemove",new n(e)}static increment(t){let e=Ox(t);return e._methodName="FieldValue.increment",new n(e)}isEqual(t){return this._delegate.isEqual(t._delegate)}};var VC={Firestore:th,GeoPoint:cs,Timestamp:Ut,Blob:Zu,Transaction:eh,WriteBatch:nh,DocumentReference:Jn,DocumentSnapshot:gs,Query:_s,QueryDocumentSnapshot:ms,QuerySnapshot:wc,CollectionReference:Mo,FieldPath:om,FieldValue:am,setLogLevel:OC,CACHE_SIZE_UNLIMITED:Hb};function NC(n,t){n.INTERNAL.registerComponent(new qr("firestore-compat",e=>{let i=e.getProvider("app-compat").getImmediate(),r=e.getProvider("firestore").getImmediate();return t(i,r)},"PUBLIC").setServiceProps(Object.assign({},VC)))}function FC(n){NC(n,(t,e)=>new th(t,e,new rm)),n.registerVersion(RC,DC)}FC($e);function LC(n,t=ml){return new Bs(e=>{let i;return t!=null?t.schedule(()=>{i=n.onSnapshot({includeMetadataChanges:!0},e)}):i=n.onSnapshot({includeMetadataChanges:!0},e),()=>{i?.()}})}function Bx(n,t){return LC(n,t)}function BC(n,t){return Bx(n,t).pipe(bl(void 0),yl(),Be(e=>{let[i,r]=e;return r.exists?i?.exists?{payload:r,type:"modified"}:{payload:r,type:"added"}:{payload:r,type:"removed"}}))}function hm(n,t){return Bx(n,t).pipe(Be(e=>({payload:e,type:"query"})))}var ih=class{ref;afs;constructor(t,e){this.ref=t,this.afs=e}set(t,e){return this.ref.set(t,e)}update(t){return this.ref.update(t)}delete(){return this.ref.delete()}collection(t,e){let i=this.ref.collection(t),{ref:r,query:s}=Wx(i,e);return new sh(r,s,this.afs)}snapshotChanges(){return BC(this.ref,this.afs.schedulers.outsideAngular).pipe(Ke)}valueChanges(t={}){return this.snapshotChanges().pipe(Be(({payload:e})=>t.idField?Rn(pn({},e.data()),{[t.idField]:e.id}):e.data()))}get(t){return zi(this.ref.get(t)).pipe(Ke)}};function rh(n,t){return hm(n,t).pipe(bl(void 0),yl(),Be(e=>{let[i,r]=e,s=r.payload.docChanges(),o=s.map(a=>({type:a.type,payload:a}));return i&&JSON.stringify(i.payload.metadata)!==JSON.stringify(r.payload.metadata)&&r.payload.docs.forEach((a,c)=>{let l=s.find(d=>d.doc.ref.isEqual(a.ref)),h=i?.payload.docs.find(d=>d.ref.isEqual(a.ref));l&&JSON.stringify(l.doc.metadata)===JSON.stringify(a.metadata)||!l&&h&&JSON.stringify(h.metadata)===JSON.stringify(a.metadata)||o.push({type:"modified",payload:{oldIndex:c,newIndex:c,type:"modified",doc:a}})}),o}))}function zx(n,t,e){return rh(n,e).pipe(vl((i,r)=>zC(i,r.map(s=>s.payload),t),[]),_l(),Be(i=>i.map(r=>({type:r.type,payload:r}))))}function zC(n,t,e){return t.forEach(i=>{e.indexOf(i.type)>-1&&(n=jC(n,i))}),n}function lm(n,t,e,...i){let r=n.slice();return r.splice(t,e,...i),r}function jC(n,t){switch(t.type){case"added":if(!(n[t.newIndex]&&n[t.newIndex].doc.ref.isEqual(t.doc.ref)))return lm(n,t.newIndex,0,t);break;case"modified":if(n[t.oldIndex]==null||n[t.oldIndex].doc.ref.isEqual(t.doc.ref))if(t.oldIndex!==t.newIndex){let e=n.slice();return e.splice(t.oldIndex,1),e.splice(t.newIndex,0,t),e}else return lm(n,t.newIndex,1,t);break;case"removed":if(n[t.oldIndex]&&n[t.oldIndex].doc.ref.isEqual(t.doc.ref))return lm(n,t.oldIndex,1);break}return n}function jx(n){return(!n||n.length===0)&&(n=["added","removed","modified"]),n}var sh=class{ref;query;afs;constructor(t,e,i){this.ref=t,this.query=e,this.afs=i}stateChanges(t){let e=rh(this.query,this.afs.schedulers.outsideAngular);return t&&t.length>0&&(e=e.pipe(Be(i=>i.filter(r=>t.indexOf(r.type)>-1)))),e.pipe(bl(void 0),yl(),Aa(([i,r])=>r.length>0||!i),Be(([,i])=>i),Ke)}auditTrail(t){return this.stateChanges(t).pipe(vl((e,i)=>[...e,...i],[]))}snapshotChanges(t){let e=jx(t);return zx(this.query,e,this.afs.schedulers.outsideAngular).pipe(Ke)}valueChanges(t={}){return hm(this.query,this.afs.schedulers.outsideAngular).pipe(Be(e=>e.payload.docs.map(i=>t.idField?Rn(pn({},i.data()),{[t.idField]:i.id}):i.data())),Ke)}get(t){return zi(this.query.get(t)).pipe(Ke)}add(t){return this.ref.add(t)}doc(t){return new ih(this.ref.doc(t),this.afs)}},um=class{query;afs;constructor(t,e){this.query=t,this.afs=e}stateChanges(t){return!t||t.length===0?rh(this.query,this.afs.schedulers.outsideAngular).pipe(Ke):rh(this.query,this.afs.schedulers.outsideAngular).pipe(Be(e=>e.filter(i=>t.indexOf(i.type)>-1)),Aa(e=>e.length>0),Ke)}auditTrail(t){return this.stateChanges(t).pipe(vl((e,i)=>[...e,...i],[]))}snapshotChanges(t){let e=jx(t);return zx(this.query,e,this.afs.schedulers.outsideAngular).pipe(Ke)}valueChanges(t={}){return hm(this.query,this.afs.schedulers.outsideAngular).pipe(Be(i=>i.payload.docs.map(r=>t.idField?pn({[t.idField]:r.id},r.data()):r.data())),Ke)}get(t){return zi(this.query.get(t)).pipe(Ke)}},Ux=new we("angularfire2.enableFirestorePersistence"),qx=new we("angularfire2.firestore.persistenceSettings"),UC=new we("angularfire2.firestore.settings"),qC=new we("angularfire2.firestore.use-emulator");function Wx(n,t=e=>e){return{query:t(n),ref:n}}var dm=(()=>{class n{schedulers;firestore;persistenceEnabled$;constructor(e,i,r,s,o,a,c,l,h,d,p,g,y,v,w,k,R){this.schedulers=c;let M=Da(e,a,i),F=h;d&&rf(M,a,p,y,v,w,g,k),[this.firestore,this.persistenceEnabled$]=Ml(`${M.name}.firestore`,"AngularFirestore",M.name,()=>{let V=a.runOutsideAngular(()=>M.firestore());if(s&&V.settings(s),F&&V.useEmulator(...F),r&&!Sl(o)){let L=()=>{try{return zi(V.enablePersistence(l||void 0).then(()=>!0,()=>!1))}catch(I){return typeof console<"u"&&console.warn(I),ji(!1)}};return[V,a.runOutsideAngular(L)]}else return[V,ji(!1)]},[s,F,r])}collection(e,i){let r;typeof e=="string"?r=this.firestore.collection(e):r=e;let{ref:s,query:o}=Wx(r,i),a=this.schedulers.ngZone.run(()=>s);return new sh(a,o,this)}collectionGroup(e,i){let r=i||(o=>o),s=this.firestore.collectionGroup(e);return new um(r(s),this)}doc(e){let i;typeof e=="string"?i=this.firestore.doc(e):i=e;let r=this.schedulers.ngZone.run(()=>i);return new ih(r,this)}createId(){return this.firestore.collection("_").doc().id}static \u0275fac=function(i){return new(i||n)(ht(Ws),ht(Hs,8),ht(Ux,8),ht(UC,8),ht(Us),ht(jn),ht(Rl),ht(qx,8),ht(qC,8),ht(Vl,8),ht(Xd,8),ht(Jd,8),ht(Zd,8),ht(tf,8),ht(ef,8),ht(nf,8),ht(Hr,8))};static \u0275prov=Me({token:n,factory:n.\u0275fac,providedIn:"any"})}return n})(),Hx=(()=>{class n{constructor(){$e.registerVersion("angularfire",qs.full,"fst-compat")}static enablePersistence(e){return{ngModule:n,providers:[{provide:Ux,useValue:!0},{provide:qx,useValue:e}]}}static \u0275fac=function(i){return new(i||n)};static \u0275mod=gi({type:n});static \u0275inj=pi({providers:[dm]})}return n})();var Gx={apiKey:"AIzaSyAcJCYeHG9s2bFsjshzCmbtHmbwoXLlt_M",authDomain:"fevor-exp.firebaseapp.com",projectId:"fevor-exp",storageBucket:"fevor-exp.appspot.com",messagingSenderId:"756785263997",appId:"1:756785263997:web:5a171b966e5e79cc350814"};var Ae=[];for(oh=0;oh<256;++oh)Ae.push((oh+256).toString(16).slice(1));var oh;function $x(n,t=0){return(Ae[n[t+0]]+Ae[n[t+1]]+Ae[n[t+2]]+Ae[n[t+3]]+"-"+Ae[n[t+4]]+Ae[n[t+5]]+"-"+Ae[n[t+6]]+Ae[n[t+7]]+"-"+Ae[n[t+8]]+Ae[n[t+9]]+"-"+Ae[n[t+10]]+Ae[n[t+11]]+Ae[n[t+12]]+Ae[n[t+13]]+Ae[n[t+14]]+Ae[n[t+15]]).toLowerCase()}var ah,HC=new Uint8Array(16);function fm(){if(!ah&&(ah=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!ah))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return ah(HC)}var GC=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto),pm={randomUUID:GC};function $C(n,t,e){if(pm.randomUUID&&!t&&!n)return pm.randomUUID();n=n||{};var i=n.random||(n.rng||fm)();if(i[6]=i[6]&15|64,i[8]=i[8]&63|128,t){e=e||0;for(var r=0;r<16;++r)t[e+r]=i[r];return t}return $x(i)}var gm=$C;var ch=class{static operators={"+":{precedence:1,associativity:"Left"},"-":{precedence:1,associativity:"Left"},"*":{precedence:2,associativity:"Left"},"/":{precedence:2,associativity:"Left"}};static evaluate(t){let e=[],i=[];for(this.tokenize(t).forEach(s=>{if(this.isNumber(s))e.push(parseFloat(s));else if(this.isOperator(s)){for(;i.length>0&&this.isOperator(i[i.length-1])&&(this.operators[s].associativity==="Left"&&this.operators[s].precedence<=this.operators[i[i.length-1]].precedence||this.operators[s].associativity==="Right"&&this.operators[s].precedence<this.operators[i[i.length-1]].precedence);)e.push(i.pop());i.push(s)}else if(s==="(")i.push(s);else if(s===")"){for(;i[i.length-1]!=="(";)e.push(i.pop());i.pop()}});i.length>0;)e.push(i.pop());return this.evaluateRPN(e)}static tokenize(t){let e=/\d+(\.\d+)?|\+|\-|\*|\/|\(|\)/g;return t.match(e)||[]}static isNumber(t){return!isNaN(parseFloat(t))}static isOperator(t){return Object.keys(this.operators).includes(t)}static evaluateRPN(t){let e=[];return t.forEach(i=>{if(typeof i=="number")e.push(i);else if(this.isOperator(i)){let r=e.pop(),s=e.pop();switch(i){case"+":e.push(s+r);break;case"-":e.push(s-r);break;case"*":e.push(s*r);break;case"/":e.push(s/r);break}}}),e.pop()}};var Oo=class n{messageSubject=new zs;message$=this.messageSubject.asObservable();showMessage(t){this.messageSubject.next(t)}static \u0275fac=function(e){return new(e||n)};static \u0275prov=Me({token:n,factory:n.\u0275fac,providedIn:"root"})};var Vo=ry(Ud());var lh=class n{constructor(t){this.el=t}swipeLeft=new Te;swipeRight=new Te;swipeDown=new Te;swipeUp=new Te;hammer;ngOnInit(){this.hammer=new Vo.Manager(this.el.nativeElement),this.hammer.add(new Vo.Swipe({direction:Vo.DIRECTION_ALL})),this.hammer.on("swipeleft",()=>this.onSwipeLeft()),this.hammer.on("swiperight",()=>this.onSwipeRight()),this.hammer.on("swipeup",()=>this.onSwipeUp()),this.hammer.on("swipedown",()=>this.onSwipeDown())}onSwipeLeft(){this.swipeLeft.emit()}onSwipeRight(){this.swipeRight.emit()}onSwipeDown(){this.swipeDown.emit()}onSwipeUp(){this.swipeUp.emit()}ngOnDestroy(){this.hammer&&this.hammer.destroy()}static \u0275fac=function(e){return new(e||n)($t(Tl))};static \u0275dir=xl({type:n,selectors:[["","appSwipe",""]],outputs:{swipeLeft:"swipeLeft",swipeRight:"swipeRight",swipeDown:"swipeDown",swipeUp:"swipeUp"}})};var YC=n=>({"scrollable-content-down":n});function QC(n,t){if(n&1){let e=zt();Y(0,"div",5),ot("click",function(){let r=rt(e).$implicit,s=tt();return st(s.onCategoryClick(r.id))}),me(1,"i"),Y(2,"span"),et(3),X()()}if(n&2){let e=t.$implicit;nt(),my(e.icon),Ie("color",e.color),nt(2),gn(e.name)}}function XC(n,t){if(n&1){let e=zt();Y(0,"div",6),ot("click",function(){rt(e);let r=tt();return st(r.onClickMore())}),Y(1,"div"),et(2,"\u0415\u0449\u0435"),X(),me(3,"i",7),X()}}function JC(n,t){if(n&1){let e=zt();Y(0,"div",8),ot("click",function(r){return rt(e),st(r.stopPropagation())}),Y(1,"button",9),ot("click",function(){rt(e);let r=tt();return st(r.updateIcon())}),et(2,"Update"),X(),Y(3,"button",9),ot("click",function(){rt(e);let r=tt();return st(r.deleteIcon())}),et(4,"Delete"),X()()}if(n&2){let e=tt();Ct("ngStyle",e.menuPosition)}}var uh=class n{isContentDown;categoryClick=new Te;categorySwipeRight=new Te;categorySwipeLeft=new Te;categorySwipeUp=new Te;categorySwipeDown=new Te;clickMore=new Te;categories=[...Wr];showMore=!1;ngOnChanges(t){t.isContentDown&&(this.isContentDown?this.categories=[...Wr]:this.updateVisibleCategories())}onCategoryClick(t){this.categoryClick.emit(t)}categoryWidth=120;categoryHeight=94;containerWidth=0;containerHeight=0;ngOnInit(){}onResize(t){this.updateVisibleCategories()}ngAfterViewInit(){this.updateVisibleCategories()}updateVisibleCategories(){this.categories=[];let t=document.querySelector(".categories");if(t){this.containerWidth=t.clientWidth,this.containerHeight=t.clientHeight;let e=this.calculateRows(this.containerWidth,this.containerHeight);this.showMore=Wr.length>e,this.showMore&&(e=this.calculateRows(this.containerWidth,this.containerHeight-40)),this.categories=[...Wr].slice(0,e)}}calculateRows(t,e){let i=Math.floor(t/this.categoryWidth),r=Math.floor(e/this.categoryHeight);return i*r}touchStartX=0;touchStartY=0;touchEndX=0;touchEndY=0;isDown=!1;onTouchStart(t){this.touchStartX=t.changedTouches[0].screenX,this.touchStartY=t.changedTouches[0].screenY}onTouchEnd(t){this.touchEndX=t.changedTouches[0].screenX,this.touchEndY=t.changedTouches[0].screenY,this.handleSwipeGesture()}handleSwipeGesture(){let t=this.touchEndX-this.touchStartX,e=this.touchEndY-this.touchStartY;Math.abs(t)>Math.abs(e)?t>50?this.onSwipeRight():t<-50&&this.onSwipeLeft():Math.abs(e)>Math.abs(t)&&(e<-50?this.onSwipeUp():e>50&&this.onSwipeDown())}onSwipeRight(){this.categorySwipeRight.emit()}onSwipeLeft(){this.categorySwipeLeft.emit()}onSwipeUp(){this.isScrolledUp()?this.isDown?this.categorySwipeUp.emit():this.isDown=!0:this.isDown=!1}onSwipeDown(){}isScrolledUp(){let t=window.pageYOffset||document.documentElement.scrollTop||document.body.scrollTop||0,e=document.documentElement.scrollHeight||document.body.scrollHeight||0,i=window.innerHeight||document.documentElement.clientHeight||document.body.clientHeight||0;return t===e-i}onClickMore(){this.clickMore.emit()}menuVisible=!1;menuPosition={top:"0px",left:"0px"};selectedIconIndex=null;updateIcon(){this.menuVisible=!1}deleteIcon(){this.menuVisible=!1}onDocumentClick(t){}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=Oe({type:n,selectors:[["app-categories"]],hostBindings:function(e,i){e&1&&ot("resize",function(s){return i.onResize(s)},!1,py)("touchstart",function(s){return i.onTouchStart(s)})("touchend",function(s){return i.onTouchEnd(s)})("click",function(s){return i.onDocumentClick(s)},!1,gy)},inputs:{isContentDown:"isContentDown"},outputs:{categoryClick:"categoryClick",categorySwipeRight:"categorySwipeRight",categorySwipeLeft:"categorySwipeLeft",categorySwipeUp:"categorySwipeUp",categorySwipeDown:"categorySwipeDown",clickMore:"clickMore"},features:[wl],decls:5,vars:10,consts:[[1,"scrollable-content"],[1,"categories",3,"ngClass"],["class","category",3,"click",4,"ngFor","ngForOf"],["class","categories-more",3,"click",4,"ngIf"],["class","menu",3,"ngStyle","click",4,"ngIf"],[1,"category",3,"click"],[1,"categories-more",3,"click"],[1,"fa-solid","fa-chevron-down"],[1,"menu",3,"click","ngStyle"],["mat-menu-item","",3,"click"]],template:function(e,i){e&1&&(Y(0,"div",0)(1,"div",1),Ee(2,QC,4,5,"div",2),X()(),Ee(3,XC,4,0,"div",3)(4,JC,5,1,"div",4)),e&2&&(Ie("overflow",i.isContentDown?"scroll":"hidden")("height",i.showMore?"calc(100% - 40px)":"100%"),nt(),Ct("ngClass",by(8,YC,i.isContentDown&&!i.showMore)),nt(),Ct("ngForOf",i.categories),nt(),Ct("ngIf",i.showMore),nt(),Ct("ngIf",i.menuVisible))},dependencies:[Ey,Il,mn,Iy],styles:[".scrollable-content[_ngcontent-%COMP%]{display:flex;height:calc(100% - 30px);width:100%}.categories[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;justify-content:space-around;width:100%;opacity:.7;touch-action:manipulation}.category[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;width:90px;height:64px;padding:15px;text-align:center;font-size:15px;touch-action:manipulation}.category[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:35px;margin-bottom:5px}.scrollable-content-down[_ngcontent-%COMP%]{align-self:flex-end}.categories-more[_ngcontent-%COMP%]{text-align:center;color:gray;background-color:#0000}.menu[_ngcontent-%COMP%]{position:absolute;background-color:#fff;border:1px solid #ccc;box-shadow:0 0 10px #0000001a;z-index:1000;display:flex;flex-direction:column}button.mat-menu-item[_ngcontent-%COMP%]{padding:10px;width:100%;text-align:left;cursor:pointer;background:none;border:none}"]})};function tP(n,t){if(n&1){let e=zt();Y(0,"span",9),ot("click",function(){rt(e);let r=tt();return st(r.onShowSavings())}),et(1),X()}if(n&2){let e=tt();nt(),_e("",e.monthAmount,"\u20AC")}}function eP(n,t){if(n&1){let e=zt();Y(0,"span",14),ot("click",function(){rt(e);let r=tt();return st(r.onShowSavings())}),et(1),X(),Y(2,"i",15),ot("click",function(){rt(e);let r=tt();return st(r.changeSavings())}),X()}if(n&2){let e=tt();nt(),_e("",e.savings,"\u20AC")}}function nP(n,t){if(n&1){let e=zt();Y(0,"app-categories",16),ot("categoryClick",function(r){rt(e);let s=tt();return st(s.onCategoryClick(r))})("clickMore",function(){rt(e);let r=tt();return st(r.onSwipeDown())})("swipeDown",function(){rt(e);let r=tt();return st(r.onSwipeDown())})("swipeUp",function(){rt(e);let r=tt();return st(r.onShowKeyBoard())})("swipeLeft",function(){rt(e);let r=tt();return st(r.onSwipeLeft())})("swipeRight",function(){rt(e);let r=tt();return st(r.onSwipeRight())}),X()}n&2&&Ie("overflow","hidden")}function iP(n,t){if(n&1){let e=zt();Y(0,"app-categories",18),ot("categorySwipeRight",function(){rt(e);let r=tt(2);return st(r.onSwipeRight())})("categorySwipeLeft",function(){rt(e);let r=tt(2);return st(r.onSwipeLeft())})("categorySwipeUp",function(){rt(e);let r=tt(2);return st(r.onShowKeyBoard())})("categoryClick",function(r){rt(e);let s=tt(2);return st(s.onCategoryClick(r))}),X()}n&2&&Ct("isContentDown",!0)}function rP(n,t){if(n&1&&Ee(0,iP,1,1,"app-categories",17),n&2){let e=tt();Ct("ngIf",!e.showKeyBoard)}}function sP(n,t){if(n&1){let e=zt();Y(0,"div",19)(1,"div",20),ot("swipeleft",function(){rt(e);let r=tt();return st(r.onDeleteClick())})("swiperight",function(){rt(e);let r=tt();return st(r.onDeleteClick())}),Y(2,"input",21),vy("ngModelChange",function(r){rt(e);let s=tt();return yy(s.enteredAmount,r)||(s.enteredAmount=r),st(r)}),X(),Y(3,"span",9),ot("click",function(){rt(e);let r=tt();return st(r.onCurrencyClick())}),et(4),X()(),Y(5,"div",22),ot("swipedown",function(r){rt(e);let s=tt();return st(s.onDisableRefresh(r))})("swipeleft",function(){rt(e);let r=tt();return st(r.onSwipeLeft())})("swiperight",function(){rt(e);let r=tt();return st(r.onSwipeRight())}),Y(6,"div",23),ot("click",function(){rt(e);let r=tt();return st(r.onNumberClick("1"))}),et(7,"1"),X(),Y(8,"div",23),ot("click",function(){rt(e);let r=tt();return st(r.onNumberClick("2"))}),et(9,"2"),X(),Y(10,"div",23),ot("click",function(){rt(e);let r=tt();return st(r.onNumberClick("3"))}),et(11,"3"),X(),Y(12,"div",23),ot("click",function(){rt(e);let r=tt();return st(r.onNumberClick("4"))}),et(13,"4"),X(),Y(14,"div",23),ot("click",function(){rt(e);let r=tt();return st(r.onNumberClick("5"))}),et(15,"5"),X(),Y(16,"div",23),ot("click",function(){rt(e);let r=tt();return st(r.onNumberClick("6"))}),et(17,"6"),X(),Y(18,"div",23),ot("click",function(){rt(e);let r=tt();return st(r.onNumberClick("7"))}),et(19,"7"),X(),Y(20,"div",23),ot("click",function(){rt(e);let r=tt();return st(r.onNumberClick("8"))}),et(21,"8"),X(),Y(22,"div",23),ot("click",function(){rt(e);let r=tt();return st(r.onNumberClick("9"))}),et(23,"9"),X(),Y(24,"div",23),ot("click",function(){rt(e);let r=tt();return st(r.onNumberClick("."))}),et(25,"."),X(),Y(26,"div",23),ot("click",function(){rt(e);let r=tt();return st(r.onNumberClick("0"))}),et(27,"0"),X(),Y(28,"div",23),ot("click",function(){rt(e);let r=tt();return st(r.onDeleteClick())}),me(29,"i",24),X()()()}if(n&2){let e=tt();nt(2),_y("ngModel",e.enteredAmount),nt(2),gn(e.getCurrencySymbol())}}var hh=class n{constructor(t,e){this.router=t;this.notificationService=e}enteredAmount="";currentAmount=0;monthAmount=0;balance=0;balanceDate="";showKeyBoard=!0;currentDate=new Date().toLocaleDateString("ru-RU",{weekday:"short",month:"short",day:"numeric"});categories=Wr;currency;showSavings;savings="0";getCurrencySymbol(){return Ty(this.currency.code,"narrow")}ngAfterViewChecked(){this.categoriesVisible=!0}ngOnInit(){let t=JSON.parse(localStorage.getItem("expenses")||"[]");this.sumValues(t),this.balance=Number(localStorage.getItem("balance"))||0,this.balanceDate=localStorage.getItem("balanceDate");let e=localStorage.getItem("currency");e?this.currency=JSON.parse(e):(this.currency={code:"EUR"},localStorage.setItem("currency",JSON.stringify(this.currency))),this.savings=localStorage.getItem("savings")||"0"}categoriesVisible=!1;onNumberClick(t){t==="."?this.enteredAmount.length===0?this.enteredAmount="0.":this.enteredAmount.includes(".")||(this.enteredAmount+=t):this.enteredAmount+=t}onDeleteClick(){this.enteredAmount.length>0&&(this.enteredAmount=this.enteredAmount.slice(0,-1))}onCategoryClick(t){let e=this.currency?.exchangeRate||1,i=ch.evaluate(this.enteredAmount),r=Math.round(i/e*100)/100;if(r>0){let s=localStorage.getItem("expenses"),o=s?JSON.parse(s):[];if(o.unshift({id:gm(),category:t,amount:r,currency:this.currency?.code,date:Date.now()}),Wy(t)?.includeInBalance){let a=Number(localStorage.getItem("balance")||0),c=Math.round((a-r)*100)/100;localStorage.setItem("balance",c.toString()),this.balance=c}localStorage.setItem("expenses",JSON.stringify(o)),this.sumValues(o),this.enteredAmount="",this.showKeyBoard=!0,this.notificationService.showMessage(`\u0414\u043E\u0431\u0430\u0432\u043B\u0435\u043D\u043E: ${Wi(t)}, ${r} \u20AC
        (${this.currentAmount}\u20AC)`)}}ngAfterViewInit(){}onBalanceChange(){let t=prompt("Enter new balance",this.balance.toString());t&&(localStorage.setItem("balance",t),this.balance=Number(t))}onBalanceDateChange(){let t=prompt("Enter new balance date",this.balanceDate||"");t&&(localStorage.setItem("balanceDate",t),this.balanceDate=t)}onDisableRefresh(t){t.stopPropagation()}onSwipeLeft(){this.router.navigate(["/history"])}onSwipeRight(){this.router.navigate(["/statistics"])}onShowKeyBoard(){this.showKeyBoard=!0}onSwipeDown(){this.showKeyBoard=!1}onShowSavings(){this.showSavings=!this.showSavings}changeSavings(){let t=prompt("Enter new savings",this.savings);t&&(localStorage.setItem("savings",t),this.savings=t)}onCurrencyClick(){let t=prompt("Enter new currency",this.currency.code);if(t){let e="1";t!=="EUR"&&(e=prompt("Enter exchange rate",this.currency?.exchangeRate?.toString()||"1")),this.currency={code:t,exchangeRate:Number(e)},localStorage.setItem("currency",JSON.stringify(this.currency))}}sumValues(t){this.currentAmount=0,this.monthAmount=0,t.forEach(e=>{if(new Date(e.date).toDateString()===new Date().toDateString()){let a=this.currentAmount+e.amount;this.currentAmount=Math.round(a*100)/100}let i=new Date().getMonth(),r=new Date().getFullYear(),s=new Date(e.date).getMonth(),o=new Date(e.date).getFullYear();if(i===s&&r===o){let a=this.monthAmount+e.amount;this.monthAmount=Math.round(a*100)/100}})}static \u0275fac=function(e){return new(e||n)($t(qi),$t(Oo))};static \u0275cmp=Oe({type:n,selectors:[["app-expense"]],decls:30,vars:27,consts:[["savingsTemplate",""],["categoriesWithScroll",""],[1,"container"],[1,"header"],[1,"menu-icon",3,"routerLink"],[1,"fas","fa-bars"],[1,"title"],[3,"click",4,"ngIf","ngIfElse"],[1,"title-total"],[3,"click"],[1,"clock-icon",3,"routerLink"],[1,"fas","fa-clock"],["appSwipe","",3,"overflow","categoryClick","clickMore","swipeDown","swipeUp","swipeLeft","swipeRight",4,"ngIf","ngIfElse"],["class","number-board",4,"ngIf"],[1,"expense-savings",3,"click"],[1,"fas","fa-pencil-alt",3,"click"],["appSwipe","",3,"categoryClick","clickMore","swipeDown","swipeUp","swipeLeft","swipeRight"],[3,"isContentDown","categorySwipeRight","categorySwipeLeft","categorySwipeUp","categoryClick",4,"ngIf"],[3,"categorySwipeRight","categorySwipeLeft","categorySwipeUp","categoryClick","isContentDown"],[1,"number-board"],[1,"number-board-header",3,"swipeleft","swiperight"],["type","text","name","input","placeholder","\u0412\u0412\u0415\u0414\u0418\u0422\u0415 \u0420\u0410\u0421\u0425\u041E\u0414",3,"ngModelChange","ngModel"],[1,"number-board-body",3,"swipedown","swipeleft","swiperight"],[1,"number",3,"click"],[1,"fas","fa-backspace"]],template:function(e,i){if(e&1){let r=zt();Y(0,"div",2)(1,"div",3)(2,"div",4),me(3,"i",5),X(),Y(4,"div",6),Ee(5,tP,2,1,"span",7)(6,eP,3,1,"ng-template",null,0,Pa),X(),Y(8,"div",6),et(9,"-"),X(),Y(10,"div",6)(11,"div"),et(12),X(),Y(13,"span",8),et(14),X(),Y(15,"span",8),et(16,"\u20AC"),X()(),Y(17,"div",6),et(18,"-"),X(),Y(19,"div",6)(20,"div",9),ot("click",function(){return rt(r),st(i.onBalanceDateChange())}),et(21),X(),Y(22,"span",9),ot("click",function(){return rt(r),st(i.onBalanceChange())}),et(23),X()(),Y(24,"div",10),me(25,"i",11),X()(),Ee(26,nP,1,2,"app-categories",12)(27,rP,1,1,"ng-template",null,1,Pa)(29,sP,30,2,"div",13),X()}if(e&2){let r=Ca(7),s=Ca(28);nt(2),Ct("routerLink","/export"),nt(),Ie("color","#BDA4A7"),nt(),Ie("color","#343434"),nt(),Ct("ngIf",!i.showSavings)("ngIfElse",r),nt(3),Ie("color","grey"),nt(3),Ie("color","grey"),nt(),gn(i.currentDate),nt(2),gn(i.currentAmount),nt(3),Ie("color","grey"),nt(2),Ie("color","grey"),nt(2),_e("\u0434\u043E ",i.balanceDate,""),nt(),Ie("color","#343434"),nt(),_e("",i.balance,"\u20AC"),nt(),Ct("routerLink","/history"),nt(),Ie("color","#BDA4A7"),nt(),Ct("ngIf",i.showKeyBoard)("ngIfElse",s),nt(3),Ct("ngIf",i.showKeyBoard)}},dependencies:[mn,qy,Ry,Dy,My,lh,uh],styles:[".container[_ngcontent-%COMP%]{display:grid;grid-template-rows:auto 1fr auto;height:100dvh;-webkit-user-select:none;user-select:none}.container[_ngcontent-%COMP%]   .expense-savings[_ngcontent-%COMP%]{padding-right:10px}.header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:10px;height:72px;background-color:#f8d7da;margin-bottom:20px;box-shadow:0 -22px 33px #870024}.menu-icon[_ngcontent-%COMP%], .clock-icon[_ngcontent-%COMP%]{font-size:24px}.expense-info[_ngcontent-%COMP%]{display:flex;align-items:center;font-size:24px;color:#ff6f61}.title[_ngcontent-%COMP%]{text-align:center;font-size:18px;margin:10px 0}.title-total[_ngcontent-%COMP%]{font-size:27px;color:#870024}.add-expense[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;font-size:36px;background-color:#ff6f61;color:#fff;width:60px;height:60px;border-radius:50%;align-self:center;margin:20px 0}.number-board[_ngcontent-%COMP%]{background-color:#f8d7da;height:292px;box-shadow:0 3px 7px #870024}.number-board-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-size:18px;padding:12px;position:relative;border:#fff 1px solid;border-top:none}.number-board-header[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;text-align:center;border:none;background:none;font-size:18px;outline:none}.number-board-body[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);overflow:hidden}.number[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;background-color:#f8d7da;border:#fff 1px solid;font-size:24px;padding:15px;overflow:hidden;color:#870024}.number[_ngcontent-%COMP%]   i[_ngcontent-%COMP%]{font-size:24px}"]})};function Sc(n){return n+.5|0}var dr=(n,t,e)=>Math.max(Math.min(n,e),t);function Ec(n){return dr(Sc(n*2.55),0,255)}function fr(n){return dr(Sc(n*255),0,255)}function Si(n){return dr(Sc(n/2.55)/100,0,1)}function Yx(n){return dr(Sc(n*100),0,100)}var xn={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},_m=[..."0123456789ABCDEF"],oP=n=>_m[n&15],aP=n=>_m[(n&240)>>4]+_m[n&15],fh=n=>(n&240)>>4===(n&15),cP=n=>fh(n.r)&&fh(n.g)&&fh(n.b)&&fh(n.a);function lP(n){var t=n.length,e;return n[0]==="#"&&(t===4||t===5?e={r:255&xn[n[1]]*17,g:255&xn[n[2]]*17,b:255&xn[n[3]]*17,a:t===5?xn[n[4]]*17:255}:(t===7||t===9)&&(e={r:xn[n[1]]<<4|xn[n[2]],g:xn[n[3]]<<4|xn[n[4]],b:xn[n[5]]<<4|xn[n[6]],a:t===9?xn[n[7]]<<4|xn[n[8]]:255})),e}var uP=(n,t)=>n<255?t(n):"";function hP(n){var t=cP(n)?oP:aP;return n?"#"+t(n.r)+t(n.g)+t(n.b)+uP(n.a,t):void 0}var dP=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function Zx(n,t,e){let i=t*Math.min(e,1-e),r=(s,o=(s+n/30)%12)=>e-i*Math.max(Math.min(o-3,9-o,1),-1);return[r(0),r(8),r(4)]}function fP(n,t,e){let i=(r,s=(r+n/60)%6)=>e-e*t*Math.max(Math.min(s,4-s,1),0);return[i(5),i(3),i(1)]}function pP(n,t,e){let i=Zx(n,1,.5),r;for(t+e>1&&(r=1/(t+e),t*=r,e*=r),r=0;r<3;r++)i[r]*=1-t-e,i[r]+=t;return i}function gP(n,t,e,i,r){return n===r?(t-e)/i+(t<e?6:0):t===r?(e-n)/i+2:(n-t)/i+4}function ym(n){let e=n.r/255,i=n.g/255,r=n.b/255,s=Math.max(e,i,r),o=Math.min(e,i,r),a=(s+o)/2,c,l,h;return s!==o&&(h=s-o,l=a>.5?h/(2-s-o):h/(s+o),c=gP(e,i,r,h,s),c=c*60+.5),[c|0,l||0,a]}function vm(n,t,e,i){return(Array.isArray(t)?n(t[0],t[1],t[2]):n(t,e,i)).map(fr)}function bm(n,t,e){return vm(Zx,n,t,e)}function mP(n,t,e){return vm(pP,n,t,e)}function _P(n,t,e){return vm(fP,n,t,e)}function tw(n){return(n%360+360)%360}function yP(n){let t=dP.exec(n),e=255,i;if(!t)return;t[5]!==i&&(e=t[6]?Ec(+t[5]):fr(+t[5]));let r=tw(+t[2]),s=+t[3]/100,o=+t[4]/100;return t[1]==="hwb"?i=mP(r,s,o):t[1]==="hsv"?i=_P(r,s,o):i=bm(r,s,o),{r:i[0],g:i[1],b:i[2],a:e}}function vP(n,t){var e=ym(n);e[0]=tw(e[0]+t),e=bm(e),n.r=e[0],n.g=e[1],n.b=e[2]}function bP(n){if(!n)return;let t=ym(n),e=t[0],i=Yx(t[1]),r=Yx(t[2]);return n.a<255?`hsla(${e}, ${i}%, ${r}%, ${Si(n.a)})`:`hsl(${e}, ${i}%, ${r}%)`}var Qx={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},Xx={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function xP(){let n={},t=Object.keys(Xx),e=Object.keys(Qx),i,r,s,o,a;for(i=0;i<t.length;i++){for(o=a=t[i],r=0;r<e.length;r++)s=e[r],a=a.replace(s,Qx[s]);s=parseInt(Xx[o],16),n[a]=[s>>16&255,s>>8&255,s&255]}return n}var ph;function wP(n){ph||(ph=xP(),ph.transparent=[0,0,0,0]);let t=ph[n.toLowerCase()];return t&&{r:t[0],g:t[1],b:t[2],a:t.length===4?t[3]:255}}var TP=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function EP(n){let t=TP.exec(n),e=255,i,r,s;if(t){if(t[7]!==i){let o=+t[7];e=t[8]?Ec(o):dr(o*255,0,255)}return i=+t[1],r=+t[3],s=+t[5],i=255&(t[2]?Ec(i):dr(i,0,255)),r=255&(t[4]?Ec(r):dr(r,0,255)),s=255&(t[6]?Ec(s):dr(s,0,255)),{r:i,g:r,b:s,a:e}}}function IP(n){return n&&(n.a<255?`rgba(${n.r}, ${n.g}, ${n.b}, ${Si(n.a)})`:`rgb(${n.r}, ${n.g}, ${n.b})`)}var mm=n=>n<=.0031308?n*12.92:Math.pow(n,1/2.4)*1.055-.055,No=n=>n<=.04045?n/12.92:Math.pow((n+.055)/1.055,2.4);function SP(n,t,e){let i=No(Si(n.r)),r=No(Si(n.g)),s=No(Si(n.b));return{r:fr(mm(i+e*(No(Si(t.r))-i))),g:fr(mm(r+e*(No(Si(t.g))-r))),b:fr(mm(s+e*(No(Si(t.b))-s))),a:n.a+e*(t.a-n.a)}}function gh(n,t,e){if(n){let i=ym(n);i[t]=Math.max(0,Math.min(i[t]+i[t]*e,t===0?360:1)),i=bm(i),n.r=i[0],n.g=i[1],n.b=i[2]}}function ew(n,t){return n&&Object.assign(t||{},n)}function Jx(n){var t={r:0,g:0,b:0,a:255};return Array.isArray(n)?n.length>=3&&(t={r:n[0],g:n[1],b:n[2],a:255},n.length>3&&(t.a=fr(n[3]))):(t=ew(n,{r:0,g:0,b:0,a:1}),t.a=fr(t.a)),t}function AP(n){return n.charAt(0)==="r"?EP(n):yP(n)}var Ic=class n{constructor(t){if(t instanceof n)return t;let e=typeof t,i;e==="object"?i=Jx(t):e==="string"&&(i=lP(t)||wP(t)||AP(t)),this._rgb=i,this._valid=!!i}get valid(){return this._valid}get rgb(){var t=ew(this._rgb);return t&&(t.a=Si(t.a)),t}set rgb(t){this._rgb=Jx(t)}rgbString(){return this._valid?IP(this._rgb):void 0}hexString(){return this._valid?hP(this._rgb):void 0}hslString(){return this._valid?bP(this._rgb):void 0}mix(t,e){if(t){let i=this.rgb,r=t.rgb,s,o=e===s?.5:e,a=2*o-1,c=i.a-r.a,l=((a*c===-1?a:(a+c)/(1+a*c))+1)/2;s=1-l,i.r=255&l*i.r+s*r.r+.5,i.g=255&l*i.g+s*r.g+.5,i.b=255&l*i.b+s*r.b+.5,i.a=o*i.a+(1-o)*r.a,this.rgb=i}return this}interpolate(t,e){return t&&(this._rgb=SP(this._rgb,t._rgb,e)),this}clone(){return new n(this.rgb)}alpha(t){return this._rgb.a=fr(t),this}clearer(t){let e=this._rgb;return e.a*=1-t,this}greyscale(){let t=this._rgb,e=Sc(t.r*.3+t.g*.59+t.b*.11);return t.r=t.g=t.b=e,this}opaquer(t){let e=this._rgb;return e.a*=1+t,this}negate(){let t=this._rgb;return t.r=255-t.r,t.g=255-t.g,t.b=255-t.b,this}lighten(t){return gh(this._rgb,2,t),this}darken(t){return gh(this._rgb,2,-t),this}saturate(t){return gh(this._rgb,1,t),this}desaturate(t){return gh(this._rgb,1,-t),this}rotate(t){return vP(this._rgb,t),this}};function ei(){}var dw=(()=>{let n=0;return()=>n++})();function yt(n){return n===null||typeof n>"u"}function kt(n){if(Array.isArray&&Array.isArray(n))return!0;let t=Object.prototype.toString.call(n);return t.slice(0,7)==="[object"&&t.slice(-6)==="Array]"}function dt(n){return n!==null&&Object.prototype.toString.call(n)==="[object Object]"}function qt(n){return(typeof n=="number"||n instanceof Number)&&isFinite(+n)}function Xe(n,t){return qt(n)?n:t}function ct(n,t){return typeof n>"u"?t:n}var fw=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100:+n/t,Em=(n,t)=>typeof n=="string"&&n.endsWith("%")?parseFloat(n)/100*t:+n;function St(n,t,e){if(n&&typeof n.call=="function")return n.apply(e,t)}function bt(n,t,e,i){let r,s,o;if(kt(n))if(s=n.length,i)for(r=s-1;r>=0;r--)t.call(e,n[r],r);else for(r=0;r<s;r++)t.call(e,n[r],r);else if(dt(n))for(o=Object.keys(n),s=o.length,r=0;r<s;r++)t.call(e,n[o[r]],o[r])}function Pc(n,t){let e,i,r,s;if(!n||!t||n.length!==t.length)return!1;for(e=0,i=n.length;e<i;++e)if(r=n[e],s=t[e],r.datasetIndex!==s.datasetIndex||r.index!==s.index)return!1;return!0}function vh(n){if(kt(n))return n.map(vh);if(dt(n)){let t=Object.create(null),e=Object.keys(n),i=e.length,r=0;for(;r<i;++r)t[e[r]]=vh(n[e[r]]);return t}return n}function pw(n){return["__proto__","prototype","constructor"].indexOf(n)===-1}function CP(n,t,e,i){if(!pw(n))return;let r=t[n],s=e[n];dt(r)&&dt(s)?Lo(r,s,i):t[n]=vh(s)}function Lo(n,t,e){let i=kt(t)?t:[t],r=i.length;if(!dt(n))return n;e=e||{};let s=e.merger||CP,o;for(let a=0;a<r;++a){if(o=i[a],!dt(o))continue;let c=Object.keys(o);for(let l=0,h=c.length;l<h;++l)s(c[l],n,o,e)}return n}function zo(n,t){return Lo(n,t,{merger:PP})}function PP(n,t,e){if(!pw(n))return;let i=t[n],r=e[n];dt(i)&&dt(r)?zo(i,r):Object.prototype.hasOwnProperty.call(t,n)||(t[n]=vh(r))}var nw={"":n=>n,x:n=>n.x,y:n=>n.y};function kP(n){let t=n.split("."),e=[],i="";for(let r of t)i+=r,i.endsWith("\\")?i=i.slice(0,-1)+".":(e.push(i),i="");return e}function RP(n){let t=kP(n);return e=>{for(let i of t){if(i==="")break;e=e&&e[i]}return e}}function Pi(n,t){return(nw[t]||(nw[t]=RP(t)))(n)}function Th(n){return n.charAt(0).toUpperCase()+n.slice(1)}var jo=n=>typeof n<"u",Ai=n=>typeof n=="function",Im=(n,t)=>{if(n.size!==t.size)return!1;for(let e of n)if(!t.has(e))return!1;return!0};function gw(n){return n.type==="mouseup"||n.type==="click"||n.type==="contextmenu"}var Rt=Math.PI,Dt=2*Rt,DP=Dt+Rt,bh=Number.POSITIVE_INFINITY,MP=Rt/180,Yt=Rt/2,vs=Rt/4,iw=Rt*2/3,Ci=Math.log10,Fn=Math.sign;function Uo(n,t,e){return Math.abs(n-t)<e}function Sm(n){let t=Math.round(n);n=Uo(n,t,n/1e3)?t:n;let e=Math.pow(10,Math.floor(Ci(n))),i=n/e;return(i<=1?1:i<=2?2:i<=5?5:10)*e}function mw(n){let t=[],e=Math.sqrt(n),i;for(i=1;i<e;i++)n%i===0&&(t.push(i),t.push(n/i));return e===(e|0)&&t.push(e),t.sort((r,s)=>r-s).pop(),t}function ws(n){return!isNaN(parseFloat(n))&&isFinite(n)}function _w(n,t){let e=Math.round(n);return e-t<=n&&e+t>=n}function Am(n,t,e){let i,r,s;for(i=0,r=n.length;i<r;i++)s=n[i][e],isNaN(s)||(t.min=Math.min(t.min,s),t.max=Math.max(t.max,s))}function wn(n){return n*(Rt/180)}function Eh(n){return n*(180/Rt)}function Cm(n){if(!qt(n))return;let t=1,e=0;for(;Math.round(n*t)/t!==n;)t*=10,e++;return e}function Pm(n,t){let e=t.x-n.x,i=t.y-n.y,r=Math.sqrt(e*e+i*i),s=Math.atan2(i,e);return s<-.5*Rt&&(s+=Dt),{angle:s,distance:r}}function xh(n,t){return Math.sqrt(Math.pow(t.x-n.x,2)+Math.pow(t.y-n.y,2))}function OP(n,t){return(n-t+DP)%Dt-Rt}function Qe(n){return(n%Dt+Dt)%Dt}function qo(n,t,e,i){let r=Qe(n),s=Qe(t),o=Qe(e),a=Qe(s-r),c=Qe(o-r),l=Qe(r-s),h=Qe(r-o);return r===s||r===o||i&&s===o||a>c&&l<h}function fe(n,t,e){return Math.max(t,Math.min(e,n))}function yw(n){return fe(n,-32768,32767)}function ni(n,t,e,i=1e-6){return n>=Math.min(t,e)-i&&n<=Math.max(t,e)+i}function Ih(n,t,e){e=e||(o=>n[o]<t);let i=n.length-1,r=0,s;for(;i-r>1;)s=r+i>>1,e(s)?r=s:i=s;return{lo:r,hi:i}}var Zn=(n,t,e,i)=>Ih(n,e,i?r=>{let s=n[r][t];return s<e||s===e&&n[r+1][t]===e}:r=>n[r][t]<e),vw=(n,t,e)=>Ih(n,e,i=>n[i][t]>=e);function bw(n,t,e){let i=0,r=n.length;for(;i<r&&n[i]<t;)i++;for(;r>i&&n[r-1]>e;)r--;return i>0||r<n.length?n.slice(i,r):n}var xw=["push","pop","shift","splice","unshift"];function ww(n,t){if(n._chartjs){n._chartjs.listeners.push(t);return}Object.defineProperty(n,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[t]}}),xw.forEach(e=>{let i="_onData"+Th(e),r=n[e];Object.defineProperty(n,e,{configurable:!0,enumerable:!1,value(...s){let o=r.apply(this,s);return n._chartjs.listeners.forEach(a=>{typeof a[i]=="function"&&a[i](...s)}),o}})})}function km(n,t){let e=n._chartjs;if(!e)return;let i=e.listeners,r=i.indexOf(t);r!==-1&&i.splice(r,1),!(i.length>0)&&(xw.forEach(s=>{delete n[s]}),delete n._chartjs)}function Rm(n){let t=new Set(n);return t.size===n.length?n:Array.from(t)}var Dm=function(){return typeof window>"u"?function(n){return n()}:window.requestAnimationFrame}();function Mm(n,t){let e=[],i=!1;return function(...r){e=r,i||(i=!0,Dm.call(window,()=>{i=!1,n.apply(t,e)}))}}function Tw(n,t){let e;return function(...i){return t?(clearTimeout(e),e=setTimeout(n,t,i)):n.apply(this,i),t}}var Sh=n=>n==="start"?"left":n==="end"?"right":"center",Ce=(n,t,e)=>n==="start"?t:n==="end"?e:(t+e)/2,Ew=(n,t,e,i)=>n===(i?"left":"right")?e:n==="center"?(t+e)/2:t;function Om(n,t,e){let i=t.length,r=0,s=i;if(n._sorted){let{iScale:o,_parsed:a}=n,c=o.axis,{min:l,max:h,minDefined:d,maxDefined:p}=o.getUserBounds();d&&(r=fe(Math.min(Zn(a,c,l).lo,e?i:Zn(t,c,o.getPixelForValue(l)).lo),0,i-1)),p?s=fe(Math.max(Zn(a,o.axis,h,!0).hi+1,e?0:Zn(t,c,o.getPixelForValue(h),!0).hi+1),r,i)-r:s=i-r}return{start:r,count:s}}function Vm(n){let{xScale:t,yScale:e,_scaleRanges:i}=n,r={xmin:t.min,xmax:t.max,ymin:e.min,ymax:e.max};if(!i)return n._scaleRanges=r,!0;let s=i.xmin!==t.min||i.xmax!==t.max||i.ymin!==e.min||i.ymax!==e.max;return Object.assign(i,r),s}var mh=n=>n===0||n===1,rw=(n,t,e)=>-(Math.pow(2,10*(n-=1))*Math.sin((n-t)*Dt/e)),sw=(n,t,e)=>Math.pow(2,-10*n)*Math.sin((n-t)*Dt/e)+1,Fo={linear:n=>n,easeInQuad:n=>n*n,easeOutQuad:n=>-n*(n-2),easeInOutQuad:n=>(n/=.5)<1?.5*n*n:-.5*(--n*(n-2)-1),easeInCubic:n=>n*n*n,easeOutCubic:n=>(n-=1)*n*n+1,easeInOutCubic:n=>(n/=.5)<1?.5*n*n*n:.5*((n-=2)*n*n+2),easeInQuart:n=>n*n*n*n,easeOutQuart:n=>-((n-=1)*n*n*n-1),easeInOutQuart:n=>(n/=.5)<1?.5*n*n*n*n:-.5*((n-=2)*n*n*n-2),easeInQuint:n=>n*n*n*n*n,easeOutQuint:n=>(n-=1)*n*n*n*n+1,easeInOutQuint:n=>(n/=.5)<1?.5*n*n*n*n*n:.5*((n-=2)*n*n*n*n+2),easeInSine:n=>-Math.cos(n*Yt)+1,easeOutSine:n=>Math.sin(n*Yt),easeInOutSine:n=>-.5*(Math.cos(Rt*n)-1),easeInExpo:n=>n===0?0:Math.pow(2,10*(n-1)),easeOutExpo:n=>n===1?1:-Math.pow(2,-10*n)+1,easeInOutExpo:n=>mh(n)?n:n<.5?.5*Math.pow(2,10*(n*2-1)):.5*(-Math.pow(2,-10*(n*2-1))+2),easeInCirc:n=>n>=1?n:-(Math.sqrt(1-n*n)-1),easeOutCirc:n=>Math.sqrt(1-(n-=1)*n),easeInOutCirc:n=>(n/=.5)<1?-.5*(Math.sqrt(1-n*n)-1):.5*(Math.sqrt(1-(n-=2)*n)+1),easeInElastic:n=>mh(n)?n:rw(n,.075,.3),easeOutElastic:n=>mh(n)?n:sw(n,.075,.3),easeInOutElastic(n){return mh(n)?n:n<.5?.5*rw(n*2,.1125,.45):.5+.5*sw(n*2-1,.1125,.45)},easeInBack(n){return n*n*((1.70158+1)*n-1.70158)},easeOutBack(n){return(n-=1)*n*((1.70158+1)*n+1.70158)+1},easeInOutBack(n){let t=1.70158;return(n/=.5)<1?.5*(n*n*(((t*=1.525)+1)*n-t)):.5*((n-=2)*n*(((t*=1.525)+1)*n+t)+2)},easeInBounce:n=>1-Fo.easeOutBounce(1-n),easeOutBounce(n){return n<1/2.75?7.5625*n*n:n<2/2.75?7.5625*(n-=1.5/2.75)*n+.75:n<2.5/2.75?7.5625*(n-=2.25/2.75)*n+.9375:7.5625*(n-=2.625/2.75)*n+.984375},easeInOutBounce:n=>n<.5?Fo.easeInBounce(n*2)*.5:Fo.easeOutBounce(n*2-1)*.5+.5};function Nm(n){if(n&&typeof n=="object"){let t=n.toString();return t==="[object CanvasPattern]"||t==="[object CanvasGradient]"}return!1}function Fm(n){return Nm(n)?n:new Ic(n)}function xm(n){return Nm(n)?n:new Ic(n).saturate(.5).darken(.1).hexString()}var VP=["x","y","borderWidth","radius","tension"],NP=["color","borderColor","backgroundColor"];function FP(n){n.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),n.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:t=>t!=="onProgress"&&t!=="onComplete"&&t!=="fn"}),n.set("animations",{colors:{type:"color",properties:NP},numbers:{type:"number",properties:VP}}),n.describe("animations",{_fallback:"animation"}),n.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:t=>t|0}}}})}function LP(n){n.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}var ow=new Map;function BP(n,t){t=t||{};let e=n+JSON.stringify(t),i=ow.get(e);return i||(i=new Intl.NumberFormat(n,t),ow.set(e,i)),i}function Wo(n,t,e){return BP(t,e).format(n)}var Iw={values(n){return kt(n)?n:""+n},numeric(n,t,e){if(n===0)return"0";let i=this.chart.options.locale,r,s=n;if(e.length>1){let l=Math.max(Math.abs(e[0].value),Math.abs(e[e.length-1].value));(l<1e-4||l>1e15)&&(r="scientific"),s=zP(n,e)}let o=Ci(Math.abs(s)),a=isNaN(o)?1:Math.max(Math.min(-1*Math.floor(o),20),0),c={notation:r,minimumFractionDigits:a,maximumFractionDigits:a};return Object.assign(c,this.options.ticks.format),Wo(n,i,c)},logarithmic(n,t,e){if(n===0)return"0";let i=e[t].significand||n/Math.pow(10,Math.floor(Ci(n)));return[1,2,3,5,10,15].includes(i)||t>.8*e.length?Iw.numeric.call(this,n,t,e):""}};function zP(n,t){let e=t.length>3?t[2].value-t[1].value:t[1].value-t[0].value;return Math.abs(e)>=1&&n!==Math.floor(n)&&(e=n-Math.floor(n)),e}var kc={formatters:Iw};function jP(n){n.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(t,e)=>e.lineWidth,tickColor:(t,e)=>e.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:kc.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),n.route("scale.ticks","color","","color"),n.route("scale.grid","color","","borderColor"),n.route("scale.border","color","","borderColor"),n.route("scale.title","color","","color"),n.describe("scale",{_fallback:!1,_scriptable:t=>!t.startsWith("before")&&!t.startsWith("after")&&t!=="callback"&&t!=="parser",_indexable:t=>t!=="borderDash"&&t!=="tickBorderDash"&&t!=="dash"}),n.describe("scales",{_fallback:"scale"}),n.describe("scale.ticks",{_scriptable:t=>t!=="backdropPadding"&&t!=="callback",_indexable:t=>t!=="backdropPadding"})}var gr=Object.create(null),Ah=Object.create(null);function Ac(n,t){if(!t)return n;let e=t.split(".");for(let i=0,r=e.length;i<r;++i){let s=e[i];n=n[s]||(n[s]=Object.create(null))}return n}function wm(n,t,e){return typeof t=="string"?Lo(Ac(n,t),e):Lo(Ac(n,""),t)}var Tm=class{constructor(t,e){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=i=>i.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(i,r)=>xm(r.backgroundColor),this.hoverBorderColor=(i,r)=>xm(r.borderColor),this.hoverColor=(i,r)=>xm(r.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(t),this.apply(e)}set(t,e){return wm(this,t,e)}get(t){return Ac(this,t)}describe(t,e){return wm(Ah,t,e)}override(t,e){return wm(gr,t,e)}route(t,e,i,r){let s=Ac(this,t),o=Ac(this,i),a="_"+e;Object.defineProperties(s,{[a]:{value:s[e],writable:!0},[e]:{enumerable:!0,get(){let c=this[a],l=o[r];return dt(c)?Object.assign({},l,c):ct(c,l)},set(c){this[a]=c}}})}apply(t){t.forEach(e=>e(this))}},Nt=new Tm({_scriptable:n=>!n.startsWith("on"),_indexable:n=>n!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[FP,LP,jP]);function UP(n){return!n||yt(n.size)||yt(n.family)?null:(n.style?n.style+" ":"")+(n.weight?n.weight+" ":"")+n.size+"px "+n.family}function Cc(n,t,e,i,r){let s=t[r];return s||(s=t[r]=n.measureText(r).width,e.push(r)),s>i&&(i=s),i}function Sw(n,t,e,i){i=i||{};let r=i.data=i.data||{},s=i.garbageCollect=i.garbageCollect||[];i.font!==t&&(r=i.data={},s=i.garbageCollect=[],i.font=t),n.save(),n.font=t;let o=0,a=e.length,c,l,h,d,p;for(c=0;c<a;c++)if(d=e[c],d!=null&&!kt(d))o=Cc(n,r,s,o,d);else if(kt(d))for(l=0,h=d.length;l<h;l++)p=d[l],p!=null&&!kt(p)&&(o=Cc(n,r,s,o,p));n.restore();let g=s.length/2;if(g>e.length){for(c=0;c<g;c++)delete r[s[c]];s.splice(0,g)}return o}function mr(n,t,e){let i=n.currentDevicePixelRatio,r=e!==0?Math.max(e/2,.5):0;return Math.round((t-r)*i)/i+r}function Lm(n,t){!t&&!n||(t=t||n.getContext("2d"),t.save(),t.resetTransform(),t.clearRect(0,0,n.width,n.height),t.restore())}function Ch(n,t,e,i){Bm(n,t,e,i,null)}function Bm(n,t,e,i,r){let s,o,a,c,l,h,d,p,g=t.pointStyle,y=t.rotation,v=t.radius,w=(y||0)*MP;if(g&&typeof g=="object"&&(s=g.toString(),s==="[object HTMLImageElement]"||s==="[object HTMLCanvasElement]")){n.save(),n.translate(e,i),n.rotate(w),n.drawImage(g,-g.width/2,-g.height/2,g.width,g.height),n.restore();return}if(!(isNaN(v)||v<=0)){switch(n.beginPath(),g){default:r?n.ellipse(e,i,r/2,v,0,0,Dt):n.arc(e,i,v,0,Dt),n.closePath();break;case"triangle":h=r?r/2:v,n.moveTo(e+Math.sin(w)*h,i-Math.cos(w)*v),w+=iw,n.lineTo(e+Math.sin(w)*h,i-Math.cos(w)*v),w+=iw,n.lineTo(e+Math.sin(w)*h,i-Math.cos(w)*v),n.closePath();break;case"rectRounded":l=v*.516,c=v-l,o=Math.cos(w+vs)*c,d=Math.cos(w+vs)*(r?r/2-l:c),a=Math.sin(w+vs)*c,p=Math.sin(w+vs)*(r?r/2-l:c),n.arc(e-d,i-a,l,w-Rt,w-Yt),n.arc(e+p,i-o,l,w-Yt,w),n.arc(e+d,i+a,l,w,w+Yt),n.arc(e-p,i+o,l,w+Yt,w+Rt),n.closePath();break;case"rect":if(!y){c=Math.SQRT1_2*v,h=r?r/2:c,n.rect(e-h,i-c,2*h,2*c);break}w+=vs;case"rectRot":d=Math.cos(w)*(r?r/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,p=Math.sin(w)*(r?r/2:v),n.moveTo(e-d,i-a),n.lineTo(e+p,i-o),n.lineTo(e+d,i+a),n.lineTo(e-p,i+o),n.closePath();break;case"crossRot":w+=vs;case"cross":d=Math.cos(w)*(r?r/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,p=Math.sin(w)*(r?r/2:v),n.moveTo(e-d,i-a),n.lineTo(e+d,i+a),n.moveTo(e+p,i-o),n.lineTo(e-p,i+o);break;case"star":d=Math.cos(w)*(r?r/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,p=Math.sin(w)*(r?r/2:v),n.moveTo(e-d,i-a),n.lineTo(e+d,i+a),n.moveTo(e+p,i-o),n.lineTo(e-p,i+o),w+=vs,d=Math.cos(w)*(r?r/2:v),o=Math.cos(w)*v,a=Math.sin(w)*v,p=Math.sin(w)*(r?r/2:v),n.moveTo(e-d,i-a),n.lineTo(e+d,i+a),n.moveTo(e+p,i-o),n.lineTo(e-p,i+o);break;case"line":o=r?r/2:Math.cos(w)*v,a=Math.sin(w)*v,n.moveTo(e-o,i-a),n.lineTo(e+o,i+a);break;case"dash":n.moveTo(e,i),n.lineTo(e+Math.cos(w)*(r?r/2:v),i+Math.sin(w)*v);break;case!1:n.closePath();break}n.fill(),t.borderWidth>0&&n.stroke()}}function ti(n,t,e){return e=e||.5,!t||n&&n.x>t.left-e&&n.x<t.right+e&&n.y>t.top-e&&n.y<t.bottom+e}function Rc(n,t){n.save(),n.beginPath(),n.rect(t.left,t.top,t.right-t.left,t.bottom-t.top),n.clip()}function Dc(n){n.restore()}function Aw(n,t,e,i,r){if(!t)return n.lineTo(e.x,e.y);if(r==="middle"){let s=(t.x+e.x)/2;n.lineTo(s,t.y),n.lineTo(s,e.y)}else r==="after"!=!!i?n.lineTo(t.x,e.y):n.lineTo(e.x,t.y);n.lineTo(e.x,e.y)}function Cw(n,t,e,i){if(!t)return n.lineTo(e.x,e.y);n.bezierCurveTo(i?t.cp1x:t.cp2x,i?t.cp1y:t.cp2y,i?e.cp2x:e.cp1x,i?e.cp2y:e.cp1y,e.x,e.y)}function qP(n,t){t.translation&&n.translate(t.translation[0],t.translation[1]),yt(t.rotation)||n.rotate(t.rotation),t.color&&(n.fillStyle=t.color),t.textAlign&&(n.textAlign=t.textAlign),t.textBaseline&&(n.textBaseline=t.textBaseline)}function WP(n,t,e,i,r){if(r.strikethrough||r.underline){let s=n.measureText(i),o=t-s.actualBoundingBoxLeft,a=t+s.actualBoundingBoxRight,c=e-s.actualBoundingBoxAscent,l=e+s.actualBoundingBoxDescent,h=r.strikethrough?(c+l)/2:l;n.strokeStyle=n.fillStyle,n.beginPath(),n.lineWidth=r.decorationWidth||2,n.moveTo(o,h),n.lineTo(a,h),n.stroke()}}function HP(n,t){let e=n.fillStyle;n.fillStyle=t.color,n.fillRect(t.left,t.top,t.width,t.height),n.fillStyle=e}function _r(n,t,e,i,r,s={}){let o=kt(t)?t:[t],a=s.strokeWidth>0&&s.strokeColor!=="",c,l;for(n.save(),n.font=r.string,qP(n,s),c=0;c<o.length;++c)l=o[c],s.backdrop&&HP(n,s.backdrop),a&&(s.strokeColor&&(n.strokeStyle=s.strokeColor),yt(s.strokeWidth)||(n.lineWidth=s.strokeWidth),n.strokeText(l,e,i,s.maxWidth)),n.fillText(l,e,i,s.maxWidth),WP(n,e,i,l,s),i+=Number(r.lineHeight);n.restore()}function Ho(n,t){let{x:e,y:i,w:r,h:s,radius:o}=t;n.arc(e+o.topLeft,i+o.topLeft,o.topLeft,1.5*Rt,Rt,!0),n.lineTo(e,i+s-o.bottomLeft),n.arc(e+o.bottomLeft,i+s-o.bottomLeft,o.bottomLeft,Rt,Yt,!0),n.lineTo(e+r-o.bottomRight,i+s),n.arc(e+r-o.bottomRight,i+s-o.bottomRight,o.bottomRight,Yt,0,!0),n.lineTo(e+r,i+o.topRight),n.arc(e+r-o.topRight,i+o.topRight,o.topRight,0,-Yt,!0),n.lineTo(e+o.topLeft,i)}var GP=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,$P=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function KP(n,t){let e=(""+n).match(GP);if(!e||e[1]==="normal")return t*1.2;switch(n=+e[2],e[3]){case"px":return n;case"%":n/=100;break}return t*n}var YP=n=>+n||0;function Ph(n,t){let e={},i=dt(t),r=i?Object.keys(t):t,s=dt(n)?i?o=>ct(n[o],n[t[o]]):o=>n[o]:()=>n;for(let o of r)e[o]=YP(s(o));return e}function zm(n){return Ph(n,{top:"y",right:"x",bottom:"y",left:"x"})}function yr(n){return Ph(n,["topLeft","topRight","bottomLeft","bottomRight"])}function Pe(n){let t=zm(n);return t.width=t.left+t.right,t.height=t.top+t.bottom,t}function ae(n,t){n=n||{},t=t||Nt.font;let e=ct(n.size,t.size);typeof e=="string"&&(e=parseInt(e,10));let i=ct(n.style,t.style);i&&!(""+i).match($P)&&(console.warn('Invalid font style specified: "'+i+'"'),i=void 0);let r={family:ct(n.family,t.family),lineHeight:KP(ct(n.lineHeight,t.lineHeight),e),size:e,style:i,weight:ct(n.weight,t.weight),string:""};return r.string=UP(r),r}function Go(n,t,e,i){let r=!0,s,o,a;for(s=0,o=n.length;s<o;++s)if(a=n[s],a!==void 0&&(t!==void 0&&typeof a=="function"&&(a=a(t),r=!1),e!==void 0&&kt(a)&&(a=a[e%a.length],r=!1),a!==void 0))return i&&!r&&(i.cacheable=!1),a}function Pw(n,t,e){let{min:i,max:r}=n,s=Em(t,(r-i)/2),o=(a,c)=>e&&a===0?0:a+c;return{min:o(i,-Math.abs(s)),max:o(r,s)}}function ki(n,t){return Object.assign(Object.create(n),t)}function kh(n,t=[""],e,i,r=()=>n[0]){let s=e||n;typeof i>"u"&&(i=Dw("_fallback",n));let o={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:n,_rootScopes:s,_fallback:i,_getTarget:r,override:a=>kh([a,...n],t,s,i)};return new Proxy(o,{deleteProperty(a,c){return delete a[c],delete a._keys,delete n[0][c],!0},get(a,c){return kw(a,c,()=>i1(c,t,n,a))},getOwnPropertyDescriptor(a,c){return Reflect.getOwnPropertyDescriptor(a._scopes[0],c)},getPrototypeOf(){return Reflect.getPrototypeOf(n[0])},has(a,c){return cw(a).includes(c)},ownKeys(a){return cw(a)},set(a,c,l){let h=a._storage||(a._storage=r());return a[c]=h[c]=l,delete a._keys,!0}})}function xs(n,t,e,i){let r={_cacheable:!1,_proxy:n,_context:t,_subProxy:e,_stack:new Set,_descriptors:jm(n,i),setContext:s=>xs(n,s,e,i),override:s=>xs(n.override(s),t,e,i)};return new Proxy(r,{deleteProperty(s,o){return delete s[o],delete n[o],!0},get(s,o,a){return kw(s,o,()=>XP(s,o,a))},getOwnPropertyDescriptor(s,o){return s._descriptors.allKeys?Reflect.has(n,o)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(n,o)},getPrototypeOf(){return Reflect.getPrototypeOf(n)},has(s,o){return Reflect.has(n,o)},ownKeys(){return Reflect.ownKeys(n)},set(s,o,a){return n[o]=a,delete s[o],!0}})}function jm(n,t={scriptable:!0,indexable:!0}){let{_scriptable:e=t.scriptable,_indexable:i=t.indexable,_allKeys:r=t.allKeys}=n;return{allKeys:r,scriptable:e,indexable:i,isScriptable:Ai(e)?e:()=>e,isIndexable:Ai(i)?i:()=>i}}var QP=(n,t)=>n?n+Th(t):t,Um=(n,t)=>dt(t)&&n!=="adapters"&&(Object.getPrototypeOf(t)===null||t.constructor===Object);function kw(n,t,e){if(Object.prototype.hasOwnProperty.call(n,t)||t==="constructor")return n[t];let i=e();return n[t]=i,i}function XP(n,t,e){let{_proxy:i,_context:r,_subProxy:s,_descriptors:o}=n,a=i[t];return Ai(a)&&o.isScriptable(t)&&(a=JP(t,a,n,e)),kt(a)&&a.length&&(a=ZP(t,a,n,o.isIndexable)),Um(t,a)&&(a=xs(a,r,s&&s[t],o)),a}function JP(n,t,e,i){let{_proxy:r,_context:s,_subProxy:o,_stack:a}=e;if(a.has(n))throw new Error("Recursion detected: "+Array.from(a).join("->")+"->"+n);a.add(n);let c=t(s,o||i);return a.delete(n),Um(n,c)&&(c=qm(r._scopes,r,n,c)),c}function ZP(n,t,e,i){let{_proxy:r,_context:s,_subProxy:o,_descriptors:a}=e;if(typeof s.index<"u"&&i(n))return t[s.index%t.length];if(dt(t[0])){let c=t,l=r._scopes.filter(h=>h!==c);t=[];for(let h of c){let d=qm(l,r,n,h);t.push(xs(d,s,o&&o[n],a))}}return t}function Rw(n,t,e){return Ai(n)?n(t,e):n}var t1=(n,t)=>n===!0?t:typeof n=="string"?Pi(t,n):void 0;function e1(n,t,e,i,r){for(let s of t){let o=t1(e,s);if(o){n.add(o);let a=Rw(o._fallback,e,r);if(typeof a<"u"&&a!==e&&a!==i)return a}else if(o===!1&&typeof i<"u"&&e!==i)return null}return!1}function qm(n,t,e,i){let r=t._rootScopes,s=Rw(t._fallback,e,i),o=[...n,...r],a=new Set;a.add(i);let c=aw(a,o,e,s||e,i);return c===null||typeof s<"u"&&s!==e&&(c=aw(a,o,s,c,i),c===null)?!1:kh(Array.from(a),[""],r,s,()=>n1(t,e,i))}function aw(n,t,e,i,r){for(;e;)e=e1(n,t,e,i,r);return e}function n1(n,t,e){let i=n._getTarget();t in i||(i[t]={});let r=i[t];return kt(r)&&dt(e)?e:r||{}}function i1(n,t,e,i){let r;for(let s of t)if(r=Dw(QP(s,n),e),typeof r<"u")return Um(n,r)?qm(e,i,n,r):r}function Dw(n,t){for(let e of t){if(!e)continue;let i=e[n];if(typeof i<"u")return i}}function cw(n){let t=n._keys;return t||(t=n._keys=r1(n._scopes)),t}function r1(n){let t=new Set;for(let e of n)for(let i of Object.keys(e).filter(r=>!r.startsWith("_")))t.add(i);return Array.from(t)}function Wm(n,t,e,i){let{iScale:r}=n,{key:s="r"}=this._parsing,o=new Array(i),a,c,l,h;for(a=0,c=i;a<c;++a)l=a+e,h=t[l],o[a]={r:r.parse(Pi(h,s),l)};return o}var s1=Number.EPSILON||1e-14,Bo=(n,t)=>t<n.length&&!n[t].skip&&n[t],Mw=n=>n==="x"?"y":"x";function o1(n,t,e,i){let r=n.skip?t:n,s=t,o=e.skip?t:e,a=xh(s,r),c=xh(o,s),l=a/(a+c),h=c/(a+c);l=isNaN(l)?0:l,h=isNaN(h)?0:h;let d=i*l,p=i*h;return{previous:{x:s.x-d*(o.x-r.x),y:s.y-d*(o.y-r.y)},next:{x:s.x+p*(o.x-r.x),y:s.y+p*(o.y-r.y)}}}function a1(n,t,e){let i=n.length,r,s,o,a,c,l=Bo(n,0);for(let h=0;h<i-1;++h)if(c=l,l=Bo(n,h+1),!(!c||!l)){if(Uo(t[h],0,s1)){e[h]=e[h+1]=0;continue}r=e[h]/t[h],s=e[h+1]/t[h],a=Math.pow(r,2)+Math.pow(s,2),!(a<=9)&&(o=3/Math.sqrt(a),e[h]=r*o*t[h],e[h+1]=s*o*t[h])}}function c1(n,t,e="x"){let i=Mw(e),r=n.length,s,o,a,c=Bo(n,0);for(let l=0;l<r;++l){if(o=a,a=c,c=Bo(n,l+1),!a)continue;let h=a[e],d=a[i];o&&(s=(h-o[e])/3,a[`cp1${e}`]=h-s,a[`cp1${i}`]=d-s*t[l]),c&&(s=(c[e]-h)/3,a[`cp2${e}`]=h+s,a[`cp2${i}`]=d+s*t[l])}}function l1(n,t="x"){let e=Mw(t),i=n.length,r=Array(i).fill(0),s=Array(i),o,a,c,l=Bo(n,0);for(o=0;o<i;++o)if(a=c,c=l,l=Bo(n,o+1),!!c){if(l){let h=l[t]-c[t];r[o]=h!==0?(l[e]-c[e])/h:0}s[o]=a?l?Fn(r[o-1])!==Fn(r[o])?0:(r[o-1]+r[o])/2:r[o-1]:r[o]}a1(n,r,s),c1(n,s,t)}function _h(n,t,e){return Math.max(Math.min(n,e),t)}function u1(n,t){let e,i,r,s,o,a=ti(n[0],t);for(e=0,i=n.length;e<i;++e)o=s,s=a,a=e<i-1&&ti(n[e+1],t),s&&(r=n[e],o&&(r.cp1x=_h(r.cp1x,t.left,t.right),r.cp1y=_h(r.cp1y,t.top,t.bottom)),a&&(r.cp2x=_h(r.cp2x,t.left,t.right),r.cp2y=_h(r.cp2y,t.top,t.bottom)))}function Ow(n,t,e,i,r){let s,o,a,c;if(t.spanGaps&&(n=n.filter(l=>!l.skip)),t.cubicInterpolationMode==="monotone")l1(n,r);else{let l=i?n[n.length-1]:n[0];for(s=0,o=n.length;s<o;++s)a=n[s],c=o1(l,a,n[Math.min(s+1,o-(i?0:1))%o],t.tension),a.cp1x=c.previous.x,a.cp1y=c.previous.y,a.cp2x=c.next.x,a.cp2y=c.next.y,l=a}t.capBezierPoints&&u1(n,e)}function Rh(){return typeof window<"u"&&typeof document<"u"}function Dh(n){let t=n.parentNode;return t&&t.toString()==="[object ShadowRoot]"&&(t=t.host),t}function wh(n,t,e){let i;return typeof n=="string"?(i=parseInt(n,10),n.indexOf("%")!==-1&&(i=i/100*t.parentNode[e])):i=n,i}var Mh=n=>n.ownerDocument.defaultView.getComputedStyle(n,null);function h1(n,t){return Mh(n).getPropertyValue(t)}var d1=["top","right","bottom","left"];function bs(n,t,e){let i={};e=e?"-"+e:"";for(let r=0;r<4;r++){let s=d1[r];i[s]=parseFloat(n[t+"-"+s+e])||0}return i.width=i.left+i.right,i.height=i.top+i.bottom,i}var f1=(n,t,e)=>(n>0||t>0)&&(!e||!e.shadowRoot);function p1(n,t){let e=n.touches,i=e&&e.length?e[0]:n,{offsetX:r,offsetY:s}=i,o=!1,a,c;if(f1(r,s,n.target))a=r,c=s;else{let l=t.getBoundingClientRect();a=i.clientX-l.left,c=i.clientY-l.top,o=!0}return{x:a,y:c,box:o}}function vr(n,t){if("native"in n)return n;let{canvas:e,currentDevicePixelRatio:i}=t,r=Mh(e),s=r.boxSizing==="border-box",o=bs(r,"padding"),a=bs(r,"border","width"),{x:c,y:l,box:h}=p1(n,e),d=o.left+(h&&a.left),p=o.top+(h&&a.top),{width:g,height:y}=t;return s&&(g-=o.width+a.width,y-=o.height+a.height),{x:Math.round((c-d)/g*e.width/i),y:Math.round((l-p)/y*e.height/i)}}function g1(n,t,e){let i,r;if(t===void 0||e===void 0){let s=n&&Dh(n);if(!s)t=n.clientWidth,e=n.clientHeight;else{let o=s.getBoundingClientRect(),a=Mh(s),c=bs(a,"border","width"),l=bs(a,"padding");t=o.width-l.width-c.width,e=o.height-l.height-c.height,i=wh(a.maxWidth,s,"clientWidth"),r=wh(a.maxHeight,s,"clientHeight")}}return{width:t,height:e,maxWidth:i||bh,maxHeight:r||bh}}var yh=n=>Math.round(n*10)/10;function Vw(n,t,e,i){let r=Mh(n),s=bs(r,"margin"),o=wh(r.maxWidth,n,"clientWidth")||bh,a=wh(r.maxHeight,n,"clientHeight")||bh,c=g1(n,t,e),{width:l,height:h}=c;if(r.boxSizing==="content-box"){let p=bs(r,"border","width"),g=bs(r,"padding");l-=g.width+p.width,h-=g.height+p.height}return l=Math.max(0,l-s.width),h=Math.max(0,i?l/i:h-s.height),l=yh(Math.min(l,o,c.maxWidth)),h=yh(Math.min(h,a,c.maxHeight)),l&&!h&&(h=yh(l/2)),(t!==void 0||e!==void 0)&&i&&c.height&&h>c.height&&(h=c.height,l=yh(Math.floor(h*i))),{width:l,height:h}}function Hm(n,t,e){let i=t||1,r=Math.floor(n.height*i),s=Math.floor(n.width*i);n.height=Math.floor(n.height),n.width=Math.floor(n.width);let o=n.canvas;return o.style&&(e||!o.style.height&&!o.style.width)&&(o.style.height=`${n.height}px`,o.style.width=`${n.width}px`),n.currentDevicePixelRatio!==i||o.height!==r||o.width!==s?(n.currentDevicePixelRatio=i,o.height=r,o.width=s,n.ctx.setTransform(i,0,0,i,0,0),!0):!1}var Nw=function(){let n=!1;try{let t={get passive(){return n=!0,!1}};Rh()&&(window.addEventListener("test",null,t),window.removeEventListener("test",null,t))}catch{}return n}();function Gm(n,t){let e=h1(n,t),i=e&&e.match(/^(\d+)(\.\d+)?px$/);return i?+i[1]:void 0}function pr(n,t,e,i){return{x:n.x+e*(t.x-n.x),y:n.y+e*(t.y-n.y)}}function Fw(n,t,e,i){return{x:n.x+e*(t.x-n.x),y:i==="middle"?e<.5?n.y:t.y:i==="after"?e<1?n.y:t.y:e>0?t.y:n.y}}function Lw(n,t,e,i){let r={x:n.cp2x,y:n.cp2y},s={x:t.cp1x,y:t.cp1y},o=pr(n,r,e),a=pr(r,s,e),c=pr(s,t,e),l=pr(o,a,e),h=pr(a,c,e);return pr(l,h,e)}var m1=function(n,t){return{x(e){return n+n+t-e},setWidth(e){t=e},textAlign(e){return e==="center"?e:e==="right"?"left":"right"},xPlus(e,i){return e-i},leftForLtr(e,i){return e-i}}},_1=function(){return{x(n){return n},setWidth(n){},textAlign(n){return n},xPlus(n,t){return n+t},leftForLtr(n,t){return n}}};function Ts(n,t,e){return n?m1(t,e):_1()}function $m(n,t){let e,i;(t==="ltr"||t==="rtl")&&(e=n.canvas.style,i=[e.getPropertyValue("direction"),e.getPropertyPriority("direction")],e.setProperty("direction",t,"important"),n.prevTextDirection=i)}function Km(n,t){t!==void 0&&(delete n.prevTextDirection,n.canvas.style.setProperty("direction",t[0],t[1]))}function Bw(n){return n==="angle"?{between:qo,compare:OP,normalize:Qe}:{between:ni,compare:(t,e)=>t-e,normalize:t=>t}}function lw({start:n,end:t,count:e,loop:i,style:r}){return{start:n%e,end:t%e,loop:i&&(t-n+1)%e===0,style:r}}function y1(n,t,e){let{property:i,start:r,end:s}=e,{between:o,normalize:a}=Bw(i),c=t.length,{start:l,end:h,loop:d}=n,p,g;if(d){for(l+=c,h+=c,p=0,g=c;p<g&&o(a(t[l%c][i]),r,s);++p)l--,h--;l%=c,h%=c}return h<l&&(h+=c),{start:l,end:h,loop:d,style:n.style}}function Ym(n,t,e){if(!e)return[n];let{property:i,start:r,end:s}=e,o=t.length,{compare:a,between:c,normalize:l}=Bw(i),{start:h,end:d,loop:p,style:g}=y1(n,t,e),y=[],v=!1,w=null,k,R,M,F=()=>c(r,M,k)&&a(r,M)!==0,V=()=>a(s,k)===0||c(s,M,k),L=()=>v||F(),I=()=>!v||V();for(let b=h,E=h;b<=d;++b)R=t[b%o],!R.skip&&(k=l(R[i]),k!==M&&(v=c(k,r,s),w===null&&L()&&(w=a(k,r)===0?b:E),w!==null&&I()&&(y.push(lw({start:w,end:b,loop:p,count:o,style:g})),w=null),E=b,M=k));return w!==null&&y.push(lw({start:w,end:d,loop:p,count:o,style:g})),y}function Qm(n,t){let e=[],i=n.segments;for(let r=0;r<i.length;r++){let s=Ym(i[r],n.points,t);s.length&&e.push(...s)}return e}function v1(n,t,e,i){let r=0,s=t-1;if(e&&!i)for(;r<t&&!n[r].skip;)r++;for(;r<t&&n[r].skip;)r++;for(r%=t,e&&(s+=r);s>r&&n[s%t].skip;)s--;return s%=t,{start:r,end:s}}function b1(n,t,e,i){let r=n.length,s=[],o=t,a=n[t],c;for(c=t+1;c<=e;++c){let l=n[c%r];l.skip||l.stop?a.skip||(i=!1,s.push({start:t%r,end:(c-1)%r,loop:i}),t=o=l.stop?c:null):(o=c,a.skip&&(t=c)),a=l}return o!==null&&s.push({start:t%r,end:o%r,loop:i}),s}function zw(n,t){let e=n.points,i=n.options.spanGaps,r=e.length;if(!r)return[];let s=!!n._loop,{start:o,end:a}=v1(e,r,s,i);if(i===!0)return uw(n,[{start:o,end:a,loop:s}],e,t);let c=a<o?a+r:a,l=!!n._fullLoop&&o===0&&a===r-1;return uw(n,b1(e,o,c,l),e,t)}function uw(n,t,e,i){return!i||!i.setContext||!e?t:x1(n,t,e,i)}function x1(n,t,e,i){let r=n._chart.getContext(),s=hw(n.options),{_datasetIndex:o,options:{spanGaps:a}}=n,c=e.length,l=[],h=s,d=t[0].start,p=d;function g(y,v,w,k){let R=a?-1:1;if(y!==v){for(y+=c;e[y%c].skip;)y-=R;for(;e[v%c].skip;)v+=R;y%c!==v%c&&(l.push({start:y%c,end:v%c,loop:w,style:k}),h=k,d=v%c)}}for(let y of t){d=a?d:y.start;let v=e[d%c],w;for(p=d+1;p<=y.end;p++){let k=e[p%c];w=hw(i.setContext(ki(r,{type:"segment",p0:v,p1:k,p0DataIndex:(p-1)%c,p1DataIndex:p%c,datasetIndex:o}))),w1(w,h)&&g(d,p-1,y.loop,h),v=k,h=w}d<p-1&&g(d,p-1,y.loop,h)}return l}function hw(n){return{backgroundColor:n.backgroundColor,borderCapStyle:n.borderCapStyle,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderJoinStyle:n.borderJoinStyle,borderWidth:n.borderWidth,borderColor:n.borderColor}}function w1(n,t){if(!t)return!1;let e=[],i=function(r,s){return Nm(s)?(e.includes(s)||e.push(s),e.indexOf(s)):s};return JSON.stringify(n,i)!==JSON.stringify(t,i)}var o_=class{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(t,e,i,r){let s=e.listeners[r],o=e.duration;s.forEach(a=>a({chart:t,initial:e.initial,numSteps:o,currentStep:Math.min(i-e.start,o)}))}_refresh(){this._request||(this._running=!0,this._request=Dm.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(t=Date.now()){let e=0;this._charts.forEach((i,r)=>{if(!i.running||!i.items.length)return;let s=i.items,o=s.length-1,a=!1,c;for(;o>=0;--o)c=s[o],c._active?(c._total>i.duration&&(i.duration=c._total),c.tick(t),a=!0):(s[o]=s[s.length-1],s.pop());a&&(r.draw(),this._notify(r,i,t,"progress")),s.length||(i.running=!1,this._notify(r,i,t,"complete"),i.initial=!1),e+=s.length}),this._lastDate=t,e===0&&(this._running=!1)}_getAnims(t){let e=this._charts,i=e.get(t);return i||(i={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},e.set(t,i)),i}listen(t,e,i){this._getAnims(t).listeners[e].push(i)}add(t,e){!e||!e.length||this._getAnims(t).items.push(...e)}has(t){return this._getAnims(t).items.length>0}start(t){let e=this._charts.get(t);e&&(e.running=!0,e.start=Date.now(),e.duration=e.items.reduce((i,r)=>Math.max(i,r._duration),0),this._refresh())}running(t){if(!this._running)return!1;let e=this._charts.get(t);return!(!e||!e.running||!e.items.length)}stop(t){let e=this._charts.get(t);if(!e||!e.items.length)return;let i=e.items,r=i.length-1;for(;r>=0;--r)i[r].cancel();e.items=[],this._notify(t,e,Date.now(),"complete")}remove(t){return this._charts.delete(t)}},Ri=new o_,jw="transparent",T1={boolean(n,t,e){return e>.5?t:n},color(n,t,e){let i=Fm(n||jw),r=i.valid&&Fm(t||jw);return r&&r.valid?r.mix(i,e).hexString():t},number(n,t,e){return n+(t-n)*e}},a_=class{constructor(t,e,i,r){let s=e[i];r=Go([t.to,r,s,t.from]);let o=Go([t.from,s,r]);this._active=!0,this._fn=t.fn||T1[t.type||typeof o],this._easing=Fo[t.easing]||Fo.linear,this._start=Math.floor(Date.now()+(t.delay||0)),this._duration=this._total=Math.floor(t.duration),this._loop=!!t.loop,this._target=e,this._prop=i,this._from=o,this._to=r,this._promises=void 0}active(){return this._active}update(t,e,i){if(this._active){this._notify(!1);let r=this._target[this._prop],s=i-this._start,o=this._duration-s;this._start=i,this._duration=Math.floor(Math.max(o,t.duration)),this._total+=s,this._loop=!!t.loop,this._to=Go([t.to,e,r,t.from]),this._from=Go([t.from,r,e])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(t){let e=t-this._start,i=this._duration,r=this._prop,s=this._from,o=this._loop,a=this._to,c;if(this._active=s!==a&&(o||e<i),!this._active){this._target[r]=a,this._notify(!0);return}if(e<0){this._target[r]=s;return}c=e/i%2,c=o&&c>1?2-c:c,c=this._easing(Math.min(1,Math.max(0,c))),this._target[r]=this._fn(s,a,c)}wait(){let t=this._promises||(this._promises=[]);return new Promise((e,i)=>{t.push({res:e,rej:i})})}_notify(t){let e=t?"res":"rej",i=this._promises||[];for(let r=0;r<i.length;r++)i[r][e]()}},qh=class{constructor(t,e){this._chart=t,this._properties=new Map,this.configure(e)}configure(t){if(!dt(t))return;let e=Object.keys(Nt.animation),i=this._properties;Object.getOwnPropertyNames(t).forEach(r=>{let s=t[r];if(!dt(s))return;let o={};for(let a of e)o[a]=s[a];(kt(s.properties)&&s.properties||[r]).forEach(a=>{(a===r||!i.has(a))&&i.set(a,o)})})}_animateOptions(t,e){let i=e.options,r=I1(t,i);if(!r)return[];let s=this._createAnimations(r,i);return i.$shared&&E1(t.options.$animations,i).then(()=>{t.options=i},()=>{}),s}_createAnimations(t,e){let i=this._properties,r=[],s=t.$animations||(t.$animations={}),o=Object.keys(e),a=Date.now(),c;for(c=o.length-1;c>=0;--c){let l=o[c];if(l.charAt(0)==="$")continue;if(l==="options"){r.push(...this._animateOptions(t,e));continue}let h=e[l],d=s[l],p=i.get(l);if(d)if(p&&d.active()){d.update(p,h,a);continue}else d.cancel();if(!p||!p.duration){t[l]=h;continue}s[l]=d=new a_(p,t,l,h),r.push(d)}return r}update(t,e){if(this._properties.size===0){Object.assign(t,e);return}let i=this._createAnimations(t,e);if(i.length)return Ri.add(this._chart,i),!0}};function E1(n,t){let e=[],i=Object.keys(t);for(let r=0;r<i.length;r++){let s=n[i[r]];s&&s.active()&&e.push(s.wait())}return Promise.all(e)}function I1(n,t){if(!t)return;let e=n.options;if(!e){n.options=t;return}return e.$shared&&(n.options=e=Object.assign({},e,{$shared:!1,$animations:{}})),e}function Uw(n,t){let e=n&&n.options||{},i=e.reverse,r=e.min===void 0?t:0,s=e.max===void 0?t:0;return{start:i?s:r,end:i?r:s}}function S1(n,t,e){if(e===!1)return!1;let i=Uw(n,e),r=Uw(t,e);return{top:r.end,right:i.end,bottom:r.start,left:i.start}}function A1(n){let t,e,i,r;return dt(n)?(t=n.top,e=n.right,i=n.bottom,r=n.left):t=e=i=r=n,{top:t,right:e,bottom:i,left:r,disabled:n===!1}}function UT(n,t){let e=[],i=n._getSortedDatasetMetas(t),r,s;for(r=0,s=i.length;r<s;++r)e.push(i[r].index);return e}function qw(n,t,e,i={}){let r=n.keys,s=i.mode==="single",o,a,c,l;if(t!==null){for(o=0,a=r.length;o<a;++o){if(c=+r[o],c===e){if(i.all)continue;break}l=n.values[c],qt(l)&&(s||t===0||Fn(t)===Fn(l))&&(t+=l)}return t}}function C1(n,t){let{iScale:e,vScale:i}=t,r=e.axis==="x"?"x":"y",s=i.axis==="x"?"x":"y",o=Object.keys(n),a=new Array(o.length),c,l,h;for(c=0,l=o.length;c<l;++c)h=o[c],a[c]={[r]:h,[s]:n[h]};return a}function Ww(n,t){let e=n&&n.options.stacked;return e||e===void 0&&t.stack!==void 0}function P1(n,t,e){return`${n.id}.${t.id}.${e.stack||e.type}`}function k1(n){let{min:t,max:e,minDefined:i,maxDefined:r}=n.getUserBounds();return{min:i?t:Number.NEGATIVE_INFINITY,max:r?e:Number.POSITIVE_INFINITY}}function R1(n,t,e){let i=n[t]||(n[t]={});return i[e]||(i[e]={})}function Hw(n,t,e,i){for(let r of t.getMatchingVisibleMetas(i).reverse()){let s=n[r.index];if(e&&s>0||!e&&s<0)return r.index}return null}function Gw(n,t){let{chart:e,_cachedMeta:i}=n,r=e._stacks||(e._stacks={}),{iScale:s,vScale:o,index:a}=i,c=s.axis,l=o.axis,h=P1(s,o,i),d=t.length,p;for(let g=0;g<d;++g){let y=t[g],{[c]:v,[l]:w}=y,k=y._stacks||(y._stacks={});p=k[l]=R1(r,h,v),p[a]=w,p._top=Hw(p,o,!0,i.type),p._bottom=Hw(p,o,!1,i.type);let R=p._visualValues||(p._visualValues={});R[a]=w}}function Xm(n,t){let e=n.scales;return Object.keys(e).filter(i=>e[i].axis===t).shift()}function D1(n,t){return ki(n,{active:!1,dataset:void 0,datasetIndex:t,index:t,mode:"default",type:"dataset"})}function M1(n,t,e){return ki(n,{active:!1,dataIndex:t,parsed:void 0,raw:void 0,element:e,index:t,mode:"default",type:"data"})}function Mc(n,t){let e=n.controller.index,i=n.vScale&&n.vScale.axis;if(i){t=t||n._parsed;for(let r of t){let s=r._stacks;if(!s||s[i]===void 0||s[i][e]===void 0)return;delete s[i][e],s[i]._visualValues!==void 0&&s[i]._visualValues[e]!==void 0&&delete s[i]._visualValues[e]}}}var Jm=n=>n==="reset"||n==="none",$w=(n,t)=>t?n:Object.assign({},n),O1=(n,t,e)=>n&&!t.hidden&&t._stacked&&{keys:UT(e,!0),values:null},xr=(()=>{class n{static defaults={};static datasetElementType=null;static dataElementType=null;constructor(e,i){this.chart=e,this._ctx=e.ctx,this.index=i,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){let e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=Ww(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&Mc(this._cachedMeta),this.index=e}linkScales(){let e=this.chart,i=this._cachedMeta,r=this.getDataset(),s=(p,g,y,v)=>p==="x"?g:p==="r"?v:y,o=i.xAxisID=ct(r.xAxisID,Xm(e,"x")),a=i.yAxisID=ct(r.yAxisID,Xm(e,"y")),c=i.rAxisID=ct(r.rAxisID,Xm(e,"r")),l=i.indexAxis,h=i.iAxisID=s(l,o,a,c),d=i.vAxisID=s(l,a,o,c);i.xScale=this.getScaleForId(o),i.yScale=this.getScaleForId(a),i.rScale=this.getScaleForId(c),i.iScale=this.getScaleForId(h),i.vScale=this.getScaleForId(d)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){let i=this._cachedMeta;return e===i.iScale?i.vScale:i.iScale}reset(){this._update("reset")}_destroy(){let e=this._cachedMeta;this._data&&km(this._data,this),e._stacked&&Mc(e)}_dataCheck(){let e=this.getDataset(),i=e.data||(e.data=[]),r=this._data;if(dt(i)){let s=this._cachedMeta;this._data=C1(i,s)}else if(r!==i){if(r){km(r,this);let s=this._cachedMeta;Mc(s),s._parsed=[]}i&&Object.isExtensible(i)&&ww(i,this),this._syncList=[],this._data=i}}addElements(){let e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){let i=this._cachedMeta,r=this.getDataset(),s=!1;this._dataCheck();let o=i._stacked;i._stacked=Ww(i.vScale,i),i.stack!==r.stack&&(s=!0,Mc(i),i.stack=r.stack),this._resyncElements(e),(s||o!==i._stacked)&&Gw(this,i._parsed)}configure(){let e=this.chart.config,i=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),i,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,i){let{_cachedMeta:r,_data:s}=this,{iScale:o,_stacked:a}=r,c=o.axis,l=e===0&&i===s.length?!0:r._sorted,h=e>0&&r._parsed[e-1],d,p,g;if(this._parsing===!1)r._parsed=s,r._sorted=!0,g=s;else{kt(s[e])?g=this.parseArrayData(r,s,e,i):dt(s[e])?g=this.parseObjectData(r,s,e,i):g=this.parsePrimitiveData(r,s,e,i);let y=()=>p[c]===null||h&&p[c]<h[c];for(d=0;d<i;++d)r._parsed[d+e]=p=g[d],l&&(y()&&(l=!1),h=p);r._sorted=l}a&&Gw(this,g)}parsePrimitiveData(e,i,r,s){let{iScale:o,vScale:a}=e,c=o.axis,l=a.axis,h=o.getLabels(),d=o===a,p=new Array(s),g,y,v;for(g=0,y=s;g<y;++g)v=g+r,p[g]={[c]:d||o.parse(h[v],v),[l]:a.parse(i[v],v)};return p}parseArrayData(e,i,r,s){let{xScale:o,yScale:a}=e,c=new Array(s),l,h,d,p;for(l=0,h=s;l<h;++l)d=l+r,p=i[d],c[l]={x:o.parse(p[0],d),y:a.parse(p[1],d)};return c}parseObjectData(e,i,r,s){let{xScale:o,yScale:a}=e,{xAxisKey:c="x",yAxisKey:l="y"}=this._parsing,h=new Array(s),d,p,g,y;for(d=0,p=s;d<p;++d)g=d+r,y=i[g],h[d]={x:o.parse(Pi(y,c),g),y:a.parse(Pi(y,l),g)};return h}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,i,r){let s=this.chart,o=this._cachedMeta,a=i[e.axis],c={keys:UT(s,!0),values:i._stacks[e.axis]._visualValues};return qw(c,a,o.index,{mode:r})}updateRangeFromParsed(e,i,r,s){let o=r[i.axis],a=o===null?NaN:o,c=s&&r._stacks[i.axis];s&&c&&(s.values=c,a=qw(s,o,this._cachedMeta.index)),e.min=Math.min(e.min,a),e.max=Math.max(e.max,a)}getMinMax(e,i){let r=this._cachedMeta,s=r._parsed,o=r._sorted&&e===r.iScale,a=s.length,c=this._getOtherScale(e),l=O1(i,r,this.chart),h={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:d,max:p}=k1(c),g,y;function v(){y=s[g];let w=y[c.axis];return!qt(y[e.axis])||d>w||p<w}for(g=0;g<a&&!(!v()&&(this.updateRangeFromParsed(h,e,y,l),o));++g);if(o){for(g=a-1;g>=0;--g)if(!v()){this.updateRangeFromParsed(h,e,y,l);break}}return h}getAllParsedValues(e){let i=this._cachedMeta._parsed,r=[],s,o,a;for(s=0,o=i.length;s<o;++s)a=i[s][e.axis],qt(a)&&r.push(a);return r}getMaxOverflow(){return!1}getLabelAndValue(e){let i=this._cachedMeta,r=i.iScale,s=i.vScale,o=this.getParsed(e);return{label:r?""+r.getLabelForValue(o[r.axis]):"",value:s?""+s.getLabelForValue(o[s.axis]):""}}_update(e){let i=this._cachedMeta;this.update(e||"default"),i._clip=A1(ct(this.options.clip,S1(i.xScale,i.yScale,this.getMaxOverflow())))}update(e){}draw(){let e=this._ctx,i=this.chart,r=this._cachedMeta,s=r.data||[],o=i.chartArea,a=[],c=this._drawStart||0,l=this._drawCount||s.length-c,h=this.options.drawActiveElementsOnTop,d;for(r.dataset&&r.dataset.draw(e,o,c,l),d=c;d<c+l;++d){let p=s[d];p.hidden||(p.active&&h?a.push(p):p.draw(e,o))}for(d=0;d<a.length;++d)a[d].draw(e,o)}getStyle(e,i){let r=i?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,i,r){let s=this.getDataset(),o;if(e>=0&&e<this._cachedMeta.data.length){let a=this._cachedMeta.data[e];o=a.$context||(a.$context=M1(this.getContext(),e,a)),o.parsed=this.getParsed(e),o.raw=s.data[e],o.index=o.dataIndex=e}else o=this.$context||(this.$context=D1(this.chart.getContext(),this.index)),o.dataset=s,o.index=o.datasetIndex=this.index;return o.active=!!i,o.mode=r,o}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,i){return this._resolveElementOptions(this.dataElementType.id,i,e)}_resolveElementOptions(e,i="default",r){let s=i==="active",o=this._cachedDataOpts,a=e+"-"+i,c=o[a],l=this.enableOptionSharing&&jo(r);if(c)return $w(c,l);let h=this.chart.config,d=h.datasetElementScopeKeys(this._type,e),p=s?[`${e}Hover`,"hover",e,""]:[e,""],g=h.getOptionScopes(this.getDataset(),d),y=Object.keys(Nt.elements[e]),v=()=>this.getContext(r,s,i),w=h.resolveNamedOptions(g,y,v,p);return w.$shared&&(w.$shared=l,o[a]=Object.freeze($w(w,l))),w}_resolveAnimations(e,i,r){let s=this.chart,o=this._cachedDataOpts,a=`animation-${i}`,c=o[a];if(c)return c;let l;if(s.options.animation!==!1){let d=this.chart.config,p=d.datasetAnimationScopeKeys(this._type,i),g=d.getOptionScopes(this.getDataset(),p);l=d.createResolver(g,this.getContext(e,r,i))}let h=new qh(s,l&&l.animations);return l&&l._cacheable&&(o[a]=Object.freeze(h)),h}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,i){return!i||Jm(e)||this.chart._animationsDisabled}_getSharedOptions(e,i){let r=this.resolveDataElementOptions(e,i),s=this._sharedOptions,o=this.getSharedOptions(r),a=this.includeOptions(i,o)||o!==s;return this.updateSharedOptions(o,i,r),{sharedOptions:o,includeOptions:a}}updateElement(e,i,r,s){Jm(s)?Object.assign(e,r):this._resolveAnimations(i,s).update(e,r)}updateSharedOptions(e,i,r){e&&!Jm(i)&&this._resolveAnimations(void 0,i).update(e,r)}_setStyle(e,i,r,s){e.active=s;let o=this.getStyle(i,s);this._resolveAnimations(i,r,s).update(e,{options:!s&&this.getSharedOptions(o)||o})}removeHoverStyle(e,i,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,i,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){let e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){let e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){let i=this._data,r=this._cachedMeta.data;for(let[c,l,h]of this._syncList)this[c](l,h);this._syncList=[];let s=r.length,o=i.length,a=Math.min(o,s);a&&this.parse(0,a),o>s?this._insertElements(s,o-s,e):o<s&&this._removeElements(o,s-o)}_insertElements(e,i,r=!0){let s=this._cachedMeta,o=s.data,a=e+i,c,l=h=>{for(h.length+=i,c=h.length-1;c>=a;c--)h[c]=h[c-i]};for(l(o),c=e;c<a;++c)o[c]=new this.dataElementType;this._parsing&&l(s._parsed),this.parse(e,i),r&&this.updateElements(o,e,i,"reset")}updateElements(e,i,r,s){}_removeElements(e,i){let r=this._cachedMeta;if(this._parsing){let s=r._parsed.splice(e,i);r._stacked&&Mc(r,s)}r.data.splice(e,i)}_sync(e){if(this._parsing)this._syncList.push(e);else{let[i,r,s]=e;this[i](r,s)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){let e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,i){i&&this._sync(["_removeElements",e,i]);let r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}return n})();function V1(n,t){if(!n._cache.$bar){let e=n.getMatchingVisibleMetas(t),i=[];for(let r=0,s=e.length;r<s;r++)i=i.concat(e[r].controller.getAllParsedValues(n));n._cache.$bar=Rm(i.sort((r,s)=>r-s))}return n._cache.$bar}function N1(n){let t=n.iScale,e=V1(t,n.type),i=t._length,r,s,o,a,c=()=>{o===32767||o===-32768||(jo(a)&&(i=Math.min(i,Math.abs(o-a)||i)),a=o)};for(r=0,s=e.length;r<s;++r)o=t.getPixelForValue(e[r]),c();for(a=void 0,r=0,s=t.ticks.length;r<s;++r)o=t.getPixelForTick(r),c();return i}function F1(n,t,e,i){let r=e.barThickness,s,o;return yt(r)?(s=t.min*e.categoryPercentage,o=e.barPercentage):(s=r*i,o=1),{chunk:s/i,ratio:o,start:t.pixels[n]-s/2}}function L1(n,t,e,i){let r=t.pixels,s=r[n],o=n>0?r[n-1]:null,a=n<r.length-1?r[n+1]:null,c=e.categoryPercentage;o===null&&(o=s-(a===null?t.end-t.start:a-s)),a===null&&(a=s+s-o);let l=s-(s-Math.min(o,a))/2*c;return{chunk:Math.abs(a-o)/2*c/i,ratio:e.barPercentage,start:l}}function B1(n,t,e,i){let r=e.parse(n[0],i),s=e.parse(n[1],i),o=Math.min(r,s),a=Math.max(r,s),c=o,l=a;Math.abs(o)>Math.abs(a)&&(c=a,l=o),t[e.axis]=l,t._custom={barStart:c,barEnd:l,start:r,end:s,min:o,max:a}}function qT(n,t,e,i){return kt(n)?B1(n,t,e,i):t[e.axis]=e.parse(n,i),t}function Kw(n,t,e,i){let r=n.iScale,s=n.vScale,o=r.getLabels(),a=r===s,c=[],l,h,d,p;for(l=e,h=e+i;l<h;++l)p=t[l],d={},d[r.axis]=a||r.parse(o[l],l),c.push(qT(p,d,s,l));return c}function Zm(n){return n&&n.barStart!==void 0&&n.barEnd!==void 0}function z1(n,t,e){return n!==0?Fn(n):(t.isHorizontal()?1:-1)*(t.min>=e?1:-1)}function j1(n){let t,e,i,r,s;return n.horizontal?(t=n.base>n.x,e="left",i="right"):(t=n.base<n.y,e="bottom",i="top"),t?(r="end",s="start"):(r="start",s="end"),{start:e,end:i,reverse:t,top:r,bottom:s}}function U1(n,t,e,i){let r=t.borderSkipped,s={};if(!r){n.borderSkipped=s;return}if(r===!0){n.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}let{start:o,end:a,reverse:c,top:l,bottom:h}=j1(n);r==="middle"&&e&&(n.enableBorderRadius=!0,(e._top||0)===i?r=l:(e._bottom||0)===i?r=h:(s[Yw(h,o,a,c)]=!0,r=l)),s[Yw(r,o,a,c)]=!0,n.borderSkipped=s}function Yw(n,t,e,i){return i?(n=q1(n,t,e),n=Qw(n,e,t)):n=Qw(n,t,e),n}function q1(n,t,e){return n===t?e:n===e?t:n}function Qw(n,t,e){return n==="start"?t:n==="end"?e:n}function W1(n,{inflateAmount:t},e){n.inflateAmount=t==="auto"?e===1?.33:0:t}var H1=(()=>{class n extends xr{static id="bar";static defaults={datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}};static overrides={scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}};parsePrimitiveData(e,i,r,s){return Kw(e,i,r,s)}parseArrayData(e,i,r,s){return Kw(e,i,r,s)}parseObjectData(e,i,r,s){let{iScale:o,vScale:a}=e,{xAxisKey:c="x",yAxisKey:l="y"}=this._parsing,h=o.axis==="x"?c:l,d=a.axis==="x"?c:l,p=[],g,y,v,w;for(g=r,y=r+s;g<y;++g)w=i[g],v={},v[o.axis]=o.parse(Pi(w,h),g),p.push(qT(Pi(w,d),v,a,g));return p}updateRangeFromParsed(e,i,r,s){super.updateRangeFromParsed(e,i,r,s);let o=r._custom;o&&i===this._cachedMeta.vScale&&(e.min=Math.min(e.min,o.min),e.max=Math.max(e.max,o.max))}getMaxOverflow(){return 0}getLabelAndValue(e){let i=this._cachedMeta,{iScale:r,vScale:s}=i,o=this.getParsed(e),a=o._custom,c=Zm(a)?"["+a.start+", "+a.end+"]":""+s.getLabelForValue(o[s.axis]);return{label:""+r.getLabelForValue(o[r.axis]),value:c}}initialize(){this.enableOptionSharing=!0,super.initialize();let e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){let i=this._cachedMeta;this.updateElements(i.data,0,i.data.length,e)}updateElements(e,i,r,s){let o=s==="reset",{index:a,_cachedMeta:{vScale:c}}=this,l=c.getBasePixel(),h=c.isHorizontal(),d=this._getRuler(),{sharedOptions:p,includeOptions:g}=this._getSharedOptions(i,s);for(let y=i;y<i+r;y++){let v=this.getParsed(y),w=o||yt(v[c.axis])?{base:l,head:l}:this._calculateBarValuePixels(y),k=this._calculateBarIndexPixels(y,d),R=(v._stacks||{})[c.axis],M={horizontal:h,base:w.base,enableBorderRadius:!R||Zm(v._custom)||a===R._top||a===R._bottom,x:h?w.head:k.center,y:h?k.center:w.head,height:h?k.size:Math.abs(w.size),width:h?Math.abs(w.size):k.size};g&&(M.options=p||this.resolveDataElementOptions(y,e[y].active?"active":s));let F=M.options||e[y].options;U1(M,F,R,a),W1(M,F,d.ratio),this.updateElement(e[y],y,M,s)}}_getStacks(e,i){let{iScale:r}=this._cachedMeta,s=r.getMatchingVisibleMetas(this._type).filter(d=>d.controller.options.grouped),o=r.options.stacked,a=[],c=this._cachedMeta.controller.getParsed(i),l=c&&c[r.axis],h=d=>{let p=d._parsed.find(y=>y[r.axis]===l),g=p&&p[d.vScale.axis];if(yt(g)||isNaN(g))return!0};for(let d of s)if(!(i!==void 0&&h(d))&&((o===!1||a.indexOf(d.stack)===-1||o===void 0&&d.stack===void 0)&&a.push(d.stack),d.index===e))break;return a.length||a.push(void 0),a}_getStackCount(e){return this._getStacks(void 0,e).length}_getStackIndex(e,i,r){let s=this._getStacks(e,r),o=i!==void 0?s.indexOf(i):-1;return o===-1?s.length-1:o}_getRuler(){let e=this.options,i=this._cachedMeta,r=i.iScale,s=[],o,a;for(o=0,a=i.data.length;o<a;++o)s.push(r.getPixelForValue(this.getParsed(o)[r.axis],o));let c=e.barThickness;return{min:c||N1(i),pixels:s,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:c?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){let{_cachedMeta:{vScale:i,_stacked:r,index:s},options:{base:o,minBarLength:a}}=this,c=o||0,l=this.getParsed(e),h=l._custom,d=Zm(h),p=l[i.axis],g=0,y=r?this.applyStack(i,l,r):p,v,w;y!==p&&(g=y-p,y=p),d&&(p=h.barStart,y=h.barEnd-h.barStart,p!==0&&Fn(p)!==Fn(h.barEnd)&&(g=0),g+=p);let k=!yt(o)&&!d?o:g,R=i.getPixelForValue(k);if(this.chart.getDataVisibility(e)?v=i.getPixelForValue(g+y):v=R,w=v-R,Math.abs(w)<a){w=z1(w,i,c)*a,p===c&&(R-=w/2);let M=i.getPixelForDecimal(0),F=i.getPixelForDecimal(1),V=Math.min(M,F),L=Math.max(M,F);R=Math.max(Math.min(R,L),V),v=R+w,r&&!d&&(l._stacks[i.axis]._visualValues[s]=i.getValueForPixel(v)-i.getValueForPixel(R))}if(R===i.getPixelForValue(c)){let M=Fn(w)*i.getLineWidthForValue(c)/2;R+=M,w-=M}return{size:w,base:R,head:v,center:v+w/2}}_calculateBarIndexPixels(e,i){let r=i.scale,s=this.options,o=s.skipNull,a=ct(s.maxBarThickness,1/0),c,l;if(i.grouped){let h=o?this._getStackCount(e):i.stackCount,d=s.barThickness==="flex"?L1(e,i,s,h):F1(e,i,s,h),p=this._getStackIndex(this.index,this._cachedMeta.stack,o?e:void 0);c=d.start+d.chunk*p+d.chunk/2,l=Math.min(a,d.chunk*d.ratio)}else c=r.getPixelForValue(this.getParsed(e)[r.axis],e),l=Math.min(a,i.min*i.ratio);return{base:c-l/2,head:c+l/2,center:c,size:l}}draw(){let e=this._cachedMeta,i=e.vScale,r=e.data,s=r.length,o=0;for(;o<s;++o)this.getParsed(o)[i.axis]!==null&&!r[o].hidden&&r[o].draw(this._ctx)}}return n})(),G1=(()=>{class n extends xr{static id="bubble";static defaults={datasetElementType:!1,dataElementType:"point",animations:{numbers:{type:"number",properties:["x","y","borderWidth","radius"]}}};static overrides={scales:{x:{type:"linear"},y:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,super.initialize()}parsePrimitiveData(e,i,r,s){let o=super.parsePrimitiveData(e,i,r,s);for(let a=0;a<o.length;a++)o[a]._custom=this.resolveDataElementOptions(a+r).radius;return o}parseArrayData(e,i,r,s){let o=super.parseArrayData(e,i,r,s);for(let a=0;a<o.length;a++){let c=i[r+a];o[a]._custom=ct(c[2],this.resolveDataElementOptions(a+r).radius)}return o}parseObjectData(e,i,r,s){let o=super.parseObjectData(e,i,r,s);for(let a=0;a<o.length;a++){let c=i[r+a];o[a]._custom=ct(c&&c.r&&+c.r,this.resolveDataElementOptions(a+r).radius)}return o}getMaxOverflow(){let e=this._cachedMeta.data,i=0;for(let r=e.length-1;r>=0;--r)i=Math.max(i,e[r].size(this.resolveDataElementOptions(r))/2);return i>0&&i}getLabelAndValue(e){let i=this._cachedMeta,r=this.chart.data.labels||[],{xScale:s,yScale:o}=i,a=this.getParsed(e),c=s.getLabelForValue(a.x),l=o.getLabelForValue(a.y),h=a._custom;return{label:r[e]||"",value:"("+c+", "+l+(h?", "+h:"")+")"}}update(e){let i=this._cachedMeta.data;this.updateElements(i,0,i.length,e)}updateElements(e,i,r,s){let o=s==="reset",{iScale:a,vScale:c}=this._cachedMeta,{sharedOptions:l,includeOptions:h}=this._getSharedOptions(i,s),d=a.axis,p=c.axis;for(let g=i;g<i+r;g++){let y=e[g],v=!o&&this.getParsed(g),w={},k=w[d]=o?a.getPixelForDecimal(.5):a.getPixelForValue(v[d]),R=w[p]=o?c.getBasePixel():c.getPixelForValue(v[p]);w.skip=isNaN(k)||isNaN(R),h&&(w.options=l||this.resolveDataElementOptions(g,y.active?"active":s),o&&(w.options.radius=0)),this.updateElement(y,g,w,s)}}resolveDataElementOptions(e,i){let r=this.getParsed(e),s=super.resolveDataElementOptions(e,i);s.$shared&&(s=Object.assign({},s,{$shared:!1}));let o=s.radius;return i!=="active"&&(s.radius=0),s.radius+=ct(r&&r._custom,o),s}}return n})();function $1(n,t,e){let i=1,r=1,s=0,o=0;if(t<Dt){let a=n,c=a+t,l=Math.cos(a),h=Math.sin(a),d=Math.cos(c),p=Math.sin(c),g=(M,F,V)=>qo(M,a,c,!0)?1:Math.max(F,F*e,V,V*e),y=(M,F,V)=>qo(M,a,c,!0)?-1:Math.min(F,F*e,V,V*e),v=g(0,l,d),w=g(Yt,h,p),k=y(Rt,l,d),R=y(Rt+Yt,h,p);i=(v-k)/2,r=(w-R)/2,s=-(v+k)/2,o=-(w+R)/2}return{ratioX:i,ratioY:r,offsetX:s,offsetY:o}}var A_=(()=>{class n extends xr{static id="doughnut";static defaults={datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"};static descriptors={_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){let i=e.data;if(i.labels.length&&i.datasets.length){let{labels:{pointStyle:r,color:s}}=e.legend.options;return i.labels.map((o,a)=>{let l=e.getDatasetMeta(0).controller.getStyle(a);return{text:o,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:s,lineWidth:l.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(a),index:a}})}return[]}},onClick(e,i,r){r.chart.toggleDataVisibility(i.index),r.chart.update()}}}};constructor(e,i){super(e,i),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,i){let r=this.getDataset().data,s=this._cachedMeta;if(this._parsing===!1)s._parsed=r;else{let o=l=>+r[l];if(dt(r[e])){let{key:l="value"}=this._parsing;o=h=>+Pi(r[h],l)}let a,c;for(a=e,c=e+i;a<c;++a)s._parsed[a]=o(a)}}_getRotation(){return wn(this.options.rotation-90)}_getCircumference(){return wn(this.options.circumference)}_getRotationExtents(){let e=Dt,i=-Dt;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){let s=this.chart.getDatasetMeta(r).controller,o=s._getRotation(),a=s._getCircumference();e=Math.min(e,o),i=Math.max(i,o+a)}return{rotation:e,circumference:i-e}}update(e){let i=this.chart,{chartArea:r}=i,s=this._cachedMeta,o=s.data,a=this.getMaxBorderWidth()+this.getMaxOffset(o)+this.options.spacing,c=Math.max((Math.min(r.width,r.height)-a)/2,0),l=Math.min(fw(this.options.cutout,c),1),h=this._getRingWeight(this.index),{circumference:d,rotation:p}=this._getRotationExtents(),{ratioX:g,ratioY:y,offsetX:v,offsetY:w}=$1(p,d,l),k=(r.width-a)/g,R=(r.height-a)/y,M=Math.max(Math.min(k,R)/2,0),F=Em(this.options.radius,M),V=Math.max(F*l,0),L=(F-V)/this._getVisibleDatasetWeightTotal();this.offsetX=v*F,this.offsetY=w*F,s.total=this.calculateTotal(),this.outerRadius=F-L*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-L*h,0),this.updateElements(o,0,o.length,e)}_circumference(e,i){let r=this.options,s=this._cachedMeta,o=this._getCircumference();return i&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||s._parsed[e]===null||s.data[e].hidden?0:this.calculateCircumference(s._parsed[e]*o/Dt)}updateElements(e,i,r,s){let o=s==="reset",a=this.chart,c=a.chartArea,h=a.options.animation,d=(c.left+c.right)/2,p=(c.top+c.bottom)/2,g=o&&h.animateScale,y=g?0:this.innerRadius,v=g?0:this.outerRadius,{sharedOptions:w,includeOptions:k}=this._getSharedOptions(i,s),R=this._getRotation(),M;for(M=0;M<i;++M)R+=this._circumference(M,o);for(M=i;M<i+r;++M){let F=this._circumference(M,o),V=e[M],L={x:d+this.offsetX,y:p+this.offsetY,startAngle:R,endAngle:R+F,circumference:F,outerRadius:v,innerRadius:y};k&&(L.options=w||this.resolveDataElementOptions(M,V.active?"active":s)),R+=F,this.updateElement(V,M,L,s)}}calculateTotal(){let e=this._cachedMeta,i=e.data,r=0,s;for(s=0;s<i.length;s++){let o=e._parsed[s];o!==null&&!isNaN(o)&&this.chart.getDataVisibility(s)&&!i[s].hidden&&(r+=Math.abs(o))}return r}calculateCircumference(e){let i=this._cachedMeta.total;return i>0&&!isNaN(e)?Dt*(Math.abs(e)/i):0}getLabelAndValue(e){let i=this._cachedMeta,r=this.chart,s=r.data.labels||[],o=Wo(i._parsed[e],r.options.locale);return{label:s[e]||"",value:o}}getMaxBorderWidth(e){let i=0,r=this.chart,s,o,a,c,l;if(!e){for(s=0,o=r.data.datasets.length;s<o;++s)if(r.isDatasetVisible(s)){a=r.getDatasetMeta(s),e=a.data,c=a.controller;break}}if(!e)return 0;for(s=0,o=e.length;s<o;++s)l=c.resolveDataElementOptions(s),l.borderAlign!=="inner"&&(i=Math.max(i,l.borderWidth||0,l.hoverBorderWidth||0));return i}getMaxOffset(e){let i=0;for(let r=0,s=e.length;r<s;++r){let o=this.resolveDataElementOptions(r);i=Math.max(i,o.offset||0,o.hoverOffset||0)}return i}_getRingWeightOffset(e){let i=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(i+=this._getRingWeight(r));return i}_getRingWeight(e){return Math.max(ct(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}return n})(),K1=(()=>{class n extends xr{static id="line";static defaults={datasetElementType:"line",dataElementType:"point",showLine:!0,spanGaps:!1};static overrides={scales:{_index_:{type:"category"},_value_:{type:"linear"}}};initialize(){this.enableOptionSharing=!0,this.supportsDecimation=!0,super.initialize()}update(e){let i=this._cachedMeta,{dataset:r,data:s=[],_dataset:o}=i,a=this.chart._animationsDisabled,{start:c,count:l}=Om(i,s,a);this._drawStart=c,this._drawCount=l,Vm(i)&&(c=0,l=s.length),r._chart=this.chart,r._datasetIndex=this.index,r._decimated=!!o._decimated,r.points=s;let h=this.resolveDatasetElementOptions(e);this.options.showLine||(h.borderWidth=0),h.segment=this.options.segment,this.updateElement(r,void 0,{animated:!a,options:h},e),this.updateElements(s,c,l,e)}updateElements(e,i,r,s){let o=s==="reset",{iScale:a,vScale:c,_stacked:l,_dataset:h}=this._cachedMeta,{sharedOptions:d,includeOptions:p}=this._getSharedOptions(i,s),g=a.axis,y=c.axis,{spanGaps:v,segment:w}=this.options,k=ws(v)?v:Number.POSITIVE_INFINITY,R=this.chart._animationsDisabled||o||s==="none",M=i+r,F=e.length,V=i>0&&this.getParsed(i-1);for(let L=0;L<F;++L){let I=e[L],b=R?I:{};if(L<i||L>=M){b.skip=!0;continue}let E=this.getParsed(L),A=yt(E[y]),P=b[g]=a.getPixelForValue(E[g],L),D=b[y]=o||A?c.getBasePixel():c.getPixelForValue(l?this.applyStack(c,E,l):E[y],L);b.skip=isNaN(P)||isNaN(D)||A,b.stop=L>0&&Math.abs(E[g]-V[g])>k,w&&(b.parsed=E,b.raw=h.data[L]),p&&(b.options=d||this.resolveDataElementOptions(L,I.active?"active":s)),R||this.updateElement(I,L,b,s),V=E}}getMaxOverflow(){let e=this._cachedMeta,i=e.dataset,r=i.options&&i.options.borderWidth||0,s=e.data||[];if(!s.length)return r;let o=s[0].size(this.resolveDataElementOptions(0)),a=s[s.length-1].size(this.resolveDataElementOptions(s.length-1));return Math.max(r,o,a)/2}draw(){let e=this._cachedMeta;e.dataset.updateControlPoints(this.chart.chartArea,e.iScale.axis),super.draw()}}return n})(),WT=(()=>{class n extends xr{static id="polarArea";static defaults={dataElementType:"arc",animation:{animateRotate:!0,animateScale:!0},animations:{numbers:{type:"number",properties:["x","y","startAngle","endAngle","innerRadius","outerRadius"]}},indexAxis:"r",startAngle:0};static overrides={aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){let i=e.data;if(i.labels.length&&i.datasets.length){let{labels:{pointStyle:r,color:s}}=e.legend.options;return i.labels.map((o,a)=>{let l=e.getDatasetMeta(0).controller.getStyle(a);return{text:o,fillStyle:l.backgroundColor,strokeStyle:l.borderColor,fontColor:s,lineWidth:l.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(a),index:a}})}return[]}},onClick(e,i,r){r.chart.toggleDataVisibility(i.index),r.chart.update()}}},scales:{r:{type:"radialLinear",angleLines:{display:!1},beginAtZero:!0,grid:{circular:!0},pointLabels:{display:!1},startAngle:0}}};constructor(e,i){super(e,i),this.innerRadius=void 0,this.outerRadius=void 0}getLabelAndValue(e){let i=this._cachedMeta,r=this.chart,s=r.data.labels||[],o=Wo(i._parsed[e].r,r.options.locale);return{label:s[e]||"",value:o}}parseObjectData(e,i,r,s){return Wm.bind(this)(e,i,r,s)}update(e){let i=this._cachedMeta.data;this._updateRadius(),this.updateElements(i,0,i.length,e)}getMinMax(){let e=this._cachedMeta,i={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};return e.data.forEach((r,s)=>{let o=this.getParsed(s).r;!isNaN(o)&&this.chart.getDataVisibility(s)&&(o<i.min&&(i.min=o),o>i.max&&(i.max=o))}),i}_updateRadius(){let e=this.chart,i=e.chartArea,r=e.options,s=Math.min(i.right-i.left,i.bottom-i.top),o=Math.max(s/2,0),a=Math.max(r.cutoutPercentage?o/100*r.cutoutPercentage:1,0),c=(o-a)/e.getVisibleDatasetCount();this.outerRadius=o-c*this.index,this.innerRadius=this.outerRadius-c}updateElements(e,i,r,s){let o=s==="reset",a=this.chart,l=a.options.animation,h=this._cachedMeta.rScale,d=h.xCenter,p=h.yCenter,g=h.getIndexAngle(0)-.5*Rt,y=g,v,w=360/this.countVisibleElements();for(v=0;v<i;++v)y+=this._computeAngle(v,s,w);for(v=i;v<i+r;v++){let k=e[v],R=y,M=y+this._computeAngle(v,s,w),F=a.getDataVisibility(v)?h.getDistanceFromCenterForValue(this.getParsed(v).r):0;y=M,o&&(l.animateScale&&(F=0),l.animateRotate&&(R=M=g));let V={x:d,y:p,innerRadius:0,outerRadius:F,startAngle:R,endAngle:M,options:this.resolveDataElementOptions(v,k.active?"active":s)};this.updateElement(k,v,V,s)}}countVisibleElements(){let e=this._cachedMeta,i=0;return e.data.forEach((r,s)=>{!isNaN(this.getParsed(s).r)&&this.chart.getDataVisibility(s)&&i++}),i}_computeAngle(e,i,r){return this.chart.getDataVisibility(e)?wn(this.resolveDataElementOptions(e,i).angle||r):0}}return n})(),Y1=(()=>{class n extends A_{static id="pie";static defaults={cutout:0,rotation:0,circumference:360,radius:"100%"}}return n})(),Q1=(()=>{class n extends xr{static id="radar";static defaults={datasetElementType:"line",dataElementType:"point",indexAxis:"r",showLine:!0,elements:{line:{fill:"start"}}};static overrides={aspectRatio:1,scales:{r:{type:"radialLinear"}}};getLabelAndValue(e){let i=this._cachedMeta.vScale,r=this.getParsed(e);return{label:i.getLabels()[e],value:""+i.getLabelForValue(r[i.axis])}}parseObjectData(e,i,r,s){return Wm.bind(this)(e,i,r,s)}update(e){let i=this._cachedMeta,r=i.dataset,s=i.data||[],o=i.iScale.getLabels();if(r.points=s,e!=="resize"){let a=this.resolveDatasetElementOptions(e);this.options.showLine||(a.borderWidth=0);let c={_loop:!0,_fullLoop:o.length===s.length,options:a};this.updateElement(r,void 0,c,e)}this.updateElements(s,0,s.length,e)}updateElements(e,i,r,s){let o=this._cachedMeta.rScale,a=s==="reset";for(let c=i;c<i+r;c++){let l=e[c],h=this.resolveDataElementOptions(c,l.active?"active":s),d=o.getPointPositionForValue(c,this.getParsed(c).r),p=a?o.xCenter:d.x,g=a?o.yCenter:d.y,y={x:p,y:g,angle:d.angle,skip:isNaN(p)||isNaN(g),options:h};this.updateElement(l,c,y,s)}}}return n})(),X1=(()=>{class n extends xr{static id="scatter";static defaults={datasetElementType:!1,dataElementType:"point",showLine:!1,fill:!1};static overrides={interaction:{mode:"point"},scales:{x:{type:"linear"},y:{type:"linear"}}};getLabelAndValue(e){let i=this._cachedMeta,r=this.chart.data.labels||[],{xScale:s,yScale:o}=i,a=this.getParsed(e),c=s.getLabelForValue(a.x),l=o.getLabelForValue(a.y);return{label:r[e]||"",value:"("+c+", "+l+")"}}update(e){let i=this._cachedMeta,{data:r=[]}=i,s=this.chart._animationsDisabled,{start:o,count:a}=Om(i,r,s);if(this._drawStart=o,this._drawCount=a,Vm(i)&&(o=0,a=r.length),this.options.showLine){this.datasetElementType||this.addElements();let{dataset:c,_dataset:l}=i;c._chart=this.chart,c._datasetIndex=this.index,c._decimated=!!l._decimated,c.points=r;let h=this.resolveDatasetElementOptions(e);h.segment=this.options.segment,this.updateElement(c,void 0,{animated:!s,options:h},e)}else this.datasetElementType&&(delete i.dataset,this.datasetElementType=!1);this.updateElements(r,o,a,e)}addElements(){let{showLine:e}=this.options;!this.datasetElementType&&e&&(this.datasetElementType=this.chart.registry.getElement("line")),super.addElements()}updateElements(e,i,r,s){let o=s==="reset",{iScale:a,vScale:c,_stacked:l,_dataset:h}=this._cachedMeta,d=this.resolveDataElementOptions(i,s),p=this.getSharedOptions(d),g=this.includeOptions(s,p),y=a.axis,v=c.axis,{spanGaps:w,segment:k}=this.options,R=ws(w)?w:Number.POSITIVE_INFINITY,M=this.chart._animationsDisabled||o||s==="none",F=i>0&&this.getParsed(i-1);for(let V=i;V<i+r;++V){let L=e[V],I=this.getParsed(V),b=M?L:{},E=yt(I[v]),A=b[y]=a.getPixelForValue(I[y],V),P=b[v]=o||E?c.getBasePixel():c.getPixelForValue(l?this.applyStack(c,I,l):I[v],V);b.skip=isNaN(A)||isNaN(P)||E,b.stop=V>0&&Math.abs(I[y]-F[y])>R,k&&(b.parsed=I,b.raw=h.data[V]),g&&(b.options=p||this.resolveDataElementOptions(V,L.active?"active":s)),M||this.updateElement(L,V,b,s),F=I}this.updateSharedOptions(p,s,d)}getMaxOverflow(){let e=this._cachedMeta,i=e.data||[];if(!this.options.showLine){let c=0;for(let l=i.length-1;l>=0;--l)c=Math.max(c,i[l].size(this.resolveDataElementOptions(l))/2);return c>0&&c}let r=e.dataset,s=r.options&&r.options.borderWidth||0;if(!i.length)return s;let o=i[0].size(this.resolveDataElementOptions(0)),a=i[i.length-1].size(this.resolveDataElementOptions(i.length-1));return Math.max(s,o,a)/2}}return n})(),J1=Object.freeze({__proto__:null,BarController:H1,BubbleController:G1,DoughnutController:A_,LineController:K1,PieController:Y1,PolarAreaController:WT,RadarController:Q1,ScatterController:X1});function Es(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}var c_=class n{static override(t){Object.assign(n.prototype,t)}options;constructor(t){this.options=t||{}}init(){}formats(){return Es()}parse(){return Es()}format(){return Es()}add(){return Es()}diff(){return Es()}startOf(){return Es()}endOf(){return Es()}},Z1={_date:c_};function tk(n,t,e,i){let{controller:r,data:s,_sorted:o}=n,a=r._cachedMeta.iScale;if(a&&t===a.axis&&t!=="r"&&o&&s.length){let c=a._reversePixels?vw:Zn;if(i){if(r._sharedOptions){let l=s[0],h=typeof l.getRange=="function"&&l.getRange(t);if(h){let d=c(s,t,e-h),p=c(s,t,e+h);return{lo:d.lo,hi:p.hi}}}}else return c(s,t,e)}return{lo:0,hi:s.length-1}}function qc(n,t,e,i,r){let s=n.getSortedVisibleDatasetMetas(),o=e[t];for(let a=0,c=s.length;a<c;++a){let{index:l,data:h}=s[a],{lo:d,hi:p}=tk(s[a],t,o,r);for(let g=d;g<=p;++g){let y=h[g];y.skip||i(y,l,g)}}}function ek(n){let t=n.indexOf("x")!==-1,e=n.indexOf("y")!==-1;return function(i,r){let s=t?Math.abs(i.x-r.x):0,o=e?Math.abs(i.y-r.y):0;return Math.sqrt(Math.pow(s,2)+Math.pow(o,2))}}function t_(n,t,e,i,r){let s=[];return!r&&!n.isPointInArea(t)||qc(n,e,t,function(a,c,l){!r&&!ti(a,n.chartArea,0)||a.inRange(t.x,t.y,i)&&s.push({element:a,datasetIndex:c,index:l})},!0),s}function nk(n,t,e,i){let r=[];function s(o,a,c){let{startAngle:l,endAngle:h}=o.getProps(["startAngle","endAngle"],i),{angle:d}=Pm(o,{x:t.x,y:t.y});qo(d,l,h)&&r.push({element:o,datasetIndex:a,index:c})}return qc(n,e,t,s),r}function ik(n,t,e,i,r,s){let o=[],a=ek(e),c=Number.POSITIVE_INFINITY;function l(h,d,p){let g=h.inRange(t.x,t.y,r);if(i&&!g)return;let y=h.getCenterPoint(r);if(!(!!s||n.isPointInArea(y))&&!g)return;let w=a(t,y);w<c?(o=[{element:h,datasetIndex:d,index:p}],c=w):w===c&&o.push({element:h,datasetIndex:d,index:p})}return qc(n,e,t,l),o}function e_(n,t,e,i,r,s){return!s&&!n.isPointInArea(t)?[]:e==="r"&&!i?nk(n,t,e,r):ik(n,t,e,i,r,s)}function Xw(n,t,e,i,r){let s=[],o=e==="x"?"inXRange":"inYRange",a=!1;return qc(n,e,t,(c,l,h)=>{c[o]&&c[o](t[e],r)&&(s.push({element:c,datasetIndex:l,index:h}),a=a||c.inRange(t.x,t.y,r))}),i&&!a?[]:s}var rk={evaluateInteractionItems:qc,modes:{index(n,t,e,i){let r=vr(t,n),s=e.axis||"x",o=e.includeInvisible||!1,a=e.intersect?t_(n,r,s,i,o):e_(n,r,s,!1,i,o),c=[];return a.length?(n.getSortedVisibleDatasetMetas().forEach(l=>{let h=a[0].index,d=l.data[h];d&&!d.skip&&c.push({element:d,datasetIndex:l.index,index:h})}),c):[]},dataset(n,t,e,i){let r=vr(t,n),s=e.axis||"xy",o=e.includeInvisible||!1,a=e.intersect?t_(n,r,s,i,o):e_(n,r,s,!1,i,o);if(a.length>0){let c=a[0].datasetIndex,l=n.getDatasetMeta(c).data;a=[];for(let h=0;h<l.length;++h)a.push({element:l[h],datasetIndex:c,index:h})}return a},point(n,t,e,i){let r=vr(t,n),s=e.axis||"xy",o=e.includeInvisible||!1;return t_(n,r,s,i,o)},nearest(n,t,e,i){let r=vr(t,n),s=e.axis||"xy",o=e.includeInvisible||!1;return e_(n,r,s,e.intersect,i,o)},x(n,t,e,i){let r=vr(t,n);return Xw(n,r,"x",e.intersect,i)},y(n,t,e,i){let r=vr(t,n);return Xw(n,r,"y",e.intersect,i)}}},HT=["left","top","right","bottom"];function Oc(n,t){return n.filter(e=>e.pos===t)}function Jw(n,t){return n.filter(e=>HT.indexOf(e.pos)===-1&&e.box.axis===t)}function Vc(n,t){return n.sort((e,i)=>{let r=t?i:e,s=t?e:i;return r.weight===s.weight?r.index-s.index:r.weight-s.weight})}function sk(n){let t=[],e,i,r,s,o,a;for(e=0,i=(n||[]).length;e<i;++e)r=n[e],{position:s,options:{stack:o,stackWeight:a=1}}=r,t.push({index:e,box:r,pos:s,horizontal:r.isHorizontal(),weight:r.weight,stack:o&&s+o,stackWeight:a});return t}function ok(n){let t={};for(let e of n){let{stack:i,pos:r,stackWeight:s}=e;if(!i||!HT.includes(r))continue;let o=t[i]||(t[i]={count:0,placed:0,weight:0,size:0});o.count++,o.weight+=s}return t}function ak(n,t){let e=ok(n),{vBoxMaxWidth:i,hBoxMaxHeight:r}=t,s,o,a;for(s=0,o=n.length;s<o;++s){a=n[s];let{fullSize:c}=a.box,l=e[a.stack],h=l&&a.stackWeight/l.weight;a.horizontal?(a.width=h?h*i:c&&t.availableWidth,a.height=r):(a.width=i,a.height=h?h*r:c&&t.availableHeight)}return e}function ck(n){let t=sk(n),e=Vc(t.filter(l=>l.box.fullSize),!0),i=Vc(Oc(t,"left"),!0),r=Vc(Oc(t,"right")),s=Vc(Oc(t,"top"),!0),o=Vc(Oc(t,"bottom")),a=Jw(t,"x"),c=Jw(t,"y");return{fullSize:e,leftAndTop:i.concat(s),rightAndBottom:r.concat(c).concat(o).concat(a),chartArea:Oc(t,"chartArea"),vertical:i.concat(r).concat(c),horizontal:s.concat(o).concat(a)}}function Zw(n,t,e,i){return Math.max(n[e],t[e])+Math.max(n[i],t[i])}function GT(n,t){n.top=Math.max(n.top,t.top),n.left=Math.max(n.left,t.left),n.bottom=Math.max(n.bottom,t.bottom),n.right=Math.max(n.right,t.right)}function lk(n,t,e,i){let{pos:r,box:s}=e,o=n.maxPadding;if(!dt(r)){e.size&&(n[r]-=e.size);let d=i[e.stack]||{size:0,count:1};d.size=Math.max(d.size,e.horizontal?s.height:s.width),e.size=d.size/d.count,n[r]+=e.size}s.getPadding&&GT(o,s.getPadding());let a=Math.max(0,t.outerWidth-Zw(o,n,"left","right")),c=Math.max(0,t.outerHeight-Zw(o,n,"top","bottom")),l=a!==n.w,h=c!==n.h;return n.w=a,n.h=c,e.horizontal?{same:l,other:h}:{same:h,other:l}}function uk(n){let t=n.maxPadding;function e(i){let r=Math.max(t[i]-n[i],0);return n[i]+=r,r}n.y+=e("top"),n.x+=e("left"),e("right"),e("bottom")}function hk(n,t){let e=t.maxPadding;function i(r){let s={left:0,top:0,right:0,bottom:0};return r.forEach(o=>{s[o]=Math.max(t[o],e[o])}),s}return i(n?["left","right"]:["top","bottom"])}function Lc(n,t,e,i){let r=[],s,o,a,c,l,h;for(s=0,o=n.length,l=0;s<o;++s){a=n[s],c=a.box,c.update(a.width||t.w,a.height||t.h,hk(a.horizontal,t));let{same:d,other:p}=lk(t,e,a,i);l|=d&&r.length,h=h||p,c.fullSize||r.push(a)}return l&&Lc(r,t,e,i)||h}function Oh(n,t,e,i,r){n.top=e,n.left=t,n.right=t+i,n.bottom=e+r,n.width=i,n.height=r}function tT(n,t,e,i){let r=e.padding,{x:s,y:o}=t;for(let a of n){let c=a.box,l=i[a.stack]||{count:1,placed:0,weight:1},h=a.stackWeight/l.weight||1;if(a.horizontal){let d=t.w*h,p=l.size||c.height;jo(l.start)&&(o=l.start),c.fullSize?Oh(c,r.left,o,e.outerWidth-r.right-r.left,p):Oh(c,t.left+l.placed,o,d,p),l.start=o,l.placed+=d,o=c.bottom}else{let d=t.h*h,p=l.size||c.width;jo(l.start)&&(s=l.start),c.fullSize?Oh(c,s,r.top,p,e.outerHeight-r.bottom-r.top):Oh(c,s,t.top+l.placed,p,d),l.start=s,l.placed+=d,s=c.right}}t.x=s,t.y=o}var Fe={addBox(n,t){n.boxes||(n.boxes=[]),t.fullSize=t.fullSize||!1,t.position=t.position||"top",t.weight=t.weight||0,t._layers=t._layers||function(){return[{z:0,draw(e){t.draw(e)}}]},n.boxes.push(t)},removeBox(n,t){let e=n.boxes?n.boxes.indexOf(t):-1;e!==-1&&n.boxes.splice(e,1)},configure(n,t,e){t.fullSize=e.fullSize,t.position=e.position,t.weight=e.weight},update(n,t,e,i){if(!n)return;let r=Pe(n.options.layout.padding),s=Math.max(t-r.width,0),o=Math.max(e-r.height,0),a=ck(n.boxes),c=a.vertical,l=a.horizontal;bt(n.boxes,v=>{typeof v.beforeLayout=="function"&&v.beforeLayout()});let h=c.reduce((v,w)=>w.box.options&&w.box.options.display===!1?v:v+1,0)||1,d=Object.freeze({outerWidth:t,outerHeight:e,padding:r,availableWidth:s,availableHeight:o,vBoxMaxWidth:s/2/h,hBoxMaxHeight:o/2}),p=Object.assign({},r);GT(p,Pe(i));let g=Object.assign({maxPadding:p,w:s,h:o,x:r.left,y:r.top},r),y=ak(c.concat(l),d);Lc(a.fullSize,g,d,y),Lc(c,g,d,y),Lc(l,g,d,y)&&Lc(c,g,d,y),uk(g),tT(a.leftAndTop,g,d,y),g.x+=g.w,g.y+=g.h,tT(a.rightAndBottom,g,d,y),n.chartArea={left:g.left,top:g.top,right:g.left+g.w,bottom:g.top+g.h,height:g.h,width:g.w},bt(a.chartArea,v=>{let w=v.box;Object.assign(w,n.chartArea),w.update(g.w,g.h,{left:0,top:0,right:0,bottom:0})})}},Wh=class{acquireContext(t,e){}releaseContext(t){return!1}addEventListener(t,e,i){}removeEventListener(t,e,i){}getDevicePixelRatio(){return 1}getMaximumSize(t,e,i,r){return e=Math.max(0,e||t.width),i=i||t.height,{width:e,height:Math.max(0,r?Math.floor(e/r):i)}}isAttached(t){return!0}updateConfig(t){}},l_=class extends Wh{acquireContext(t){return t&&t.getContext&&t.getContext("2d")||null}updateConfig(t){t.options.animation=!1}},jh="$chartjs",dk={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},eT=n=>n===null||n==="";function fk(n,t){let e=n.style,i=n.getAttribute("height"),r=n.getAttribute("width");if(n[jh]={initial:{height:i,width:r,style:{display:e.display,height:e.height,width:e.width}}},e.display=e.display||"block",e.boxSizing=e.boxSizing||"border-box",eT(r)){let s=Gm(n,"width");s!==void 0&&(n.width=s)}if(eT(i))if(n.style.height==="")n.height=n.width/(t||2);else{let s=Gm(n,"height");s!==void 0&&(n.height=s)}return n}var $T=Nw?{passive:!0}:!1;function pk(n,t,e){n&&n.addEventListener(t,e,$T)}function gk(n,t,e){n&&n.canvas&&n.canvas.removeEventListener(t,e,$T)}function mk(n,t){let e=dk[n.type]||n.type,{x:i,y:r}=vr(n,t);return{type:e,chart:t,native:n,x:i!==void 0?i:null,y:r!==void 0?r:null}}function Hh(n,t){for(let e of n)if(e===t||e.contains(t))return!0}function _k(n,t,e){let i=n.canvas,r=new MutationObserver(s=>{let o=!1;for(let a of s)o=o||Hh(a.addedNodes,i),o=o&&!Hh(a.removedNodes,i);o&&e()});return r.observe(document,{childList:!0,subtree:!0}),r}function yk(n,t,e){let i=n.canvas,r=new MutationObserver(s=>{let o=!1;for(let a of s)o=o||Hh(a.removedNodes,i),o=o&&!Hh(a.addedNodes,i);o&&e()});return r.observe(document,{childList:!0,subtree:!0}),r}var zc=new Map,nT=0;function KT(){let n=window.devicePixelRatio;n!==nT&&(nT=n,zc.forEach((t,e)=>{e.currentDevicePixelRatio!==n&&t()}))}function vk(n,t){zc.size||window.addEventListener("resize",KT),zc.set(n,t)}function bk(n){zc.delete(n),zc.size||window.removeEventListener("resize",KT)}function xk(n,t,e){let i=n.canvas,r=i&&Dh(i);if(!r)return;let s=Mm((a,c)=>{let l=r.clientWidth;e(a,c),l<r.clientWidth&&e()},window),o=new ResizeObserver(a=>{let c=a[0],l=c.contentRect.width,h=c.contentRect.height;l===0&&h===0||s(l,h)});return o.observe(r),vk(n,s),o}function n_(n,t,e){e&&e.disconnect(),t==="resize"&&bk(n)}function wk(n,t,e){let i=n.canvas,r=Mm(s=>{n.ctx!==null&&e(mk(s,n))},n);return pk(i,t,r),r}var u_=class extends Wh{acquireContext(t,e){let i=t&&t.getContext&&t.getContext("2d");return i&&i.canvas===t?(fk(t,e),i):null}releaseContext(t){let e=t.canvas;if(!e[jh])return!1;let i=e[jh].initial;["height","width"].forEach(s=>{let o=i[s];yt(o)?e.removeAttribute(s):e.setAttribute(s,o)});let r=i.style||{};return Object.keys(r).forEach(s=>{e.style[s]=r[s]}),e.width=e.width,delete e[jh],!0}addEventListener(t,e,i){this.removeEventListener(t,e);let r=t.$proxies||(t.$proxies={}),o={attach:_k,detach:yk,resize:xk}[e]||wk;r[e]=o(t,e,i)}removeEventListener(t,e){let i=t.$proxies||(t.$proxies={}),r=i[e];if(!r)return;({attach:n_,detach:n_,resize:n_}[e]||gk)(t,e,r),i[e]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(t,e,i,r){return Vw(t,e,i,r)}isAttached(t){let e=t&&Dh(t);return!!(e&&e.isConnected)}};function Tk(n){return!Rh()||typeof OffscreenCanvas<"u"&&n instanceof OffscreenCanvas?l_:u_}var Ln=class{static defaults={};static defaultRoutes=void 0;x;y;active=!1;options;$animations;tooltipPosition(t){let{x:e,y:i}=this.getProps(["x","y"],t);return{x:e,y:i}}hasValue(){return ws(this.x)&&ws(this.y)}getProps(t,e){let i=this.$animations;if(!e||!i)return this;let r={};return t.forEach(s=>{r[s]=i[s]&&i[s].active()?i[s]._to:this[s]}),r}};function Ek(n,t){let e=n.options.ticks,i=Ik(n),r=Math.min(e.maxTicksLimit||i,i),s=e.major.enabled?Ak(t):[],o=s.length,a=s[0],c=s[o-1],l=[];if(o>r)return Ck(t,l,s,o/r),l;let h=Sk(s,t,r);if(o>0){let d,p,g=o>1?Math.round((c-a)/(o-1)):null;for(Vh(t,l,h,yt(g)?0:a-g,a),d=0,p=o-1;d<p;d++)Vh(t,l,h,s[d],s[d+1]);return Vh(t,l,h,c,yt(g)?t.length:c+g),l}return Vh(t,l,h),l}function Ik(n){let t=n.options.offset,e=n._tickSize(),i=n._length/e+(t?0:1),r=n._maxLength/e;return Math.floor(Math.min(i,r))}function Sk(n,t,e){let i=Pk(n),r=t.length/e;if(!i)return Math.max(r,1);let s=mw(i);for(let o=0,a=s.length-1;o<a;o++){let c=s[o];if(c>r)return c}return Math.max(r,1)}function Ak(n){let t=[],e,i;for(e=0,i=n.length;e<i;e++)n[e].major&&t.push(e);return t}function Ck(n,t,e,i){let r=0,s=e[0],o;for(i=Math.ceil(i),o=0;o<n.length;o++)o===s&&(t.push(n[o]),r++,s=e[r*i])}function Vh(n,t,e,i,r){let s=ct(i,0),o=Math.min(ct(r,n.length),n.length),a=0,c,l,h;for(e=Math.ceil(e),r&&(c=r-i,e=c/Math.floor(c/e)),h=s;h<0;)a++,h=Math.round(s+a*e);for(l=Math.max(s,0);l<o;l++)l===h&&(t.push(n[l]),a++,h=Math.round(s+a*e))}function Pk(n){let t=n.length,e,i;if(t<2)return!1;for(i=n[0],e=1;e<t;++e)if(n[e]-n[e-1]!==i)return!1;return i}var kk=n=>n==="left"?"right":n==="right"?"left":n,iT=(n,t,e)=>t==="top"||t==="left"?n[t]+e:n[t]-e,rT=(n,t)=>Math.min(t||n,n);function sT(n,t){let e=[],i=n.length/t,r=n.length,s=0;for(;s<r;s+=i)e.push(n[Math.floor(s)]);return e}function Rk(n,t,e){let i=n.ticks.length,r=Math.min(t,i-1),s=n._startPixel,o=n._endPixel,a=1e-6,c=n.getPixelForTick(r),l;if(!(e&&(i===1?l=Math.max(c-s,o-c):t===0?l=(n.getPixelForTick(1)-c)/2:l=(c-n.getPixelForTick(r-1))/2,c+=r<t?l:-l,c<s-a||c>o+a)))return c}function Dk(n,t){bt(n,e=>{let i=e.gc,r=i.length/2,s;if(r>t){for(s=0;s<r;++s)delete e.data[i[s]];i.splice(0,r)}})}function Nc(n){return n.drawTicks?n.tickLength:0}function oT(n,t){if(!n.display)return 0;let e=ae(n.font,t),i=Pe(n.padding);return(kt(n.text)?n.text.length:1)*e.lineHeight+i.height}function Mk(n,t){return ki(n,{scale:t,type:"scale"})}function Ok(n,t,e){return ki(n,{tick:e,index:t,type:"tick"})}function Vk(n,t,e){let i=Sh(n);return(e&&t!=="right"||!e&&t==="right")&&(i=kk(i)),i}function Nk(n,t,e,i){let{top:r,left:s,bottom:o,right:a,chart:c}=n,{chartArea:l,scales:h}=c,d=0,p,g,y,v=o-r,w=a-s;if(n.isHorizontal()){if(g=Ce(i,s,a),dt(e)){let k=Object.keys(e)[0],R=e[k];y=h[k].getPixelForValue(R)+v-t}else e==="center"?y=(l.bottom+l.top)/2+v-t:y=iT(n,e,t);p=a-s}else{if(dt(e)){let k=Object.keys(e)[0],R=e[k];g=h[k].getPixelForValue(R)-w+t}else e==="center"?g=(l.left+l.right)/2-w+t:g=iT(n,e,t);y=Ce(i,o,r),d=e==="left"?-Yt:Yt}return{titleX:g,titleY:y,maxWidth:p,rotation:d}}var Ss=class n extends Ln{constructor(t){super(),this.id=t.id,this.type=t.type,this.options=void 0,this.ctx=t.ctx,this.chart=t.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(t){this.options=t.setContext(this.getContext()),this.axis=t.axis,this._userMin=this.parse(t.min),this._userMax=this.parse(t.max),this._suggestedMin=this.parse(t.suggestedMin),this._suggestedMax=this.parse(t.suggestedMax)}parse(t,e){return t}getUserBounds(){let{_userMin:t,_userMax:e,_suggestedMin:i,_suggestedMax:r}=this;return t=Xe(t,Number.POSITIVE_INFINITY),e=Xe(e,Number.NEGATIVE_INFINITY),i=Xe(i,Number.POSITIVE_INFINITY),r=Xe(r,Number.NEGATIVE_INFINITY),{min:Xe(t,i),max:Xe(e,r),minDefined:qt(t),maxDefined:qt(e)}}getMinMax(t){let{min:e,max:i,minDefined:r,maxDefined:s}=this.getUserBounds(),o;if(r&&s)return{min:e,max:i};let a=this.getMatchingVisibleMetas();for(let c=0,l=a.length;c<l;++c)o=a[c].controller.getMinMax(this,t),r||(e=Math.min(e,o.min)),s||(i=Math.max(i,o.max));return e=s&&e>i?i:e,i=r&&e>i?e:i,{min:Xe(e,Xe(i,e)),max:Xe(i,Xe(e,i))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){let t=this.chart.data;return this.options.labels||(this.isHorizontal()?t.xLabels:t.yLabels)||t.labels||[]}getLabelItems(t=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(t))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){St(this.options.beforeUpdate,[this])}update(t,e,i){let{beginAtZero:r,grace:s,ticks:o}=this.options,a=o.sampleSize;this.beforeUpdate(),this.maxWidth=t,this.maxHeight=e,this._margins=i=Object.assign({left:0,right:0,top:0,bottom:0},i),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+i.left+i.right:this.height+i.top+i.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=Pw(this,s,r),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();let c=a<this.ticks.length;this._convertTicksToLabels(c?sT(this.ticks,a):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),o.display&&(o.autoSkip||o.source==="auto")&&(this.ticks=Ek(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),c&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let t=this.options.reverse,e,i;this.isHorizontal()?(e=this.left,i=this.right):(e=this.top,i=this.bottom,t=!t),this._startPixel=e,this._endPixel=i,this._reversePixels=t,this._length=i-e,this._alignToPixels=this.options.alignToPixels}afterUpdate(){St(this.options.afterUpdate,[this])}beforeSetDimensions(){St(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){St(this.options.afterSetDimensions,[this])}_callHooks(t){this.chart.notifyPlugins(t,this.getContext()),St(this.options[t],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){St(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(t){let e=this.options.ticks,i,r,s;for(i=0,r=t.length;i<r;i++)s=t[i],s.label=St(e.callback,[s.value,i,t],this)}afterTickToLabelConversion(){St(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){St(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){let t=this.options,e=t.ticks,i=rT(this.ticks.length,t.ticks.maxTicksLimit),r=e.minRotation||0,s=e.maxRotation,o=r,a,c,l;if(!this._isVisible()||!e.display||r>=s||i<=1||!this.isHorizontal()){this.labelRotation=r;return}let h=this._getLabelSizes(),d=h.widest.width,p=h.highest.height,g=fe(this.chart.width-d,0,this.maxWidth);a=t.offset?this.maxWidth/i:g/(i-1),d+6>a&&(a=g/(i-(t.offset?.5:1)),c=this.maxHeight-Nc(t.grid)-e.padding-oT(t.title,this.chart.options.font),l=Math.sqrt(d*d+p*p),o=Eh(Math.min(Math.asin(fe((h.highest.height+6)/a,-1,1)),Math.asin(fe(c/l,-1,1))-Math.asin(fe(p/l,-1,1)))),o=Math.max(r,Math.min(s,o))),this.labelRotation=o}afterCalculateLabelRotation(){St(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){St(this.options.beforeFit,[this])}fit(){let t={width:0,height:0},{chart:e,options:{ticks:i,title:r,grid:s}}=this,o=this._isVisible(),a=this.isHorizontal();if(o){let c=oT(r,e.options.font);if(a?(t.width=this.maxWidth,t.height=Nc(s)+c):(t.height=this.maxHeight,t.width=Nc(s)+c),i.display&&this.ticks.length){let{first:l,last:h,widest:d,highest:p}=this._getLabelSizes(),g=i.padding*2,y=wn(this.labelRotation),v=Math.cos(y),w=Math.sin(y);if(a){let k=i.mirror?0:w*d.width+v*p.height;t.height=Math.min(this.maxHeight,t.height+k+g)}else{let k=i.mirror?0:v*d.width+w*p.height;t.width=Math.min(this.maxWidth,t.width+k+g)}this._calculatePadding(l,h,w,v)}}this._handleMargins(),a?(this.width=this._length=e.width-this._margins.left-this._margins.right,this.height=t.height):(this.width=t.width,this.height=this._length=e.height-this._margins.top-this._margins.bottom)}_calculatePadding(t,e,i,r){let{ticks:{align:s,padding:o},position:a}=this.options,c=this.labelRotation!==0,l=a!=="top"&&this.axis==="x";if(this.isHorizontal()){let h=this.getPixelForTick(0)-this.left,d=this.right-this.getPixelForTick(this.ticks.length-1),p=0,g=0;c?l?(p=r*t.width,g=i*e.height):(p=i*t.height,g=r*e.width):s==="start"?g=e.width:s==="end"?p=t.width:s!=="inner"&&(p=t.width/2,g=e.width/2),this.paddingLeft=Math.max((p-h+o)*this.width/(this.width-h),0),this.paddingRight=Math.max((g-d+o)*this.width/(this.width-d),0)}else{let h=e.height/2,d=t.height/2;s==="start"?(h=0,d=t.height):s==="end"&&(h=e.height,d=0),this.paddingTop=h+o,this.paddingBottom=d+o}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){St(this.options.afterFit,[this])}isHorizontal(){let{axis:t,position:e}=this.options;return e==="top"||e==="bottom"||t==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(t){this.beforeTickToLabelConversion(),this.generateTickLabels(t);let e,i;for(e=0,i=t.length;e<i;e++)yt(t[e].label)&&(t.splice(e,1),i--,e--);this.afterTickToLabelConversion()}_getLabelSizes(){let t=this._labelSizes;if(!t){let e=this.options.ticks.sampleSize,i=this.ticks;e<i.length&&(i=sT(i,e)),this._labelSizes=t=this._computeLabelSizes(i,i.length,this.options.ticks.maxTicksLimit)}return t}_computeLabelSizes(t,e,i){let{ctx:r,_longestTextCache:s}=this,o=[],a=[],c=Math.floor(e/rT(e,i)),l=0,h=0,d,p,g,y,v,w,k,R,M,F,V;for(d=0;d<e;d+=c){if(y=t[d].label,v=this._resolveTickFontOptions(d),r.font=w=v.string,k=s[w]=s[w]||{data:{},gc:[]},R=v.lineHeight,M=F=0,!yt(y)&&!kt(y))M=Cc(r,k.data,k.gc,M,y),F=R;else if(kt(y))for(p=0,g=y.length;p<g;++p)V=y[p],!yt(V)&&!kt(V)&&(M=Cc(r,k.data,k.gc,M,V),F+=R);o.push(M),a.push(F),l=Math.max(M,l),h=Math.max(F,h)}Dk(s,e);let L=o.indexOf(l),I=a.indexOf(h),b=E=>({width:o[E]||0,height:a[E]||0});return{first:b(0),last:b(e-1),widest:b(L),highest:b(I),widths:o,heights:a}}getLabelForValue(t){return t}getPixelForValue(t,e){return NaN}getValueForPixel(t){}getPixelForTick(t){let e=this.ticks;return t<0||t>e.length-1?null:this.getPixelForValue(e[t].value)}getPixelForDecimal(t){this._reversePixels&&(t=1-t);let e=this._startPixel+t*this._length;return yw(this._alignToPixels?mr(this.chart,e,0):e)}getDecimalForPixel(t){let e=(t-this._startPixel)/this._length;return this._reversePixels?1-e:e}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){let{min:t,max:e}=this;return t<0&&e<0?e:t>0&&e>0?t:0}getContext(t){let e=this.ticks||[];if(t>=0&&t<e.length){let i=e[t];return i.$context||(i.$context=Ok(this.getContext(),t,i))}return this.$context||(this.$context=Mk(this.chart.getContext(),this))}_tickSize(){let t=this.options.ticks,e=wn(this.labelRotation),i=Math.abs(Math.cos(e)),r=Math.abs(Math.sin(e)),s=this._getLabelSizes(),o=t.autoSkipPadding||0,a=s?s.widest.width+o:0,c=s?s.highest.height+o:0;return this.isHorizontal()?c*i>a*r?a/i:c/r:c*r<a*i?c/i:a/r}_isVisible(){let t=this.options.display;return t!=="auto"?!!t:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(t){let e=this.axis,i=this.chart,r=this.options,{grid:s,position:o,border:a}=r,c=s.offset,l=this.isHorizontal(),d=this.ticks.length+(c?1:0),p=Nc(s),g=[],y=a.setContext(this.getContext()),v=y.display?y.width:0,w=v/2,k=function(xt){return mr(i,xt,v)},R,M,F,V,L,I,b,E,A,P,D,S;if(o==="top")R=k(this.bottom),I=this.bottom-p,E=R-w,P=k(t.top)+w,S=t.bottom;else if(o==="bottom")R=k(this.top),P=t.top,S=k(t.bottom)-w,I=R+w,E=this.top+p;else if(o==="left")R=k(this.right),L=this.right-p,b=R-w,A=k(t.left)+w,D=t.right;else if(o==="right")R=k(this.left),A=t.left,D=k(t.right)-w,L=R+w,b=this.left+p;else if(e==="x"){if(o==="center")R=k((t.top+t.bottom)/2+.5);else if(dt(o)){let xt=Object.keys(o)[0],wt=o[xt];R=k(this.chart.scales[xt].getPixelForValue(wt))}P=t.top,S=t.bottom,I=R+w,E=I+p}else if(e==="y"){if(o==="center")R=k((t.left+t.right)/2);else if(dt(o)){let xt=Object.keys(o)[0],wt=o[xt];R=k(this.chart.scales[xt].getPixelForValue(wt))}L=R-w,b=L-p,A=t.left,D=t.right}let Mt=ct(r.ticks.maxTicksLimit,d),ft=Math.max(1,Math.ceil(d/Mt));for(M=0;M<d;M+=ft){let xt=this.getContext(M),wt=s.setContext(xt),te=a.setContext(xt),Wt=wt.lineWidth,En=wt.color,ln=te.dash||[],ye=te.dashOffset,At=wt.tickWidth,In=wt.tickColor,en=wt.tickBorderDash||[],Ot=wt.tickBorderDashOffset;F=Rk(this,M,c),F!==void 0&&(V=mr(i,F,Wt),l?L=b=A=D=V:I=E=P=S=V,g.push({tx1:L,ty1:I,tx2:b,ty2:E,x1:A,y1:P,x2:D,y2:S,width:Wt,color:En,borderDash:ln,borderDashOffset:ye,tickWidth:At,tickColor:In,tickBorderDash:en,tickBorderDashOffset:Ot}))}return this._ticksLength=d,this._borderValue=R,g}_computeLabelItems(t){let e=this.axis,i=this.options,{position:r,ticks:s}=i,o=this.isHorizontal(),a=this.ticks,{align:c,crossAlign:l,padding:h,mirror:d}=s,p=Nc(i.grid),g=p+h,y=d?-h:g,v=-wn(this.labelRotation),w=[],k,R,M,F,V,L,I,b,E,A,P,D,S="middle";if(r==="top")L=this.bottom-y,I=this._getXAxisLabelAlignment();else if(r==="bottom")L=this.top+y,I=this._getXAxisLabelAlignment();else if(r==="left"){let ft=this._getYAxisLabelAlignment(p);I=ft.textAlign,V=ft.x}else if(r==="right"){let ft=this._getYAxisLabelAlignment(p);I=ft.textAlign,V=ft.x}else if(e==="x"){if(r==="center")L=(t.top+t.bottom)/2+g;else if(dt(r)){let ft=Object.keys(r)[0],xt=r[ft];L=this.chart.scales[ft].getPixelForValue(xt)+g}I=this._getXAxisLabelAlignment()}else if(e==="y"){if(r==="center")V=(t.left+t.right)/2-g;else if(dt(r)){let ft=Object.keys(r)[0],xt=r[ft];V=this.chart.scales[ft].getPixelForValue(xt)}I=this._getYAxisLabelAlignment(p).textAlign}e==="y"&&(c==="start"?S="top":c==="end"&&(S="bottom"));let Mt=this._getLabelSizes();for(k=0,R=a.length;k<R;++k){M=a[k],F=M.label;let ft=s.setContext(this.getContext(k));b=this.getPixelForTick(k)+s.labelOffset,E=this._resolveTickFontOptions(k),A=E.lineHeight,P=kt(F)?F.length:1;let xt=P/2,wt=ft.color,te=ft.textStrokeColor,Wt=ft.textStrokeWidth,En=I;o?(V=b,I==="inner"&&(k===R-1?En=this.options.reverse?"left":"right":k===0?En=this.options.reverse?"right":"left":En="center"),r==="top"?l==="near"||v!==0?D=-P*A+A/2:l==="center"?D=-Mt.highest.height/2-xt*A+A:D=-Mt.highest.height+A/2:l==="near"||v!==0?D=A/2:l==="center"?D=Mt.highest.height/2-xt*A:D=Mt.highest.height-P*A,d&&(D*=-1),v!==0&&!ft.showLabelBackdrop&&(V+=A/2*Math.sin(v))):(L=b,D=(1-P)*A/2);let ln;if(ft.showLabelBackdrop){let ye=Pe(ft.backdropPadding),At=Mt.heights[k],In=Mt.widths[k],en=D-ye.top,Ot=0-ye.left;switch(S){case"middle":en-=At/2;break;case"bottom":en-=At;break}switch(I){case"center":Ot-=In/2;break;case"right":Ot-=In;break;case"inner":k===R-1?Ot-=In:k>0&&(Ot-=In/2);break}ln={left:Ot,top:en,width:In+ye.width,height:At+ye.height,color:ft.backdropColor}}w.push({label:F,font:E,textOffset:D,options:{rotation:v,color:wt,strokeColor:te,strokeWidth:Wt,textAlign:En,textBaseline:S,translation:[V,L],backdrop:ln}})}return w}_getXAxisLabelAlignment(){let{position:t,ticks:e}=this.options;if(-wn(this.labelRotation))return t==="top"?"left":"right";let r="center";return e.align==="start"?r="left":e.align==="end"?r="right":e.align==="inner"&&(r="inner"),r}_getYAxisLabelAlignment(t){let{position:e,ticks:{crossAlign:i,mirror:r,padding:s}}=this.options,o=this._getLabelSizes(),a=t+s,c=o.widest.width,l,h;return e==="left"?r?(h=this.right+s,i==="near"?l="left":i==="center"?(l="center",h+=c/2):(l="right",h+=c)):(h=this.right-a,i==="near"?l="right":i==="center"?(l="center",h-=c/2):(l="left",h=this.left)):e==="right"?r?(h=this.left+s,i==="near"?l="right":i==="center"?(l="center",h-=c/2):(l="left",h-=c)):(h=this.left+a,i==="near"?l="left":i==="center"?(l="center",h+=c/2):(l="right",h=this.right)):l="right",{textAlign:l,x:h}}_computeLabelArea(){if(this.options.ticks.mirror)return;let t=this.chart,e=this.options.position;if(e==="left"||e==="right")return{top:0,left:this.left,bottom:t.height,right:this.right};if(e==="top"||e==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:t.width}}drawBackground(){let{ctx:t,options:{backgroundColor:e},left:i,top:r,width:s,height:o}=this;e&&(t.save(),t.fillStyle=e,t.fillRect(i,r,s,o),t.restore())}getLineWidthForValue(t){let e=this.options.grid;if(!this._isVisible()||!e.display)return 0;let r=this.ticks.findIndex(s=>s.value===t);return r>=0?e.setContext(this.getContext(r)).lineWidth:0}drawGrid(t){let e=this.options.grid,i=this.ctx,r=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(t)),s,o,a=(c,l,h)=>{!h.width||!h.color||(i.save(),i.lineWidth=h.width,i.strokeStyle=h.color,i.setLineDash(h.borderDash||[]),i.lineDashOffset=h.borderDashOffset,i.beginPath(),i.moveTo(c.x,c.y),i.lineTo(l.x,l.y),i.stroke(),i.restore())};if(e.display)for(s=0,o=r.length;s<o;++s){let c=r[s];e.drawOnChartArea&&a({x:c.x1,y:c.y1},{x:c.x2,y:c.y2},c),e.drawTicks&&a({x:c.tx1,y:c.ty1},{x:c.tx2,y:c.ty2},{color:c.tickColor,width:c.tickWidth,borderDash:c.tickBorderDash,borderDashOffset:c.tickBorderDashOffset})}}drawBorder(){let{chart:t,ctx:e,options:{border:i,grid:r}}=this,s=i.setContext(this.getContext()),o=i.display?s.width:0;if(!o)return;let a=r.setContext(this.getContext(0)).lineWidth,c=this._borderValue,l,h,d,p;this.isHorizontal()?(l=mr(t,this.left,o)-o/2,h=mr(t,this.right,a)+a/2,d=p=c):(d=mr(t,this.top,o)-o/2,p=mr(t,this.bottom,a)+a/2,l=h=c),e.save(),e.lineWidth=s.width,e.strokeStyle=s.color,e.beginPath(),e.moveTo(l,d),e.lineTo(h,p),e.stroke(),e.restore()}drawLabels(t){if(!this.options.ticks.display)return;let i=this.ctx,r=this._computeLabelArea();r&&Rc(i,r);let s=this.getLabelItems(t);for(let o of s){let a=o.options,c=o.font,l=o.label,h=o.textOffset;_r(i,l,0,h,c,a)}r&&Dc(i)}drawTitle(){let{ctx:t,options:{position:e,title:i,reverse:r}}=this;if(!i.display)return;let s=ae(i.font),o=Pe(i.padding),a=i.align,c=s.lineHeight/2;e==="bottom"||e==="center"||dt(e)?(c+=o.bottom,kt(i.text)&&(c+=s.lineHeight*(i.text.length-1))):c+=o.top;let{titleX:l,titleY:h,maxWidth:d,rotation:p}=Nk(this,c,e,a);_r(t,i.text,0,0,s,{color:i.color,maxWidth:d,rotation:p,textAlign:Vk(a,e,r),textBaseline:"middle",translation:[l,h]})}draw(t){this._isVisible()&&(this.drawBackground(),this.drawGrid(t),this.drawBorder(),this.drawTitle(),this.drawLabels(t))}_layers(){let t=this.options,e=t.ticks&&t.ticks.z||0,i=ct(t.grid&&t.grid.z,-1),r=ct(t.border&&t.border.z,0);return!this._isVisible()||this.draw!==n.prototype.draw?[{z:e,draw:s=>{this.draw(s)}}]:[{z:i,draw:s=>{this.drawBackground(),this.drawGrid(s),this.drawTitle()}},{z:r,draw:()=>{this.drawBorder()}},{z:e,draw:s=>{this.drawLabels(s)}}]}getMatchingVisibleMetas(t){let e=this.chart.getSortedVisibleDatasetMetas(),i=this.axis+"AxisID",r=[],s,o;for(s=0,o=e.length;s<o;++s){let a=e[s];a[i]===this.id&&(!t||a.type===t)&&r.push(a)}return r}_resolveTickFontOptions(t){let e=this.options.ticks.setContext(this.getContext(t));return ae(e.font)}_maxDigits(){let t=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/t}},Ko=class{constructor(t,e,i){this.type=t,this.scope=e,this.override=i,this.items=Object.create(null)}isForType(t){return Object.prototype.isPrototypeOf.call(this.type.prototype,t.prototype)}register(t){let e=Object.getPrototypeOf(t),i;Bk(e)&&(i=this.register(e));let r=this.items,s=t.id,o=this.scope+"."+s;if(!s)throw new Error("class does not have id: "+t);return s in r||(r[s]=t,Fk(t,o,i),this.override&&Nt.override(t.id,t.overrides)),o}get(t){return this.items[t]}unregister(t){let e=this.items,i=t.id,r=this.scope;i in e&&delete e[i],r&&i in Nt[r]&&(delete Nt[r][i],this.override&&delete gr[i])}};function Fk(n,t,e){let i=Lo(Object.create(null),[e?Nt.get(e):{},Nt.get(t),n.defaults]);Nt.set(t,i),n.defaultRoutes&&Lk(t,n.defaultRoutes),n.descriptors&&Nt.describe(t,n.descriptors)}function Lk(n,t){Object.keys(t).forEach(e=>{let i=e.split("."),r=i.pop(),s=[n].concat(i).join("."),o=t[e].split("."),a=o.pop(),c=o.join(".");Nt.route(s,r,c,a)})}function Bk(n){return"id"in n&&"defaults"in n}var h_=class{constructor(){this.controllers=new Ko(xr,"datasets",!0),this.elements=new Ko(Ln,"elements"),this.plugins=new Ko(Object,"plugins"),this.scales=new Ko(Ss,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...t){this._each("register",t)}remove(...t){this._each("unregister",t)}addControllers(...t){this._each("register",t,this.controllers)}addElements(...t){this._each("register",t,this.elements)}addPlugins(...t){this._each("register",t,this.plugins)}addScales(...t){this._each("register",t,this.scales)}getController(t){return this._get(t,this.controllers,"controller")}getElement(t){return this._get(t,this.elements,"element")}getPlugin(t){return this._get(t,this.plugins,"plugin")}getScale(t){return this._get(t,this.scales,"scale")}removeControllers(...t){this._each("unregister",t,this.controllers)}removeElements(...t){this._each("unregister",t,this.elements)}removePlugins(...t){this._each("unregister",t,this.plugins)}removeScales(...t){this._each("unregister",t,this.scales)}_each(t,e,i){[...e].forEach(r=>{let s=i||this._getRegistryForType(r);i||s.isForType(r)||s===this.plugins&&r.id?this._exec(t,s,r):bt(r,o=>{let a=i||this._getRegistryForType(o);this._exec(t,a,o)})})}_exec(t,e,i){let r=Th(t);St(i["before"+r],[],i),e[t](i),St(i["after"+r],[],i)}_getRegistryForType(t){for(let e=0;e<this._typedRegistries.length;e++){let i=this._typedRegistries[e];if(i.isForType(t))return i}return this.plugins}_get(t,e,i){let r=e.get(t);if(r===void 0)throw new Error('"'+t+'" is not a registered '+i+".");return r}},ri=new h_,d_=class{constructor(){this._init=[]}notify(t,e,i,r){e==="beforeInit"&&(this._init=this._createDescriptors(t,!0),this._notify(this._init,t,"install"));let s=r?this._descriptors(t).filter(r):this._descriptors(t),o=this._notify(s,t,e,i);return e==="afterDestroy"&&(this._notify(s,t,"stop"),this._notify(this._init,t,"uninstall")),o}_notify(t,e,i,r){r=r||{};for(let s of t){let o=s.plugin,a=o[i],c=[e,r,s.options];if(St(a,c,o)===!1&&r.cancelable)return!1}return!0}invalidate(){yt(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(t){if(this._cache)return this._cache;let e=this._cache=this._createDescriptors(t);return this._notifyStateChanges(t),e}_createDescriptors(t,e){let i=t&&t.config,r=ct(i.options&&i.options.plugins,{}),s=zk(i);return r===!1&&!e?[]:Uk(t,s,r,e)}_notifyStateChanges(t){let e=this._oldCache||[],i=this._cache,r=(s,o)=>s.filter(a=>!o.some(c=>a.plugin.id===c.plugin.id));this._notify(r(e,i),t,"stop"),this._notify(r(i,e),t,"start")}};function zk(n){let t={},e=[],i=Object.keys(ri.plugins.items);for(let s=0;s<i.length;s++)e.push(ri.getPlugin(i[s]));let r=n.plugins||[];for(let s=0;s<r.length;s++){let o=r[s];e.indexOf(o)===-1&&(e.push(o),t[o.id]=!0)}return{plugins:e,localIds:t}}function jk(n,t){return!t&&n===!1?null:n===!0?{}:n}function Uk(n,{plugins:t,localIds:e},i,r){let s=[],o=n.getContext();for(let a of t){let c=a.id,l=jk(i[c],r);l!==null&&s.push({plugin:a,options:qk(n.config,{plugin:a,local:e[c]},l,o)})}return s}function qk(n,{plugin:t,local:e},i,r){let s=n.pluginScopeKeys(t),o=n.getOptionScopes(i,s);return e&&t.defaults&&o.push(t.defaults),n.createResolver(o,r,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function f_(n,t){let e=Nt.datasets[n]||{};return((t.datasets||{})[n]||{}).indexAxis||t.indexAxis||e.indexAxis||"x"}function Wk(n,t){let e=n;return n==="_index_"?e=t:n==="_value_"&&(e=t==="x"?"y":"x"),e}function Hk(n,t){return n===t?"_index_":"_value_"}function aT(n){if(n==="x"||n==="y"||n==="r")return n}function Gk(n){if(n==="top"||n==="bottom")return"x";if(n==="left"||n==="right")return"y"}function p_(n,...t){if(aT(n))return n;for(let e of t){let i=e.axis||Gk(e.position)||n.length>1&&aT(n[0].toLowerCase());if(i)return i}throw new Error(`Cannot determine type of '${n}' axis. Please provide 'axis' or 'position' option.`)}function cT(n,t,e){if(e[t+"AxisID"]===n)return{axis:t}}function $k(n,t){if(t.data&&t.data.datasets){let e=t.data.datasets.filter(i=>i.xAxisID===n||i.yAxisID===n);if(e.length)return cT(n,"x",e[0])||cT(n,"y",e[0])}return{}}function Kk(n,t){let e=gr[n.type]||{scales:{}},i=t.scales||{},r=f_(n.type,t),s=Object.create(null);return Object.keys(i).forEach(o=>{let a=i[o];if(!dt(a))return console.error(`Invalid scale configuration for scale: ${o}`);if(a._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${o}`);let c=p_(o,a,$k(o,n),Nt.scales[a.type]),l=Hk(c,r),h=e.scales||{};s[o]=zo(Object.create(null),[{axis:c},a,h[c],h[l]])}),n.data.datasets.forEach(o=>{let a=o.type||n.type,c=o.indexAxis||f_(a,t),h=(gr[a]||{}).scales||{};Object.keys(h).forEach(d=>{let p=Wk(d,c),g=o[p+"AxisID"]||p;s[g]=s[g]||Object.create(null),zo(s[g],[{axis:p},i[g],h[d]])})}),Object.keys(s).forEach(o=>{let a=s[o];zo(a,[Nt.scales[a.type],Nt.scale])}),s}function YT(n){let t=n.options||(n.options={});t.plugins=ct(t.plugins,{}),t.scales=Kk(n,t)}function QT(n){return n=n||{},n.datasets=n.datasets||[],n.labels=n.labels||[],n}function Yk(n){return n=n||{},n.data=QT(n.data),YT(n),n}var lT=new Map,XT=new Set;function Nh(n,t){let e=lT.get(n);return e||(e=t(),lT.set(n,e),XT.add(e)),e}var Fc=(n,t,e)=>{let i=Pi(t,e);i!==void 0&&n.add(i)},g_=class{constructor(t){this._config=Yk(t),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(t){this._config.type=t}get data(){return this._config.data}set data(t){this._config.data=QT(t)}get options(){return this._config.options}set options(t){this._config.options=t}get plugins(){return this._config.plugins}update(){let t=this._config;this.clearCache(),YT(t)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(t){return Nh(t,()=>[[`datasets.${t}`,""]])}datasetAnimationScopeKeys(t,e){return Nh(`${t}.transition.${e}`,()=>[[`datasets.${t}.transitions.${e}`,`transitions.${e}`],[`datasets.${t}`,""]])}datasetElementScopeKeys(t,e){return Nh(`${t}-${e}`,()=>[[`datasets.${t}.elements.${e}`,`datasets.${t}`,`elements.${e}`,""]])}pluginScopeKeys(t){let e=t.id,i=this.type;return Nh(`${i}-plugin-${e}`,()=>[[`plugins.${e}`,...t.additionalOptionScopes||[]]])}_cachedScopes(t,e){let i=this._scopeCache,r=i.get(t);return(!r||e)&&(r=new Map,i.set(t,r)),r}getOptionScopes(t,e,i){let{options:r,type:s}=this,o=this._cachedScopes(t,i),a=o.get(e);if(a)return a;let c=new Set;e.forEach(h=>{t&&(c.add(t),h.forEach(d=>Fc(c,t,d))),h.forEach(d=>Fc(c,r,d)),h.forEach(d=>Fc(c,gr[s]||{},d)),h.forEach(d=>Fc(c,Nt,d)),h.forEach(d=>Fc(c,Ah,d))});let l=Array.from(c);return l.length===0&&l.push(Object.create(null)),XT.has(e)&&o.set(e,l),l}chartOptionScopes(){let{options:t,type:e}=this;return[t,gr[e]||{},Nt.datasets[e]||{},{type:e},Nt,Ah]}resolveNamedOptions(t,e,i,r=[""]){let s={$shared:!0},{resolver:o,subPrefixes:a}=uT(this._resolverCache,t,r),c=o;if(Xk(o,e)){s.$shared=!1,i=Ai(i)?i():i;let l=this.createResolver(t,i,a);c=xs(o,i,l)}for(let l of e)s[l]=c[l];return s}createResolver(t,e,i=[""],r){let{resolver:s}=uT(this._resolverCache,t,i);return dt(e)?xs(s,e,void 0,r):s}};function uT(n,t,e){let i=n.get(t);i||(i=new Map,n.set(t,i));let r=e.join(),s=i.get(r);return s||(s={resolver:kh(t,e),subPrefixes:e.filter(a=>!a.toLowerCase().includes("hover"))},i.set(r,s)),s}var Qk=n=>dt(n)&&Object.getOwnPropertyNames(n).some(t=>Ai(n[t]));function Xk(n,t){let{isScriptable:e,isIndexable:i}=jm(n);for(let r of t){let s=e(r),o=i(r),a=(o||s)&&n[r];if(s&&(Ai(a)||Qk(a))||o&&kt(a))return!0}return!1}var Jk="4.4.4",Zk=["top","bottom","left","right","chartArea"];function hT(n,t){return n==="top"||n==="bottom"||Zk.indexOf(n)===-1&&t==="x"}function dT(n,t){return function(e,i){return e[n]===i[n]?e[t]-i[t]:e[n]-i[n]}}function fT(n){let t=n.chart,e=t.options.animation;t.notifyPlugins("afterRender"),St(e&&e.onComplete,[n],t)}function tR(n){let t=n.chart,e=t.options.animation;St(e&&e.onProgress,[n],t)}function JT(n){return Rh()&&typeof n=="string"?n=document.getElementById(n):n&&n.length&&(n=n[0]),n&&n.canvas&&(n=n.canvas),n}var Uh={},pT=n=>{let t=JT(n);return Object.values(Uh).filter(e=>e.canvas===t).pop()};function eR(n,t,e){let i=Object.keys(n);for(let r of i){let s=+r;if(s>=t){let o=n[r];delete n[r],(e>0||s>t)&&(n[s+e]=o)}}}function nR(n,t,e,i){return!e||n.type==="mouseout"?null:i?t:n}function Fh(n,t,e){return n.options.clip?n[e]:t[e]}function iR(n,t){let{xScale:e,yScale:i}=n;return e&&i?{left:Fh(e,t,"left"),right:Fh(e,t,"right"),top:Fh(i,t,"top"),bottom:Fh(i,t,"bottom")}:t}var Yh=(()=>{class n{static defaults=Nt;static instances=Uh;static overrides=gr;static registry=ri;static version=Jk;static getChart=pT;static register(...e){ri.add(...e),gT()}static unregister(...e){ri.remove(...e),gT()}constructor(e,i){let r=this.config=new g_(i),s=JT(e),o=pT(s);if(o)throw new Error("Canvas is already in use. Chart with ID '"+o.id+"' must be destroyed before the canvas with ID '"+o.canvas.id+"' can be reused.");let a=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||Tk(s)),this.platform.updateConfig(r);let c=this.platform.acquireContext(s,a.aspectRatio),l=c&&c.canvas,h=l&&l.height,d=l&&l.width;if(this.id=dw(),this.ctx=c,this.canvas=l,this.width=d,this.height=h,this._options=a,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new d_,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Tw(p=>this.update(p),a.resizeDelay||0),this._dataChanges=[],Uh[this.id]=this,!c||!l){console.error("Failed to create chart: can't acquire context from the given item");return}Ri.listen(this,"complete",fT),Ri.listen(this,"progress",tR),this._initialize(),this.attached&&this.update()}get aspectRatio(){let{options:{aspectRatio:e,maintainAspectRatio:i},width:r,height:s,_aspectRatio:o}=this;return yt(e)?i&&o?o:s?r/s:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return ri}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():Hm(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return Lm(this.canvas,this.ctx),this}stop(){return Ri.stop(this),this}resize(e,i){Ri.running(this)?this._resizeBeforeDraw={width:e,height:i}:this._resize(e,i)}_resize(e,i){let r=this.options,s=this.canvas,o=r.maintainAspectRatio&&this.aspectRatio,a=this.platform.getMaximumSize(s,e,i,o),c=r.devicePixelRatio||this.platform.getDevicePixelRatio(),l=this.width?"resize":"attach";this.width=a.width,this.height=a.height,this._aspectRatio=this.aspectRatio,Hm(this,c,!0)&&(this.notifyPlugins("resize",{size:a}),St(r.onResize,[this,a],this),this.attached&&this._doResize(l)&&this.render())}ensureScalesHaveIDs(){let i=this.options.scales||{};bt(i,(r,s)=>{r.id=s})}buildOrUpdateScales(){let e=this.options,i=e.scales,r=this.scales,s=Object.keys(r).reduce((a,c)=>(a[c]=!1,a),{}),o=[];i&&(o=o.concat(Object.keys(i).map(a=>{let c=i[a],l=p_(a,c),h=l==="r",d=l==="x";return{options:c,dposition:h?"chartArea":d?"bottom":"left",dtype:h?"radialLinear":d?"category":"linear"}}))),bt(o,a=>{let c=a.options,l=c.id,h=p_(l,c),d=ct(c.type,a.dtype);(c.position===void 0||hT(c.position,h)!==hT(a.dposition))&&(c.position=a.dposition),s[l]=!0;let p=null;if(l in r&&r[l].type===d)p=r[l];else{let g=ri.getScale(d);p=new g({id:l,type:d,ctx:this.ctx,chart:this}),r[p.id]=p}p.init(c,e)}),bt(s,(a,c)=>{a||delete r[c]}),bt(r,a=>{Fe.configure(this,a,a.options),Fe.addBox(this,a)})}_updateMetasets(){let e=this._metasets,i=this.data.datasets.length,r=e.length;if(e.sort((s,o)=>s.index-o.index),r>i){for(let s=i;s<r;++s)this._destroyDatasetMeta(s);e.splice(i,r-i)}this._sortedMetasets=e.slice(0).sort(dT("order","index"))}_removeUnreferencedMetasets(){let{_metasets:e,data:{datasets:i}}=this;e.length>i.length&&delete this._stacks,e.forEach((r,s)=>{i.filter(o=>o===r._dataset).length===0&&this._destroyDatasetMeta(s)})}buildOrUpdateControllers(){let e=[],i=this.data.datasets,r,s;for(this._removeUnreferencedMetasets(),r=0,s=i.length;r<s;r++){let o=i[r],a=this.getDatasetMeta(r),c=o.type||this.config.type;if(a.type&&a.type!==c&&(this._destroyDatasetMeta(r),a=this.getDatasetMeta(r)),a.type=c,a.indexAxis=o.indexAxis||f_(c,this.options),a.order=o.order||0,a.index=r,a.label=""+o.label,a.visible=this.isDatasetVisible(r),a.controller)a.controller.updateIndex(r),a.controller.linkScales();else{let l=ri.getController(c),{datasetElementType:h,dataElementType:d}=Nt.datasets[c];Object.assign(l,{dataElementType:ri.getElement(d),datasetElementType:h&&ri.getElement(h)}),a.controller=new l(this,r),e.push(a.controller)}}return this._updateMetasets(),e}_resetElements(){bt(this.data.datasets,(e,i)=>{this.getDatasetMeta(i).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){let i=this.config;i.update();let r=this._options=i.createResolver(i.chartOptionScopes(),this.getContext()),s=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;let o=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let a=0;for(let h=0,d=this.data.datasets.length;h<d;h++){let{controller:p}=this.getDatasetMeta(h),g=!s&&o.indexOf(p)===-1;p.buildOrUpdateElements(g),a=Math.max(+p.getMaxOverflow(),a)}a=this._minPadding=r.layout.autoPadding?a:0,this._updateLayout(a),s||bt(o,h=>{h.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(dT("z","_idx"));let{_active:c,_lastEvent:l}=this;l?this._eventHandler(l,!0):c.length&&this._updateHoverStyles(c,c,!0),this.render()}_updateScales(){bt(this.scales,e=>{Fe.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){let e=this.options,i=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!Im(i,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){let{_hiddenIndices:e}=this,i=this._getUniformDataChanges()||[];for(let{method:r,start:s,count:o}of i){let a=r==="_removeElements"?-o:o;eR(e,s,a)}}_getUniformDataChanges(){let e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];let i=this.data.datasets.length,r=o=>new Set(e.filter(a=>a[0]===o).map((a,c)=>c+","+a.splice(1).join(","))),s=r(0);for(let o=1;o<i;o++)if(!Im(s,r(o)))return;return Array.from(s).map(o=>o.split(",")).map(o=>({method:o[1],start:+o[2],count:+o[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Fe.update(this,this.width,this.height,e);let i=this.chartArea,r=i.width<=0||i.height<=0;this._layers=[],bt(this.boxes,s=>{r&&s.position==="chartArea"||(s.configure&&s.configure(),this._layers.push(...s._layers()))},this),this._layers.forEach((s,o)=>{s._idx=o}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let i=0,r=this.data.datasets.length;i<r;++i)this.getDatasetMeta(i).controller.configure();for(let i=0,r=this.data.datasets.length;i<r;++i)this._updateDataset(i,Ai(e)?e({datasetIndex:i}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,i){let r=this.getDatasetMeta(e),s={meta:r,index:e,mode:i,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",s)!==!1&&(r.controller._update(i),s.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",s))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(Ri.has(this)?this.attached&&!Ri.running(this)&&Ri.start(this):(this.draw(),fT({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){let{width:r,height:s}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,s)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;let i=this._layers;for(e=0;e<i.length&&i[e].z<=0;++e)i[e].draw(this.chartArea);for(this._drawDatasets();e<i.length;++e)i[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){let i=this._sortedMetasets,r=[],s,o;for(s=0,o=i.length;s<o;++s){let a=i[s];(!e||a.visible)&&r.push(a)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;let e=this.getSortedVisibleDatasetMetas();for(let i=e.length-1;i>=0;--i)this._drawDataset(e[i]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){let i=this.ctx,r=e._clip,s=!r.disabled,o=iR(e,this.chartArea),a={meta:e,index:e.index,cancelable:!0};this.notifyPlugins("beforeDatasetDraw",a)!==!1&&(s&&Rc(i,{left:r.left===!1?0:o.left-r.left,right:r.right===!1?this.width:o.right+r.right,top:r.top===!1?0:o.top-r.top,bottom:r.bottom===!1?this.height:o.bottom+r.bottom}),e.controller.draw(),s&&Dc(i),a.cancelable=!1,this.notifyPlugins("afterDatasetDraw",a))}isPointInArea(e){return ti(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,i,r,s){let o=rk.modes[i];return typeof o=="function"?o(this,e,r,s):[]}getDatasetMeta(e){let i=this.data.datasets[e],r=this._metasets,s=r.filter(o=>o&&o._dataset===i).pop();return s||(s={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:i&&i.order||0,index:e,_dataset:i,_parsed:[],_sorted:!1},r.push(s)),s}getContext(){return this.$context||(this.$context=ki(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){let i=this.data.datasets[e];if(!i)return!1;let r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!i.hidden}setDatasetVisibility(e,i){let r=this.getDatasetMeta(e);r.hidden=!i}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,i,r){let s=r?"show":"hide",o=this.getDatasetMeta(e),a=o.controller._resolveAnimations(void 0,s);jo(i)?(o.data[i].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),a.update(o,{visible:r}),this.update(c=>c.datasetIndex===e?s:void 0))}hide(e,i){this._updateVisibility(e,i,!1)}show(e,i){this._updateVisibility(e,i,!0)}_destroyDatasetMeta(e){let i=this._metasets[e];i&&i.controller&&i.controller._destroy(),delete this._metasets[e]}_stop(){let e,i;for(this.stop(),Ri.remove(this),e=0,i=this.data.datasets.length;e<i;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");let{canvas:e,ctx:i}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),Lm(e,i),this.platform.releaseContext(i),this.canvas=null,this.ctx=null),delete Uh[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){let e=this._listeners,i=this.platform,r=(o,a)=>{i.addEventListener(this,o,a),e[o]=a},s=(o,a,c)=>{o.offsetX=a,o.offsetY=c,this._eventHandler(o)};bt(this.options.events,o=>r(o,s))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});let e=this._responsiveListeners,i=this.platform,r=(l,h)=>{i.addEventListener(this,l,h),e[l]=h},s=(l,h)=>{e[l]&&(i.removeEventListener(this,l,h),delete e[l])},o=(l,h)=>{this.canvas&&this.resize(l,h)},a,c=()=>{s("attach",c),this.attached=!0,this.resize(),r("resize",o),r("detach",a)};a=()=>{this.attached=!1,s("resize",o),this._stop(),this._resize(0,0),r("attach",c)},i.isAttached(this.canvas)?c():a()}unbindEvents(){bt(this._listeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._listeners={},bt(this._responsiveListeners,(e,i)=>{this.platform.removeEventListener(this,i,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,i,r){let s=r?"set":"remove",o,a,c,l;for(i==="dataset"&&(o=this.getDatasetMeta(e[0].datasetIndex),o.controller["_"+s+"DatasetHoverStyle"]()),c=0,l=e.length;c<l;++c){a=e[c];let h=a&&this.getDatasetMeta(a.datasetIndex).controller;h&&h[s+"HoverStyle"](a.element,a.datasetIndex,a.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){let i=this._active||[],r=e.map(({datasetIndex:o,index:a})=>{let c=this.getDatasetMeta(o);if(!c)throw new Error("No dataset found at index "+o);return{datasetIndex:o,element:c.data[a],index:a}});!Pc(r,i)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,i))}notifyPlugins(e,i,r){return this._plugins.notify(this,e,i,r)}isPluginEnabled(e){return this._plugins._cache.filter(i=>i.plugin.id===e).length===1}_updateHoverStyles(e,i,r){let s=this.options.hover,o=(l,h)=>l.filter(d=>!h.some(p=>d.datasetIndex===p.datasetIndex&&d.index===p.index)),a=o(i,e),c=r?e:o(e,i);a.length&&this.updateHoverStyle(a,s.mode,!1),c.length&&s.mode&&this.updateHoverStyle(c,s.mode,!0)}_eventHandler(e,i){let r={event:e,replay:i,cancelable:!0,inChartArea:this.isPointInArea(e)},s=a=>(a.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,s)===!1)return;let o=this._handleEvent(e,i,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,s),(o||r.changed)&&this.render(),this}_handleEvent(e,i,r){let{_active:s=[],options:o}=this,a=i,c=this._getActiveElements(e,s,r,a),l=gw(e),h=nR(e,this._lastEvent,r,l);r&&(this._lastEvent=null,St(o.onHover,[e,c,this],this),l&&St(o.onClick,[e,c,this],this));let d=!Pc(c,s);return(d||i)&&(this._active=c,this._updateHoverStyles(c,s,i)),this._lastEvent=h,d}_getActiveElements(e,i,r,s){if(e.type==="mouseout")return[];if(!r)return i;let o=this.options.hover;return this.getElementsAtEventForMode(e,o.mode,o,s)}}return n})();function gT(){return bt(Yh.instances,n=>n._plugins.invalidate())}function rR(n,t,e){let{startAngle:i,pixelMargin:r,x:s,y:o,outerRadius:a,innerRadius:c}=t,l=r/a;n.beginPath(),n.arc(s,o,a,i-l,e+l),c>r?(l=r/c,n.arc(s,o,c,e+l,i-l,!0)):n.arc(s,o,r,e+Yt,i-Yt),n.closePath(),n.clip()}function sR(n){return Ph(n,["outerStart","outerEnd","innerStart","innerEnd"])}function oR(n,t,e,i){let r=sR(n.options.borderRadius),s=(e-t)/2,o=Math.min(s,i*t/2),a=c=>{let l=(e-Math.min(s,c))*i/2;return fe(c,0,Math.min(s,l))};return{outerStart:a(r.outerStart),outerEnd:a(r.outerEnd),innerStart:fe(r.innerStart,0,o),innerEnd:fe(r.innerEnd,0,o)}}function $o(n,t,e,i){return{x:e+n*Math.cos(t),y:i+n*Math.sin(t)}}function Gh(n,t,e,i,r,s){let{x:o,y:a,startAngle:c,pixelMargin:l,innerRadius:h}=t,d=Math.max(t.outerRadius+i+e-l,0),p=h>0?h+i+e+l:0,g=0,y=r-c;if(i){let ft=h>0?h-i:0,xt=d>0?d-i:0,wt=(ft+xt)/2,te=wt!==0?y*wt/(wt+i):y;g=(y-te)/2}let v=Math.max(.001,y*d-e/Rt)/d,w=(y-v)/2,k=c+w+g,R=r-w-g,{outerStart:M,outerEnd:F,innerStart:V,innerEnd:L}=oR(t,p,d,R-k),I=d-M,b=d-F,E=k+M/I,A=R-F/b,P=p+V,D=p+L,S=k+V/P,Mt=R-L/D;if(n.beginPath(),s){let ft=(E+A)/2;if(n.arc(o,a,d,E,ft),n.arc(o,a,d,ft,A),F>0){let Wt=$o(b,A,o,a);n.arc(Wt.x,Wt.y,F,A,R+Yt)}let xt=$o(D,R,o,a);if(n.lineTo(xt.x,xt.y),L>0){let Wt=$o(D,Mt,o,a);n.arc(Wt.x,Wt.y,L,R+Yt,Mt+Math.PI)}let wt=(R-L/p+(k+V/p))/2;if(n.arc(o,a,p,R-L/p,wt,!0),n.arc(o,a,p,wt,k+V/p,!0),V>0){let Wt=$o(P,S,o,a);n.arc(Wt.x,Wt.y,V,S+Math.PI,k-Yt)}let te=$o(I,k,o,a);if(n.lineTo(te.x,te.y),M>0){let Wt=$o(I,E,o,a);n.arc(Wt.x,Wt.y,M,k-Yt,E)}}else{n.moveTo(o,a);let ft=Math.cos(E)*d+o,xt=Math.sin(E)*d+a;n.lineTo(ft,xt);let wt=Math.cos(A)*d+o,te=Math.sin(A)*d+a;n.lineTo(wt,te)}n.closePath()}function aR(n,t,e,i,r){let{fullCircles:s,startAngle:o,circumference:a}=t,c=t.endAngle;if(s){Gh(n,t,e,i,c,r);for(let l=0;l<s;++l)n.fill();isNaN(a)||(c=o+(a%Dt||Dt))}return Gh(n,t,e,i,c,r),n.fill(),c}function cR(n,t,e,i,r){let{fullCircles:s,startAngle:o,circumference:a,options:c}=t,{borderWidth:l,borderJoinStyle:h,borderDash:d,borderDashOffset:p}=c,g=c.borderAlign==="inner";if(!l)return;n.setLineDash(d||[]),n.lineDashOffset=p,g?(n.lineWidth=l*2,n.lineJoin=h||"round"):(n.lineWidth=l,n.lineJoin=h||"bevel");let y=t.endAngle;if(s){Gh(n,t,e,i,y,r);for(let v=0;v<s;++v)n.stroke();isNaN(a)||(y=o+(a%Dt||Dt))}g&&rR(n,t,y),s||(Gh(n,t,e,i,y,r),n.stroke())}var m_=class extends Ln{static id="arc";static defaults={borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0};static defaultRoutes={backgroundColor:"backgroundColor"};static descriptors={_scriptable:!0,_indexable:t=>t!=="borderDash"};circumference;endAngle;fullCircles;innerRadius;outerRadius;pixelMargin;startAngle;constructor(t){super(),this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,t&&Object.assign(this,t)}inRange(t,e,i){let r=this.getProps(["x","y"],i),{angle:s,distance:o}=Pm(r,{x:t,y:e}),{startAngle:a,endAngle:c,innerRadius:l,outerRadius:h,circumference:d}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],i),p=(this.options.spacing+this.options.borderWidth)/2,g=ct(d,c-a),y=qo(s,a,c)&&a!==c,v=g>=Dt||y,w=ni(o,l+p,h+p);return v&&w}getCenterPoint(t){let{x:e,y:i,startAngle:r,endAngle:s,innerRadius:o,outerRadius:a}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],t),{offset:c,spacing:l}=this.options,h=(r+s)/2,d=(o+a+l+c)/2;return{x:e+Math.cos(h)*d,y:i+Math.sin(h)*d}}tooltipPosition(t){return this.getCenterPoint(t)}draw(t){let{options:e,circumference:i}=this,r=(e.offset||0)/4,s=(e.spacing||0)/2,o=e.circular;if(this.pixelMargin=e.borderAlign==="inner"?.33:0,this.fullCircles=i>Dt?Math.floor(i/Dt):0,i===0||this.innerRadius<0||this.outerRadius<0)return;t.save();let a=(this.startAngle+this.endAngle)/2;t.translate(Math.cos(a)*r,Math.sin(a)*r);let c=1-Math.sin(Math.min(Rt,i||0)),l=r*c;t.fillStyle=e.backgroundColor,t.strokeStyle=e.borderColor,aR(t,this,l,s,o),cR(t,this,l,s,o),t.restore()}};function ZT(n,t,e=t){n.lineCap=ct(e.borderCapStyle,t.borderCapStyle),n.setLineDash(ct(e.borderDash,t.borderDash)),n.lineDashOffset=ct(e.borderDashOffset,t.borderDashOffset),n.lineJoin=ct(e.borderJoinStyle,t.borderJoinStyle),n.lineWidth=ct(e.borderWidth,t.borderWidth),n.strokeStyle=ct(e.borderColor,t.borderColor)}function lR(n,t,e){n.lineTo(e.x,e.y)}function uR(n){return n.stepped?Aw:n.tension||n.cubicInterpolationMode==="monotone"?Cw:lR}function tE(n,t,e={}){let i=n.length,{start:r=0,end:s=i-1}=e,{start:o,end:a}=t,c=Math.max(r,o),l=Math.min(s,a),h=r<o&&s<o||r>a&&s>a;return{count:i,start:c,loop:t.loop,ilen:l<c&&!h?i+l-c:l-c}}function hR(n,t,e,i){let{points:r,options:s}=t,{count:o,start:a,loop:c,ilen:l}=tE(r,e,i),h=uR(s),{move:d=!0,reverse:p}=i||{},g,y,v;for(g=0;g<=l;++g)y=r[(a+(p?l-g:g))%o],!y.skip&&(d?(n.moveTo(y.x,y.y),d=!1):h(n,v,y,p,s.stepped),v=y);return c&&(y=r[(a+(p?l:0))%o],h(n,v,y,p,s.stepped)),!!c}function dR(n,t,e,i){let r=t.points,{count:s,start:o,ilen:a}=tE(r,e,i),{move:c=!0,reverse:l}=i||{},h=0,d=0,p,g,y,v,w,k,R=F=>(o+(l?a-F:F))%s,M=()=>{v!==w&&(n.lineTo(h,w),n.lineTo(h,v),n.lineTo(h,k))};for(c&&(g=r[R(0)],n.moveTo(g.x,g.y)),p=0;p<=a;++p){if(g=r[R(p)],g.skip)continue;let F=g.x,V=g.y,L=F|0;L===y?(V<v?v=V:V>w&&(w=V),h=(d*h+F)/++d):(M(),n.lineTo(F,V),y=L,d=0,v=w=V),k=V}M()}function __(n){let t=n.options,e=t.borderDash&&t.borderDash.length;return!n._decimated&&!n._loop&&!t.tension&&t.cubicInterpolationMode!=="monotone"&&!t.stepped&&!e?dR:hR}function fR(n){return n.stepped?Fw:n.tension||n.cubicInterpolationMode==="monotone"?Lw:pr}function pR(n,t,e,i){let r=t._path;r||(r=t._path=new Path2D,t.path(r,e,i)&&r.closePath()),ZT(n,t.options),n.stroke(r)}function gR(n,t,e,i){let{segments:r,options:s}=t,o=__(t);for(let a of r)ZT(n,s,a.style),n.beginPath(),o(n,t,a,{start:e,end:e+i-1})&&n.closePath(),n.stroke()}var mR=typeof Path2D=="function";function _R(n,t,e,i){mR&&!t.options.segment?pR(n,t,e,i):gR(n,t,e,i)}var Qh=(()=>{class n extends Ln{static id="line";static defaults={borderCapStyle:"butt",borderDash:[],borderDashOffset:0,borderJoinStyle:"miter",borderWidth:3,capBezierPoints:!0,cubicInterpolationMode:"default",fill:!1,spanGaps:!1,stepped:!1,tension:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};static descriptors={_scriptable:!0,_indexable:e=>e!=="borderDash"&&e!=="fill"};constructor(e){super(),this.animated=!0,this.options=void 0,this._chart=void 0,this._loop=void 0,this._fullLoop=void 0,this._path=void 0,this._points=void 0,this._segments=void 0,this._decimated=!1,this._pointsUpdated=!1,this._datasetIndex=void 0,e&&Object.assign(this,e)}updateControlPoints(e,i){let r=this.options;if((r.tension||r.cubicInterpolationMode==="monotone")&&!r.stepped&&!this._pointsUpdated){let s=r.spanGaps?this._loop:this._fullLoop;Ow(this._points,r,e,s,i),this._pointsUpdated=!0}}set points(e){this._points=e,delete this._segments,delete this._path,this._pointsUpdated=!1}get points(){return this._points}get segments(){return this._segments||(this._segments=zw(this,this.options.segment))}first(){let e=this.segments,i=this.points;return e.length&&i[e[0].start]}last(){let e=this.segments,i=this.points,r=e.length;return r&&i[e[r-1].end]}interpolate(e,i){let r=this.options,s=e[i],o=this.points,a=Qm(this,{property:i,start:s,end:s});if(!a.length)return;let c=[],l=fR(r),h,d;for(h=0,d=a.length;h<d;++h){let{start:p,end:g}=a[h],y=o[p],v=o[g];if(y===v){c.push(y);continue}let w=Math.abs((s-y[i])/(v[i]-y[i])),k=l(y,v,w,r.stepped);k[i]=e[i],c.push(k)}return c.length===1?c[0]:c}pathSegment(e,i,r){return __(this)(e,this,i,r)}path(e,i,r){let s=this.segments,o=__(this),a=this._loop;i=i||0,r=r||this.points.length-i;for(let c of s)a&=o(e,this,c,{start:i,end:i+r-1});return!!a}draw(e,i,r,s){let o=this.options||{};(this.points||[]).length&&o.borderWidth&&(e.save(),_R(e,this,r,s),e.restore()),this.animated&&(this._pointsUpdated=!1,this._path=void 0)}}return n})();function mT(n,t,e,i){let r=n.options,{[e]:s}=n.getProps([e],i);return Math.abs(t-s)<r.radius+r.hitRadius}var yR=(()=>{class n extends Ln{static id="point";parsed;skip;stop;static defaults={borderWidth:1,hitRadius:1,hoverBorderWidth:1,hoverRadius:4,pointStyle:"circle",radius:3,rotation:0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(e){super(),this.options=void 0,this.parsed=void 0,this.skip=void 0,this.stop=void 0,e&&Object.assign(this,e)}inRange(e,i,r){let s=this.options,{x:o,y:a}=this.getProps(["x","y"],r);return Math.pow(e-o,2)+Math.pow(i-a,2)<Math.pow(s.hitRadius+s.radius,2)}inXRange(e,i){return mT(this,e,"x",i)}inYRange(e,i){return mT(this,e,"y",i)}getCenterPoint(e){let{x:i,y:r}=this.getProps(["x","y"],e);return{x:i,y:r}}size(e){e=e||this.options||{};let i=e.radius||0;i=Math.max(i,i&&e.hoverRadius||0);let r=i&&e.borderWidth||0;return(i+r)*2}draw(e,i){let r=this.options;this.skip||r.radius<.1||!ti(this,i,this.size(r)/2)||(e.strokeStyle=r.borderColor,e.lineWidth=r.borderWidth,e.fillStyle=r.backgroundColor,Ch(e,r,this.x,this.y))}getRange(){let e=this.options||{};return e.radius+e.hitRadius}}return n})();function eE(n,t){let{x:e,y:i,base:r,width:s,height:o}=n.getProps(["x","y","base","width","height"],t),a,c,l,h,d;return n.horizontal?(d=o/2,a=Math.min(e,r),c=Math.max(e,r),l=i-d,h=i+d):(d=s/2,a=e-d,c=e+d,l=Math.min(i,r),h=Math.max(i,r)),{left:a,top:l,right:c,bottom:h}}function br(n,t,e,i){return n?0:fe(t,e,i)}function vR(n,t,e){let i=n.options.borderWidth,r=n.borderSkipped,s=zm(i);return{t:br(r.top,s.top,0,e),r:br(r.right,s.right,0,t),b:br(r.bottom,s.bottom,0,e),l:br(r.left,s.left,0,t)}}function bR(n,t,e){let{enableBorderRadius:i}=n.getProps(["enableBorderRadius"]),r=n.options.borderRadius,s=yr(r),o=Math.min(t,e),a=n.borderSkipped,c=i||dt(r);return{topLeft:br(!c||a.top||a.left,s.topLeft,0,o),topRight:br(!c||a.top||a.right,s.topRight,0,o),bottomLeft:br(!c||a.bottom||a.left,s.bottomLeft,0,o),bottomRight:br(!c||a.bottom||a.right,s.bottomRight,0,o)}}function xR(n){let t=eE(n),e=t.right-t.left,i=t.bottom-t.top,r=vR(n,e/2,i/2),s=bR(n,e/2,i/2);return{outer:{x:t.left,y:t.top,w:e,h:i,radius:s},inner:{x:t.left+r.l,y:t.top+r.t,w:e-r.l-r.r,h:i-r.t-r.b,radius:{topLeft:Math.max(0,s.topLeft-Math.max(r.t,r.l)),topRight:Math.max(0,s.topRight-Math.max(r.t,r.r)),bottomLeft:Math.max(0,s.bottomLeft-Math.max(r.b,r.l)),bottomRight:Math.max(0,s.bottomRight-Math.max(r.b,r.r))}}}}function i_(n,t,e,i){let r=t===null,s=e===null,a=n&&!(r&&s)&&eE(n,i);return a&&(r||ni(t,a.left,a.right))&&(s||ni(e,a.top,a.bottom))}function wR(n){return n.topLeft||n.topRight||n.bottomLeft||n.bottomRight}function TR(n,t){n.rect(t.x,t.y,t.w,t.h)}function r_(n,t,e={}){let i=n.x!==e.x?-t:0,r=n.y!==e.y?-t:0,s=(n.x+n.w!==e.x+e.w?t:0)-i,o=(n.y+n.h!==e.y+e.h?t:0)-r;return{x:n.x+i,y:n.y+r,w:n.w+s,h:n.h+o,radius:n.radius}}var y_=class extends Ln{static id="bar";static defaults={borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0};static defaultRoutes={backgroundColor:"backgroundColor",borderColor:"borderColor"};constructor(t){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,t&&Object.assign(this,t)}draw(t){let{inflateAmount:e,options:{borderColor:i,backgroundColor:r}}=this,{inner:s,outer:o}=xR(this),a=wR(o.radius)?Ho:TR;t.save(),(o.w!==s.w||o.h!==s.h)&&(t.beginPath(),a(t,r_(o,e,s)),t.clip(),a(t,r_(s,-e,o)),t.fillStyle=i,t.fill("evenodd")),t.beginPath(),a(t,r_(s,e)),t.fillStyle=r,t.fill(),t.restore()}inRange(t,e,i){return i_(this,t,e,i)}inXRange(t,e){return i_(this,t,null,e)}inYRange(t,e){return i_(this,null,t,e)}getCenterPoint(t){let{x:e,y:i,base:r,horizontal:s}=this.getProps(["x","y","base","horizontal"],t);return{x:s?(e+r)/2:e,y:s?i:(i+r)/2}}getRange(t){return t==="x"?this.width/2:this.height/2}},ER=Object.freeze({__proto__:null,ArcElement:m_,BarElement:y_,LineElement:Qh,PointElement:yR}),v_=["rgb(54, 162, 235)","rgb(255, 99, 132)","rgb(255, 159, 64)","rgb(255, 205, 86)","rgb(75, 192, 192)","rgb(153, 102, 255)","rgb(201, 203, 207)"],_T=v_.map(n=>n.replace("rgb(","rgba(").replace(")",", 0.5)"));function nE(n){return v_[n%v_.length]}function iE(n){return _T[n%_T.length]}function IR(n,t){return n.borderColor=nE(t),n.backgroundColor=iE(t),++t}function SR(n,t){return n.backgroundColor=n.data.map(()=>nE(t++)),t}function AR(n,t){return n.backgroundColor=n.data.map(()=>iE(t++)),t}function CR(n){let t=0;return(e,i)=>{let r=n.getDatasetMeta(i).controller;r instanceof A_?t=SR(e,t):r instanceof WT?t=AR(e,t):r&&(t=IR(e,t))}}function yT(n){let t;for(t in n)if(n[t].borderColor||n[t].backgroundColor)return!0;return!1}function PR(n){return n&&(n.borderColor||n.backgroundColor)}var kR={id:"colors",defaults:{enabled:!0,forceOverride:!1},beforeLayout(n,t,e){if(!e.enabled)return;let{data:{datasets:i},options:r}=n.config,{elements:s}=r;if(!e.forceOverride&&(yT(i)||PR(r)||s&&yT(s)))return;let o=CR(n);i.forEach(o)}};function RR(n,t,e,i,r){let s=r.samples||i;if(s>=e)return n.slice(t,t+e);let o=[],a=(e-2)/(s-2),c=0,l=t+e-1,h=t,d,p,g,y,v;for(o[c++]=n[h],d=0;d<s-2;d++){let w=0,k=0,R,M=Math.floor((d+1)*a)+1+t,F=Math.min(Math.floor((d+2)*a)+1,e)+t,V=F-M;for(R=M;R<F;R++)w+=n[R].x,k+=n[R].y;w/=V,k/=V;let L=Math.floor(d*a)+1+t,I=Math.min(Math.floor((d+1)*a)+1,e)+t,{x:b,y:E}=n[h];for(g=y=-1,R=L;R<I;R++)y=.5*Math.abs((b-w)*(n[R].y-E)-(b-n[R].x)*(k-E)),y>g&&(g=y,p=n[R],v=R);o[c++]=p,h=v}return o[c++]=n[l],o}function DR(n,t,e,i){let r=0,s=0,o,a,c,l,h,d,p,g,y,v,w=[],k=t+e-1,R=n[t].x,F=n[k].x-R;for(o=t;o<t+e;++o){a=n[o],c=(a.x-R)/F*i,l=a.y;let V=c|0;if(V===h)l<y?(y=l,d=o):l>v&&(v=l,p=o),r=(s*r+a.x)/++s;else{let L=o-1;if(!yt(d)&&!yt(p)){let I=Math.min(d,p),b=Math.max(d,p);I!==g&&I!==L&&w.push(Rn(pn({},n[I]),{x:r})),b!==g&&b!==L&&w.push(Rn(pn({},n[b]),{x:r}))}o>0&&L!==g&&w.push(n[L]),w.push(a),h=V,s=0,y=v=l,d=p=g=o}}return w}function rE(n){if(n._decimated){let t=n._data;delete n._decimated,delete n._data,Object.defineProperty(n,"data",{configurable:!0,enumerable:!0,writable:!0,value:t})}}function vT(n){n.data.datasets.forEach(t=>{rE(t)})}function MR(n,t){let e=t.length,i=0,r,{iScale:s}=n,{min:o,max:a,minDefined:c,maxDefined:l}=s.getUserBounds();return c&&(i=fe(Zn(t,s.axis,o).lo,0,e-1)),l?r=fe(Zn(t,s.axis,a).hi+1,i,e)-i:r=e-i,{start:i,count:r}}var OR={id:"decimation",defaults:{algorithm:"min-max",enabled:!1},beforeElementsUpdate:(n,t,e)=>{if(!e.enabled){vT(n);return}let i=n.width;n.data.datasets.forEach((r,s)=>{let{_data:o,indexAxis:a}=r,c=n.getDatasetMeta(s),l=o||r.data;if(Go([a,n.options.indexAxis])==="y"||!c.controller.supportsDecimation)return;let h=n.scales[c.xAxisID];if(h.type!=="linear"&&h.type!=="time"||n.options.parsing)return;let{start:d,count:p}=MR(c,l),g=e.threshold||4*i;if(p<=g){rE(r);return}yt(o)&&(r._data=l,delete r.data,Object.defineProperty(r,"data",{configurable:!0,enumerable:!0,get:function(){return this._decimated},set:function(v){this._data=v}}));let y;switch(e.algorithm){case"lttb":y=RR(l,d,p,i,e);break;case"min-max":y=DR(l,d,p,i);break;default:throw new Error(`Unsupported decimation algorithm '${e.algorithm}'`)}r._decimated=y})},destroy(n){vT(n)}};function VR(n,t,e){let i=n.segments,r=n.points,s=t.points,o=[];for(let a of i){let{start:c,end:l}=a;l=C_(c,l,r);let h=b_(e,r[c],r[l],a.loop);if(!t.segments){o.push({source:a,target:h,start:r[c],end:r[l]});continue}let d=Qm(t,h);for(let p of d){let g=b_(e,s[p.start],s[p.end],p.loop),y=Ym(a,r,g);for(let v of y)o.push({source:v,target:p,start:{[e]:bT(h,g,"start",Math.max)},end:{[e]:bT(h,g,"end",Math.min)}})}}return o}function b_(n,t,e,i){if(i)return;let r=t[n],s=e[n];return n==="angle"&&(r=Qe(r),s=Qe(s)),{property:n,start:r,end:s}}function NR(n,t){let{x:e=null,y:i=null}=n||{},r=t.points,s=[];return t.segments.forEach(({start:o,end:a})=>{a=C_(o,a,r);let c=r[o],l=r[a];i!==null?(s.push({x:c.x,y:i}),s.push({x:l.x,y:i})):e!==null&&(s.push({x:e,y:c.y}),s.push({x:e,y:l.y}))}),s}function C_(n,t,e){for(;t>n;t--){let i=e[t];if(!isNaN(i.x)&&!isNaN(i.y))break}return t}function bT(n,t,e,i){return n&&t?i(n[e],t[e]):n?n[e]:t?t[e]:0}function sE(n,t){let e=[],i=!1;return kt(n)?(i=!0,e=n):e=NR(n,t),e.length?new Qh({points:e,options:{tension:0},_loop:i,_fullLoop:i}):null}function xT(n){return n&&n.fill!==!1}function FR(n,t,e){let r=n[t].fill,s=[t],o;if(!e)return r;for(;r!==!1&&s.indexOf(r)===-1;){if(!qt(r))return r;if(o=n[r],!o)return!1;if(o.visible)return r;s.push(r),r=o.fill}return!1}function LR(n,t,e){let i=UR(n);if(dt(i))return isNaN(i.value)?!1:i;let r=parseFloat(i);return qt(r)&&Math.floor(r)===r?BR(i[0],t,r,e):["origin","start","end","stack","shape"].indexOf(i)>=0&&i}function BR(n,t,e,i){return(n==="-"||n==="+")&&(e=t+e),e===t||e<0||e>=i?!1:e}function zR(n,t){let e=null;return n==="start"?e=t.bottom:n==="end"?e=t.top:dt(n)?e=t.getPixelForValue(n.value):t.getBasePixel&&(e=t.getBasePixel()),e}function jR(n,t,e){let i;return n==="start"?i=e:n==="end"?i=t.options.reverse?t.min:t.max:dt(n)?i=n.value:i=t.getBaseValue(),i}function UR(n){let t=n.options,e=t.fill,i=ct(e&&e.target,e);return i===void 0&&(i=!!t.backgroundColor),i===!1||i===null?!1:i===!0?"origin":i}function qR(n){let{scale:t,index:e,line:i}=n,r=[],s=i.segments,o=i.points,a=WR(t,e);a.push(sE({x:null,y:t.bottom},i));for(let c=0;c<s.length;c++){let l=s[c];for(let h=l.start;h<=l.end;h++)HR(r,o[h],a)}return new Qh({points:r,options:{}})}function WR(n,t){let e=[],i=n.getMatchingVisibleMetas("line");for(let r=0;r<i.length;r++){let s=i[r];if(s.index===t)break;s.hidden||e.unshift(s.dataset)}return e}function HR(n,t,e){let i=[];for(let r=0;r<e.length;r++){let s=e[r],{first:o,last:a,point:c}=GR(s,t,"x");if(!(!c||o&&a)){if(o)i.unshift(c);else if(n.push(c),!a)break}}n.push(...i)}function GR(n,t,e){let i=n.interpolate(t,e);if(!i)return{};let r=i[e],s=n.segments,o=n.points,a=!1,c=!1;for(let l=0;l<s.length;l++){let h=s[l],d=o[h.start][e],p=o[h.end][e];if(ni(r,d,p)){a=r===d,c=r===p;break}}return{first:a,last:c,point:i}}var $h=class{constructor(t){this.x=t.x,this.y=t.y,this.radius=t.radius}pathSegment(t,e,i){let{x:r,y:s,radius:o}=this;return e=e||{start:0,end:Dt},t.arc(r,s,o,e.end,e.start,!0),!i.bounds}interpolate(t){let{x:e,y:i,radius:r}=this,s=t.angle;return{x:e+Math.cos(s)*r,y:i+Math.sin(s)*r,angle:s}}};function $R(n){let{chart:t,fill:e,line:i}=n;if(qt(e))return KR(t,e);if(e==="stack")return qR(n);if(e==="shape")return!0;let r=YR(n);return r instanceof $h?r:sE(r,i)}function KR(n,t){let e=n.getDatasetMeta(t);return e&&n.isDatasetVisible(t)?e.dataset:null}function YR(n){return(n.scale||{}).getPointPositionForValue?XR(n):QR(n)}function QR(n){let{scale:t={},fill:e}=n,i=zR(e,t);if(qt(i)){let r=t.isHorizontal();return{x:r?i:null,y:r?null:i}}return null}function XR(n){let{scale:t,fill:e}=n,i=t.options,r=t.getLabels().length,s=i.reverse?t.max:t.min,o=jR(e,t,s),a=[];if(i.grid.circular){let c=t.getPointPositionForValue(0,s);return new $h({x:c.x,y:c.y,radius:t.getDistanceFromCenterForValue(o)})}for(let c=0;c<r;++c)a.push(t.getPointPositionForValue(c,o));return a}function s_(n,t,e){let i=$R(t),{line:r,scale:s,axis:o}=t,a=r.options,c=a.fill,l=a.backgroundColor,{above:h=l,below:d=l}=c||{};i&&r.points.length&&(Rc(n,e),JR(n,{line:r,target:i,above:h,below:d,area:e,scale:s,axis:o}),Dc(n))}function JR(n,t){let{line:e,target:i,above:r,below:s,area:o,scale:a}=t,c=e._loop?"angle":t.axis;n.save(),c==="x"&&s!==r&&(wT(n,i,o.top),TT(n,{line:e,target:i,color:r,scale:a,property:c}),n.restore(),n.save(),wT(n,i,o.bottom)),TT(n,{line:e,target:i,color:s,scale:a,property:c}),n.restore()}function wT(n,t,e){let{segments:i,points:r}=t,s=!0,o=!1;n.beginPath();for(let a of i){let{start:c,end:l}=a,h=r[c],d=r[C_(c,l,r)];s?(n.moveTo(h.x,h.y),s=!1):(n.lineTo(h.x,e),n.lineTo(h.x,h.y)),o=!!t.pathSegment(n,a,{move:o}),o?n.closePath():n.lineTo(d.x,e)}n.lineTo(t.first().x,e),n.closePath(),n.clip()}function TT(n,t){let{line:e,target:i,property:r,color:s,scale:o}=t,a=VR(e,i,r);for(let{source:c,target:l,start:h,end:d}of a){let{style:{backgroundColor:p=s}={}}=c,g=i!==!0;n.save(),n.fillStyle=p,ZR(n,o,g&&b_(r,h,d)),n.beginPath();let y=!!e.pathSegment(n,c),v;if(g){y?n.closePath():ET(n,i,d,r);let w=!!i.pathSegment(n,l,{move:y,reverse:!0});v=y&&w,v||ET(n,i,h,r)}n.closePath(),n.fill(v?"evenodd":"nonzero"),n.restore()}}function ZR(n,t,e){let{top:i,bottom:r}=t.chart.chartArea,{property:s,start:o,end:a}=e||{};s==="x"&&(n.beginPath(),n.rect(o,i,a-o,r-i),n.clip())}function ET(n,t,e,i){let r=t.interpolate(e,i);r&&n.lineTo(r.x,r.y)}var tD={id:"filler",afterDatasetsUpdate(n,t,e){let i=(n.data.datasets||[]).length,r=[],s,o,a,c;for(o=0;o<i;++o)s=n.getDatasetMeta(o),a=s.dataset,c=null,a&&a.options&&a instanceof Qh&&(c={visible:n.isDatasetVisible(o),index:o,fill:LR(a,o,i),chart:n,axis:s.controller.options.indexAxis,scale:s.vScale,line:a}),s.$filler=c,r.push(c);for(o=0;o<i;++o)c=r[o],!(!c||c.fill===!1)&&(c.fill=FR(r,o,e.propagate))},beforeDraw(n,t,e){let i=e.drawTime==="beforeDraw",r=n.getSortedVisibleDatasetMetas(),s=n.chartArea;for(let o=r.length-1;o>=0;--o){let a=r[o].$filler;a&&(a.line.updateControlPoints(s,a.axis),i&&a.fill&&s_(n.ctx,a,s))}},beforeDatasetsDraw(n,t,e){if(e.drawTime!=="beforeDatasetsDraw")return;let i=n.getSortedVisibleDatasetMetas();for(let r=i.length-1;r>=0;--r){let s=i[r].$filler;xT(s)&&s_(n.ctx,s,n.chartArea)}},beforeDatasetDraw(n,t,e){let i=t.meta.$filler;!xT(i)||e.drawTime!=="beforeDatasetDraw"||s_(n.ctx,i,n.chartArea)},defaults:{propagate:!0,drawTime:"beforeDatasetDraw"}},IT=(n,t)=>{let{boxHeight:e=t,boxWidth:i=t}=n;return n.usePointStyle&&(e=Math.min(e,t),i=n.pointStyleWidth||Math.min(i,t)),{boxWidth:i,boxHeight:e,itemHeight:Math.max(t,e)}},eD=(n,t)=>n!==null&&t!==null&&n.datasetIndex===t.datasetIndex&&n.index===t.index,Kh=class extends Ln{constructor(t){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e,i){this.maxWidth=t,this.maxHeight=e,this._margins=i,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){let t=this.options.labels||{},e=St(t.generateLabels,[this.chart],this)||[];t.filter&&(e=e.filter(i=>t.filter(i,this.chart.data))),t.sort&&(e=e.sort((i,r)=>t.sort(i,r,this.chart.data))),this.options.reverse&&e.reverse(),this.legendItems=e}fit(){let{options:t,ctx:e}=this;if(!t.display){this.width=this.height=0;return}let i=t.labels,r=ae(i.font),s=r.size,o=this._computeTitleHeight(),{boxWidth:a,itemHeight:c}=IT(i,s),l,h;e.font=r.string,this.isHorizontal()?(l=this.maxWidth,h=this._fitRows(o,s,a,c)+10):(h=this.maxHeight,l=this._fitCols(o,r,a,c)+10),this.width=Math.min(l,t.maxWidth||this.maxWidth),this.height=Math.min(h,t.maxHeight||this.maxHeight)}_fitRows(t,e,i,r){let{ctx:s,maxWidth:o,options:{labels:{padding:a}}}=this,c=this.legendHitBoxes=[],l=this.lineWidths=[0],h=r+a,d=t;s.textAlign="left",s.textBaseline="middle";let p=-1,g=-h;return this.legendItems.forEach((y,v)=>{let w=i+e/2+s.measureText(y.text).width;(v===0||l[l.length-1]+w+2*a>o)&&(d+=h,l[l.length-(v>0?0:1)]=0,g+=h,p++),c[v]={left:0,top:g,row:p,width:w,height:r},l[l.length-1]+=w+a}),d}_fitCols(t,e,i,r){let{ctx:s,maxHeight:o,options:{labels:{padding:a}}}=this,c=this.legendHitBoxes=[],l=this.columnSizes=[],h=o-t,d=a,p=0,g=0,y=0,v=0;return this.legendItems.forEach((w,k)=>{let{itemWidth:R,itemHeight:M}=nD(i,e,s,w,r);k>0&&g+M+2*a>h&&(d+=p+a,l.push({width:p,height:g}),y+=p+a,v++,p=g=0),c[k]={left:y,top:g,col:v,width:R,height:M},p=Math.max(p,R),g+=M+a}),d+=p,l.push({width:p,height:g}),d}adjustHitBoxes(){if(!this.options.display)return;let t=this._computeTitleHeight(),{legendHitBoxes:e,options:{align:i,labels:{padding:r},rtl:s}}=this,o=Ts(s,this.left,this.width);if(this.isHorizontal()){let a=0,c=Ce(i,this.left+r,this.right-this.lineWidths[a]);for(let l of e)a!==l.row&&(a=l.row,c=Ce(i,this.left+r,this.right-this.lineWidths[a])),l.top+=this.top+t+r,l.left=o.leftForLtr(o.x(c),l.width),c+=l.width+r}else{let a=0,c=Ce(i,this.top+t+r,this.bottom-this.columnSizes[a].height);for(let l of e)l.col!==a&&(a=l.col,c=Ce(i,this.top+t+r,this.bottom-this.columnSizes[a].height)),l.top=c,l.left+=this.left+r,l.left=o.leftForLtr(o.x(l.left),l.width),c+=l.height+r}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){let t=this.ctx;Rc(t,this),this._draw(),Dc(t)}}_draw(){let{options:t,columnSizes:e,lineWidths:i,ctx:r}=this,{align:s,labels:o}=t,a=Nt.color,c=Ts(t.rtl,this.left,this.width),l=ae(o.font),{padding:h}=o,d=l.size,p=d/2,g;this.drawTitle(),r.textAlign=c.textAlign("left"),r.textBaseline="middle",r.lineWidth=.5,r.font=l.string;let{boxWidth:y,boxHeight:v,itemHeight:w}=IT(o,d),k=function(L,I,b){if(isNaN(y)||y<=0||isNaN(v)||v<0)return;r.save();let E=ct(b.lineWidth,1);if(r.fillStyle=ct(b.fillStyle,a),r.lineCap=ct(b.lineCap,"butt"),r.lineDashOffset=ct(b.lineDashOffset,0),r.lineJoin=ct(b.lineJoin,"miter"),r.lineWidth=E,r.strokeStyle=ct(b.strokeStyle,a),r.setLineDash(ct(b.lineDash,[])),o.usePointStyle){let A={radius:v*Math.SQRT2/2,pointStyle:b.pointStyle,rotation:b.rotation,borderWidth:E},P=c.xPlus(L,y/2),D=I+p;Bm(r,A,P,D,o.pointStyleWidth&&y)}else{let A=I+Math.max((d-v)/2,0),P=c.leftForLtr(L,y),D=yr(b.borderRadius);r.beginPath(),Object.values(D).some(S=>S!==0)?Ho(r,{x:P,y:A,w:y,h:v,radius:D}):r.rect(P,A,y,v),r.fill(),E!==0&&r.stroke()}r.restore()},R=function(L,I,b){_r(r,b.text,L,I+w/2,l,{strikethrough:b.hidden,textAlign:c.textAlign(b.textAlign)})},M=this.isHorizontal(),F=this._computeTitleHeight();M?g={x:Ce(s,this.left+h,this.right-i[0]),y:this.top+h+F,line:0}:g={x:this.left+h,y:Ce(s,this.top+F+h,this.bottom-e[0].height),line:0},$m(this.ctx,t.textDirection);let V=w+h;this.legendItems.forEach((L,I)=>{r.strokeStyle=L.fontColor,r.fillStyle=L.fontColor;let b=r.measureText(L.text).width,E=c.textAlign(L.textAlign||(L.textAlign=o.textAlign)),A=y+p+b,P=g.x,D=g.y;c.setWidth(this.width),M?I>0&&P+A+h>this.right&&(D=g.y+=V,g.line++,P=g.x=Ce(s,this.left+h,this.right-i[g.line])):I>0&&D+V>this.bottom&&(P=g.x=P+e[g.line].width+h,g.line++,D=g.y=Ce(s,this.top+F+h,this.bottom-e[g.line].height));let S=c.x(P);if(k(S,D,L),P=Ew(E,P+y+p,M?P+A:this.right,t.rtl),R(c.x(P),D,L),M)g.x+=A+h;else if(typeof L.text!="string"){let Mt=l.lineHeight;g.y+=oE(L,Mt)+h}else g.y+=V}),Km(this.ctx,t.textDirection)}drawTitle(){let t=this.options,e=t.title,i=ae(e.font),r=Pe(e.padding);if(!e.display)return;let s=Ts(t.rtl,this.left,this.width),o=this.ctx,a=e.position,c=i.size/2,l=r.top+c,h,d=this.left,p=this.width;if(this.isHorizontal())p=Math.max(...this.lineWidths),h=this.top+l,d=Ce(t.align,d,this.right-p);else{let y=this.columnSizes.reduce((v,w)=>Math.max(v,w.height),0);h=l+Ce(t.align,this.top,this.bottom-y-t.labels.padding-this._computeTitleHeight())}let g=Ce(a,d,d+p);o.textAlign=s.textAlign(Sh(a)),o.textBaseline="middle",o.strokeStyle=e.color,o.fillStyle=e.color,o.font=i.string,_r(o,e.text,g,h,i)}_computeTitleHeight(){let t=this.options.title,e=ae(t.font),i=Pe(t.padding);return t.display?e.lineHeight+i.height:0}_getLegendItemAt(t,e){let i,r,s;if(ni(t,this.left,this.right)&&ni(e,this.top,this.bottom)){for(s=this.legendHitBoxes,i=0;i<s.length;++i)if(r=s[i],ni(t,r.left,r.left+r.width)&&ni(e,r.top,r.top+r.height))return this.legendItems[i]}return null}handleEvent(t){let e=this.options;if(!sD(t.type,e))return;let i=this._getLegendItemAt(t.x,t.y);if(t.type==="mousemove"||t.type==="mouseout"){let r=this._hoveredItem,s=eD(r,i);r&&!s&&St(e.onLeave,[t,r,this],this),this._hoveredItem=i,i&&!s&&St(e.onHover,[t,i,this],this)}else i&&St(e.onClick,[t,i,this],this)}};function nD(n,t,e,i,r){let s=iD(i,n,t,e),o=rD(r,i,t.lineHeight);return{itemWidth:s,itemHeight:o}}function iD(n,t,e,i){let r=n.text;return r&&typeof r!="string"&&(r=r.reduce((s,o)=>s.length>o.length?s:o)),t+e.size/2+i.measureText(r).width}function rD(n,t,e){let i=n;return typeof t.text!="string"&&(i=oE(t,e)),i}function oE(n,t){let e=n.text?n.text.length:0;return t*e}function sD(n,t){return!!((n==="mousemove"||n==="mouseout")&&(t.onHover||t.onLeave)||t.onClick&&(n==="click"||n==="mouseup"))}var oD={id:"legend",_element:Kh,start(n,t,e){let i=n.legend=new Kh({ctx:n.ctx,options:e,chart:n});Fe.configure(n,i,e),Fe.addBox(n,i)},stop(n){Fe.removeBox(n,n.legend),delete n.legend},beforeUpdate(n,t,e){let i=n.legend;Fe.configure(n,i,e),i.options=e},afterUpdate(n){let t=n.legend;t.buildLabels(),t.adjustHitBoxes()},afterEvent(n,t){t.replay||n.legend.handleEvent(t.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(n,t,e){let i=t.datasetIndex,r=e.chart;r.isDatasetVisible(i)?(r.hide(i),t.hidden=!0):(r.show(i),t.hidden=!1)},onHover:null,onLeave:null,labels:{color:n=>n.chart.options.color,boxWidth:40,padding:10,generateLabels(n){let t=n.data.datasets,{labels:{usePointStyle:e,pointStyle:i,textAlign:r,color:s,useBorderRadius:o,borderRadius:a}}=n.legend.options;return n._getSortedDatasetMetas().map(c=>{let l=c.controller.getStyle(e?0:void 0),h=Pe(l.borderWidth);return{text:t[c.index].label,fillStyle:l.backgroundColor,fontColor:s,hidden:!c.visible,lineCap:l.borderCapStyle,lineDash:l.borderDash,lineDashOffset:l.borderDashOffset,lineJoin:l.borderJoinStyle,lineWidth:(h.width+h.height)/4,strokeStyle:l.borderColor,pointStyle:i||l.pointStyle,rotation:l.rotation,textAlign:r||l.textAlign,borderRadius:o&&(a||l.borderRadius),datasetIndex:c.index}},this)}},title:{color:n=>n.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:n=>!n.startsWith("on"),labels:{_scriptable:n=>!["generateLabels","filter","sort"].includes(n)}}},jc=class extends Ln{constructor(t){super(),this.chart=t.chart,this.options=t.options,this.ctx=t.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(t,e){let i=this.options;if(this.left=0,this.top=0,!i.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=t,this.height=this.bottom=e;let r=kt(i.text)?i.text.length:1;this._padding=Pe(i.padding);let s=r*ae(i.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=s:this.width=s}isHorizontal(){let t=this.options.position;return t==="top"||t==="bottom"}_drawArgs(t){let{top:e,left:i,bottom:r,right:s,options:o}=this,a=o.align,c=0,l,h,d;return this.isHorizontal()?(h=Ce(a,i,s),d=e+t,l=s-i):(o.position==="left"?(h=i+t,d=Ce(a,r,e),c=Rt*-.5):(h=s-t,d=Ce(a,e,r),c=Rt*.5),l=r-e),{titleX:h,titleY:d,maxWidth:l,rotation:c}}draw(){let t=this.ctx,e=this.options;if(!e.display)return;let i=ae(e.font),s=i.lineHeight/2+this._padding.top,{titleX:o,titleY:a,maxWidth:c,rotation:l}=this._drawArgs(s);_r(t,e.text,0,0,i,{color:e.color,maxWidth:c,rotation:l,textAlign:Sh(e.align),textBaseline:"middle",translation:[o,a]})}};function aD(n,t){let e=new jc({ctx:n.ctx,options:t,chart:n});Fe.configure(n,e,t),Fe.addBox(n,e),n.titleBlock=e}var cD={id:"title",_element:jc,start(n,t,e){aD(n,e)},stop(n){let t=n.titleBlock;Fe.removeBox(n,t),delete n.titleBlock},beforeUpdate(n,t,e){let i=n.titleBlock;Fe.configure(n,i,e),i.options=e},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},Lh=new WeakMap,lD={id:"subtitle",start(n,t,e){let i=new jc({ctx:n.ctx,options:e,chart:n});Fe.configure(n,i,e),Fe.addBox(n,i),Lh.set(n,i)},stop(n){Fe.removeBox(n,Lh.get(n)),Lh.delete(n)},beforeUpdate(n,t,e){let i=Lh.get(n);Fe.configure(n,i,e),i.options=e},defaults:{align:"center",display:!1,font:{weight:"normal"},fullSize:!0,padding:0,position:"top",text:"",weight:1500},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}},Bc={average(n){if(!n.length)return!1;let t,e,i=new Set,r=0,s=0;for(t=0,e=n.length;t<e;++t){let a=n[t].element;if(a&&a.hasValue()){let c=a.tooltipPosition();i.add(c.x),r+=c.y,++s}}return s===0||i.size===0?!1:{x:[...i].reduce((a,c)=>a+c)/i.size,y:r/s}},nearest(n,t){if(!n.length)return!1;let e=t.x,i=t.y,r=Number.POSITIVE_INFINITY,s,o,a;for(s=0,o=n.length;s<o;++s){let c=n[s].element;if(c&&c.hasValue()){let l=c.getCenterPoint(),h=xh(t,l);h<r&&(r=h,a=c)}}if(a){let c=a.tooltipPosition();e=c.x,i=c.y}return{x:e,y:i}}};function ii(n,t){return t&&(kt(t)?Array.prototype.push.apply(n,t):n.push(t)),n}function Di(n){return(typeof n=="string"||n instanceof String)&&n.indexOf(`
`)>-1?n.split(`
`):n}function uD(n,t){let{element:e,datasetIndex:i,index:r}=t,s=n.getDatasetMeta(i).controller,{label:o,value:a}=s.getLabelAndValue(r);return{chart:n,label:o,parsed:s.getParsed(r),raw:n.data.datasets[i].data[r],formattedValue:a,dataset:s.getDataset(),dataIndex:r,datasetIndex:i,element:e}}function ST(n,t){let e=n.chart.ctx,{body:i,footer:r,title:s}=n,{boxWidth:o,boxHeight:a}=t,c=ae(t.bodyFont),l=ae(t.titleFont),h=ae(t.footerFont),d=s.length,p=r.length,g=i.length,y=Pe(t.padding),v=y.height,w=0,k=i.reduce((F,V)=>F+V.before.length+V.lines.length+V.after.length,0);if(k+=n.beforeBody.length+n.afterBody.length,d&&(v+=d*l.lineHeight+(d-1)*t.titleSpacing+t.titleMarginBottom),k){let F=t.displayColors?Math.max(a,c.lineHeight):c.lineHeight;v+=g*F+(k-g)*c.lineHeight+(k-1)*t.bodySpacing}p&&(v+=t.footerMarginTop+p*h.lineHeight+(p-1)*t.footerSpacing);let R=0,M=function(F){w=Math.max(w,e.measureText(F).width+R)};return e.save(),e.font=l.string,bt(n.title,M),e.font=c.string,bt(n.beforeBody.concat(n.afterBody),M),R=t.displayColors?o+2+t.boxPadding:0,bt(i,F=>{bt(F.before,M),bt(F.lines,M),bt(F.after,M)}),R=0,e.font=h.string,bt(n.footer,M),e.restore(),w+=y.width,{width:w,height:v}}function hD(n,t){let{y:e,height:i}=t;return e<i/2?"top":e>n.height-i/2?"bottom":"center"}function dD(n,t,e,i){let{x:r,width:s}=i,o=e.caretSize+e.caretPadding;if(n==="left"&&r+s+o>t.width||n==="right"&&r-s-o<0)return!0}function fD(n,t,e,i){let{x:r,width:s}=e,{width:o,chartArea:{left:a,right:c}}=n,l="center";return i==="center"?l=r<=(a+c)/2?"left":"right":r<=s/2?l="left":r>=o-s/2&&(l="right"),dD(l,n,t,e)&&(l="center"),l}function AT(n,t,e){let i=e.yAlign||t.yAlign||hD(n,e);return{xAlign:e.xAlign||t.xAlign||fD(n,t,e,i),yAlign:i}}function pD(n,t){let{x:e,width:i}=n;return t==="right"?e-=i:t==="center"&&(e-=i/2),e}function gD(n,t,e){let{y:i,height:r}=n;return t==="top"?i+=e:t==="bottom"?i-=r+e:i-=r/2,i}function CT(n,t,e,i){let{caretSize:r,caretPadding:s,cornerRadius:o}=n,{xAlign:a,yAlign:c}=e,l=r+s,{topLeft:h,topRight:d,bottomLeft:p,bottomRight:g}=yr(o),y=pD(t,a),v=gD(t,c,l);return c==="center"?a==="left"?y+=l:a==="right"&&(y-=l):a==="left"?y-=Math.max(h,p)+r:a==="right"&&(y+=Math.max(d,g)+r),{x:fe(y,0,i.width-t.width),y:fe(v,0,i.height-t.height)}}function Bh(n,t,e){let i=Pe(e.padding);return t==="center"?n.x+n.width/2:t==="right"?n.x+n.width-i.right:n.x+i.left}function PT(n){return ii([],Di(n))}function mD(n,t,e){return ki(n,{tooltip:t,tooltipItems:e,type:"tooltip"})}function kT(n,t){let e=t&&t.dataset&&t.dataset.tooltip&&t.dataset.tooltip.callbacks;return e?n.override(e):n}var aE={beforeTitle:ei,title(n){if(n.length>0){let t=n[0],e=t.chart.data.labels,i=e?e.length:0;if(this&&this.options&&this.options.mode==="dataset")return t.dataset.label||"";if(t.label)return t.label;if(i>0&&t.dataIndex<i)return e[t.dataIndex]}return""},afterTitle:ei,beforeBody:ei,beforeLabel:ei,label(n){if(this&&this.options&&this.options.mode==="dataset")return n.label+": "+n.formattedValue||n.formattedValue;let t=n.dataset.label||"";t&&(t+=": ");let e=n.formattedValue;return yt(e)||(t+=e),t},labelColor(n){let e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{borderColor:e.borderColor,backgroundColor:e.backgroundColor,borderWidth:e.borderWidth,borderDash:e.borderDash,borderDashOffset:e.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(n){let e=n.chart.getDatasetMeta(n.datasetIndex).controller.getStyle(n.dataIndex);return{pointStyle:e.pointStyle,rotation:e.rotation}},afterLabel:ei,afterBody:ei,beforeFooter:ei,footer:ei,afterFooter:ei};function Je(n,t,e,i){let r=n[t].call(e,i);return typeof r>"u"?aE[t].call(e,i):r}var RT=(()=>{class n extends Ln{static positioners=Bc;constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){let e=this._cachedAnimations;if(e)return e;let i=this.chart,r=this.options.setContext(this.getContext()),s=r.enabled&&i.options.animation&&r.animations,o=new qh(this.chart,s);return s._cacheable&&(this._cachedAnimations=Object.freeze(o)),o}getContext(){return this.$context||(this.$context=mD(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,i){let{callbacks:r}=i,s=Je(r,"beforeTitle",this,e),o=Je(r,"title",this,e),a=Je(r,"afterTitle",this,e),c=[];return c=ii(c,Di(s)),c=ii(c,Di(o)),c=ii(c,Di(a)),c}getBeforeBody(e,i){return PT(Je(i.callbacks,"beforeBody",this,e))}getBody(e,i){let{callbacks:r}=i,s=[];return bt(e,o=>{let a={before:[],lines:[],after:[]},c=kT(r,o);ii(a.before,Di(Je(c,"beforeLabel",this,o))),ii(a.lines,Je(c,"label",this,o)),ii(a.after,Di(Je(c,"afterLabel",this,o))),s.push(a)}),s}getAfterBody(e,i){return PT(Je(i.callbacks,"afterBody",this,e))}getFooter(e,i){let{callbacks:r}=i,s=Je(r,"beforeFooter",this,e),o=Je(r,"footer",this,e),a=Je(r,"afterFooter",this,e),c=[];return c=ii(c,Di(s)),c=ii(c,Di(o)),c=ii(c,Di(a)),c}_createItems(e){let i=this._active,r=this.chart.data,s=[],o=[],a=[],c=[],l,h;for(l=0,h=i.length;l<h;++l)c.push(uD(this.chart,i[l]));return e.filter&&(c=c.filter((d,p,g)=>e.filter(d,p,g,r))),e.itemSort&&(c=c.sort((d,p)=>e.itemSort(d,p,r))),bt(c,d=>{let p=kT(e.callbacks,d);s.push(Je(p,"labelColor",this,d)),o.push(Je(p,"labelPointStyle",this,d)),a.push(Je(p,"labelTextColor",this,d))}),this.labelColors=s,this.labelPointStyles=o,this.labelTextColors=a,this.dataPoints=c,c}update(e,i){let r=this.options.setContext(this.getContext()),s=this._active,o,a=[];if(!s.length)this.opacity!==0&&(o={opacity:0});else{let c=Bc[r.position].call(this,s,this._eventPosition);a=this._createItems(r),this.title=this.getTitle(a,r),this.beforeBody=this.getBeforeBody(a,r),this.body=this.getBody(a,r),this.afterBody=this.getAfterBody(a,r),this.footer=this.getFooter(a,r);let l=this._size=ST(this,r),h=Object.assign({},c,l),d=AT(this.chart,r,h),p=CT(r,h,d,this.chart);this.xAlign=d.xAlign,this.yAlign=d.yAlign,o={opacity:1,x:p.x,y:p.y,width:l.width,height:l.height,caretX:c.x,caretY:c.y}}this._tooltipItems=a,this.$context=void 0,o&&this._resolveAnimations().update(this,o),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:i})}drawCaret(e,i,r,s){let o=this.getCaretPosition(e,r,s);i.lineTo(o.x1,o.y1),i.lineTo(o.x2,o.y2),i.lineTo(o.x3,o.y3)}getCaretPosition(e,i,r){let{xAlign:s,yAlign:o}=this,{caretSize:a,cornerRadius:c}=r,{topLeft:l,topRight:h,bottomLeft:d,bottomRight:p}=yr(c),{x:g,y}=e,{width:v,height:w}=i,k,R,M,F,V,L;return o==="center"?(V=y+w/2,s==="left"?(k=g,R=k-a,F=V+a,L=V-a):(k=g+v,R=k+a,F=V-a,L=V+a),M=k):(s==="left"?R=g+Math.max(l,d)+a:s==="right"?R=g+v-Math.max(h,p)-a:R=this.caretX,o==="top"?(F=y,V=F-a,k=R-a,M=R+a):(F=y+w,V=F+a,k=R+a,M=R-a),L=F),{x1:k,x2:R,x3:M,y1:F,y2:V,y3:L}}drawTitle(e,i,r){let s=this.title,o=s.length,a,c,l;if(o){let h=Ts(r.rtl,this.x,this.width);for(e.x=Bh(this,r.titleAlign,r),i.textAlign=h.textAlign(r.titleAlign),i.textBaseline="middle",a=ae(r.titleFont),c=r.titleSpacing,i.fillStyle=r.titleColor,i.font=a.string,l=0;l<o;++l)i.fillText(s[l],h.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+c,l+1===o&&(e.y+=r.titleMarginBottom-c)}}_drawColorBox(e,i,r,s,o){let a=this.labelColors[r],c=this.labelPointStyles[r],{boxHeight:l,boxWidth:h}=o,d=ae(o.bodyFont),p=Bh(this,"left",o),g=s.x(p),y=l<d.lineHeight?(d.lineHeight-l)/2:0,v=i.y+y;if(o.usePointStyle){let w={radius:Math.min(h,l)/2,pointStyle:c.pointStyle,rotation:c.rotation,borderWidth:1},k=s.leftForLtr(g,h)+h/2,R=v+l/2;e.strokeStyle=o.multiKeyBackground,e.fillStyle=o.multiKeyBackground,Ch(e,w,k,R),e.strokeStyle=a.borderColor,e.fillStyle=a.backgroundColor,Ch(e,w,k,R)}else{e.lineWidth=dt(a.borderWidth)?Math.max(...Object.values(a.borderWidth)):a.borderWidth||1,e.strokeStyle=a.borderColor,e.setLineDash(a.borderDash||[]),e.lineDashOffset=a.borderDashOffset||0;let w=s.leftForLtr(g,h),k=s.leftForLtr(s.xPlus(g,1),h-2),R=yr(a.borderRadius);Object.values(R).some(M=>M!==0)?(e.beginPath(),e.fillStyle=o.multiKeyBackground,Ho(e,{x:w,y:v,w:h,h:l,radius:R}),e.fill(),e.stroke(),e.fillStyle=a.backgroundColor,e.beginPath(),Ho(e,{x:k,y:v+1,w:h-2,h:l-2,radius:R}),e.fill()):(e.fillStyle=o.multiKeyBackground,e.fillRect(w,v,h,l),e.strokeRect(w,v,h,l),e.fillStyle=a.backgroundColor,e.fillRect(k,v+1,h-2,l-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,i,r){let{body:s}=this,{bodySpacing:o,bodyAlign:a,displayColors:c,boxHeight:l,boxWidth:h,boxPadding:d}=r,p=ae(r.bodyFont),g=p.lineHeight,y=0,v=Ts(r.rtl,this.x,this.width),w=function(E){i.fillText(E,v.x(e.x+y),e.y+g/2),e.y+=g+o},k=v.textAlign(a),R,M,F,V,L,I,b;for(i.textAlign=a,i.textBaseline="middle",i.font=p.string,e.x=Bh(this,k,r),i.fillStyle=r.bodyColor,bt(this.beforeBody,w),y=c&&k!=="right"?a==="center"?h/2+d:h+2+d:0,V=0,I=s.length;V<I;++V){for(R=s[V],M=this.labelTextColors[V],i.fillStyle=M,bt(R.before,w),F=R.lines,c&&F.length&&(this._drawColorBox(i,e,V,v,r),g=Math.max(p.lineHeight,l)),L=0,b=F.length;L<b;++L)w(F[L]),g=p.lineHeight;bt(R.after,w)}y=0,g=p.lineHeight,bt(this.afterBody,w),e.y-=o}drawFooter(e,i,r){let s=this.footer,o=s.length,a,c;if(o){let l=Ts(r.rtl,this.x,this.width);for(e.x=Bh(this,r.footerAlign,r),e.y+=r.footerMarginTop,i.textAlign=l.textAlign(r.footerAlign),i.textBaseline="middle",a=ae(r.footerFont),i.fillStyle=r.footerColor,i.font=a.string,c=0;c<o;++c)i.fillText(s[c],l.x(e.x),e.y+a.lineHeight/2),e.y+=a.lineHeight+r.footerSpacing}}drawBackground(e,i,r,s){let{xAlign:o,yAlign:a}=this,{x:c,y:l}=e,{width:h,height:d}=r,{topLeft:p,topRight:g,bottomLeft:y,bottomRight:v}=yr(s.cornerRadius);i.fillStyle=s.backgroundColor,i.strokeStyle=s.borderColor,i.lineWidth=s.borderWidth,i.beginPath(),i.moveTo(c+p,l),a==="top"&&this.drawCaret(e,i,r,s),i.lineTo(c+h-g,l),i.quadraticCurveTo(c+h,l,c+h,l+g),a==="center"&&o==="right"&&this.drawCaret(e,i,r,s),i.lineTo(c+h,l+d-v),i.quadraticCurveTo(c+h,l+d,c+h-v,l+d),a==="bottom"&&this.drawCaret(e,i,r,s),i.lineTo(c+y,l+d),i.quadraticCurveTo(c,l+d,c,l+d-y),a==="center"&&o==="left"&&this.drawCaret(e,i,r,s),i.lineTo(c,l+p),i.quadraticCurveTo(c,l,c+p,l),i.closePath(),i.fill(),s.borderWidth>0&&i.stroke()}_updateAnimationTarget(e){let i=this.chart,r=this.$animations,s=r&&r.x,o=r&&r.y;if(s||o){let a=Bc[e.position].call(this,this._active,this._eventPosition);if(!a)return;let c=this._size=ST(this,e),l=Object.assign({},a,this._size),h=AT(i,e,l),d=CT(e,l,h,i);(s._to!==d.x||o._to!==d.y)&&(this.xAlign=h.xAlign,this.yAlign=h.yAlign,this.width=c.width,this.height=c.height,this.caretX=a.x,this.caretY=a.y,this._resolveAnimations().update(this,d))}}_willRender(){return!!this.opacity}draw(e){let i=this.options.setContext(this.getContext()),r=this.opacity;if(!r)return;this._updateAnimationTarget(i);let s={width:this.width,height:this.height},o={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;let a=Pe(i.padding),c=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;i.enabled&&c&&(e.save(),e.globalAlpha=r,this.drawBackground(o,e,s,i),$m(e,i.textDirection),o.y+=a.top,this.drawTitle(o,e,i),this.drawBody(o,e,i),this.drawFooter(o,e,i),Km(e,i.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,i){let r=this._active,s=e.map(({datasetIndex:c,index:l})=>{let h=this.chart.getDatasetMeta(c);if(!h)throw new Error("Cannot find a dataset at index "+c);return{datasetIndex:c,element:h.data[l],index:l}}),o=!Pc(r,s),a=this._positionChanged(s,i);(o||a)&&(this._active=s,this._eventPosition=i,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,i,r=!0){if(i&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;let s=this.options,o=this._active||[],a=this._getActiveElements(e,o,i,r),c=this._positionChanged(a,e),l=i||!Pc(a,o)||c;return l&&(this._active=a,(s.enabled||s.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,i))),l}_getActiveElements(e,i,r,s){let o=this.options;if(e.type==="mouseout")return[];if(!s)return i.filter(c=>this.chart.data.datasets[c.datasetIndex]&&this.chart.getDatasetMeta(c.datasetIndex).controller.getParsed(c.index)!==void 0);let a=this.chart.getElementsAtEventForMode(e,o.mode,o,r);return o.reverse&&a.reverse(),a}_positionChanged(e,i){let{caretX:r,caretY:s,options:o}=this,a=Bc[o.position].call(this,e,i);return a!==!1&&(r!==a.x||s!==a.y)}}return n})(),_D={id:"tooltip",_element:RT,positioners:Bc,afterInit(n,t,e){e&&(n.tooltip=new RT({chart:n,options:e}))},beforeUpdate(n,t,e){n.tooltip&&n.tooltip.initialize(e)},reset(n,t,e){n.tooltip&&n.tooltip.initialize(e)},afterDraw(n){let t=n.tooltip;if(t&&t._willRender()){let e={tooltip:t};if(n.notifyPlugins("beforeTooltipDraw",Rn(pn({},e),{cancelable:!0}))===!1)return;t.draw(n.ctx),n.notifyPlugins("afterTooltipDraw",e)}},afterEvent(n,t){if(n.tooltip){let e=t.replay;n.tooltip.handleEvent(t.event,e,t.inChartArea)&&(t.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(n,t)=>t.bodyFont.size,boxWidth:(n,t)=>t.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:aE},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:n=>n!=="filter"&&n!=="itemSort"&&n!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]},yD=Object.freeze({__proto__:null,Colors:kR,Decimation:OR,Filler:tD,Legend:oD,SubTitle:lD,Title:cD,Tooltip:_D}),vD=(n,t,e,i)=>(typeof t=="string"?(e=n.push(t)-1,i.unshift({index:e,label:t})):isNaN(t)&&(e=null),e);function bD(n,t,e,i){let r=n.indexOf(t);if(r===-1)return vD(n,t,e,i);let s=n.lastIndexOf(t);return r!==s?e:r}var xD=(n,t)=>n===null?null:fe(Math.round(n),0,t);function DT(n){let t=this.getLabels();return n>=0&&n<t.length?t[n]:n}var wD=(()=>{class n extends Ss{static id="category";static defaults={ticks:{callback:DT}};constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){let i=this._addedLabels;if(i.length){let r=this.getLabels();for(let{index:s,label:o}of i)r[s]===o&&r.splice(s,1);this._addedLabels=[]}super.init(e)}parse(e,i){if(yt(e))return null;let r=this.getLabels();return i=isFinite(i)&&r[i]===e?i:bD(r,e,ct(i,e),this._addedLabels),xD(i,r.length-1)}determineDataLimits(){let{minDefined:e,maxDefined:i}=this.getUserBounds(),{min:r,max:s}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),i||(s=this.getLabels().length-1)),this.min=r,this.max=s}buildTicks(){let e=this.min,i=this.max,r=this.options.offset,s=[],o=this.getLabels();o=e===0&&i===o.length-1?o:o.slice(e,i+1),this._valueRange=Math.max(o.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let a=e;a<=i;a++)s.push({value:a});return s}getLabelForValue(e){return DT.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){let i=this.ticks;return e<0||e>i.length-1?null:this.getPixelForValue(i[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}return n})();function TD(n,t){let e=[],{bounds:r,step:s,min:o,max:a,precision:c,count:l,maxTicks:h,maxDigits:d,includeBounds:p}=n,g=s||1,y=h-1,{min:v,max:w}=t,k=!yt(o),R=!yt(a),M=!yt(l),F=(w-v)/(d+1),V=Sm((w-v)/y/g)*g,L,I,b,E;if(V<1e-14&&!k&&!R)return[{value:v},{value:w}];E=Math.ceil(w/V)-Math.floor(v/V),E>y&&(V=Sm(E*V/y/g)*g),yt(c)||(L=Math.pow(10,c),V=Math.ceil(V*L)/L),r==="ticks"?(I=Math.floor(v/V)*V,b=Math.ceil(w/V)*V):(I=v,b=w),k&&R&&s&&_w((a-o)/s,V/1e3)?(E=Math.round(Math.min((a-o)/V,h)),V=(a-o)/E,I=o,b=a):M?(I=k?o:I,b=R?a:b,E=l-1,V=(b-I)/E):(E=(b-I)/V,Uo(E,Math.round(E),V/1e3)?E=Math.round(E):E=Math.ceil(E));let A=Math.max(Cm(V),Cm(I));L=Math.pow(10,yt(c)?A:c),I=Math.round(I*L)/L,b=Math.round(b*L)/L;let P=0;for(k&&(p&&I!==o?(e.push({value:o}),I<o&&P++,Uo(Math.round((I+P*V)*L)/L,o,MT(o,F,n))&&P++):I<o&&P++);P<E;++P){let D=Math.round((I+P*V)*L)/L;if(R&&D>a)break;e.push({value:D})}return R&&p&&b!==a?e.length&&Uo(e[e.length-1].value,a,MT(a,F,n))?e[e.length-1].value=a:e.push({value:a}):(!R||b===a)&&e.push({value:b}),e}function MT(n,t,{horizontal:e,minRotation:i}){let r=wn(i),s=(e?Math.sin(r):Math.cos(r))||.001,o=.75*t*(""+n).length;return Math.min(t/s,o)}var Yo=class extends Ss{constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(t,e){return yt(t)||(typeof t=="number"||t instanceof Number)&&!isFinite(+t)?null:+t}handleTickRangeOptions(){let{beginAtZero:t}=this.options,{minDefined:e,maxDefined:i}=this.getUserBounds(),{min:r,max:s}=this,o=c=>r=e?r:c,a=c=>s=i?s:c;if(t){let c=Fn(r),l=Fn(s);c<0&&l<0?a(0):c>0&&l>0&&o(0)}if(r===s){let c=s===0?1:Math.abs(s*.05);a(s+c),t||o(r-c)}this.min=r,this.max=s}getTickLimit(){let t=this.options.ticks,{maxTicksLimit:e,stepSize:i}=t,r;return i?(r=Math.ceil(this.max/i)-Math.floor(this.min/i)+1,r>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${i} would result generating up to ${r} ticks. Limiting to 1000.`),r=1e3)):(r=this.computeTickLimit(),e=e||11),e&&(r=Math.min(e,r)),r}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){let t=this.options,e=t.ticks,i=this.getTickLimit();i=Math.max(2,i);let r={maxTicks:i,bounds:t.bounds,min:t.min,max:t.max,precision:e.precision,step:e.stepSize,count:e.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:e.minRotation||0,includeBounds:e.includeBounds!==!1},s=this._range||this,o=TD(r,s);return t.bounds==="ticks"&&Am(o,this,"value"),t.reverse?(o.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),o}configure(){let t=this.ticks,e=this.min,i=this.max;if(super.configure(),this.options.offset&&t.length){let r=(i-e)/Math.max(t.length-1,1)/2;e-=r,i+=r}this._startValue=e,this._endValue=i,this._valueRange=i-e}getLabelForValue(t){return Wo(t,this.chart.options.locale,this.options.ticks.format)}},x_=class extends Yo{static id="linear";static defaults={ticks:{callback:kc.formatters.numeric}};determineDataLimits(){let{min:t,max:e}=this.getMinMax(!0);this.min=qt(t)?t:0,this.max=qt(e)?e:1,this.handleTickRangeOptions()}computeTickLimit(){let t=this.isHorizontal(),e=t?this.width:this.height,i=wn(this.options.ticks.minRotation),r=(t?Math.sin(i):Math.cos(i))||.001,s=this._resolveTickFontOptions(0);return Math.ceil(e/Math.min(40,s.lineHeight/r))}getPixelForValue(t){return t===null?NaN:this.getPixelForDecimal((t-this._startValue)/this._valueRange)}getValueForPixel(t){return this._startValue+this.getDecimalForPixel(t)*this._valueRange}},Uc=n=>Math.floor(Ci(n)),Is=(n,t)=>Math.pow(10,Uc(n)+t);function OT(n){return n/Math.pow(10,Uc(n))===1}function VT(n,t,e){let i=Math.pow(10,e),r=Math.floor(n/i);return Math.ceil(t/i)-r}function ED(n,t){let e=t-n,i=Uc(e);for(;VT(n,t,i)>10;)i++;for(;VT(n,t,i)<10;)i--;return Math.min(i,Uc(n))}function ID(n,{min:t,max:e}){t=Xe(n.min,t);let i=[],r=Uc(t),s=ED(t,e),o=s<0?Math.pow(10,Math.abs(s)):1,a=Math.pow(10,s),c=r>s?Math.pow(10,r):0,l=Math.round((t-c)*o)/o,h=Math.floor((t-c)/a/10)*a*10,d=Math.floor((l-h)/Math.pow(10,s)),p=Xe(n.min,Math.round((c+h+d*Math.pow(10,s))*o)/o);for(;p<e;)i.push({value:p,major:OT(p),significand:d}),d>=10?d=d<15?15:20:d++,d>=20&&(s++,d=2,o=s>=0?1:o),p=Math.round((c+h+d*Math.pow(10,s))*o)/o;let g=Xe(n.max,p);return i.push({value:g,major:OT(g),significand:d}),i}var w_=class extends Ss{static id="logarithmic";static defaults={ticks:{callback:kc.formatters.logarithmic,major:{enabled:!0}}};constructor(t){super(t),this.start=void 0,this.end=void 0,this._startValue=void 0,this._valueRange=0}parse(t,e){let i=Yo.prototype.parse.apply(this,[t,e]);if(i===0){this._zero=!0;return}return qt(i)&&i>0?i:null}determineDataLimits(){let{min:t,max:e}=this.getMinMax(!0);this.min=qt(t)?Math.max(0,t):null,this.max=qt(e)?Math.max(0,e):null,this.options.beginAtZero&&(this._zero=!0),this._zero&&this.min!==this._suggestedMin&&!qt(this._userMin)&&(this.min=t===Is(this.min,0)?Is(this.min,-1):Is(this.min,0)),this.handleTickRangeOptions()}handleTickRangeOptions(){let{minDefined:t,maxDefined:e}=this.getUserBounds(),i=this.min,r=this.max,s=a=>i=t?i:a,o=a=>r=e?r:a;i===r&&(i<=0?(s(1),o(10)):(s(Is(i,-1)),o(Is(r,1)))),i<=0&&s(Is(r,-1)),r<=0&&o(Is(i,1)),this.min=i,this.max=r}buildTicks(){let t=this.options,e={min:this._userMin,max:this._userMax},i=ID(e,this);return t.bounds==="ticks"&&Am(i,this,"value"),t.reverse?(i.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),i}getLabelForValue(t){return t===void 0?"0":Wo(t,this.chart.options.locale,this.options.ticks.format)}configure(){let t=this.min;super.configure(),this._startValue=Ci(t),this._valueRange=Ci(this.max)-Ci(t)}getPixelForValue(t){return(t===void 0||t===0)&&(t=this.min),t===null||isNaN(t)?NaN:this.getPixelForDecimal(t===this.min?0:(Ci(t)-this._startValue)/this._valueRange)}getValueForPixel(t){let e=this.getDecimalForPixel(t);return Math.pow(10,this._startValue+e*this._valueRange)}};function T_(n){let t=n.ticks;if(t.display&&n.display){let e=Pe(t.backdropPadding);return ct(t.font&&t.font.size,Nt.font.size)+e.height}return 0}function SD(n,t,e){return e=kt(e)?e:[e],{w:Sw(n,t.string,e),h:e.length*t.lineHeight}}function NT(n,t,e,i,r){return n===i||n===r?{start:t-e/2,end:t+e/2}:n<i||n>r?{start:t-e,end:t}:{start:t,end:t+e}}function AD(n){let t={l:n.left+n._padding.left,r:n.right-n._padding.right,t:n.top+n._padding.top,b:n.bottom-n._padding.bottom},e=Object.assign({},t),i=[],r=[],s=n._pointLabels.length,o=n.options.pointLabels,a=o.centerPointLabels?Rt/s:0;for(let c=0;c<s;c++){let l=o.setContext(n.getPointLabelContext(c));r[c]=l.padding;let h=n.getPointPosition(c,n.drawingArea+r[c],a),d=ae(l.font),p=SD(n.ctx,d,n._pointLabels[c]);i[c]=p;let g=Qe(n.getIndexAngle(c)+a),y=Math.round(Eh(g)),v=NT(y,h.x,p.w,0,180),w=NT(y,h.y,p.h,90,270);CD(e,t,g,v,w)}n.setCenterPoint(t.l-e.l,e.r-t.r,t.t-e.t,e.b-t.b),n._pointLabelItems=RD(n,i,r)}function CD(n,t,e,i,r){let s=Math.abs(Math.sin(e)),o=Math.abs(Math.cos(e)),a=0,c=0;i.start<t.l?(a=(t.l-i.start)/s,n.l=Math.min(n.l,t.l-a)):i.end>t.r&&(a=(i.end-t.r)/s,n.r=Math.max(n.r,t.r+a)),r.start<t.t?(c=(t.t-r.start)/o,n.t=Math.min(n.t,t.t-c)):r.end>t.b&&(c=(r.end-t.b)/o,n.b=Math.max(n.b,t.b+c))}function PD(n,t,e){let i=n.drawingArea,{extra:r,additionalAngle:s,padding:o,size:a}=e,c=n.getPointPosition(t,i+r+o,s),l=Math.round(Eh(Qe(c.angle+Yt))),h=OD(c.y,a.h,l),d=DD(l),p=MD(c.x,a.w,d);return{visible:!0,x:c.x,y:h,textAlign:d,left:p,top:h,right:p+a.w,bottom:h+a.h}}function kD(n,t){if(!t)return!0;let{left:e,top:i,right:r,bottom:s}=n;return!(ti({x:e,y:i},t)||ti({x:e,y:s},t)||ti({x:r,y:i},t)||ti({x:r,y:s},t))}function RD(n,t,e){let i=[],r=n._pointLabels.length,s=n.options,{centerPointLabels:o,display:a}=s.pointLabels,c={extra:T_(s)/2,additionalAngle:o?Rt/r:0},l;for(let h=0;h<r;h++){c.padding=e[h],c.size=t[h];let d=PD(n,h,c);i.push(d),a==="auto"&&(d.visible=kD(d,l),d.visible&&(l=d))}return i}function DD(n){return n===0||n===180?"center":n<180?"left":"right"}function MD(n,t,e){return e==="right"?n-=t:e==="center"&&(n-=t/2),n}function OD(n,t,e){return e===90||e===270?n-=t/2:(e>270||e<90)&&(n-=t),n}function VD(n,t,e){let{left:i,top:r,right:s,bottom:o}=e,{backdropColor:a}=t;if(!yt(a)){let c=yr(t.borderRadius),l=Pe(t.backdropPadding);n.fillStyle=a;let h=i-l.left,d=r-l.top,p=s-i+l.width,g=o-r+l.height;Object.values(c).some(y=>y!==0)?(n.beginPath(),Ho(n,{x:h,y:d,w:p,h:g,radius:c}),n.fill()):n.fillRect(h,d,p,g)}}function ND(n,t){let{ctx:e,options:{pointLabels:i}}=n;for(let r=t-1;r>=0;r--){let s=n._pointLabelItems[r];if(!s.visible)continue;let o=i.setContext(n.getPointLabelContext(r));VD(e,o,s);let a=ae(o.font),{x:c,y:l,textAlign:h}=s;_r(e,n._pointLabels[r],c,l+a.lineHeight/2,a,{color:o.color,textAlign:h,textBaseline:"middle"})}}function cE(n,t,e,i){let{ctx:r}=n;if(e)r.arc(n.xCenter,n.yCenter,t,0,Dt);else{let s=n.getPointPosition(0,t);r.moveTo(s.x,s.y);for(let o=1;o<i;o++)s=n.getPointPosition(o,t),r.lineTo(s.x,s.y)}}function FD(n,t,e,i,r){let s=n.ctx,o=t.circular,{color:a,lineWidth:c}=t;!o&&!i||!a||!c||e<0||(s.save(),s.strokeStyle=a,s.lineWidth=c,s.setLineDash(r.dash),s.lineDashOffset=r.dashOffset,s.beginPath(),cE(n,e,o,i),s.closePath(),s.stroke(),s.restore())}function LD(n,t,e){return ki(n,{label:e,index:t,type:"pointLabel"})}var E_=class extends Yo{static id="radialLinear";static defaults={display:!0,animate:!0,position:"chartArea",angleLines:{display:!0,lineWidth:1,borderDash:[],borderDashOffset:0},grid:{circular:!1},startAngle:0,ticks:{showLabelBackdrop:!0,callback:kc.formatters.numeric},pointLabels:{backdropColor:void 0,backdropPadding:2,display:!0,font:{size:10},callback(t){return t},padding:5,centerPointLabels:!1}};static defaultRoutes={"angleLines.color":"borderColor","pointLabels.color":"color","ticks.color":"color"};static descriptors={angleLines:{_fallback:"grid"}};constructor(t){super(t),this.xCenter=void 0,this.yCenter=void 0,this.drawingArea=void 0,this._pointLabels=[],this._pointLabelItems=[]}setDimensions(){let t=this._padding=Pe(T_(this.options)/2),e=this.width=this.maxWidth-t.width,i=this.height=this.maxHeight-t.height;this.xCenter=Math.floor(this.left+e/2+t.left),this.yCenter=Math.floor(this.top+i/2+t.top),this.drawingArea=Math.floor(Math.min(e,i)/2)}determineDataLimits(){let{min:t,max:e}=this.getMinMax(!1);this.min=qt(t)&&!isNaN(t)?t:0,this.max=qt(e)&&!isNaN(e)?e:0,this.handleTickRangeOptions()}computeTickLimit(){return Math.ceil(this.drawingArea/T_(this.options))}generateTickLabels(t){Yo.prototype.generateTickLabels.call(this,t),this._pointLabels=this.getLabels().map((e,i)=>{let r=St(this.options.pointLabels.callback,[e,i],this);return r||r===0?r:""}).filter((e,i)=>this.chart.getDataVisibility(i))}fit(){let t=this.options;t.display&&t.pointLabels.display?AD(this):this.setCenterPoint(0,0,0,0)}setCenterPoint(t,e,i,r){this.xCenter+=Math.floor((t-e)/2),this.yCenter+=Math.floor((i-r)/2),this.drawingArea-=Math.min(this.drawingArea/2,Math.max(t,e,i,r))}getIndexAngle(t){let e=Dt/(this._pointLabels.length||1),i=this.options.startAngle||0;return Qe(t*e+wn(i))}getDistanceFromCenterForValue(t){if(yt(t))return NaN;let e=this.drawingArea/(this.max-this.min);return this.options.reverse?(this.max-t)*e:(t-this.min)*e}getValueForDistanceFromCenter(t){if(yt(t))return NaN;let e=t/(this.drawingArea/(this.max-this.min));return this.options.reverse?this.max-e:this.min+e}getPointLabelContext(t){let e=this._pointLabels||[];if(t>=0&&t<e.length){let i=e[t];return LD(this.getContext(),t,i)}}getPointPosition(t,e,i=0){let r=this.getIndexAngle(t)-Yt+i;return{x:Math.cos(r)*e+this.xCenter,y:Math.sin(r)*e+this.yCenter,angle:r}}getPointPositionForValue(t,e){return this.getPointPosition(t,this.getDistanceFromCenterForValue(e))}getBasePosition(t){return this.getPointPositionForValue(t||0,this.getBaseValue())}getPointLabelPosition(t){let{left:e,top:i,right:r,bottom:s}=this._pointLabelItems[t];return{left:e,top:i,right:r,bottom:s}}drawBackground(){let{backgroundColor:t,grid:{circular:e}}=this.options;if(t){let i=this.ctx;i.save(),i.beginPath(),cE(this,this.getDistanceFromCenterForValue(this._endValue),e,this._pointLabels.length),i.closePath(),i.fillStyle=t,i.fill(),i.restore()}}drawGrid(){let t=this.ctx,e=this.options,{angleLines:i,grid:r,border:s}=e,o=this._pointLabels.length,a,c,l;if(e.pointLabels.display&&ND(this,o),r.display&&this.ticks.forEach((h,d)=>{if(d!==0||d===0&&this.min<0){c=this.getDistanceFromCenterForValue(h.value);let p=this.getContext(d),g=r.setContext(p),y=s.setContext(p);FD(this,g,c,o,y)}}),i.display){for(t.save(),a=o-1;a>=0;a--){let h=i.setContext(this.getPointLabelContext(a)),{color:d,lineWidth:p}=h;!p||!d||(t.lineWidth=p,t.strokeStyle=d,t.setLineDash(h.borderDash),t.lineDashOffset=h.borderDashOffset,c=this.getDistanceFromCenterForValue(e.reverse?this.min:this.max),l=this.getPointPosition(a,c),t.beginPath(),t.moveTo(this.xCenter,this.yCenter),t.lineTo(l.x,l.y),t.stroke())}t.restore()}}drawBorder(){}drawLabels(){let t=this.ctx,e=this.options,i=e.ticks;if(!i.display)return;let r=this.getIndexAngle(0),s,o;t.save(),t.translate(this.xCenter,this.yCenter),t.rotate(r),t.textAlign="center",t.textBaseline="middle",this.ticks.forEach((a,c)=>{if(c===0&&this.min>=0&&!e.reverse)return;let l=i.setContext(this.getContext(c)),h=ae(l.font);if(s=this.getDistanceFromCenterForValue(this.ticks[c].value),l.showLabelBackdrop){t.font=h.string,o=t.measureText(a.label).width,t.fillStyle=l.backdropColor;let d=Pe(l.backdropPadding);t.fillRect(-o/2-d.left,-s-h.size/2-d.top,o+d.width,h.size+d.height)}_r(t,a.label,0,-s,h,{color:l.color,strokeColor:l.textStrokeColor,strokeWidth:l.textStrokeWidth})}),t.restore()}drawTitle(){}},Xh={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Ze=Object.keys(Xh);function FT(n,t){return n-t}function LT(n,t){if(yt(t))return null;let e=n._adapter,{parser:i,round:r,isoWeekday:s}=n._parseOpts,o=t;return typeof i=="function"&&(o=i(o)),qt(o)||(o=typeof i=="string"?e.parse(o,i):e.parse(o)),o===null?null:(r&&(o=r==="week"&&(ws(s)||s===!0)?e.startOf(o,"isoWeek",s):e.startOf(o,r)),+o)}function BT(n,t,e,i){let r=Ze.length;for(let s=Ze.indexOf(n);s<r-1;++s){let o=Xh[Ze[s]],a=o.steps?o.steps:Number.MAX_SAFE_INTEGER;if(o.common&&Math.ceil((e-t)/(a*o.size))<=i)return Ze[s]}return Ze[r-1]}function BD(n,t,e,i,r){for(let s=Ze.length-1;s>=Ze.indexOf(e);s--){let o=Ze[s];if(Xh[o].common&&n._adapter.diff(r,i,o)>=t-1)return o}return Ze[e?Ze.indexOf(e):0]}function zD(n){for(let t=Ze.indexOf(n)+1,e=Ze.length;t<e;++t)if(Xh[Ze[t]].common)return Ze[t]}function zT(n,t,e){if(!e)n[t]=!0;else if(e.length){let{lo:i,hi:r}=Ih(e,t),s=e[i]>=t?e[i]:e[r];n[s]=!0}}function jD(n,t,e,i){let r=n._adapter,s=+r.startOf(t[0].value,i),o=t[t.length-1].value,a,c;for(a=s;a<=o;a=+r.add(a,1,i))c=e[a],c>=0&&(t[c].major=!0);return t}function jT(n,t,e){let i=[],r={},s=t.length,o,a;for(o=0;o<s;++o)a=t[o],r[a]=o,i.push({value:a,major:!1});return s===0||!e?i:jD(n,i,r,e)}var I_=(()=>{class n extends Ss{static id="time";static defaults={bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}};constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,i={}){let r=e.time||(e.time={}),s=this._adapter=new Z1._date(e.adapters.date);s.init(i),zo(r.displayFormats,s.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=i.normalized}parse(e,i){return e===void 0?null:LT(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){let e=this.options,i=this._adapter,r=e.time.unit||"day",{min:s,max:o,minDefined:a,maxDefined:c}=this.getUserBounds();function l(h){!a&&!isNaN(h.min)&&(s=Math.min(s,h.min)),!c&&!isNaN(h.max)&&(o=Math.max(o,h.max))}(!a||!c)&&(l(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&l(this.getMinMax(!1))),s=qt(s)&&!isNaN(s)?s:+i.startOf(Date.now(),r),o=qt(o)&&!isNaN(o)?o:+i.endOf(Date.now(),r)+1,this.min=Math.min(s,o-1),this.max=Math.max(s+1,o)}_getLabelBounds(){let e=this.getLabelTimestamps(),i=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(i=e[0],r=e[e.length-1]),{min:i,max:r}}buildTicks(){let e=this.options,i=e.time,r=e.ticks,s=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&s.length&&(this.min=this._userMin||s[0],this.max=this._userMax||s[s.length-1]);let o=this.min,a=this.max,c=bw(s,o,a);return this._unit=i.unit||(r.autoSkip?BT(i.minUnit,this.min,this.max,this._getLabelCapacity(o)):BD(this,c.length,i.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:zD(this._unit),this.initOffsets(s),e.reverse&&c.reverse(),jT(this,c,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let i=0,r=0,s,o;this.options.offset&&e.length&&(s=this.getDecimalForValue(e[0]),e.length===1?i=1-s:i=(this.getDecimalForValue(e[1])-s)/2,o=this.getDecimalForValue(e[e.length-1]),e.length===1?r=o:r=(o-this.getDecimalForValue(e[e.length-2]))/2);let a=e.length<3?.5:.25;i=fe(i,0,a),r=fe(r,0,a),this._offsets={start:i,end:r,factor:1/(i+1+r)}}_generate(){let e=this._adapter,i=this.min,r=this.max,s=this.options,o=s.time,a=o.unit||BT(o.minUnit,i,r,this._getLabelCapacity(i)),c=ct(s.ticks.stepSize,1),l=a==="week"?o.isoWeekday:!1,h=ws(l)||l===!0,d={},p=i,g,y;if(h&&(p=+e.startOf(p,"isoWeek",l)),p=+e.startOf(p,h?"day":a),e.diff(r,i,a)>1e5*c)throw new Error(i+" and "+r+" are too far apart with stepSize of "+c+" "+a);let v=s.ticks.source==="data"&&this.getDataTimestamps();for(g=p,y=0;g<r;g=+e.add(g,c,a),y++)zT(d,g,v);return(g===r||s.bounds==="ticks"||y===1)&&zT(d,g,v),Object.keys(d).sort(FT).map(w=>+w)}getLabelForValue(e){let i=this._adapter,r=this.options.time;return r.tooltipFormat?i.format(e,r.tooltipFormat):i.format(e,r.displayFormats.datetime)}format(e,i){let s=this.options.time.displayFormats,o=this._unit,a=i||s[o];return this._adapter.format(e,a)}_tickFormatFunction(e,i,r,s){let o=this.options,a=o.ticks.callback;if(a)return St(a,[e,i,r],this);let c=o.time.displayFormats,l=this._unit,h=this._majorUnit,d=l&&c[l],p=h&&c[h],g=r[i],y=h&&p&&g&&g.major;return this._adapter.format(e,s||(y?p:d))}generateTickLabels(e){let i,r,s;for(i=0,r=e.length;i<r;++i)s=e[i],s.label=this._tickFormatFunction(s.value,i,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){let i=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((i.start+r)*i.factor)}getValueForPixel(e){let i=this._offsets,r=this.getDecimalForPixel(e)/i.factor-i.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){let i=this.options.ticks,r=this.ctx.measureText(e).width,s=wn(this.isHorizontal()?i.maxRotation:i.minRotation),o=Math.cos(s),a=Math.sin(s),c=this._resolveTickFontOptions(0).size;return{w:r*o+c*a,h:r*a+c*o}}_getLabelCapacity(e){let i=this.options.time,r=i.displayFormats,s=r[i.unit]||r.millisecond,o=this._tickFormatFunction(e,0,jT(this,[e],this._majorUnit),s),a=this._getLabelSize(o),c=Math.floor(this.isHorizontal()?this.width/a.w:this.height/a.h)-1;return c>0?c:1}getDataTimestamps(){let e=this._cache.data||[],i,r;if(e.length)return e;let s=this.getMatchingVisibleMetas();if(this._normalized&&s.length)return this._cache.data=s[0].controller.getAllParsedValues(this);for(i=0,r=s.length;i<r;++i)e=e.concat(s[i].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){let e=this._cache.labels||[],i,r;if(e.length)return e;let s=this.getLabels();for(i=0,r=s.length;i<r;++i)e.push(LT(this,s[i]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return Rm(e.sort(FT))}}return n})();function zh(n,t,e){let i=0,r=n.length-1,s,o,a,c;e?(t>=n[i].pos&&t<=n[r].pos&&({lo:i,hi:r}=Zn(n,"pos",t)),{pos:s,time:a}=n[i],{pos:o,time:c}=n[r]):(t>=n[i].time&&t<=n[r].time&&({lo:i,hi:r}=Zn(n,"time",t)),{time:s,pos:a}=n[i],{time:o,pos:c}=n[r]);let l=o-s;return l?a+(c-a)*(t-s)/l:a}var S_=class extends I_{static id="timeseries";static defaults=I_.defaults;constructor(t){super(t),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){let t=this._getTimestampsForTable(),e=this._table=this.buildLookupTable(t);this._minPos=zh(e,this.min),this._tableRange=zh(e,this.max)-this._minPos,super.initOffsets(t)}buildLookupTable(t){let{min:e,max:i}=this,r=[],s=[],o,a,c,l,h;for(o=0,a=t.length;o<a;++o)l=t[o],l>=e&&l<=i&&r.push(l);if(r.length<2)return[{time:e,pos:0},{time:i,pos:1}];for(o=0,a=r.length;o<a;++o)h=r[o+1],c=r[o-1],l=r[o],Math.round((h+c)/2)!==l&&s.push({time:l,pos:o/(a-1)});return s}_generate(){let t=this.min,e=this.max,i=super.getDataTimestamps();return(!i.includes(t)||!i.length)&&i.splice(0,0,t),(!i.includes(e)||i.length===1)&&i.push(e),i.sort((r,s)=>r-s)}_getTimestampsForTable(){let t=this._cache.all||[];if(t.length)return t;let e=this.getDataTimestamps(),i=this.getLabelTimestamps();return e.length&&i.length?t=this.normalize(e.concat(i)):t=e.length?e:i,t=this._cache.all=t,t}getDecimalForValue(t){return(zh(this._table,t)-this._minPos)/this._tableRange}getValueForPixel(t){let e=this._offsets,i=this.getDecimalForPixel(t)/e.factor-e.end;return zh(this._table,i*this._tableRange+this._minPos,!0)}},UD=Object.freeze({__proto__:null,CategoryScale:wD,LinearScale:x_,LogarithmicScale:w_,RadialLinearScale:E_,TimeScale:I_,TimeSeriesScale:S_}),lE=[J1,ER,yD,UD];var qD=typeof global=="object"&&global&&global.Object===Object&&global,Jh=qD;var WD=typeof self=="object"&&self&&self.Object===Object&&self,HD=Jh||WD||Function("return this")(),Tn=HD;var GD=Tn.Symbol,Qo=GD;var uE=Object.prototype,$D=uE.hasOwnProperty,KD=uE.toString,Wc=Qo?Qo.toStringTag:void 0;function YD(n){var t=$D.call(n,Wc),e=n[Wc];try{n[Wc]=void 0;var i=!0}catch{}var r=KD.call(n);return i&&(t?n[Wc]=e:delete n[Wc]),r}var hE=YD;var QD=Object.prototype,XD=QD.toString;function JD(n){return XD.call(n)}var dE=JD;var ZD="[object Null]",tM="[object Undefined]",fE=Qo?Qo.toStringTag:void 0;function eM(n){return n==null?n===void 0?tM:ZD:fE&&fE in Object(n)?hE(n):dE(n)}var wr=eM;function nM(n){return n!=null&&typeof n=="object"}var si=nM;var iM=Array.isArray,Hc=iM;function rM(n){var t=typeof n;return n!=null&&(t=="object"||t=="function")}var tn=rM;function sM(n){return n}var Zh=sM;var oM="[object AsyncFunction]",aM="[object Function]",cM="[object GeneratorFunction]",lM="[object Proxy]";function uM(n){if(!tn(n))return!1;var t=wr(n);return t==aM||t==cM||t==oM||t==lM}var Xo=uM;var hM=Tn["__core-js_shared__"],td=hM;var pE=function(){var n=/[^.]+$/.exec(td&&td.keys&&td.keys.IE_PROTO||"");return n?"Symbol(src)_1."+n:""}();function dM(n){return!!pE&&pE in n}var gE=dM;var fM=Function.prototype,pM=fM.toString;function gM(n){if(n!=null){try{return pM.call(n)}catch{}try{return n+""}catch{}}return""}var mE=gM;var mM=/[\\^$.*+?()[\]{}|]/g,_M=/^\[object .+?Constructor\]$/,yM=Function.prototype,vM=Object.prototype,bM=yM.toString,xM=vM.hasOwnProperty,wM=RegExp("^"+bM.call(xM).replace(mM,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function TM(n){if(!tn(n)||gE(n))return!1;var t=Xo(n)?wM:_M;return t.test(mE(n))}var _E=TM;function EM(n,t){return n?.[t]}var yE=EM;function IM(n,t){var e=yE(n,t);return _E(e)?e:void 0}var Jo=IM;var vE=Object.create,SM=function(){function n(){}return function(t){if(!tn(t))return{};if(vE)return vE(t);n.prototype=t;var e=new n;return n.prototype=void 0,e}}(),bE=SM;function AM(n,t,e){switch(e.length){case 0:return n.call(t);case 1:return n.call(t,e[0]);case 2:return n.call(t,e[0],e[1]);case 3:return n.call(t,e[0],e[1],e[2])}return n.apply(t,e)}var xE=AM;function CM(n,t){var e=-1,i=n.length;for(t||(t=Array(i));++e<i;)t[e]=n[e];return t}var wE=CM;var PM=800,kM=16,RM=Date.now;function DM(n){var t=0,e=0;return function(){var i=RM(),r=kM-(i-e);if(e=i,r>0){if(++t>=PM)return arguments[0]}else t=0;return n.apply(void 0,arguments)}}var TE=DM;function MM(n){return function(){return n}}var EE=MM;var OM=function(){try{var n=Jo(Object,"defineProperty");return n({},"",{}),n}catch{}}(),Zo=OM;var VM=Zo?function(n,t){return Zo(n,"toString",{configurable:!0,enumerable:!1,value:EE(t),writable:!0})}:Zh,IE=VM;var NM=TE(IE),SE=NM;var FM=9007199254740991,LM=/^(?:0|[1-9]\d*)$/;function BM(n,t){var e=typeof n;return t=t??FM,!!t&&(e=="number"||e!="symbol"&&LM.test(n))&&n>-1&&n%1==0&&n<t}var ed=BM;function zM(n,t,e){t=="__proto__"&&Zo?Zo(n,t,{configurable:!0,enumerable:!0,value:e,writable:!0}):n[t]=e}var ta=zM;function jM(n,t){return n===t||n!==n&&t!==t}var Tr=jM;var UM=Object.prototype,qM=UM.hasOwnProperty;function WM(n,t,e){var i=n[t];(!(qM.call(n,t)&&Tr(i,e))||e===void 0&&!(t in n))&&ta(n,t,e)}var AE=WM;function HM(n,t,e,i){var r=!e;e||(e={});for(var s=-1,o=t.length;++s<o;){var a=t[s],c=i?i(e[a],n[a],a,e,n):void 0;c===void 0&&(c=n[a]),r?ta(e,a,c):AE(e,a,c)}return e}var CE=HM;var PE=Math.max;function GM(n,t,e){return t=PE(t===void 0?n.length-1:t,0),function(){for(var i=arguments,r=-1,s=PE(i.length-t,0),o=Array(s);++r<s;)o[r]=i[t+r];r=-1;for(var a=Array(t+1);++r<t;)a[r]=i[r];return a[t]=e(o),xE(n,this,a)}}var kE=GM;function $M(n,t){return SE(kE(n,t,Zh),n+"")}var RE=$M;var KM=9007199254740991;function YM(n){return typeof n=="number"&&n>-1&&n%1==0&&n<=KM}var nd=YM;function QM(n){return n!=null&&nd(n.length)&&!Xo(n)}var ea=QM;function XM(n,t,e){if(!tn(e))return!1;var i=typeof t;return(i=="number"?ea(e)&&ed(t,e.length):i=="string"&&t in e)?Tr(e[t],n):!1}var DE=XM;function JM(n){return RE(function(t,e){var i=-1,r=e.length,s=r>1?e[r-1]:void 0,o=r>2?e[2]:void 0;for(s=n.length>3&&typeof s=="function"?(r--,s):void 0,o&&DE(e[0],e[1],o)&&(s=r<3?void 0:s,r=1),t=Object(t);++i<r;){var a=e[i];a&&n(t,a,i,s)}return t})}var ME=JM;var ZM=Object.prototype;function tO(n){var t=n&&n.constructor,e=typeof t=="function"&&t.prototype||ZM;return n===e}var id=tO;function eO(n,t){for(var e=-1,i=Array(n);++e<n;)i[e]=t(e);return i}var OE=eO;var nO="[object Arguments]";function iO(n){return si(n)&&wr(n)==nO}var P_=iO;var VE=Object.prototype,rO=VE.hasOwnProperty,sO=VE.propertyIsEnumerable,oO=P_(function(){return arguments}())?P_:function(n){return si(n)&&rO.call(n,"callee")&&!sO.call(n,"callee")},Gc=oO;function aO(){return!1}var NE=aO;var BE=typeof exports=="object"&&exports&&!exports.nodeType&&exports,FE=BE&&typeof module=="object"&&module&&!module.nodeType&&module,cO=FE&&FE.exports===BE,LE=cO?Tn.Buffer:void 0,lO=LE?LE.isBuffer:void 0,uO=lO||NE,rd=uO;var hO="[object Arguments]",dO="[object Array]",fO="[object Boolean]",pO="[object Date]",gO="[object Error]",mO="[object Function]",_O="[object Map]",yO="[object Number]",vO="[object Object]",bO="[object RegExp]",xO="[object Set]",wO="[object String]",TO="[object WeakMap]",EO="[object ArrayBuffer]",IO="[object DataView]",SO="[object Float32Array]",AO="[object Float64Array]",CO="[object Int8Array]",PO="[object Int16Array]",kO="[object Int32Array]",RO="[object Uint8Array]",DO="[object Uint8ClampedArray]",MO="[object Uint16Array]",OO="[object Uint32Array]",Ft={};Ft[SO]=Ft[AO]=Ft[CO]=Ft[PO]=Ft[kO]=Ft[RO]=Ft[DO]=Ft[MO]=Ft[OO]=!0;Ft[hO]=Ft[dO]=Ft[EO]=Ft[fO]=Ft[IO]=Ft[pO]=Ft[gO]=Ft[mO]=Ft[_O]=Ft[yO]=Ft[vO]=Ft[bO]=Ft[xO]=Ft[wO]=Ft[TO]=!1;function VO(n){return si(n)&&nd(n.length)&&!!Ft[wr(n)]}var zE=VO;function NO(n){return function(t){return n(t)}}var jE=NO;var UE=typeof exports=="object"&&exports&&!exports.nodeType&&exports,$c=UE&&typeof module=="object"&&module&&!module.nodeType&&module,FO=$c&&$c.exports===UE,k_=FO&&Jh.process,LO=function(){try{var n=$c&&$c.require&&$c.require("util").types;return n||k_&&k_.binding&&k_.binding("util")}catch{}}(),R_=LO;var qE=R_&&R_.isTypedArray,BO=qE?jE(qE):zE,sd=BO;var zO=Object.prototype,jO=zO.hasOwnProperty;function UO(n,t){var e=Hc(n),i=!e&&Gc(n),r=!e&&!i&&rd(n),s=!e&&!i&&!r&&sd(n),o=e||i||r||s,a=o?OE(n.length,String):[],c=a.length;for(var l in n)(t||jO.call(n,l))&&!(o&&(l=="length"||r&&(l=="offset"||l=="parent")||s&&(l=="buffer"||l=="byteLength"||l=="byteOffset")||ed(l,c)))&&a.push(l);return a}var WE=UO;function qO(n,t){return function(e){return n(t(e))}}var HE=qO;function WO(n){var t=[];if(n!=null)for(var e in Object(n))t.push(e);return t}var GE=WO;var HO=Object.prototype,GO=HO.hasOwnProperty;function $O(n){if(!tn(n))return GE(n);var t=id(n),e=[];for(var i in n)i=="constructor"&&(t||!GO.call(n,i))||e.push(i);return e}var $E=$O;function KO(n){return ea(n)?WE(n,!0):$E(n)}var od=KO;var YO=Jo(Object,"create"),Mi=YO;function QO(){this.__data__=Mi?Mi(null):{},this.size=0}var KE=QO;function XO(n){var t=this.has(n)&&delete this.__data__[n];return this.size-=t?1:0,t}var YE=XO;var JO="__lodash_hash_undefined__",ZO=Object.prototype,tV=ZO.hasOwnProperty;function eV(n){var t=this.__data__;if(Mi){var e=t[n];return e===JO?void 0:e}return tV.call(t,n)?t[n]:void 0}var QE=eV;var nV=Object.prototype,iV=nV.hasOwnProperty;function rV(n){var t=this.__data__;return Mi?t[n]!==void 0:iV.call(t,n)}var XE=rV;var sV="__lodash_hash_undefined__";function oV(n,t){var e=this.__data__;return this.size+=this.has(n)?0:1,e[n]=Mi&&t===void 0?sV:t,this}var JE=oV;function na(n){var t=-1,e=n==null?0:n.length;for(this.clear();++t<e;){var i=n[t];this.set(i[0],i[1])}}na.prototype.clear=KE;na.prototype.delete=YE;na.prototype.get=QE;na.prototype.has=XE;na.prototype.set=JE;var D_=na;function aV(){this.__data__=[],this.size=0}var ZE=aV;function cV(n,t){for(var e=n.length;e--;)if(Tr(n[e][0],t))return e;return-1}var Er=cV;var lV=Array.prototype,uV=lV.splice;function hV(n){var t=this.__data__,e=Er(t,n);if(e<0)return!1;var i=t.length-1;return e==i?t.pop():uV.call(t,e,1),--this.size,!0}var tI=hV;function dV(n){var t=this.__data__,e=Er(t,n);return e<0?void 0:t[e][1]}var eI=dV;function fV(n){return Er(this.__data__,n)>-1}var nI=fV;function pV(n,t){var e=this.__data__,i=Er(e,n);return i<0?(++this.size,e.push([n,t])):e[i][1]=t,this}var iI=pV;function ia(n){var t=-1,e=n==null?0:n.length;for(this.clear();++t<e;){var i=n[t];this.set(i[0],i[1])}}ia.prototype.clear=ZE;ia.prototype.delete=tI;ia.prototype.get=eI;ia.prototype.has=nI;ia.prototype.set=iI;var Ir=ia;var gV=Jo(Tn,"Map"),ad=gV;function mV(){this.size=0,this.__data__={hash:new D_,map:new(ad||Ir),string:new D_}}var rI=mV;function _V(n){var t=typeof n;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?n!=="__proto__":n===null}var sI=_V;function yV(n,t){var e=n.__data__;return sI(t)?e[typeof t=="string"?"string":"hash"]:e.map}var Sr=yV;function vV(n){var t=Sr(this,n).delete(n);return this.size-=t?1:0,t}var oI=vV;function bV(n){return Sr(this,n).get(n)}var aI=bV;function xV(n){return Sr(this,n).has(n)}var cI=xV;function wV(n,t){var e=Sr(this,n),i=e.size;return e.set(n,t),this.size+=e.size==i?0:1,this}var lI=wV;function ra(n){var t=-1,e=n==null?0:n.length;for(this.clear();++t<e;){var i=n[t];this.set(i[0],i[1])}}ra.prototype.clear=rI;ra.prototype.delete=oI;ra.prototype.get=aI;ra.prototype.has=cI;ra.prototype.set=lI;var uI=ra;var TV=HE(Object.getPrototypeOf,Object),cd=TV;var EV="[object Object]",IV=Function.prototype,SV=Object.prototype,hI=IV.toString,AV=SV.hasOwnProperty,CV=hI.call(Object);function PV(n){if(!si(n)||wr(n)!=EV)return!1;var t=cd(n);if(t===null)return!0;var e=AV.call(t,"constructor")&&t.constructor;return typeof e=="function"&&e instanceof e&&hI.call(e)==CV}var dI=PV;function kV(){this.__data__=new Ir,this.size=0}var fI=kV;function RV(n){var t=this.__data__,e=t.delete(n);return this.size=t.size,e}var pI=RV;function DV(n){return this.__data__.get(n)}var gI=DV;function MV(n){return this.__data__.has(n)}var mI=MV;var OV=200;function VV(n,t){var e=this.__data__;if(e instanceof Ir){var i=e.__data__;if(!ad||i.length<OV-1)return i.push([n,t]),this.size=++e.size,this;e=this.__data__=new uI(i)}return e.set(n,t),this.size=e.size,this}var _I=VV;function sa(n){var t=this.__data__=new Ir(n);this.size=t.size}sa.prototype.clear=fI;sa.prototype.delete=pI;sa.prototype.get=gI;sa.prototype.has=mI;sa.prototype.set=_I;var yI=sa;var wI=typeof exports=="object"&&exports&&!exports.nodeType&&exports,vI=wI&&typeof module=="object"&&module&&!module.nodeType&&module,NV=vI&&vI.exports===wI,bI=NV?Tn.Buffer:void 0,xI=bI?bI.allocUnsafe:void 0;function FV(n,t){if(t)return n.slice();var e=n.length,i=xI?xI(e):new n.constructor(e);return n.copy(i),i}var TI=FV;var LV=Tn.Uint8Array,M_=LV;function BV(n){var t=new n.constructor(n.byteLength);return new M_(t).set(new M_(n)),t}var EI=BV;function zV(n,t){var e=t?EI(n.buffer):n.buffer;return new n.constructor(e,n.byteOffset,n.length)}var II=zV;function jV(n){return typeof n.constructor=="function"&&!id(n)?bE(cd(n)):{}}var SI=jV;function UV(n){return function(t,e,i){for(var r=-1,s=Object(t),o=i(t),a=o.length;a--;){var c=o[n?a:++r];if(e(s[c],c,s)===!1)break}return t}}var AI=UV;var qV=AI(),CI=qV;function WV(n,t,e){(e!==void 0&&!Tr(n[t],e)||e===void 0&&!(t in n))&&ta(n,t,e)}var Kc=WV;function HV(n){return si(n)&&ea(n)}var PI=HV;function GV(n,t){if(!(t==="constructor"&&typeof n[t]=="function")&&t!="__proto__")return n[t]}var Yc=GV;function $V(n){return CE(n,od(n))}var kI=$V;function KV(n,t,e,i,r,s,o){var a=Yc(n,e),c=Yc(t,e),l=o.get(c);if(l){Kc(n,e,l);return}var h=s?s(a,c,e+"",n,t,o):void 0,d=h===void 0;if(d){var p=Hc(c),g=!p&&rd(c),y=!p&&!g&&sd(c);h=c,p||g||y?Hc(a)?h=a:PI(a)?h=wE(a):g?(d=!1,h=TI(c,!0)):y?(d=!1,h=II(c,!0)):h=[]:dI(c)||Gc(c)?(h=a,Gc(a)?h=kI(a):(!tn(a)||Xo(a))&&(h=SI(c))):d=!1}d&&(o.set(c,h),r(h,c,i,s,o),o.delete(c)),Kc(n,e,h)}var RI=KV;function DI(n,t,e,i,r){n!==t&&CI(t,function(s,o){if(r||(r=new yI),tn(s))RI(n,t,o,e,DI,i,r);else{var a=i?i(Yc(n,o),s,o+"",n,t,r):void 0;a===void 0&&(a=s),Kc(n,o,a)}},od)}var MI=DI;var YV=ME(function(n,t,e){MI(n,t,e)}),ld=YV;var OI=new we("Configuration for ngCharts");function VI(...n){return{registerables:[...lE,...n]}}function NI(...n){let t=ld({},...n);return{provide:OI,useValue:t}}var QV=(()=>{let t=class t{constructor(){this.colorschemesOptions=new sy(void 0)}setColorschemesOptions(i){this.pColorschemesOptions=i,this.colorschemesOptions.next(i)}getColorschemesOptions(){return this.pColorschemesOptions}};t.\u0275fac=function(r){return new(r||t)},t.\u0275prov=Me({token:t,factory:t.\u0275fac,providedIn:"root"});let n=t;return n})(),FI=(()=>{let t=class t{constructor(i,r,s,o){this.zone=r,this.themeService=s,this.type="bar",this.plugins=[],this.chartClick=new Te,this.chartHover=new Te,this.subs=[],this.themeOverrides={},o?.registerables&&Yh.register(...o.registerables),o?.defaults&&Nt.set(o.defaults),this.ctx=i.nativeElement.getContext("2d"),this.subs.push(this.themeService.colorschemesOptions.pipe(_l()).subscribe(a=>this.themeChanged(a)))}ngOnChanges(i){let r=["type"],s=Object.getOwnPropertyNames(i);if(s.some(o=>r.includes(o))||s.every(o=>i[o].isFirstChange()))this.render();else{let o=this.getChartConfiguration();this.chart&&(Object.assign(this.chart.config.data,o.data),this.chart.config.plugins&&Object.assign(this.chart.config.plugins,o.plugins),this.chart.config.options&&Object.assign(this.chart.config.options,o.options)),this.update()}}ngOnDestroy(){this.chart&&(this.chart.destroy(),this.chart=void 0),this.subs.forEach(i=>i.unsubscribe())}render(){return this.chart&&this.chart.destroy(),this.zone.runOutsideAngular(()=>this.chart=new Yh(this.ctx,this.getChartConfiguration()))}update(i){this.chart&&this.zone.runOutsideAngular(()=>this.chart?.update(i))}hideDataset(i,r){this.chart&&(this.chart.getDatasetMeta(i).hidden=r,this.update())}isDatasetHidden(i){return this.chart?.getDatasetMeta(i)?.hidden}toBase64Image(){return this.chart?.toBase64Image()}themeChanged(i){this.themeOverrides=i,this.chart&&(this.chart.config.options&&Object.assign(this.chart.config.options,this.getChartOptions()),this.update())}getChartOptions(){return ld({onHover:(i,r)=>{!this.chartHover.observed&&!this.chartHover.observers?.length||this.zone.run(()=>this.chartHover.emit({event:i,active:r}))},onClick:(i,r)=>{!this.chartClick.observed&&!this.chartClick.observers?.length||this.zone.run(()=>this.chartClick.emit({event:i,active:r}))}},this.themeOverrides,this.options,{plugins:{legend:{display:this.legend}}})}getChartConfiguration(){return{type:this.type,data:this.getChartData(),options:this.getChartOptions(),plugins:this.plugins}}getChartData(){return this.data?this.data:{labels:this.labels||[],datasets:this.datasets||[]}}};t.\u0275fac=function(r){return new(r||t)($t(Tl),$t(jn),$t(QV),$t(OI,8))},t.\u0275dir=xl({type:t,selectors:[["canvas","baseChart",""]],inputs:{type:"type",legend:"legend",data:"data",options:"options",plugins:"plugins",labels:"labels",datasets:"datasets"},outputs:{chartClick:"chartClick",chartHover:"chartHover"},exportAs:["base-chart"],standalone:!0,features:[wl]});let n=t;return n})();function JV(n,t){if(n&1){let e=zt();Y(0,"div",1)(1,"div",2)(2,"span",3),ot("click",function(){rt(e);let r=tt();return st(r.showCategoryDetails(r.category))}),et(3),X(),Y(4,"span"),et(5),X()(),Y(6,"div",4)(7,"div",5)(8,"div",5),et(9),X()(),Y(10,"div",6),ot("click",function(){rt(e);let r=tt();return st(r.onHide())}),et(11,"X"),X()()()}if(n&2){let e=tt();nt(3),gn(e.getCategoryNameByIdFunc(e.category)),nt(2),_e("",e.amount,"\u20AC"),nt(3),Ie("width",e.percentage,"%")("background-color",e.color),nt(),_e(" ",e.percentage.toFixed(2),"% ")}}var ud=class n{constructor(t){this.router=t}category;amount;percentage;color;close=new Te;getCategoryNameByIdFunc=Wi;isVisible=!0;showCategoryDetails(t){this.router.navigate(["/details"],{queryParams:{"category-id":t,"back-url":"/statistics"}})}onHide(){this.isVisible=!1,this.close.emit(this.category)}static \u0275fac=function(e){return new(e||n)($t(qi))};static \u0275cmp=Oe({type:n,selectors:[["app-statistics-bar"]],inputs:{category:"category",amount:"amount",percentage:"percentage",color:"color"},outputs:{close:"close"},decls:1,vars:1,consts:[["class","category-summary",4,"ngIf"],[1,"category-summary"],[1,"category-header"],[1,"app-link",3,"click"],[1,"progress-bar-container"],[1,"progress-bar"],[1,"progress-bar-delete",3,"click"]],template:function(e,i){e&1&&Ee(0,JV,12,7,"div",0),e&2&&Ct("ngIf",i.isVisible)},dependencies:[mn],styles:[".category-summary[_ngcontent-%COMP%]{margin-bottom:20px}.category-summary[_ngcontent-%COMP%]   .category-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-weight:700;margin-bottom:5px}.category-summary[_ngcontent-%COMP%]   .progress-bar-container[_ngcontent-%COMP%]{display:flex}.category-summary[_ngcontent-%COMP%]   .progress-bar-container[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{background-color:#e0e0e0;border-radius:5px;overflow:hidden;width:calc(100% - 30px);height:25px}.category-summary[_ngcontent-%COMP%]   .progress-bar-container[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]   .progress-bar[_ngcontent-%COMP%]{background-color:#4caf50;height:25px;line-height:25px;color:#fff;text-align:center;border-radius:5px}.category-summary[_ngcontent-%COMP%]   .progress-bar-container[_ngcontent-%COMP%]   .progress-bar-delete[_ngcontent-%COMP%]{padding:5px}"]})};function tN(n,t){if(n&1){let e=zt();Y(0,"div")(1,"span"),et(2),X(),Y(3,"i",8),ot("click",function(){rt(e);let r=tt();return st(r.onRefresh())}),X(),me(4,"br")(5,"br"),X()}if(n&2){let e=tt();nt(2),_e("(\u0417\u0430 \u0438\u0441\u043A\u043B\u044E\u0447\u0435\u043D\u0438\u0435\u043C: ",e.excludedCategories.join(", "),") ")}}function eN(n,t){if(n&1){let e=zt();Y(0,"app-statistics-bar",9),ot("close",function(r){rt(e);let s=tt();return st(s.onBarClose(r))}),X()}if(n&2){let e=t.$implicit;Ct("amount",e.amount)("category",e.category)("percentage",e.percentage)("color",e.color)}}var LI=(i=>(i.TODAY="today",i.WEEK="week",i.MONTH="month",i))(LI||{}),hd=class n{constructor(t){this.router=t}categoryTotals=[];totalAmount=0;getCategoryNameByIdFunc=Wi;excludedCategories=[];chartOptions={datasets:[{data:[1],label:"Expenses"}],labels:["1"],options:{responsive:!0},colors:[{borderColor:"black",backgroundColor:"rgba(255,0,0,0.3)"}],legend:!1};mode="today";title="\u0437\u0430 \u0441\u0435\u0433\u043E\u0434\u043D\u044F";ngOnInit(){this.calculateCategoryTotals()}showCategoryDetails(t){this.router.navigate(["/details"],{queryParams:{"category-id":t,"back-url":"/statistics"}})}calculateCategoryTotals(t){let e=new Date;if(t==="week"){let s=e.getDay(),o=s===0?6:s-1;e.setDate(e.getDate()-o)}t==="month"&&(e=new Date(e.setDate(1)));let i=JSON.parse(localStorage.getItem("expenses")||"[]"),r={};if(!t||t==="today"){this.chartOptions.labels=new Array(24).fill(0).map((s,o)=>o+":00"),this.chartOptions.datasets[0].data=new Array(24).fill(0);for(let s=new Date().getHours();s<24;s++)this.chartOptions.datasets[0].data[s]=null}if(t==="week"){this.chartOptions.labels=["\u0412\u0441","\u041F\u043D","\u0412\u0442","\u0421\u0440","\u0427\u0442","\u041F\u0442","\u0421\u0431"],this.chartOptions.datasets[0].data=new Array(7).fill(0);for(let s=new Date().getDay();s<7;s++)this.chartOptions.datasets[0].data[s]=null}if(t==="month"){this.chartOptions.labels=new Array(31).fill(0).map((s,o)=>o+1),this.chartOptions.datasets[0].data=new Array(31).fill(0);for(let s=new Date().getDate();s<31;s++)this.chartOptions.datasets[0].data[s]=null}i.filter(s=>{let o=new Date(s.date);return o.getDate()>=e.getDate()&&o.getMonth()===e.getMonth()&&o.getFullYear()===e.getFullYear()}).forEach(s=>{if(!t||t==="today"){let o=new Date(s.date).getHours();this.chartOptions.datasets[0].data[o]=Math.round((this.chartOptions.datasets[0].data[o]+s.amount)*100)/100}if(t==="week"){let o=new Date(s.date).getDay();this.chartOptions.datasets[0].data[o]=Math.round((this.chartOptions.datasets[0].data[o]+s.amount)*100)/100}if(t==="month"){let o=new Date(s.date).getDate();this.chartOptions.datasets[0].data[o-1]=Math.round((this.chartOptions.datasets[0].data[o-1]+s.amount)*100)/100}r[s.category]||(r[s.category]=0),r[s.category]=Math.round((r[s.category]+s.amount)*100)/100,this.totalAmount=Math.round((this.totalAmount+s.amount)*100)/100});for(let s in r){let o=r[s],a=o/this.totalAmount*100,c=this.getColor(a);this.categoryTotals.push({category:s,amount:o,percentage:a,color:c}),this.categoryTotals.sort((l,h)=>l.amount-h.amount)}t==="week"&&(this.chartOptions.labels.push(this.chartOptions.labels.shift()),this.chartOptions.datasets[0].data.push(this.chartOptions.datasets[0].data.shift()),new Date().getDay()!==0&&(this.chartOptions.datasets[0].data[6]=null)),console.log(this.chartOptions)}calculateChartValues(){}touchStartX=0;touchStartY=0;touchEndX=0;touchEndY=0;onTouchStart(t){this.touchStartX=t.changedTouches[0].screenX,this.touchStartY=t.changedTouches[0].screenY}onTouchEnd(t){this.touchEndX=t.changedTouches[0].screenX,this.touchEndY=t.changedTouches[0].screenY,this.handleSwipeGesture()}handleSwipeGesture(){let t=this.touchEndX-this.touchStartX,e=this.touchEndY-this.touchStartY;Math.abs(t)>Math.abs(e)&&(t>50?this.onSwipeRight():t<-50&&this.onSwipeLeft())}onSwipeLeft(){this.router.navigate(["/"])}onSwipeRight(){this.router.navigate(["/history"])}getColor(t){let e=Math.min(255,Math.round((100-t)*2.55));return`rgb(${Math.min(180,Math.round(t*1.8))}, ${e}, 0)`}onRefresh(){this.categoryTotals=[],this.totalAmount=0,this.excludedCategories=[],this.calculateCategoryTotals()}onBarClose(t){this.excludedCategories=[...this.excludedCategories,t],this.totalAmount=this.categoryTotals.filter(e=>!this.excludedCategories.includes(e.category)).reduce((e,i)=>Math.round((e+i.amount)*100)/100,0)}changeMode(t){this.mode=t,this.categoryTotals=[],this.totalAmount=0,this.calculateCategoryTotals(t),this.title=t==="today"?"\u0437\u0430 \u0441\u0435\u0433\u043E\u0434\u043D\u044F":t==="week"?"\u043D\u0430 \u044D\u0442\u043E\u0439 \u043D\u0435\u0434\u0435\u043B\u0435":"\u0432 \u044D\u0442\u043E\u043C \u043C\u0435\u0441\u044F\u0446\u0435"}Mode=LI;static \u0275fac=function(e){return new(e||n)($t(qi))};static \u0275cmp=Oe({type:n,selectors:[["app-statistics"]],hostBindings:function(e,i){e&1&&ot("touchstart",function(s){return i.onTouchStart(s)})("touchend",function(s){return i.onTouchEnd(s)})},decls:17,vars:14,consts:[[1,"statistics"],[1,"statistics-period"],[1,"statistics-period-button",3,"click"],[1,"statistics-title"],[4,"ngIf"],[3,"amount","category","percentage","color","close",4,"ngFor","ngForOf"],[2,"display","block"],["baseChart","","type","line",3,"datasets","labels","options","legend"],[1,"fas","fa-redo-alt",3,"click"],[3,"close","amount","category","percentage","color"]],template:function(e,i){e&1&&(Y(0,"div",0)(1,"header",1)(2,"button",2),ot("click",function(){return i.changeMode(i.Mode.TODAY)}),et(3,"\u0417\u0430 \u0441\u0435\u0433\u043E\u0434\u043D\u044F "),X(),Y(4,"button",2),ot("click",function(){return i.changeMode(i.Mode.WEEK)}),et(5,"\u0417\u0430 \u043D\u0435\u0434\u0435\u043B\u044E "),X(),Y(6,"button",2),ot("click",function(){return i.changeMode(i.Mode.MONTH)}),et(7,"\u0417\u0430 \u043C\u0435\u0441\u044F\u0446 "),X()(),Y(8,"div",3),et(9),X(),et(10),me(11,"br")(12,"br"),Ee(13,tN,6,1,"div",4)(14,eN,1,4,"app-statistics-bar",5),Y(15,"div",6),me(16,"canvas",7),X()()),e&2&&(nt(2),El("statistics-period-button-active",i.mode===i.Mode.TODAY),nt(2),El("statistics-period-button-active",i.mode===i.Mode.WEEK),nt(2),El("statistics-period-button-active",i.mode===i.Mode.MONTH),nt(3),_e("\u0421\u0442\u0430\u0442\u0438\u0441\u0442\u0438\u043A\u0430 \u043F\u043E \u043A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F\u043C ",i.title,":"),nt(),_e(" \u0412\u0441\u0435\u0433\u043E \u043F\u043E\u0442\u0440\u0430\u0447\u0435\u043D\u043E: ",i.totalAmount,"\u20AC"),nt(3),Ct("ngIf",(i.excludedCategories==null?null:i.excludedCategories.length)>0),nt(),Ct("ngForOf",i.categoryTotals),nt(2),Ct("datasets",i.chartOptions.datasets)("labels",i.chartOptions.labels)("options",i.chartOptions.options)("legend",i.chartOptions.legend))},dependencies:[Il,mn,FI,ud],styles:[".category-summary[_ngcontent-%COMP%]{margin-bottom:20px}.category-summary[_ngcontent-%COMP%]:last-child{margin-bottom:50px}.category-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;font-weight:700;margin-bottom:5px}.progress-bar-container[_ngcontent-%COMP%]{background-color:#e0e0e0;border-radius:5px;overflow:hidden}.progress-bar[_ngcontent-%COMP%]{background-color:#4caf50;height:25px;line-height:25px;color:#fff;text-align:center;border-radius:5px}.statistics[_ngcontent-%COMP%]{padding:15px;min-height:100dvh}.statistics-title[_ngcontent-%COMP%]{text-align:center;font-size:18px;margin:15px}.statistics-period[_ngcontent-%COMP%]{display:flex;justify-content:center;margin-bottom:20px}.statistics-period-button[_ngcontent-%COMP%]{margin:0 10px;padding:5px 10px;font-size:.9rem;font-family:Montserrat,sans-serif;border:1px solid #e0e0e0;border-radius:5px;background-color:transparent;cursor:pointer}.statistics-period-button-active[_ngcontent-%COMP%]{background-color:#f8d7da}"]})};var dd=class n{constructor(t,e){this.activatedRoute=t;this.router=e}amountForDay=0;amountForMonth=0;amountForYear=0;backUrl="";selectedCategory="";ngOnInit(){this.initDetails()}initDetails(){let t=this.activatedRoute.snapshot.queryParamMap.get("category-id");this.selectedCategory=Wi(t),this.backUrl=this.activatedRoute.snapshot.queryParamMap.get("back-url");let e=JSON.parse(localStorage.getItem("expenses")||"[]"),i=new Date().getDate(),r=new Date().getMonth(),s=new Date().getFullYear();e.forEach(o=>{let a=new Date(o.date),c=a.getDate(),l=a.getMonth(),h=a.getFullYear();t===o.category&&(i===c&&r===l&&s===h&&(this.amountForDay=Math.round((this.amountForDay+o.amount)*100)/100),r===l&&s===h&&(this.amountForMonth=Math.round((this.amountForMonth+o.amount)*100)/100),s===h&&(this.amountForYear=Math.round((this.amountForYear+o.amount)*100)/100))})}touchStartX=0;touchStartY=0;touchEndX=0;touchEndY=0;onTouchStart(t){this.touchStartX=t.changedTouches[0].screenX,this.touchStartY=t.changedTouches[0].screenY}onTouchEnd(t){this.touchEndX=t.changedTouches[0].screenX,this.touchEndY=t.changedTouches[0].screenY,this.handleSwipeGesture()}handleSwipeGesture(){let t=this.touchEndX-this.touchStartX,e=this.touchEndY-this.touchStartY;Math.abs(t)>Math.abs(e)&&(t>50?this.navigateBack():t<-50&&this.navigateBack())}navigateBack(){this.router.navigate([this.backUrl])}static \u0275fac=function(e){return new(e||n)($t(jy),$t(qi))};static \u0275cmp=Oe({type:n,selectors:[["app-details"]],hostBindings:function(e,i){e&1&&ot("touchstart",function(s){return i.onTouchStart(s)})("touchend",function(s){return i.onTouchEnd(s)})},decls:21,vars:6,consts:[[1,"details"],[1,"details-item"],[1,"amount"]],template:function(e,i){e&1&&(Y(0,"div",0)(1,"div"),et(2," \u041A\u0430\u0442\u0435\u0433\u043E\u0440\u0438\u044F: "),Y(3,"span"),et(4),X()(),me(5,"hr"),Y(6,"div",1),et(7," \u041F\u043E\u0442\u0440\u0430\u0447\u0435\u043D\u043E \u0441\u0435\u0433\u043E\u0434\u043D\u044F: "),Y(8,"span",2),et(9),X()(),me(10,"hr"),Y(11,"div",1),et(12," \u041F\u043E\u0442\u0440\u0430\u0447\u0435\u043D\u043E \u0437\u0430 \u043C\u0435\u0441\u044F\u0446: "),Y(13,"span",2),et(14),X()(),me(15,"hr"),Y(16,"div",1),et(17," \u041F\u043E\u0442\u0440\u0430\u0447\u0435\u043D\u043E \u0437\u0430 \u0433\u043E\u0434: "),Y(18,"span",2),et(19),X()(),me(20,"hr"),X()),e&2&&(nt(3),Ie("color","#DB654D"),nt(),gn(i.selectedCategory),nt(5),_e("",i.amountForDay,"\u20AC"),nt(5),_e("",i.amountForMonth,"\u20AC"),nt(5),_e("",i.amountForYear,"\u20AC"))},styles:[".details[_ngcontent-%COMP%]{height:100dvh;margin:15px}.details-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin:10px 0}.details[_ngcontent-%COMP%]   .amount[_ngcontent-%COMP%]{font-size:18px;color:#ff6f61}"]})};var fd=class n{constructor(t){this.fireStore=t;this.expensesCollection=this.fireStore.collection("expenses")}expensesCollection;addExpense(t){let e=this.fireStore.createId();return this.expensesCollection.doc(e).set(Rn(pn({},t),{id:e}))}getExpenses(){return this.expensesCollection.valueChanges({idField:"id"})}updateExpense(t){return this.expensesCollection.doc(t.id).update(t)}deleteExpense(t){return this.expensesCollection.doc(t).delete()}static \u0275fac=function(e){return new(e||n)(ht(dm))};static \u0275prov=Me({token:n,factory:n.\u0275fac,providedIn:"root"})};var pd=class n{constructor(t){this.afAuth=t;this.user$=this.afAuth.authState}user$;signInWithGoogle(){return this.afAuth.signInWithPopup(new zd)}signOut(){return this.afAuth.signOut()}static \u0275fac=function(e){return new(e||n)(ht(Vl))};static \u0275prov=Me({token:n,factory:n.\u0275fac,providedIn:"root"})};function rN(n,t){if(n&1){let e=zt();Y(0,"div")(1,"button",1),ot("click",function(){rt(e);let r=tt();return st(r.exportFirebase())}),et(2,"Export Firebase"),X()()}}function sN(n,t){if(n&1){let e=zt();Y(0,"div")(1,"h3"),et(2),X(),Y(3,"button",1),ot("click",function(){rt(e);let r=tt();return st(r.logout())}),et(4,"Sign Out"),X()()}if(n&2){let e=t.ngIf;nt(2),_e("Welcome, ",e.displayName,"!")}}function oN(n,t){if(n&1){let e=zt();Y(0,"button",1),ot("click",function(){rt(e);let r=tt();return st(r.login())}),et(1,"Sign in with Google"),X()}}var gd=class n{constructor(t,e){this.expenseService=t;this.authService=e;this.user$=this.authService.user$}user$;login(){this.authService.signInWithGoogle().then(t=>{console.log("Logged in with Google:",t)}).catch(t=>{console.error("Google Sign-in Error:",t)})}logout(){this.authService.signOut().then(()=>{console.log("User logged out")})}exportCSV(){let t=JSON.parse(localStorage.getItem("expenses")||"[]").map(o=>Rn(pn({},o),{date:new Date(o.date).toLocaleDateString()})),e=this.convertToCSV(t),i=new Blob([e],{type:"text/csv"}),r=window.URL.createObjectURL(i),s=document.createElement("a");s.href=r,s.download="exported_data.csv",s.click(),window.URL.revokeObjectURL(r)}convertToCSV(t){return[Object.keys(t[0])].concat(t).map(i=>Object.values(i).map(r=>typeof r=="string"&&(r=r.replace(/"/g,'""'),r.includes(","))?`"${r}"`:r).join(",")).join(`
`)}exportFirebase(){let t=JSON.parse(localStorage.getItem("expenses")||"[]");if(t.length>0){let e=t.map(i=>this.expenseService.addExpense(i));ay(e).subscribe(()=>{console.log("Data migrated successfully to Firestore")})}}static \u0275fac=function(e){return new(e||n)($t(fd),$t(pd))};static \u0275cmp=Oe({type:n,selectors:[["app-export"]],decls:9,vars:7,consts:[["loginButton",""],[3,"click"],[4,"ngIf"],[4,"ngIf","ngIfElse"]],template:function(e,i){if(e&1){let r=zt();Y(0,"div")(1,"button",1),ot("click",function(){return rt(r),st(i.exportCSV())}),et(2,"Export CSV"),X()(),Ee(3,rN,3,0,"div",2),Md(4,"async"),Ee(5,sN,5,1,"div",3),Md(6,"async"),Ee(7,oN,2,0,"ng-template",null,0,Pa)}if(e&2){let r=Ca(8);nt(3),Ct("ngIf",Od(4,3,i.user$)),nt(2),Ct("ngIf",Od(6,5,i.user$))("ngIfElse",r)}},dependencies:[mn,Sy],styles:["button[_ngcontent-%COMP%]{padding:10px 20px;font-size:16px;cursor:pointer}"]})};var aN=[{path:"history",loadChildren:()=>import("./chunk-4F5S3GKN.js").then(n=>n.HistoryModule)},{path:"statistics",component:hd},{path:"export",component:gd},{path:"details",component:dd},{path:"",pathMatch:"full",component:hh}],md=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=gi({type:n});static \u0275inj=pi({imports:[jd.forRoot(aN,{useHash:!0}),jd]})};function cN(n,t){if(n&1){let e=zt();Y(0,"div",1)(1,"span"),et(2),X(),Y(3,"span",2),ot("click",function(){rt(e);let r=tt();return st(r.onCloseNotification())}),et(4,"X"),X()()}if(n&2){let e=tt();nt(2),gn(e.message)}}var _d=class n{constructor(t){this.notificationService=t;this.notificationService.message$.pipe(uy(this.destroySubject)).subscribe(e=>{this.showMessage(e)})}message="";show=!1;destroySubject=new zs;showMessage(t){this.message=t,this.show=!0,setTimeout(()=>{this.show=!1},5e3)}onCloseNotification(){this.show=!1}ngOnDestroy(){this.destroySubject.next(),this.destroySubject.complete()}static \u0275fac=function(e){return new(e||n)($t(Oo))};static \u0275cmp=Oe({type:n,selectors:[["app-notification"]],decls:1,vars:1,consts:[["class","notification-container",4,"ngIf"],[1,"notification-container"],[1,"notification-close",3,"click"]],template:function(e,i){e&1&&Ee(0,cN,5,1,"div",0),e&2&&Ct("ngIf",i.show)},dependencies:[mn],styles:[".notification-container[_ngcontent-%COMP%]{position:fixed;top:92px;right:0;z-index:9999;width:300px;padding:15px;margin:15px;background-color:#346078;color:#fff;opacity:.9;border-radius:5px;box-shadow:0 0 10px #00000080;transition:top .5s}.notification-container[_ngcontent-%COMP%]   .notification-close[_ngcontent-%COMP%]{position:absolute;top:15px;right:15px;cursor:pointer}"]})};var yd=class n{title="expenses";static \u0275fac=function(e){return new(e||n)};static \u0275cmp=Oe({type:n,selectors:[["app-root"]],decls:2,vars:0,template:function(e,i){e&1&&me(0,"router-outlet")(1,"app-notification")},dependencies:[Uy,_d]})};var vd=class n extends Nd{override={swipe:{direction:Hammer.DIRECTION_HORIZONTAL,threshold:10,velocity:.3}};static \u0275fac=(()=>{let t;return function(i){return(t||(t=fy(n)))(i||n)}})();static \u0275prov=Me({token:n,factory:n.\u0275fac})};var bd=class n{static \u0275fac=function(e){return new(e||n)};static \u0275mod=gi({type:n,bootstrap:[yd]});static \u0275inj=pi({providers:[{provide:Py,useClass:vd},NI(VI())],imports:[Cy,md,Hy,Oy,ky,Yy.initializeApp(Gx),Hx]})};Ay().bootstrapModule(bd,{ngZoneEventCoalescing:!0}).catch(n=>console.error(n));
